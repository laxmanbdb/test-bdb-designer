/*! BDB Dashboard Designer V10.0.0 (2025-08-14 11:38:13) 
 Copyright 2015-2024 BDB (BizViz Technologies Pvt Ltd). All Rights Reserved */
var designerModules={module:{ComponentManager:"component-manager",DashboardManager:"dashboard-manager",WorkspaceManager:"workspace-manager",DashboardDesignerManager:"dashboard-designer",DataSourceManager:"datasource-manager",DesignerManager:"designer-manager",DesignerPropertyManager:"designer-property-manager",MainMenuManager:"mainmenu-manager",PropertyManager:"property-manager",UserScriptManager:"userscript-manager",HelpManager:"help-manager"}};!function(){"use strict";angular.module("designer",["ngDraggable","cgNotify","ui.select2","ui.bootstrap","ui.codemirror","pascalprecht.translate","cfp.hotkeys","bvz.numberspinner","ngMaterial","textAngular",designerModules.module.DesignerManager,designerModules.module.MainMenuManager,designerModules.module.DashboardDesignerManager,designerModules.module.DesignerPropertyManager,designerModules.module.HelpManager]),angular.module(designerModules.module.DesignerPropertyManager,[designerModules.module.ComponentManager,designerModules.module.DataSourceManager,designerModules.module.PropertyManager,designerModules.module.UserScriptManager]),angular.module(designerModules.module.MainMenuManager,[designerModules.module.DashboardManager,designerModules.module.WorkspaceManager]),angular.module(designerModules.module.DesignerManager,[]),angular.module(designerModules.module.DashboardManager,[]),angular.module(designerModules.module.WorkspaceManager,[]),angular.module(designerModules.module.DashboardDesignerManager,[]),angular.module(designerModules.module.ComponentManager,[]),angular.module(designerModules.module.DataSourceManager,[]),angular.module(designerModules.module.PropertyManager,[]),angular.module(designerModules.module.UserScriptManager,[]),angular.module(designerModules.module.HelpManager,[])}(),angular.module(designerModules.module.UserScriptManager).controller("ComponentAttributeController",["$scope","$timeout","ServiceFactory",function(i,d,e){i.varAs="COMPONENT",i.showCompSearch=!1,i.showConnSearch=!1,i.uiActive={variable:{}},i.showSearchField=function(e){switch(e){case"COMPONENT":i.showCompSearch?(i.compSearch="",i.showCompSearch=!1):(i.showCompSearch=!0,d(function(){$("#vCompSearch").focus()},10));break;case"CONNECTION":i.showConnSearch?(i.connSearch="",i.showConnSearch=!1):(i.showConnSearch=!0,d(function(){$("#vConnSearch").focus()},10))}},i.connSortCfg={axis:"y",tolerance:"pointer",containment:"parent",cursor:"move",revert:!0,placeholder:"s-o-p-h",scroll:!0,handle:".connReorderDragDiv",start:function(e,o){i.oldConnIndex=o.item.index()},stop:function(e,o){var a=o.item.index();d(function(){i.updateConnindex(i.oldConnIndex,a)},0)}},i.updateConnindex=function(e,o){var a=i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL;a&&0<a.length&&(Array.prototype.move=function(e,o){var a=!1;if(o>=this.length)for(var t=o-this.length,a=!0;1+t--;)this.push(void 0);if(this.splice(o,0,this.splice(e,1)[0]),a){var s=JSON.parse(JSON.stringify(this));this.splice(0,this.length);for(var n=0;n<s.length;n++)void 0!==s[n]&&null!==s[n]&&this.push(s[n])}},a.move(e,o))},i.resetComponentAttributesList=function(){i.modal.cm.refresh()},i.appearAsSelectedVariableList=function(e){$(".var-list").removeClass("active-workspace"),e.addClass("active-workspace")},i.addDatasetBtnOnComponents=function(e){return i.modal.isDatasetEnabled=IsBoolean(i.getComponentbyId(e).isDataSetAvailable),i.modal.isDatasetEnabled},i.dashboardPropertiesBtnClickHandler=function(){i.createPropertyPalette(i.modal.selectedDashboard.id,!0)},i.setSelectedVariable=function(e,o,a){var t,s,n,r=function(e,o){i.deselectAllComponent(),i.modal.selectedComponentId=o,i.modal.selectedComponentContainer="#"+i.modal.selectedDashboard.id,i.addToSelectedComponentList(o),IsBoolean(e)||d(function(){i.displayAsSelected(o),i.showResizableHandles(o),i.showSettingsBtn(o)},0),d(i.$apply.bind(i))},l=function(e){e&&("object"==typeof e?(i.uiActive.dashboard=!1,i.uiActive.variable.isUiActiveCA=!1,e.isUiActiveCA=e.isUiActiveCA||!0,i.uiActive.variable=e):(i.uiActive.variable.isUiActiveCA=!1,i.uiActive.dashboard=!0))};if(a)try{switch(a){case"Component":i.modal.selectedDashboard.json.Dashboard[i.modal.layoutType].Object.map(function(e){e&&null!=e&&(e.isUiActiveCA=!1)}),(n=(s=o).objectID)&&(i.selectedVariable=s.variable,i.varAs="COMPONENT",r(s.showLocked,n),i.resetFunctionWindow(void 0,!0,a),i.fetchAttributes(o),i.modal.scriptFor=s.objectName,i.populateGvarDefaultValueList(),l(s));break;case"Connection":t=o,i.selectedVariable=t.variable,i.varAs="CONNECTION",i.modal.scriptFor=t.connectionName,i.resetFunctionWindow(void 0,!1,a),i.populateGvarDefaultValueList(),l(t);break;case"Dashboard":i.selectedVariable=null,i.varAs="Dashboard",i.modal.scriptFor="Dashboard",i.resetFunctionWindow(void 0,!1,a),l("Dashboard");break;default:i.selectedVariable=null}}catch(e){}finally{d(function(){i.modal.cm.refresh(),i.modal.cm.focus()},10),$('.nav-tabs a[href="#scriptContent"]').closest("li").removeClass("active"),$('.nav-tabs a[href="#scriptContent"]').tab("show"),$(".c-group").removeClass("selected-group")}},i.fetchAttributes=function(e){var o;e[e.subElement].DataSet?(o=e[e.subElement].DataSet.Fields,i.checkAndFill(o)):IsBoolean(e.isDataSetAvailable)&&!IsBoolean(e.isValueFieldsAvailable)||null!=(o=e[e.subElement].fieldName)&&i.checkAndFill([{Name:o}])},i.checkAndFill=function(e){var o=angular.copy(i.selectedVariable.DefaultValues.DefaultValue);if(i.selectedVariable.DefaultValues.DefaultValue=[],i.modal.selectedVariableDefaultValue="",e)for(var a=0;a<e.length;a++){var t,s,n=e[a],r=DesignerUtil.prototype.findInArray(o,"name",n.Name);null==r?(t=i.selectedVariable.Key+"."+n.Name,i.pushToDefaultValues(n.Name,"",t,t)):(t=r.displayTag,s=new RegExp("{(.*?)}"),s=r.actualTag.match(s)[1],i.pushToDefaultValues(n.Name,r.text,t,s))}},i.deleteAttribute=function(e){e=i.selectedVariable.DefaultValues.DefaultValue.indexOf(e);i.selectedVariable.DefaultValues.DefaultValue.splice(e,1)},i.createNewAttribute=function(){""!=i.modal.selectedDashboard?i.showModelPopup("gvarAddAttrModal"):e.showNotification("No dashboard found","alert-success",3e3)},i.onNewAttributeAdd=function(){var e=DesignerUtil.prototype.findInArray(i.selectedVariable.DefaultValues.DefaultValue,"name",i.newAttributeName);null==e?i.pushToDefaultValues(i.newAttributeName,i.newAttributeValue,i.selectedVariable.Key.$scope.newAttributeName,i.selectedVariable.Key.$scope.newAttributeName):e.value=i.newAttributeValue},i.pushToDefaultValues=function(e,o,a,t){var s;null==DesignerUtil.prototype.findInArray(i.selectedVariable.DefaultValues.DefaultValue,"name",e)&&((s=i.getNewDefaultValueJson()).name=e,s.text=o,s.displayTag=a,s.actualTag="{"+t+"}",s.actualTagForLabels="["+t+"]",i.selectedVariable.DefaultValues.DefaultValue.push(s),i.modal.selectedVariableDefaultValue=i.selectedVariable.DefaultValues.DefaultValue)},i.getNewDefaultValueJson=function(e){return angular.copy(i.modal.selectedDashboard.json.GlobalVariable_Variable_DefaultValues_DefaultValue,e)},i.showDashboardScript=function(){$('.nav-tabs a[href="#scriptContent"]').tab("show")},i.isComponentInCompList=function(e){return null==i.compSearch||-1<e.referenceID.toLowerCase().indexOf(i.compSearch.toLowerCase())},i.isConnInConnList=function(e){return null==i.connSearch||-1<e.connectionName.toLowerCase().indexOf(i.connSearch.toLowerCase())},i.initComponentAttribute=function(){i.uiActive={variable:{isUiActiveCA:!1},dashboard:!1}},i.printer=function(e){}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("ComponentController",["$scope","ServiceFactory",function(s,e){s.types=[{value:"all",label:"All",header:"Components"},{value:"chart",label:"Charts",header:"Charts"},{value:"container",label:"Containers",header:"Containers"},{value:"datagrid",label:"Grids",header:"Grids"},{value:"filter",label:"Filters",header:"Filters"},{value:"singleValuedComponent",label:"Others",header:"Others"}],s.cat=s.types[0],e.getJsonFileData("./resources/data/Components.data",function(e){s.allComponentData=e,s.componentData=e}),s.drag=function(e){e.dataTransfer.setData("text",e.target.id)},s.isComponentInList=function(e){return null==s.query||-1<e.name.toLowerCase().indexOf(s.query.toLowerCase())},s.filterComponentData=function(e){var o=s.allComponentData;if("all"!=e){for(var a=[],t=0;t<o.length;t++)o[t].type==e&&a.push(o[t]);s.componentData=a}else s.componentData=o}}]),angular.module("designer").controller("DashboardDesignerController",["$rootScope","$scope","$timeout","ServiceFactory","DesignerFactory","$translate","$cacheFactory","textAngularManager",function(e,F,C,T,p,o,a,s){F.modal=p,F.selectedTemplate={},F.gradientColorList=[],F.customprop={},F.selectedTheme={},F.selectedGlobalProperty={},F.designerThemeInfo={},F.custompropBubbleBand={},F.custompropRangeIndicator={},F.custompropBulletBand={},F.custompropGaugeIndicator={},F.prePos={},F.cSpaceMap={},F.tabIndex=0,F.isOpen=!0,F.component="",F.cAllJson={},F.customThemeUpdateDropdown={heading:""},F.addNewDashboardDiv=function(a,t,s,n){F.loadComps(),T.getJsonFileData("./resources/data/property/dashboard.data",function(e){F.modal.globalFontProperties=e["Global Font And Themes"][4].options}),T.getJsonFileData("./resources/bizvizchart-themes/default-theme/chart/CopyComponent.data",function(e){F.modal.copyJson=e.Properties.Object}),T.getJsonFileData("./resources/bizvizchart-themes/default-theme/AllComponentsData.data",function(e){F.cAllJson=e}),T.getJsonFileData("./resources/data/dashboard.data",function(o){F.modal.selectedDashboard={id:a,name:t,json:o},F.modal.selectedDashboard.componentObjectList={},F.modal.selectedDashboard.json.Dashboard.id=a,F.modal.selectedDashboard.json.Dashboard.name=t,F.setSnapToGridSize(),F.modal.layoutType="AbsoluteLayout",F.appendDesignDataForDashboard(),F.selectedTheme[F.getActiveDashboardId()]=o.Dashboard.AbsoluteLayout.designerTheme||"default-theme",F.loadDesignerThemeInfo(F.selectedTheme[F.getActiveDashboardId()],function(){var e;F.initHintVariables(a),n?(e=F.selectedTemplate.tPath||F.modal.responsiveTemplates[0],T.getJsonFileData(e,function(e){F.modal.selectedDashboard.json.Dashboard.Containers=e,F.modal.selectedDashboard.json.Dashboard.responsive=!0,s(a,t,o,n)})):s(a,t,o),F.modal.dashboards.push(F.modal.selectedDashboard)}),F.selectedGlobalProperty[F.getActiveDashboardId()]={},F.selectedGlobalProperty[F.getActiveDashboardId()].AbsoluteLayout=o.Dashboard.AbsoluteLayout.globalProperties,F.selectedGlobalProperty[F.getActiveDashboardId()].MobileLayout=o.Dashboard.MobileLayout.globalProperties,F.selectedGlobalProperty[F.getActiveDashboardId()].TabletLayout=o.Dashboard.TabletLayout.globalProperties})},F.addNewDashboardTemplateDiv=function(l,i,d,c,u){F.loadComps(),T.getJsonFileData("./resources/data/dashboard.data",function(e){F.modal.selectedDashboard={id:l,name:i,json:u},F.modal.selectedDashboard.componentObjectList={};for(var o=u.Dashboard.AbsoluteLayout.Object,a=[],t=[],s=0;s<o.length;s++){var n={objectID:o[s].objectID},r={id:o[s].objectID,name:o[s].objectName,refId:o[s].referenceID};a.push(n),t.push(r)}F.modal.selectedDashboard.componentObjectList=a,F.modal.selectedDashboard.objectsList=t,F.modal.selectedDashboard.json.Dashboard.id=l,F.modal.selectedDashboard.json.Dashboard.name=i,F.setSnapToGridSize(),F.modal.layoutType="AbsoluteLayout",F.appendDesignDataForDashboard(),F.selectedTheme[F.getActiveDashboardId()]=u.Dashboard.AbsoluteLayout.designerTheme||"default-theme",F.loadDesignerThemeInfo(F.selectedTheme[F.getActiveDashboardId()],function(){var e;F.initHintVariables(l),c?(e=F.selectedTemplate.tPath||F.modal.responsiveTemplates[0],T.getJsonFileData(e,function(e){F.modal.selectedDashboard.json.Dashboard.Containers=e,F.modal.selectedDashboard.json.Dashboard.responsive=!0,d(l,i,u,c)})):d(l,i,u),F.modal.dashboards.push(F.modal.selectedDashboard)})})},F.appendDesignDataForDashboard=function(){var e;F.modal.selectedDashboard.json.Dashboard.variable||((e=F.getNewVariableJson({})).Key="dashboard",F.modal.selectedDashboard.json.Dashboard.variable=e)},F.handleContextMenuSelection=function(e,o){if(o)return!1;switch(e){case"doPreview":F.togglePreview();break;case"dataSources":F.toggleDataSource();break;case"components":F.toggleComponents();break;case"dashboardObjects":F.objectBrowserWindow();break;case"componentAttributes":F.toggleVariableWindow("0");break;case"selectAll":F.selectAllComponents();break;case"dbProperties":F.dashboardDblClickHandler(F.modal.selectedDashboard.id);break;case"compProperties":F.executeAction(F.modal.selectedComponentId,"openPropWindow");break;case"dataSets":F.executeAction(F.modal.selectedComponentId,"openDatasetWindow");break;case"scriptOnChange":F.executeAction(F.modal.selectedComponentId,"openFnWindow");break;case"duplicate":F.createDuplicate(!1,F.getComponentbyId(F.modal.selectedComponentId));break;case"copyProperties":F.copyProperties(F.getComponentbyId(F.modal.selectedComponentId));break;case"pasteProperties":F.pasteProperties(F.getComponentbyId(F.modal.selectedComponentId));break;case"compRemove":F.executeAction(F.modal.selectedComponentId,"removeComponent");break;case"alignLeft":F.alignLeft();break;case"alignRight":F.alignRight();break;case"alignTop":F.alignTop();break;case"alignBottom":F.alignBottom();break;case"alignHorizontal":F.alignHorizontal();break;case"alignVertical":F.alignVertical();break;case"equalHorizontal":F.equalHorizontal();break;case"equalVertical":F.equalVertical();break;case"equalHeight":F.equalHeight();break;case"equalWidth":F.equalWidth();break;case"duplicateComponents":F.duplicateComponents(F.modal.listOfSelectedComponents);break;case"deleteAll":F.doYouWantToDeleteAll();break;case"sendToBack":F.sendToBack();break;case"sendBackward":F.sendBackward();break;case"bringToFront":F.bringToFront();break;case"bringForward":F.bringForward();break;case"manageGroup":F.showGroupPanel();break;case"lockComp":F.lockSelectedComponent();break;case"unLockComp":F.unLockSelectedComponent();break;default:T.showNotification("Invalid selection","alert-warning",3e3)}},F.initContextMenu=function(){$("body").on("mouseenter",".bizvizComponent",function(e){e.stopPropagation(),$(this).dContextMenu({menuSelector:["#alignmentCxtMenu","#compCxtMenu"],containment:".draggablesParentDiv",menuSelected:function(e,o,a){var t=null,t=(o[0],o[0].parentNode.id),o=$(o[0].parentNode).hasClass("disabled");F.handleContextMenuSelection(t,o)}},F.isMultiEleSelected)}),$("body").on("mouseenter",".draggablesParentDiv",function(e){e.stopPropagation(),$(this).dContextMenu({menuSelector:["#alignmentCxtMenu","#dbCxtMenu"],containment:".draggablesParentDiv",menuSelected:function(e,o,a){var t=null,t=(o[0].localName,o[0].parentNode.id),o=$(o[0].parentNode).hasClass("disabled");F.handleContextMenuSelection(t,o)}},F.isMultiEleSelected)})},F.initContextMenu(),F.isMultiEleSelected=function(){return 1<F.modal.listOfSelectedComponents.length},F.dashboardBodyClickHandler=function(e){},F.dashboardDblClickHandler=function(e){F.createPropertyPalette(e,!0)},F.manageDatasetColors=function(e){var o=e[e.subElement].DataSet;if(o&&o.Fields&&0<o.Fields.length)for(var a=0;a<o.Fields.length;a++)F.datasetcolor?F.datasetcolor[o.id]||(F.datasetcolor[o.id]={}):(F.datasetcolor={},F.datasetcolor[o.id]={}),F.datasetcolor[o.id][o.Fields[a].Name]={},F.datasetcolor[o.id][o.Fields[a].Name].Color=o.Fields[a].Color},F.SupportOldConfiguredDashboard=function(e){if(e){switch(F.manageDatasetColors(e),e.groupings=e.groupings||"",e.objectType){case"datagrid":e[e.subElement].pagination=void 0===e[e.subElement].pagination?"false":e[e.subElement].pagination,e[e.subElement].maxRow=null==e[e.subElement].maxRow?"10":e[e.subElement].maxRow,e[e.subElement].exportToCSV=null==e[e.subElement].exportToCSV?"true":e[e.subElement].exportToCSV;break;case"exportppt":e.designData.type="singleValuedComponent",null==e[e.subElement].exportWindow&&(e[e.subElement].exportWindow="true"),e[e.subElement].pdfType=void 0===e[e.subElement].pdfType?"screenshot":e[e.subElement].pdfType,e[e.subElement].pdfGridType=void 0===e[e.subElement].pdfGridType?"striped":e[e.subElement].pdfGridType,e[e.subElement].pdfTabularOrientation=void 0===e[e.subElement].pdfTabularOrientation?"l":e[e.subElement].pdfTabularOrientation,e[e.subElement].pdfFilterDetails=void 0===e[e.subElement].pdfFilterDetails?"false":e[e.subElement].pdfFilterDetails,e[e.subElement].pdfPages=void 0===e[e.subElement].pdfPages?"single":e[e.subElement].pdfPages,e[e.subElement].pdfHeadingColor=void 0===e[e.subElement].pdfHeadingColor?"#006684":e[e.subElement].pdfHeadingColor,e[e.subElement].pdfSubHeadingColor=void 0===e[e.subElement].pdfSubHeadingColor?"#f5f5f5":e[e.subElement].pdfSubHeadingColor,e[e.subElement].pdfHeadingOpacity=void 0===e[e.subElement].pdfHeadingOpacity?1:e[e.subElement].pdfHeadingOpacity,e[e.subElement].pdfSubHeadingOpacity=void 0===e[e.subElement].pdfSubHeadingOpacity?1:e[e.subElement].pdfSubHeadingOpacity,e[e.subElement].pdfHFontColor=void 0===e[e.subElement].pdfHFontColor?"#ffffff":e[e.subElement].pdfHFontColor,e[e.subElement].pdfSHFontColor=void 0===e[e.subElement].pdfSHFontColor?"#000000":e[e.subElement].pdfSHFontColor,e[e.subElement].showDataServices=void 0===e[e.subElement].showDataServices?"true":e[e.subElement].showDataServices,e[e.subElement].showExcel=void 0===e[e.subElement].showExcel?"true":e[e.subElement].showExcel,e[e.subElement].showPpt=void 0===e[e.subElement].showPpt?"true":e[e.subElement].showPpt,e[e.subElement].showPdf=void 0===e[e.subElement].showPdf?"true":e[e.subElement].showPdf,e[e.subElement].showPng=void 0===e[e.subElement].showPng?"true":e[e.subElement].showPng,e[e.subElement].showPrint=void 0===e[e.subElement].showPrint?"true":e[e.subElement].showPrint;break;case"image":null==e[e.subElement].cursorType&&(e[e.subElement].cursorType="default");break;case"date":null==e[e.subElement].enhanceddate&&(e[e.subElement].enhanceddate=!1),null==e[e.subElement].datetype&&(e[e.subElement].datetype="none"),null==e[e.subElement].backgroundColor&&(e[e.subElement].backgroundColor="#dddddd"),null==e[e.subElement].monthNavigationEnabled&&(e[e.subElement].monthNavigationEnabled=!1),null==e[e.subElement].yearRange&&(e[e.subElement].yearRange="10"),null==e[e.subElement].startdatecolor&&(e[e.subElement].startdatecolor="#000000"),null==e[e.subElement].enddatecolor&&(e[e.subElement].enddatecolor="#000000");case"label":e[e.subElement].labelPadding=e[e.subElement].labelPadding||0,e[e.subElement].cursorType=e[e.subElement].cursorType||"pointer",e[e.subElement].labelTextRotation=e[e.subElement].labelTextRotation||"horizontal",null==e[e.subElement].borderWidth&&(e[e.subElement].borderWidth=0),null==e[e.subElement].hoverEnabled&&(e[e.subElement].hoverEnabled=!1),null==e[e.subElement].hoverColor&&(e[e.subElement].hoverColor="#dddddd"),F.addDefaultLabelFormatterProperties(e);break;case"SVGImage":case"SVGShape":null==e[e.subElement].cursorType&&(e[e.subElement].cursorType="pointer");break;case"filterchips":null==e[e.subElement].imgData&&(e[e.subElement].imgData=""),null==e[e.subElement].chipsTitle&&(e[e.subElement].chipsTitle="Applied Filters"),null==e[e.subElement].btnTitle&&(e[e.subElement].btnTitle="All Filters"),null==e[e.subElement].popupTitle&&(e[e.subElement].popupTitle="Additional Filters"),null==e[e.subElement].chipsBgColor&&(e[e.subElement].chipsBgColor="#efefef"),null==e[e.subElement].chipsFontColor&&(e[e.subElement].chipsFontColor="#000000"),null==e[e.subElement].btnBgColor&&(e[e.subElement].btnBgColor="#ffffff"),null==e[e.subElement].filterBgColor&&(e[e.subElement].filterBgColor="#ffffff"),null==e[e.subElement].filterHeaderBgColor&&(e[e.subElement].filterHeaderBgColor="#EFF0F0"),null==e[e.subElement].closeBtnBgColor&&(e[e.subElement].closeBtnBgColor="#000000"),null==e[e.subElement].showAllFilterButton&&(e[e.subElement].showAllFilterButton=!0),null==e[e.subElement].showChipsCount&&(e[e.subElement].showChipsCount=!0);break;case"gauge":case"semigauge":e[e.subElement].SecondaryUnit=e[e.subElement].SecondaryUnit||"none",e[e.subElement].Unit=e[e.subElement].Unit||"none",e[e.subElement].Precision=e[e.subElement].Precision||"default",e[e.subElement].SignPosition=e[e.subElement].SignPosition||"prefix";break;case"legend":""!==e.Legend.associatedChartId&&F.addDefaultLegendProperties(e),e.Legend.legendTextAlign=void 0===e.Legend.legendTextAlign?"left":e.Legend.legendTextAlign,e.Legend.rowPadding=void 0===e.Legend.rowPadding?"4":e.Legend.rowPadding,e.Legend.columnPadding=void 0===e.Legend.columnPadding?"0":e.Legend.columnPadding;break;case"hslider":null==e[e.subElement].backgroundColor&&(e[e.subElement].backgroundColor="#FFFFFF",e[e.subElement].backgroundAlpha="0"),e[e.subElement].unit=void 0===e[e.subElement].unit?"auto":e[e.subElement].unit,e[e.subElement].freezeHandle=void 0===e[e.subElement].freezeHandle?"false":e[e.subElement].freezeHandle,e[e.subElement].enhancedHSlider=void 0===e[e.subElement].enhancedHSlider?"false":e[e.subElement].enhancedHSlider;break;case"vslider":null==e[e.subElement].backgroundColor&&(e[e.subElement].backgroundColor="#FFFFFF",e[e.subElement].backgroundAlpha="0"),e[e.subElement].unit=void 0===e[e.subElement].unit?"auto":e[e.subElement].unit,e[e.subElement].freezeHandle=void 0===e[e.subElement].freezeHandle?"false":e[e.subElement].freezeHandle,e[e.subElement].enhancedVSlider=void 0===e[e.subElement].enhancedVSlider?"false":e[e.subElement].enhancedVSlider;break;case"chart":switch(e[e.subElement].updatedDesign=void 0===e[e.subElement].updatedDesign?"false":e[e.subElement].updatedDesign,e[e.subElement].exportToCSV=void 0===e[e.subElement].exportToCSV||e[e.subElement].exportToCSV,e[e.subElement].Type){case"Bar":if(null==e[e.subElement].showSettingMenuButton&&(e[e.subElement].showSettingMenuButton=!1),"350"==e[e.subElement].controlBarWidth&&(e[e.subElement].controlBarWidth="auto"),null==e[e.subElement].enableAnimation&&(e[e.subElement].enableAnimation=!1),null==e[e.subElement].enablethresholdfill&&(e[e.subElement].enablethresholdfill=!1),null==e[e.subElement].thresholdfilllevel&&(e[e.subElement].thresholdfilllevel="low,middle,top"),null==e[e.subElement].thresholdfillcolor&&(e[e.subElement].thresholdfillcolor="#ffea00,#00FF00,#ff0000"),null==e[e.subElement].thresholdfillopacity&&(e[e.subElement].thresholdfillopacity="0.3,0.3,0.3"),null==e[e.subElement].thresholdfilllabel&&(e[e.subElement].thresholdfilllabel="Low,Middle,Top"),null==e[e.subElement].thresholdfilllabelcolor&&(e[e.subElement].thresholdfilllabelcolor="#000000,#000000,#000000"),null==e[e.subElement].showSlider&&(e[e.subElement].showSlider=!1),null==e[e.subElement].sliderBorderColor&&(e[e.subElement].sliderBorderColor="#cccccc"),null==e[e.subElement].sliderHeightRatio&&(e[e.subElement].sliderHeightRatio="7"),null==e[e.subElement].sliderRangeFlag&&(e[e.subElement].sliderRangeFlag=!1),null==e[e.subElement].sliderRangeValue&&(e[e.subElement].sliderRangeValue="10"),null==e[e.subElement].sliderPosition&&(e[e.subElement].sliderPosition="default"),null==e[e.subElement].sliderBorderOpacity&&(e[e.subElement].sliderBorderOpacity="0.5"),null==e[e.subElement].sliderOpacitySelection&&(e[e.subElement].sliderOpacitySelection="0.5"),null==e[e.subElement].sliderOpacityContainer&&(e[e.subElement].sliderOpacityContainer="0.1"),null==e[e.subElement].showRangeSelector&&(e[e.subElement].showRangeSelector=!1),null==e[e.subElement].rangeSelectorOpacity&&(e[e.subElement].rangeSelectorOpacity="0.2"),null==e[e.subElement].showSliderText&&(e[e.subElement].showSliderText=!1),null==e[e.subElement].sliderRange&&(e[e.subElement].sliderRange="auto"),e[e.subElement].stackBorderRadius=null!=e[e.subElement].stackBorderRadius?e[e.subElement].stackBorderRadius:"0",e[e.subElement].stackBorderColor=null!=e[e.subElement].stackBorderColor?e[e.subElement].stackBorderColor:"#ffffff",e[e.subElement].stackBorderWidth=null!=e[e.subElement].stackBorderWidth?e[e.subElement].stackBorderWidth:"0",e.Chart.DataSet&&e.Chart.DataSet.Fields)for(var o=0;o<e.Chart.DataSet.Fields.length;o++)"Series"==e.Chart.DataSet.Fields[o].Type&&((d=e.Chart.DataSet.Fields[o]).DataLabelCustomProperties.datalabelBackgroundRect=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRect&&d.DataLabelCustomProperties.datalabelBackgroundRect,d.DataLabelCustomProperties.datalabelBackgroundRectColor=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRectColor?d.DataLabelCustomProperties.datalabelBackgroundRectColor:"#ffffff",d.DataLabelCustomProperties.datalabelStrokeColor=void 0!==d.DataLabelCustomProperties.datalabelStrokeColor?d.DataLabelCustomProperties.datalabelStrokeColor:"#000000");null==e[e.subElement].ShowXAxisThreshold&&(e[e.subElement].ShowXAxisThreshold=!1),null==e[e.subElement].MinimumXAxisThreshold&&(e[e.subElement].MinimumXAxisThreshold="0"),null==e[e.subElement].MaximumXAxisThreshold&&(e[e.subElement].MaximumXAxisThreshold="50"),null==e[e.subElement].minimumthresholdstrokecolor&&(e[e.subElement].minimumthresholdstrokecolor="#00FF00"),null==e[e.subElement].maximumthresholdstrokecolor&&(e[e.subElement].maximumthresholdstrokecolor="#FF0000");break;case"BenchmarkAnalysis":null==e[e.subElement].headerfontsize&&(e[e.subElement].headerfontsize="16"),null==e[e.subElement].headerfontcolor&&(e[e.subElement].headerfontcolor="#000000"),null==e[e.subElement].headerchromecolor&&(e[e.subElement].headerchromecolor="#E7E7E7"),null==e[e.subElement].headerfontweight&&(e[e.subElement].headerfontweight="bold"),null==e[e.subElement].gridlabelfontcolor&&(e[e.subElement].gridlabelfontcolor="#000000"),null==e[e.subElement].gridlabelfontsize&&(e[e.subElement].gridlabelfontsize="14"),null==e[e.subElement].gridlabelfontweight&&(e[e.subElement].gridlabelfontweight="normal"),null==e[e.subElement].fitColumns&&(e[e.subElement].fitColumns=!0),null==e[e.subElement].textWrap&&(e[e.subElement].textWrap=!1),null==e[e.subElement].showdatavalidation&&(e[e.subElement].showdatavalidation=!0);case"Bubble":if(F.addDynamicRangeProperties(e),F.addConditionalCategoryColors(e),e[e.subElement].SolidColorFill=e[e.subElement].SolidColorFill||"false",e.Chart.DataSet&&e.Chart.DataSet.Fields)for(var a,t=0;t<e.Chart.DataSet.Fields.length;t++)"Series"==e.Chart.DataSet.Fields[t].Type&&(a=e.Chart.DataSet.Fields[t],null==IsBoolean(e[e.subElement].rangeEnabledSeries)?a.ColorField=a.ColorField:IsBoolean(e[e.subElement].rangeEnabledSeries)?a.ColorField=a.ColorField||"":a.ColorField="");break;case"BoxPlot":e[e.subElement].legendfontFamily=e[e.subElement].legendfontFamily||"Ubuntu";break;case"CandleStick":e[e.subElement].showTooltipCategory=e[e.subElement].showTooltipCategory||"true";break;case"Circumplex":e[e.subElement].lineWidth=e[e.subElement].lineWidth||100,null==e[e.subElement].enableAnimation&&(e[e.subElement].enableAnimation=!1);break;case"Decomposition":e[e.subElement].showPercentage=e[e.subElement].showPercentage||"true",e[e.subElement].maxNodes=e[e.subElement].maxNodes||"10",e[e.subElement].aggregationType=e[e.subElement].aggregationType||"sum",e[e.subElement].nodeColor=e[e.subElement].nodeColor||"#f5f5f5",e[e.subElement].fillColor=e[e.subElement].fillColor||"#0d78bf",e[e.subElement].nodeHeight=e[e.subElement].nodeHeight||30,e[e.subElement].labelFontColor=e[e.subElement].labelFontColor||"#000000",e[e.subElement].labelFontSize=e[e.subElement].labelFontSize||"12",e[e.subElement].labelFontStyle=e[e.subElement].labelFontStyle||"normal",e[e.subElement].labelFontWeight=e[e.subElement].labelFontWeight||"normal",e[e.subElement].labelFontFamily=e[e.subElement].labelFontFamily||"BizvizFont",e[e.subElement].labelValueFontColor=e[e.subElement].labelValueFontColor||"#000000",e[e.subElement].labelValueFontSize=e[e.subElement].labelValueFontSize||"12",e[e.subElement].labelValueFontStyle=e[e.subElement].labelValueFontStyle||"normal",e[e.subElement].labelValueFontWeight=e[e.subElement].labelValueFontWeight||"normal",e[e.subElement].labelValueFontFamily=e[e.subElement].labelValueFontFamily||"BizvizFont";break;case"GroupBar":if(F.addConditionalCategoryColors(e),e[e.subElement].yAxis.subCategoryFontSize=e[e.subElement].yAxis.subCategoryFontSize||"10",e[e.subElement].stackBorderRadius=null!=e[e.subElement].stackBorderRadius?e[e.subElement].stackBorderRadius:"0",e[e.subElement].stackBorderColor=null!=e[e.subElement].stackBorderColor?e[e.subElement].stackBorderColor:"#ffffff",e[e.subElement].stackBorderWidth=null!=e[e.subElement].stackBorderWidth?e[e.subElement].stackBorderWidth:"0",null==e[e.subElement].SubCategoryColors&&(e[e.subElement].SubCategoryColors={},e[e.subElement].SubCategoryColors.subCategoryDefaultColor="",e[e.subElement].SubCategoryColors.subCategoryDefaultColorSet="",e[e.subElement].SubCategoryColors.showColorsFromSubCategoryName="false",e[e.subElement].SubCategoryColors.subCategoryColor=[]),null==e[e.subElement].enableAnimation&&(e[e.subElement].enableAnimation=!1),null==e[e.subElement].showSlider&&(e[e.subElement].showSlider=!1),null==e[e.subElement].sliderBorderColor&&(e[e.subElement].sliderBorderColor="#cccccc"),null==e[e.subElement].sliderHeightRatio&&(e[e.subElement].sliderHeightRatio="7"),null==e[e.subElement].sliderRangeFlag&&(e[e.subElement].sliderRangeFlag=!1),null==e[e.subElement].sliderRangeValue&&(e[e.subElement].sliderRangeValue="10"),null==e[e.subElement].sliderPosition&&(e[e.subElement].sliderPosition="default"),null==e[e.subElement].sliderBorderOpacity&&(e[e.subElement].sliderBorderOpacity="0.5"),null==e[e.subElement].sliderOpacitySelection&&(e[e.subElement].sliderOpacitySelection="0.5"),null==e[e.subElement].sliderOpacityContainer&&(e[e.subElement].sliderOpacityContainer="0.1"),null==e[e.subElement].showRangeSelector&&(e[e.subElement].showRangeSelector=!1),null==e[e.subElement].rangeSelectorOpacity&&(e[e.subElement].rangeSelectorOpacity="0.2"),null==e[e.subElement].showSliderText&&(e[e.subElement].showSliderText=!1),null==e[e.subElement].sliderRange&&(e[e.subElement].sliderRange="auto"),e.Chart.DataSet&&e.Chart.DataSet.Fields)for(o=0;o<e.Chart.DataSet.Fields.length;o++)"Series"==e.Chart.DataSet.Fields[o].Type&&((d=e.Chart.DataSet.Fields[o]).DataLabelCustomProperties.datalabelBackgroundRect=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRect&&d.DataLabelCustomProperties.datalabelBackgroundRect,d.DataLabelCustomProperties.datalabelBackgroundRectColor=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRectColor?d.DataLabelCustomProperties.datalabelBackgroundRectColor:"#ffffff",d.DataLabelCustomProperties.datalabelStrokeColor=void 0!==d.DataLabelCustomProperties.datalabelStrokeColor?d.DataLabelCustomProperties.datalabelStrokeColor:"#000000");break;case"GroupColumn":if(e[e.subElement].stackBorderRadius=null!=e[e.subElement].stackBorderRadius?e[e.subElement].stackBorderRadius:"0",e[e.subElement].stackBorderColor=null!=e[e.subElement].stackBorderColor?e[e.subElement].stackBorderColor:"#ffffff",e[e.subElement].stackBorderWidth=null!=e[e.subElement].stackBorderWidth?e[e.subElement].stackBorderWidth:"0",e[e.subElement].xAxis.xAxisCategoryTextWrap=e[e.subElement].xAxis.xAxisCategoryTextWrap||"false",e[e.subElement].xAxis.xAxisSubCategoryTextWrap=e[e.subElement].xAxis.xAxisSubCategoryTextWrap||"false",e.Chart.DataSet&&e.Chart.DataSet.Fields)for(o=0;o<e.Chart.DataSet.Fields.length;o++)"Series"==e.Chart.DataSet.Fields[o].Type&&((d=e.Chart.DataSet.Fields[o]).DataLabelCustomProperties.datalabelBackgroundRect=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRect&&d.DataLabelCustomProperties.datalabelBackgroundRect,d.DataLabelCustomProperties.datalabelBackgroundRectColor=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRectColor?d.DataLabelCustomProperties.datalabelBackgroundRectColor:"#ffffff",d.DataLabelCustomProperties.datalabelStrokeColor=void 0!==d.DataLabelCustomProperties.datalabelStrokeColor?d.DataLabelCustomProperties.datalabelStrokeColor:"#000000");break;case"HeatMap":F.addDynamicRangeProperties(e),"0xffffff"===e[e.subElement].bgGradients&&(e[e.subElement].bgGradients="#ffffff"),e[e.subElement].SolidColorFill=e[e.subElement].SolidColorFill||"false",null==e[e.subElement].enableAnimation&&(e[e.subElement].enableAnimation=!1),null==e[e.subElement].xAxis.xAxisTextWrap&&(e[e.subElement].xAxis.xAxisTextWrap=!1);break;case"KnowledgeGraph":e[e.subElement].customNodeTypeShapes=e[e.subElement].customNodeTypeShapes||"dot,box,ellipsis,star",e[e.subElement].customNodeRangeShapes=e[e.subElement].customNodeRangeShapes||"dot,box,ellipsis,star",e[e.subElement].customNodeTypeColors=e[e.subElement].customNodeTypeColors||"#E08283,#38d3a9,#797979,#eeeeee",e[e.subElement].customNodeRangeColors=e[e.subElement].customNodeRangeColors||"#E08283,#38d3a9,#797979,#eeeeee",e[e.subElement].customNodeLevelShapes=e[e.subElement].customNodeLevelShapes||"dot,star,square",e[e.subElement].customNodeLevelColors=e[e.subElement].customNodeLevelColors||"#E08283,#38d3a9,#797979",e[e.subElement].shapeLevel=e[e.subElement].shapeLevel||"Level1,Level2,Level3",e[e.subElement].colorLevel=e[e.subElement].colorLevel||"Level1,Level2,Level3",e[e.subElement].shapeType=e[e.subElement].shapeType||"Default",e[e.subElement].shapeDisplayName=e[e.subElement].shapeDisplayName||"Low,Medium,High,Very High",e[e.subElement].colorDisplayName=e[e.subElement].colorDisplayName||"Low,Medium,High,Very High",e[e.subElement].customShapeRange=e[e.subElement].customShapeRange||"0~5,5~10,10~20,20~30",e[e.subElement].customColorRange=e[e.subElement].customColorRange||"0~5,5~10,10~20,20~30";break;case"Line":if(F.addConditionalCategoryColors(e),e.Chart.DataSet&&e.Chart.DataSet.Fields)for(var s,n=0;n<e.Chart.DataSet.Fields.length;n++)"Series"==e.Chart.DataSet.Fields[n].Type&&((s=e.Chart.DataSet.Fields[n]).LineType=s.LineType||"straight",s.LineWidth=void 0!==s.LineWidth&&""!==s.LineWidth?s.LineWidth:2);null==e[e.subElement].showAnnotation&&(e[e.subElement].showAnnotation=!1),null==e[e.subElement].annotationDataType&&(e[e.subElement].annotationDataType="number"),null==e[e.subElement].annotationRadius&&(e[e.subElement].annotationRadius="1"),null==e[e.subElement].annotationOpacity&&(e[e.subElement].annotationOpacity="1"),null==e[e.subElement].annotationColor&&(e[e.subElement].annotationColor="#FF5733"),null==e[e.subElement].annotationFormat&&(e[e.subElement].annotationFormat="year"),null==e[e.subElement].annotationxdata&&(e[e.subElement].annotationxdata=[]),null==e[e.subElement].AnnotationTooltipTitle&&(e[e.subElement].AnnotationTooltipTitle="Annotation"),null==e[e.subElement].lineType&&(e[e.subElement].lineType="false"),void 0===e[e.subElement].Annotation&&(e[e.subElement].Annotation={Category:"2013, 2015, 2017",Label:"Low, Medium, High",DataSource:"",DataSourceId:"",DataLabel:"",DataValue:""}),null==e[e.subElement].ShowYAxisThreshold&&(e[e.subElement].ShowYAxisThreshold=!1),null==e[e.subElement].MinimumYAxisThreshold&&(e[e.subElement].MinimumYAxisThreshold="0"),null==e[e.subElement].MaximumYAxisThreshold&&(e[e.subElement].MaximumYAxisThreshold="50"),null==e[e.subElement].minimumthresholdstrokecolor&&(e[e.subElement].minimumthresholdstrokecolor="#00FF00"),null==e[e.subElement].maximumthresholdstrokecolor&&(e[e.subElement].maximumthresholdstrokecolor="#FF0000"),null==e[e.subElement].enableThresholdFill&&(e[e.subElement].enableThresholdFill=!1),null==e[e.subElement].thresholdFillLevel&&(e[e.subElement].thresholdFillLevel="low,middle,top"),null==e[e.subElement].thresholdFillColor&&(e[e.subElement].thresholdFillColor="#ffea00,#00FF00,#ff0000"),null==e[e.subElement].thresholdFillOpacity&&(e[e.subElement].thresholdFillOpacity="0.3,0.3,0.3"),null==e[e.subElement].thresholdFillLabel&&(e[e.subElement].thresholdFillLabel="Low,Middle,Top"),null==e[e.subElement].thresholdFillLabelColor&&(e[e.subElement].thresholdFillLabelColor="#000000,#000000,#000000");break;case"Mixed":null==e[e.subElement].ShowYAxisThreshold&&(e[e.subElement].ShowYAxisThreshold=!1),null==e[e.subElement].MinimumYAxisThreshold&&(e[e.subElement].MinimumYAxisThreshold="0"),null==e[e.subElement].MaximumYAxisThreshold&&(e[e.subElement].MaximumYAxisThreshold="50"),null==e[e.subElement].minimumthresholdstrokecolor&&(e[e.subElement].minimumthresholdstrokecolor="#00FF00"),null==e[e.subElement].maximumthresholdstrokecolor&&(e[e.subElement].maximumthresholdstrokecolor="#FF0000"),null==e[e.subElement].enablethresholdfill&&(e[e.subElement].enablethresholdfill=!1),null==e[e.subElement].thresholdfilllevel&&(e[e.subElement].thresholdfilllevel="low,middle,top"),null==e[e.subElement].thresholdfillcolor&&(e[e.subElement].thresholdfillcolor="#ffea00,#00FF00,#ff0000"),null==e[e.subElement].thresholdfillopacity&&(e[e.subElement].thresholdfillopacity="0.3,0.3,0.3"),null==e[e.subElement].thresholdfilllabel&&(e[e.subElement].thresholdfilllabel="Low,Middle,Top"),null==e[e.subElement].thresholdfilllabelcolor&&(e[e.subElement].thresholdfilllabelcolor="#000000,#000000,#000000"),null==e[e.subElement].showAnnotation&&(e[e.subElement].showAnnotation=!1),null==e[e.subElement].annotationDataType&&(e[e.subElement].annotationDataType="number"),null==e[e.subElement].annotationRadius&&(e[e.subElement].annotationRadius="1"),null==e[e.subElement].annotationOpacity&&(e[e.subElement].annotationOpacity="1"),null==e[e.subElement].annotationColor&&(e[e.subElement].annotationColor="#FF5733"),null==e[e.subElement].annotationFormat&&(e[e.subElement].annotationFormat="year"),null==e[e.subElement].annotationxdata&&(e[e.subElement].annotationxdata=[]),null==e[e.subElement].AnnotationTooltipTitle&&(e[e.subElement].AnnotationTooltipTitle="Annotation"),null==e[e.subElement].lineType&&(e[e.subElement].lineType="false"),void 0===e[e.subElement].Annotation&&(e[e.subElement].Annotation={Category:"2013, 2015, 2017",Label:"Low, Medium, High",DataSource:"",DataSourceId:"",DataLabel:"",DataValue:""});break;case"Pie":if(null==e[e.subElement].showSettingMenuButton&&(e[e.subElement].showSettingMenuButton=!1),null==e[e.subElement].actualValues&&(e[e.subElement].actualValues=!1),null==e[e.subElement].enableAnimation&&(e[e.subElement].enableAnimation=!1),void 0!==e.showSliceValue&&(e[e.subElement].showSliceValue=e.showSliceValue,delete e.showSliceValue),void 0!==e.sliceLimit&&(e[e.subElement].sliceLimit=e.sliceLimit,delete e.sliceLimit),F.addConditionalCategoryColors(e),e.Chart.DataSet&&e.Chart.DataSet.Fields)for(o=0;o<e.Chart.DataSet.Fields.length;o++)"Series"==e.Chart.DataSet.Fields[o].Type&&((d=e.Chart.DataSet.Fields[o]).DataLabelCustomProperties.datalabelBackgroundRect=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRect&&d.DataLabelCustomProperties.datalabelBackgroundRect,d.DataLabelCustomProperties.datalabelBackgroundRectColor=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRectColor?d.DataLabelCustomProperties.datalabelBackgroundRectColor:"#ffffff",d.DataLabelCustomProperties.datalabelStrokeColor=void 0!==d.DataLabelCustomProperties.datalabelStrokeColor?d.DataLabelCustomProperties.datalabelStrokeColor:"#000000");break;case"Plot":if(null==e[e.subElement].Legend&&(e[e.subElement].higherValuesAreGood=!0,e[e.subElement].showFrequencyBar=!1,e[e.subElement].Legend={},e[e.subElement].Legend.DisplayName="Very Low,Low,Medium,High,Very High,Extremely High",e[e.subElement].Legend.Ranges="0~20,20~30,30~50,50~70,70~100,100~140",e[e.subElement].Legend.Colors="#E74C3C,#DB0A5B,#F7CA18,#F89406,#36D7B7,#26A65B"),void 0===e[e.subElement].ShowXAxisThreshold&&(e[e.subElement].ShowXAxisThreshold="false"),void 0===e[e.subElement].MinimumXAxisThreshold&&(e[e.subElement].MinimumXAxisThreshold="0"),void 0===e[e.subElement].MaximumXAxisThreshold&&(e[e.subElement].MaximumXAxisThreshold="50"),void 0===e[e.subElement].ShowYAxisThreshold&&(e[e.subElement].ShowYAxisThreshold="false"),void 0===e[e.subElement].MinimumYAxisThreshold&&(e[e.subElement].MinimumYAxisThreshold="0"),void 0===e[e.subElement].MaximumYAxisThreshold&&(e[e.subElement].MaximumYAxisThreshold="50"),F.addDynamicRangeProperties(e),e[e.subElement].SolidColorFill=e[e.subElement].SolidColorFill||"false",e.Chart.DataSet&&e.Chart.DataSet.Fields)for(var r=0;r<e.Chart.DataSet.Fields.length;r++){var l=e.Chart.DataSet.Fields[r];l.OtherFieldDisplayName=l.OtherFieldDisplayName||l.Name,l.RadiusFieldDisplayName=l.RadiusFieldDisplayName||"Radius",l.ColorFieldDisplayName=l.ColorFieldDisplayName||"Color"}if(0<e.Chart.ConditionalColors.ConditionalColor.length)for(var i=0;i<e.Chart.ConditionalColors.ConditionalColor.length;i++)e.Chart.ConditionalColors.ConditionalColor[i].opacity=null==e.Chart.ConditionalColors.ConditionalColor[i].opacity?1:e.Chart.ConditionalColors.ConditionalColor[i].opacity;break;case"SparkLine":null==e[e.subElement].sparkLineType&&(e[e.subElement].sparkLineType=e[e.subElement].type),null==e[e.subElement].minimumAxisValue&&(e[e.subElement].minimumAxisValue="0"),null==e[e.subElement].autoaxisSetup&&(e[e.subElement].autoaxisSetup="true"),null==e[e.subElement].Unit&&(e[e.subElement].Unit="none"),null==e[e.subElement].SignPosition&&(e[e.subElement].SignPosition="prefix"),null==e[e.subElement].NumberFormatter&&(e[e.subElement].NumberFormatter="number");break;case"Timeline":if(e[e.subElement].sliderPosition=e[e.subElement].sliderPosition||"default",e[e.subElement].legendfontFamily=e[e.subElement].legendfontFamily||"Ubuntu",e[e.subElement].legendbackgroundColor=null!=e[e.subElement].legendbackgroundColor?e[e.subElement].legendbackgroundColor:"#FFFFFF",e[e.subElement].legendbackgroundTransparency=null!=e[e.subElement].legendbackgroundTransparency?e[e.subElement].legendbackgroundTransparency:"1",e[e.subElement].stackBorderColor=null!=e[e.subElement].stackBorderColor?e[e.subElement].stackBorderColor:"#ffffff",e[e.subElement].stackBorderWidth=null!=e[e.subElement].stackBorderWidth?e[e.subElement].stackBorderWidth:"0.5",e[e.subElement].stackBorderRadius=null!=e[e.subElement].stackBorderRadius?e[e.subElement].stackBorderRadius:"0",e[e.subElement].secondaryAxisLabelFontColor=null!=e[e.subElement].secondaryAxisLabelFontColor?e[e.subElement].secondaryAxisLabelFontColor:e[e.subElement].yAxis.LabelFontColor,e[e.subElement].secondaryAxisLabelFontSize=null!=e[e.subElement].secondaryAxisLabelFontSize?e[e.subElement].secondaryAxisLabelFontSize:e[e.subElement].yAxis.LabelFontSize,e[e.subElement].secondaryAxisLabelFontStyle=null!=e[e.subElement].secondaryAxisLabelFontStyle?e[e.subElement].secondaryAxisLabelFontStyle:e[e.subElement].yAxis.LabelFontStyle,e[e.subElement].secondaryAxisLabelFontWeight=null!=e[e.subElement].secondaryAxisLabelFontWeight?e[e.subElement].secondaryAxisLabelFontWeight:e[e.subElement].yAxis.LabelFontWeight,e[e.subElement].secondaryAxisLabelFontFamily=null!=e[e.subElement].secondaryAxisLabelFontFamily?e[e.subElement].secondaryAxisLabelFontFamily:e[e.subElement].yAxis.LabelFontFamily,e[e.subElement].secondaryAxisLabelTextDecoration=null!=e[e.subElement].secondaryAxisLabelTextDecoration?e[e.subElement].secondaryAxisLabelTextDecoration:e[e.subElement].yAxis.LabelTextDecoration,null==e[e.subElement].fixedLegend&&(e[e.subElement].fixedLegend=!0,e[e.subElement].legendPosition="horizontalTopLeft"),null==e[e.subElement].enableAnimation&&(e[e.subElement].enableAnimation=!1),null==e[e.subElement].showSettingMenuButton&&(e[e.subElement].showSettingMenuButton=!1),null==e[e.subElement].showLineSecondAxis&&(e[e.subElement].showLineSecondAxis=!1),null==e[e.subElement].lineSecondAxisColor&&(e[e.subElement].lineSecondAxisColor=e[e.subElement].yAxis.LineYAxisColor||"#FFFFFF"),null==e[e.subElement].xAxis.xAxisMarkers&&(e[e.subElement].xAxis.xAxisMarkers=e[e.subElement].xAxis.xAxisMarkers||"auto"),null==e[e.subElement].xAxis.xAxisTextWrap&&(e[e.subElement].xAxis.xAxisTextWrap=!1),e.Chart.DataSet&&e.Chart.DataSet.Fields)for(var d,o=0;o<e.Chart.DataSet.Fields.length;o++)"Series"==e.Chart.DataSet.Fields[o].Type&&((d=e.Chart.DataSet.Fields[o]).enableFillArea=null==d.enableFillArea?IsBoolean(e.Chart.fillarea):d.enableFillArea,d.FanSeriesType=d.FanSeriesType||"none",d.FillAreaColor=null==d.FillAreaColor?d.Color:d.FillAreaColor,d.FillTransparency=void 0!==d.FillTransparency&&""!==d.FillTransparency?d.FillTransparency:.6,d.DataLabelCustomProperties.datalabelBackgroundRect=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRect&&d.DataLabelCustomProperties.datalabelBackgroundRect,d.DataLabelCustomProperties.datalabelBackgroundRectColor=void 0!==d.DataLabelCustomProperties.datalabelBackgroundRectColor?d.DataLabelCustomProperties.datalabelBackgroundRectColor:"#ffffff",d.DataLabelCustomProperties.datalabelStrokeColor=void 0!==d.DataLabelCustomProperties.datalabelStrokeColor?d.DataLabelCustomProperties.datalabelStrokeColor:"#000000");null==e[e.subElement].enablethresholdfill&&(e[e.subElement].enablethresholdfill=!1),null==e[e.subElement].thresholdfilllevel&&(e[e.subElement].thresholdfilllevel="low,middle,top"),null==e[e.subElement].thresholdfillcolor&&(e[e.subElement].thresholdfillcolor="#ffea00,#00FF00,#ff0000"),null==e[e.subElement].thresholdfillopacity&&(e[e.subElement].thresholdfillopacity="0.3,0.3,0.3"),null==e[e.subElement].thresholdfilllabel&&(e[e.subElement].thresholdfilllabel="Low,Middle,Top"),null==e[e.subElement].thresholdfilllabelcolor&&(e[e.subElement].thresholdfilllabelcolor="#000000,#000000,#000000"),null==e[e.subElement].ShowYAxisThreshold&&(e[e.subElement].ShowYAxisThreshold=!1),null==e[e.subElement].MinimumYAxisThreshold&&(e[e.subElement].MinimumYAxisThreshold="0"),null==e[e.subElement].MaximumYAxisThreshold&&(e[e.subElement].MaximumYAxisThreshold="50"),null==e[e.subElement].minimumthresholdstrokecolor&&(e[e.subElement].minimumthresholdstrokecolor="#00FF00"),null==e[e.subElement].maximumthresholdstrokecolor&&(e[e.subElement].maximumthresholdstrokecolor="#FF0000"),null==e[e.subElement].showAnnotation&&(e[e.subElement].showAnnotation=!1),null==e[e.subElement].annotationDataType&&(e[e.subElement].annotationDataType="number"),null==e[e.subElement].annotationRadius&&(e[e.subElement].annotationRadius="1"),null==e[e.subElement].annotationOpacity&&(e[e.subElement].annotationOpacity="1"),null==e[e.subElement].annotationColor&&(e[e.subElement].annotationColor="#FF5733"),null==e[e.subElement].annotationFormat&&(e[e.subElement].annotationFormat="year"),null==e[e.subElement].AnnotationTooltipTitle&&(e[e.subElement].AnnotationTooltipTitle="Annotation"),null==e[e.subElement].lineType&&(e[e.subElement].lineType="false"),null==e[e.subElement].annotationxdata&&(e[e.subElement].annotationxdata=[]),void 0===e[e.subElement].Annotation&&(e[e.subElement].Annotation={Category:"2013, 2015, 2017",Label:"Low, Medium, High",DataSource:"",DataSourceId:"",DataLabel:"",DataValue:""});break;case"TreeMap":if(F.addDynamicRangeProperties(e),e[e.subElement].position=e[e.subElement].position||"center",e[e.subElement].bodyStrokeColorLineWidth=e[e.subElement].bodyStrokeColorLineWidth||"1",e.Chart.DataSet&&e.Chart.DataSet.Fields)for(var c,u=0;u<e.Chart.DataSet.Fields.length;u++)"Series"==e.Chart.DataSet.Fields[u].Type&&((c=e.Chart.DataSet.Fields[u]).AdditionalField=c.AdditionalField||c.Name);break;case"Trellis":e[e.subElement].Aggregation=e[e.subElement].Aggregation||"sum",e[e.subElement].drawingmode=e[e.subElement].drawingmode||"horizontal",e[e.subElement].showhorizontalGridLines=e[e.subElement].showhorizontalGridLines||"true",e[e.subElement].horizontalGridLineColor=e[e.subElement].horizontalGridLineColor||"#e5dede",e[e.subElement].verticalGridLineColor=e[e.subElement].verticalGridLineColor||"#e5dede",e[e.subElement].headerchromeColor=e[e.subElement].headerchromeColor||"#FFFFFF",e[e.subElement].headerFontColor=e[e.subElement].headerFontColor||"#4d4d4d",e[e.subElement].headerFontSize=e[e.subElement].headerFontSize||12,e[e.subElement].headerFontStyle=e[e.subElement].headerFontStyle||"normal",e[e.subElement].headerFontWeight=e[e.subElement].headerFontWeight||"bold",e[e.subElement].headerFontFamily=e[e.subElement].headerFontFamily||"Roboto",e[e.subElement].headerTextAlign=e[e.subElement].headerTextAlign||"left",e[e.subElement].headerTextDecoration=e[e.subElement].headerTextDecoration||"none",e[e.subElement].ChartType=e[e.subElement].ChartType||"bar",e[e.subElement].MergeFieldChartType=e[e.subElement].MergeFieldChartType||"stacked";break;case"WordCloud":null==e[e.subElement].Legend&&(e[e.subElement].Legend={},e[e.subElement].Legend.DisplayName="Low,Medium,High,Very High",e[e.subElement].Legend.Ranges="0~2,2~5,5~12,12~25",e[e.subElement].Legend.Colors="#E74C3C,#F7CA18,#36D7B7,#26A65B"),e[e.subElement].useRandomColor=e[e.subElement].useRandomColor||!1,e[e.subElement].showRangeBar=e[e.subElement].showRangeBar||!1,F.addDynamicRangeProperties(e);break;case"NewWordCloud":e[e.subElement].wordInputFormat=e[e.subElement].wordInputFormat||"word",e[e.subElement].maxTextValue=e[e.subElement].maxTextValue||"1000";break;case"Sankey":e[e.subElement].highlightPathStyle=e[e.subElement].highlightPathStyle||"adjacency",e[e.subElement].textAlign=e[e.subElement].textAlign||"right",e[e.subElement].tooltipBackgroundColor=e[e.subElement].tooltipBackgroundColor||"#ffffff",e[e.subElement].tooltipBorderColor=e[e.subElement].tooltipBorderColor||"#000000",e[e.subElement].tooltipPrecision=e[e.subElement].tooltipPrecision||"default",e[e.subElement].showTooltip=e[e.subElement].showTooltip||"true",e[e.subElement].tooltipFontSize=e[e.subElement].tooltipFontSize||"12",e[e.subElement].tooltipFontStyle=e[e.subElement].tooltipFontStyle||"normal",e[e.subElement].tooltipFontWeight=e[e.subElement].tooltipFontWeight||"normal",e[e.subElement].tooltipFontFamily=e[e.subElement].tooltipFontFamily||"BizvizFont",e[e.subElement].tooltipFontColor=e[e.subElement].tooltipFontColor||"#000000",void 0===e[e.subElement].SubCategoryColors&&(e[e.subElement].SubCategoryColors={subCategoryDefaultColor:"",subCategoryDefaultColorSet:"",showColorsFromSubCategoryName:"false",subCategoryColor:[]}),e[e.subElement].SecondaryUnit=e[e.subElement].SecondaryUnit||"none",e[e.subElement].Unit=e[e.subElement].Unit||"none",e[e.subElement].Precision=e[e.subElement].Precision||"default",e[e.subElement].SignPosition=e[e.subElement].SignPosition||"prefix",e[e.subElement].NumberFormatter=e[e.subElement].NumberFormatter||"none";break;case"WorldMap":F.addDynamicRangeProperties(e),void 0===e[e.subElement].CategoryColors&&(e[e.subElement].CategoryColors={categoryDefaultColor:"",categoryDefaultColorSet:"",showColorsFromCategoryName:"false",CategoryColor:[]}),void 0===e[e.subElement].ConditionalColors&&(e[e.subElement].ConditionalColors={ConditionalColor:[]}),e[e.subElement].SolidColorFill=e[e.subElement].SolidColorFill||"false",e[e.subElement].geometryType=e[e.subElement].geometryType||"marker",e[e.subElement].lineType=e[e.subElement].lineType||"straight",e[e.subElement].lineThickness=e[e.subElement].lineThickness||3}if(void 0!==e[e.subElement].ConditionalColors){var p=e[e.subElement].ConditionalColors.ConditionalColor;if(p)for(var m=0;m<p.length;m++)0===p[m].compareTo&&(p[m].compareTo="0")}break;case"filter":switch(e[e.subElement].Type){case"list":e[e.subElement].selectionFontColor=e[e.subElement].selectionFontColor||"#000000",null==e[e.subElement].Title&&(e[e.subElement].Title={FontWeight:"normal",Description:"Year",FontSize:"12",TextDecoration:"none",Align:"left",FontFamily:"Roboto",FontColor:"#808080",FontStyle:"normal",showTitle:"false",showGradient:"false",GradientColor:"#F5F5F5,#F5F5F5",TitleBarHeight:"25"}),e[e.subElement].ListBorderColor=void 0!==e[e.subElement].ListBorderColor?e[e.subElement].ListBorderColor:"#c2c2c2",e[e.subElement].enableBorder=void 0!==e[e.subElement].enableBorder?e[e.subElement].enableBorder:"false",e[e.subElement].enableGVAutoUpdate=null!=e[e.subElement].enableGVAutoUpdate&&e[e.subElement].enableGVAutoUpdate,e[e.subElement].notifyGVAutoUpdate=null!=e[e.subElement].notifyGVAutoUpdate&&e[e.subElement].notifyGVAutoUpdate,e[e.subElement].menupanelRowHeight=null==e[e.subElement].menupanelRowHeight?"32":e[e.subElement].menupanelRowHeight,e[e.subElement].actionBarHeight=null==e[e.subElement].actionBarHeight?"25":e[e.subElement].actionBarHeight,e[e.subElement].menupanelFontColor=null==e[e.subElement].menupanelFontColor?"#333333":e[e.subElement].menupanelFontColor;break;case"ComboTree":e[e.subElement].selectionLimit=null==e[e.subElement].selectionLimit?"0":e[e.subElement].selectionLimit,e[e.subElement].customSelection=null==e[e.subElement].customSelection?"false":e[e.subElement].customSelection,e[e.subElement].showSelectionLimit=null==e[e.subElement].showSelectionLimit?"false":e[e.subElement].showSelectionLimit,e[e.subElement].filterBorderRadius=null==e[e.subElement].filterBorderRadius?"0":e[e.subElement].filterBorderRadius,e[e.subElement].chromeColorPanel=void 0!==e[e.subElement].chromeColorPanel?e[e.subElement].chromeColorPanel:e[e.subElement].chromeColor,e[e.subElement].panelBorderRadius=void 0!==e[e.subElement].panelBorderRadius?e[e.subElement].panelBorderRadius:e[e.subElement].filterBorderRadius,e[e.subElement].advanceTheme=void 0!==e[e.subElement].advanceTheme?e[e.subElement].advanceTheme:"default",e[e.subElement].menuPanelFontColor=void 0!==e[e.subElement].menuPanelFontColor?e[e.subElement].menuPanelFontColor:e[e.subElement].FontColor,e[e.subElement].enableGVAutoUpdate=null!=e[e.subElement].enableGVAutoUpdate&&e[e.subElement].enableGVAutoUpdate,e[e.subElement].notifyGVAutoUpdate=null!=e[e.subElement].notifyGVAutoUpdate&&e[e.subElement].notifyGVAutoUpdate;break;case"dropdown":null==e[e.subElement].Title&&(e[e.subElement].Title={FontWeight:"normal",Description:"Year",FontSize:"12",TextDecoration:"none",Align:"left",FontFamily:"Roboto",FontColor:"#808080",FontStyle:"normal",showTitle:"false",showGradient:"false",GradientColor:"#F5F5F5,#F5F5F5",TitleBarHeight:"25",Position:"top"}),e[e.subElement].rollOverColor=void 0!==e[e.subElement].rollOverColor&&"0xE8F2FE"!==e[e.subElement].rollOverColor?e[e.subElement].rollOverColor:"#d9d7d8",e[e.subElement].m_cbbordercolor=void 0!==e[e.subElement].m_cbbordercolor?e[e.subElement].m_cbbordercolor:"#d3d3d3",e[e.subElement].filterbgColor=void 0!==e[e.subElement].filterbgColor?e[e.subElement].filterbgColor:"#dddddd",e[e.subElement].chromeColor=void 0!==e[e.subElement].chromeColor&&"0xcccccc"!==e[e.subElement].chromeColor?e[e.subElement].chromeColor:"#f2f2f2",e[e.subElement].selectionColor=void 0!==e[e.subElement].selectionColor&&"0xE8F2FE"!==e[e.subElement].selectionColor?e[e.subElement].selectionColor:"#BDC3C7",e[e.subElement].enableGVAutoUpdate=null!=e[e.subElement].enableGVAutoUpdate&&e[e.subElement].enableGVAutoUpdate,e[e.subElement].notifyGVAutoUpdate=null!=e[e.subElement].notifyGVAutoUpdate&&e[e.subElement].notifyGVAutoUpdate,void 0===e[e.subElement].SelectionType&&(e[e.subElement].SelectionType=IsBoolean(e[e.subElement].allowMultipleSelection)?"multiselect":"default"),null==e[e.subElement].backgroundColor&&(e[e.subElement].backgroundColor="#ffffff"),e[e.subElement].actionBarTooltip=null==e[e.subElement].actionBarTooltip?"true":"false";break;case"radiogroup":null==e[e.subElement].viewType&&(e[e.subElement].viewType="radio"),e[e.subElement].buttonColor=e[e.subElement].buttonColor||"#e8edec",e[e.subElement].circleColor=e[e.subElement].circleColor||"#1b7ced",e[e.subElement].circleSize=e[e.subElement].circleSize||"15",e[e.subElement].buttonPadding=e[e.subElement].buttonPadding||"4",e[e.subElement].buttonTopSpacing=e[e.subElement].buttonTopSpacing||"4",e[e.subElement].selectionColor=convertColorToHex(e[e.subElement].selectionColor),e[e.subElement].enableGVAutoUpdate=null!=e[e.subElement].enableGVAutoUpdate&&e[e.subElement].enableGVAutoUpdate,e[e.subElement].notifyGVAutoUpdate=null!=e[e.subElement].notifyGVAutoUpdate&&e[e.subElement].notifyGVAutoUpdate;break;case"checkboxgroup":e[e.subElement].checkboxDirection,e[e.subElement].checkboxDirection,e[e.subElement].checkboxColors=e[e.subElement].checkboxColors||"#039DEF,#124CA3,#00BCD4#e8edec",e[e.subElement].checkboxNames=e[e.subElement].checkboxNames||"Label 1,Label 2,Label 3",e[e.subElement].checkboxShapes=e[e.subElement].checkboxShapes||"unchecked,unchecked,unchecked",e[e.subElement].checkboxValue=e[e.subElement].checkboxValue||"1,1,1",e[e.subElement].toggleCheckedColor=e[e.subElement].toggleCheckedColor||"#2196F3",e[e.subElement].toggleUnCheckedColor=e[e.subElement].toggleUnCheckedColor||"#cccccc",e[e.subElement].toggleCheckboxLayout=e[e.subElement].toggleCheckboxLayout||"false",e[e.subElement].toggleShape=e[e.subElement].toggleShape||"round"}break;case"TabComponent":null==e[e.subElement].tabAlignment&&(e[e.subElement].tabAlignment="horizontal"),null==e[e.subElement].contentAlignment&&(e[e.subElement].contentAlignment="center")}switch(e.subElement){case"Chart":null==e.Chart.hideLegendOnStart&&(e.Chart.hideLegendOnStart=!0),e.Chart.yAxis?(e.Chart.FixedLabel=!1,e.Chart.Formater="Currency",e.Chart.SecondaryFormater="Number",e.Chart.yAxis.leftaxisFormater=!0,e.Chart.rightaxisFormater=!0,e.Chart.Unit=e.Chart.Unit||"none",e.Chart.SecondaryUnit=e.Chart.SecondaryUnit||"none",F.addDefaultCustomTextBoxForToolTipProperties(e),F.addDefaultCustomTextBoxForToolTipFormatterProperties(e),e.Chart.barWidth=e.Chart.barWidth||50,e.Chart.maxBarWidth=e.Chart.maxBarWidth||40,e.Chart.minBarWidth=e.Chart.minBarWidth||20,e.Chart.sliderRange=e.Chart.sliderRange||"auto",e.Chart.chartAlignment=e.Chart.chartAlignment||"center",e.Chart.zeroMarkerLine=e.Chart.zeroMarkerLine||"false",e.Chart.zeroMarkerColor=e.Chart.zeroMarkerColor||"#CCCCCC",e.Chart.secondAxisZeroMarkerLine=e.Chart.secondAxisZeroMarkerLine||"false",e.Chart.secondAxisZeroMarkerColor=e.Chart.secondAxisZeroMarkerColor||"#CCCCCC",e.Chart.verticalZeroMarkerLine=e.Chart.verticalZeroMarkerLine||"false",e.Chart.verticalZeroMarkerColor=e.Chart.verticalZeroMarkerColor||"#CCCCCC",e.Chart.NumberFormatter=e.Chart.NumberFormatter||"none",e.Chart.SecondaryAxisNumberFormatter=e.Chart.SecondaryAxisNumberFormatter||"none",e.Chart.repeaterCommonMarker=e.Chart.repeaterCommonMarker||"false",null==e.Chart.Title.TitleBarHeight&&(e.Chart.Title.TitleBarHeight="25"),e.Chart.DataSet&&e.Chart.DataSet.Fields&&(F.addDefaultDataLabelProperties(e),"Timeline"!=e.Chart.Type&&"Bar"!=e.Chart.Type||F.addDefaultChartProperties(e))):"TreeMap"==e.Chart.Type?F.addDefaultTreeMapProperties(e):"WorldMap"==e.Chart.Type?F.addDefaultWorldMapProperties(e):"Progress"==e.Chart.Type&&F.addDefaultProgressPieProperties(e),e.Chart.tooltipBackgroundColor=e.Chart.tooltipBackgroundColor||"#FFFFFF",e.Chart.tooltipBackgroundTransparency=e.Chart.tooltipBackgroundTransparency||"1",e.Chart.tooltipBorderColor=e.Chart.tooltipBorderColor||"#E0DFDF",e.Chart.customTooltipWidth=e.Chart.customTooltipWidth||"auto",e.Chart.tooltipPrecision=e.Chart.tooltipPrecision||"default",e.Chart.tooltipHighlighter=e.Chart.tooltipHighlighter||"false",e.Chart.tooltipFontSize=null!=e.Chart.tooltipFontSize?e.Chart.tooltipFontSize:"12",e.Chart.legendfontSize=null!=e.Chart.legendfontSize?e.Chart.legendfontSize:"10",e.Chart.colorOpacity=void 0!==e.Chart.colorOpacity?e.Chart.colorOpacity:"1",e.Chart.exportType=null!=e.Chart.exportType?e.Chart.exportType:"screenshot";break;case"Funnel":F.addDefaultFunnelProperties(e),e[e.subElement].exportToCSV=e[e.subElement].exportToCSV||!0,null!=e[e.subElement].chartType&&""!==e[e.subElement].chartType||(e[e.subElement].chartType="inverted"),e[e.subElement].DataSet&&e[e.subElement].DataSet.Fields&&F.addDefaultDataLabelProperties(e),e[e.subElement].exportType=null!=e[e.subElement].exportType?e[e.subElement].exportType:"screenshot";break;case"DataGrid":e[e.subElement].exportToCSV=e[e.subElement].exportToCSV||"true",e[e.subElement].updatedDesign=void 0===e[e.subElement].updatedDesign?"false":e[e.subElement].updatedDesign,F.addDefaultDataGridProperties(e),e[e.subElement].exportType=null!=e[e.subElement].exportType?e[e.subElement].exportType:"screenshot",e[e.subElement].showMultipleCheckbox=null!=e[e.subElement].showMultipleCheckbox?e[e.subElement].showMultipleCheckbox:"false";for(var b=0;b<e[e.subElement].DataSet.Fields.length;b++)e[e.subElement].DataSet.Fields[b].dateformat=null!=e[e.subElement].DataSet.Fields[b].dateformat?e[e.subElement].DataSet.Fields[b].dateformat:"none",e[e.subElement].DataSet.Fields[b].showcellmerge=null!=e[e.subElement].DataSet.Fields[b].showcellmerge?e[e.subElement].DataSet.Fields[b].showcellmerge:"false",e[e.subElement].DataSet.Fields[b].CellMergeCustomProperties=null!=e[e.subElement].DataSet.Fields[b].CellMergeCustomProperties?e[e.subElement].DataSet.Fields[b].CellMergeCustomProperties:{};break;case"Scorecard":F.addDefaultScoreCardProperties(e),e[e.subElement].exportType=null!=e[e.subElement].exportType?e[e.subElement].exportType:"screenshot",e[e.subElement].exportToCSV=e[e.subElement].exportToCSV||"true"}null!=e[e.subElement].showBorder&&""!==e[e.subElement].showBorder||(e[e.subElement].showBorder=!1),null!=e[e.subElement].borderColor&&""!==e[e.subElement].borderColor||(e[e.subElement].borderColor="#BDC3C7"),null!=e[e.subElement].borderThickness&&""!==e[e.subElement].borderThickness||(e[e.subElement].borderThickness="1"),null!=e[e.subElement].borderRadius&&""!==e[e.subElement].borderRadius||(e[e.subElement].borderRadius="0"),null==e[e.subElement].showShadow&&(e[e.subElement].showShadow=!1,e[e.subElement].shadowColor="#000000",e[e.subElement].shadowOpacity="0.1"),null!=e[e.subElement].TitleBarHeight&&""!==e[e.subElement].TitleBarHeight||(e[e.subElement].TitleBarHeight="25")}return e},F.addDefaultFunnelProperties=function(e){if(e.Funnel.FixedLabel=!1,e.Funnel.Formater="Currency",e.Funnel.SecondaryFormater="Number",e.Funnel.Precision=e.Funnel.Precision||0,e.Funnel.SignPosition=e.Funnel.SignPosition||"prefix",e.Funnel.Unit=e.Funnel.Unit||"none",e.Funnel.SecondaryUnit=e.Funnel.SecondaryUnit||"none",e.Funnel.NumberFormatter=e.Funnel.NumberFormatter||"none",F.addDefaultCustomTextBoxForToolTipProperties(e),e.Funnel.Title.TitleBarHeight=e.Funnel.Title.TitleBarHeight||"25",e.Funnel.hideLegendOnStart=e.Funnel.hideLegendOnStart||!0,e.Funnel.tooltipBackgroundColor=e.Funnel.tooltipBackgroundColor||"#FFFFFF",e.Funnel.tooltipBackgroundTransparency=e.Funnel.tooltipBackgroundTransparency||"1",e.Funnel.tooltipBorderColor=e.Funnel.tooltipBorderColor||"#E0DFDF",e.Funnel.customTooltipWidth=e.Funnel.customTooltipWidth||"auto",e.Funnel.tooltipPrecision=e.Funnel.tooltipPrecision||"default",e.Funnel.tooltipHighlighter=e.Funnel.tooltipHighlighter||"false",e.Funnel.tooltipFontSize=null!=e.Funnel.tooltipFontSize?e.Funnel.tooltipFontSize:"12",e.Funnel.legendfontSize=null!=e.Funnel.legendfontSize?e.Funnel.legendfontSize:"10","InvertedFunnel"==e.Funnel.Type&&(e.Funnel.showcustom="true",F.addDefaultCustomTextBoxForToolTipFormatterProperties(e)),e.Funnel.DataSet&&e.Funnel.DataSet.Fields)for(var o=0;o<e.Funnel.DataSet.Fields.length;o++){var a=e.Funnel.DataSet.Fields[o];a.PlotTransparency=0!=+a.PlotTransparency&&null!=a.PlotTransparency?a.PlotTransparency:1}},F.addDefaultTreeMapProperties=function(e){e.Chart.FixedLabel=!1,e.Chart.Formater="Currency",e.Chart.SecondaryFormater="Number",e.Chart.Unit=e.Chart.Unit||"none",e.Chart.NumberFormatter=e.Chart.NumberFormatter||"none",e.Chart.SecondaryUnit=e.Chart.SecondaryUnit||"none",e.Chart.Title.TitleBarHeight=e.Chart.Title.TitleBarHeight||"25",e.Chart.showcustom="true",F.addDefaultCustomTextBoxForToolTipProperties(e),F.addDefaultCustomTextBoxForToolTipFormatterProperties(e)},F.addDefaultChartProperties=function(e){for(var o=0;o<e.Chart.DataSet.Fields.length;o++){var a=e.Chart.DataSet.Fields[o];void 0!==a.dstype&&"none"!==a.dstype||"Series"!==a.Type||(a.dstype="sum")}},F.addDefaultWorldMapProperties=function(e){if(e.Chart.Title.TitleBarHeight=e.Chart.Title.TitleBarHeight||"25",e.Chart.svgType=e.Chart.svgType||"svg",e.Chart.showcustom="true",F.addDefaultCustomTextBoxForToolTipProperties(e),F.addDefaultCustomTextBoxForToolTipFormatterProperties(e),e.Chart.DataSet&&e.Chart.DataSet.Fields)for(var o=0;o<e.Chart.DataSet.Fields.length;o++){var a=e.Chart.DataSet.Fields[o],t=a.unitname,s=a.secondunitname;"Number"==a.formatter&&(a.secondunitname=t),"Currency"==a.secondformatter&&(a.unitname=s),a.formatter="Currency",a.secondformatter="Number",a.isfixedlabel=!1,a.Precision=0!=+a.Precision?a.Precision:0,a.signposition=a.signposition||"prefix",a.secondunitname=""!=a.secondunitname?a.secondunitname:"none",a.unitname=""!=a.unitname?a.unitname:"none",a.numberFormatter=a.numberFormatter||"number"}},F.addDefaultProgressPieProperties=function(e){e.Chart.Title.TitleBarHeight=e.Chart.Title.TitleBarHeight||"25",F.addDefaultCustomTextBoxForToolTipProperties(e)},F.addDefaultDataGridProperties=function(e){if(e.DataGrid.DataSet&&e.DataGrid.DataSet.Fields)for(var o=0;o<e.DataGrid.DataSet.Fields.length;o++){var a=e.DataGrid.DataSet.Fields[o],t=a.unitname,s=a.secondunitname;if("Number"==a.formatter&&(a.secondunitname=t),"Currency"==a.secondformatter&&(a.unitname=s),null==a.cellType&&(a.cellType=IsBoolean(a.isNumeric)?"Numeric":"none"),void 0===a.dstype&&(a.dstype="none"),a.formatter="Currency",a.secondformatter="Number",a.isfixedlabel=!1,a.precision=0!=+a.precision?a.precision:0,a.signposition=a.signposition||"prefix",a.secondunitname=""!=a.secondunitname?a.secondunitname:"none",a.unitname=""!=a.unitname?a.unitname:"none",a.rowAggregation=a.rowAggregation||"none",a.showTooltip=a.showTooltip||"false",a.numberFormatter=a.numberFormatter||"none",null==a.sorting&&(a.sorting="true"),e.DataGrid.Alerts&&e.DataGrid.Alerts.AlertColumn&&0<e.DataGrid.Alerts.AlertColumn.length)for(var n=0;n<e.DataGrid.Alerts.AlertColumn.length;n++){var r=e.DataGrid.Alerts.AlertColumn[n];a.Name==r.name&&void 0!==e.DataGrid.Alerts.AlertColumn[n].showTooltip&&(a.showTooltip=e.DataGrid.Alerts.AlertColumn[n].showTooltip)}}if(e.DataGrid.Alerts&&e.DataGrid.Alerts.AlertColumn&&0<e.DataGrid.Alerts.AlertColumn.length)for(var l=0;l<e.DataGrid.Alerts.AlertColumn.length;l++)e.DataGrid.Alerts.AlertColumn[l].showDynamicRange=e.DataGrid.Alerts.AlertColumn[l].showDynamicRange||!1,e.DataGrid.Alerts.AlertColumn[l].minColor=e.DataGrid.Alerts.AlertColumn[l].minColor||"#f89406",e.DataGrid.Alerts.AlertColumn[l].maxColor=e.DataGrid.Alerts.AlertColumn[l].maxColor||"#00b16a";var i;e.DataGrid.DatagridStyles.alternateRowsColor?1==(i=e.DataGrid.DatagridStyles.alternateRowsColor).split(",").length&&(e.DataGrid.DatagridStyles.alternateRowsColor=i+","+i):e.DataGrid.DatagridStyles.alternateRowsColor="#ffffff,#ffffff",e.DataGrid.useFieldColorAsHeader=e.DataGrid.useFieldColorAsHeader||!1,null==e.DataGrid.Title.TitleBarHeight&&(e.DataGrid.Title.TitleBarHeight="25"),null==e[e.subElement].fitColumns&&(e[e.subElement].fitColumns="dynamic_data_grid"!=e.componentType),null==e[e.subElement].scrollViewLimit&&(e[e.subElement].scrollViewLimit=0),null!=e.DataGrid.RowHeight&&"paging_data_grid"==e.componentType&&delete e.DataGrid.RowHeight},F.addDefaultScoreCardProperties=function(e){if(e.Scorecard.DataSet&&e.Scorecard.DataSet.Fields)for(var o=0;o<e.Scorecard.DataSet.Fields.length;o++){var a=e.Scorecard.DataSet.Fields[o],t=a.unitname,s=a.secondunitname;if("Number"==a.formatter&&(a.secondunitname=t),"Currency"==a.secondformatter&&(a.unitname=s),null==a.cellType&&(a.cellType=IsBoolean(a.isNumeric)?"Numeric":"none"),a.formatter="Currency",a.secondformatter="Number",a.isfixedlabel=!1,a.precision=0!=+a.precision?a.precision:0,a.signposition=a.signposition||"prefix",a.secondunitname=""!=a.secondunitname?a.secondunitname:"none",a.unitname=""!=a.unitname?a.unitname:"none",a.showTooltip=a.showTooltip||"false",a.numberFormatter=a.numberFormatter||"none",null==a.sorting&&(a.sorting="true"),void 0===a.parentAggregation&&(a.parentAggregation="none"),e.Scorecard.Alerts&&e.Scorecard.Alerts.AlertColumn&&0<e.Scorecard.Alerts.AlertColumn.length)for(var n=0;n<e.Scorecard.Alerts.AlertColumn.length;n++){var r=e.Scorecard.Alerts.AlertColumn[n];a.Name==r.name&&void 0!==e.Scorecard.Alerts.AlertColumn[n].showTooltip&&(a.showTooltip=e.Scorecard.Alerts.AlertColumn[n].showTooltip)}}if(e.Scorecard.Alerts&&e.Scorecard.Alerts.AlertColumn&&0<e.Scorecard.Alerts.AlertColumn.length)for(var l=0;l<e.Scorecard.Alerts.AlertColumn.length;l++)e.Scorecard.Alerts.AlertColumn[l].showDynamicRange=e.Scorecard.Alerts.AlertColumn[l].showDynamicRange||!1,e.Scorecard.Alerts.AlertColumn[l].minColor=e.Scorecard.Alerts.AlertColumn[l].minColor||"#f89406",e.Scorecard.Alerts.AlertColumn[l].maxColor=e.Scorecard.Alerts.AlertColumn[l].maxColor||"#00b16a";var i;null==e[e.subElement].fitColumns&&(e[e.subElement].fitColumns=!0),e.Scorecard.alternaterowscolor?1==(i=e.Scorecard.alternaterowscolor).split(",").length&&(e.Scorecard.alternaterowscolor=i+","+i):e.Scorecard.alternaterowscolor="#ffffff,#ffffff"},F.addConditionalCategoryColors=function(e){null==e[e.subElement].ConditionalColors&&(e[e.subElement].ConditionalColors={},e[e.subElement].ConditionalColors.ConditionalColor=[]),null==e[e.subElement].CategoryColors&&(e[e.subElement].CategoryColors={},e[e.subElement].CategoryColors.categoryDefaultColor="",e[e.subElement].CategoryColors.categoryDefaultColorSet="",e[e.subElement].CategoryColors.showColorsFromCategoryName="false",e[e.subElement].CategoryColors.CategoryColor=[])},F.addDynamicRangeProperties=function(e){e[e.subElement].showDynamicRange=e[e.subElement].showDynamicRange||!1,e[e.subElement].maxRangeColor=e[e.subElement].maxRangeColor||"#00b16a",e[e.subElement].minRangeColor=e[e.subElement].minRangeColor||"#f89406"},F.addDefaultDataLabelProperties=function(e){for(var o=0;o<e[e.subElement].DataSet.Fields.length;o++){var a=e[e.subElement].DataSet.Fields[o];null==a.DataLabelCustomProperties?(a.DataLabelCustomProperties={},"Pie"===e[e.subElement].Type&&IsBoolean(e.showSliceValue)||"Funnel"===e.subElement&&IsBoolean(e.Funnel.showLayerValue)?a.DataLabelCustomProperties.showDataLabel=!0:a.DataLabelCustomProperties.showDataLabel=a.DataLabelCustomProperties.showDataLabel||"false",a.DataLabelCustomProperties.showDataLabel=a.DataLabelCustomProperties.showDataLabel||"false",a.DataLabelCustomProperties.hideDataLabel=a.DataLabelCustomProperties.hideDataLabel||"false",a.DataLabelCustomProperties.hideDataLabelText=a.DataLabelCustomProperties.hideDataLabelText||"",a.DataLabelCustomProperties.useFieldColor=a.DataLabelCustomProperties.useFieldColor||"false",a.DataLabelCustomProperties.showPercentValue=a.DataLabelCustomProperties.useFieldColor?a.DataLabelCustomProperties.showPercentValue:"false",a.DataLabelCustomProperties.dataLabelFontColor=a.DataLabelCustomProperties.dataLabelFontColor||"#808080",a.DataLabelCustomProperties.dataLabelDefaultFontColor=a.DataLabelCustomProperties.dataLabelDefaultFontColor||"#ffffff",a.DataLabelCustomProperties.dataLabelFontSize=a.DataLabelCustomProperties.dataLabelFontSize||12,a.DataLabelCustomProperties.dataLabelRotation=a.DataLabelCustomProperties.dataLabelRotation||"0",a.DataLabelCustomProperties.dataLabelTextAlign=a.DataLabelCustomProperties.dataLabelTextAlign||"center",a.DataLabelCustomProperties.datalabelField=a.DataLabelCustomProperties.datalabelField||a.Name,a.DataLabelCustomProperties.datalabelFontFamily=a.DataLabelCustomProperties.datalabelFontFamily||"Roboto",a.DataLabelCustomProperties.datalabelFontStyle=a.DataLabelCustomProperties.datalabelFontStyle||"normal",a.DataLabelCustomProperties.datalabelFontWeight=a.DataLabelCustomProperties.datalabelFontWeight||"normal",a.DataLabelCustomProperties.datalabelPosition=a.DataLabelCustomProperties.datalabelPosition||"Top",a.DataLabelCustomProperties.dataLabelUseComponentFormater=a.DataLabelCustomProperties.dataLabelUseComponentFormater||!0,a.DataLabelCustomProperties.datalabelFormaterUnit=a.DataLabelCustomProperties.datalabelFormaterUnit||"none",a.DataLabelCustomProperties.datalabelFormaterPrecision=a.DataLabelCustomProperties.datalabelFormaterPrecision||"default",a.DataLabelCustomProperties.datalabelFormaterCurrency=a.DataLabelCustomProperties.datalabelFormaterCurrency||"none",a.DataLabelCustomProperties.datalabelFormaterPosition=a.DataLabelCustomProperties.datalabelFormaterPosition||"suffix",a.DataLabelCustomProperties.datalabelBackgroundRect=a.DataLabelCustomProperties.datalabelBackgroundRect||"false",a.DataLabelCustomProperties.datalabelBackgroundRectColor=a.DataLabelCustomProperties.datalabelBackgroundRectColor||"#ffffff",a.DataLabelCustomProperties.datalabelStrokeColor=a.DataLabelCustomProperties.datalabelStrokeColor||"#000000"):null==a.DataLabelCustomProperties.datalabelFormaterUnit?(a.DataLabelCustomProperties.datalabelFormaterUnit=a.DataLabelCustomProperties.datalabelFormaterUnit||"none",a.DataLabelCustomProperties.datalabelFormaterPrecision=a.DataLabelCustomProperties.datalabelFormaterPrecision||"default",a.DataLabelCustomProperties.datalabelFormaterCurrency=a.DataLabelCustomProperties.datalabelFormaterCurrency||"none",a.DataLabelCustomProperties.datalabelFormaterPosition=a.DataLabelCustomProperties.datalabelFormaterPosition||"suffix"):(a.DataLabelCustomProperties.hideDataLabel=a.DataLabelCustomProperties.hideDataLabel||"false",a.DataLabelCustomProperties.hideDataLabelText=a.DataLabelCustomProperties.hideDataLabelText||"",a.DataLabelCustomProperties.dataLabelDefaultFontColor=a.DataLabelCustomProperties.dataLabelDefaultFontColor||"#ffffff"),a.DataLabelCustomProperties.showPercentValue=a.DataLabelCustomProperties.showPercentValue||"false"}},F.addDefaultLegendProperties=function(e){var o=F.getComponentbyId(e.Legend.associatedChartId);if(o&&void 0===o.defaultLegendFields&&void 0!==o.Chart.DataSet){o.defaultLegendFields=[];for(var a=o.Chart.DataSet.Fields,t=0;t<a.length;t++)"Series"!=a[t].Type&&"Values"!=a[t].Type||!a[t].visible||"parent"===a[t].hierarchyType||o.defaultLegendFields.push({key:a[t].Name,value:!0})}},F.addDefaultLabelFormatterProperties=function(e){e[e.subElement].Formater=e[e.subElement].Formater||"Currency",e[e.subElement].Unit=e[e.subElement].Unit||"none",e[e.subElement].SignPosition=e[e.subElement].SignPosition||"prefix",e[e.subElement].Precision=e[e.subElement].Precision||"default",e[e.subElement].NumberFormatter=e[e.subElement].NumberFormatter||"none",e[e.subElement].SecondaryFormater=e[e.subElement].SecondaryFormater||"Number",e[e.subElement].SecondaryUnit=e[e.subElement].SecondaryUnit||"none"},F.addDefaultCustomTextBoxForToolTipProperties=function(e){void 0===e[e.subElement].CustomTextBoxForToolTip&&(e[e.subElement].CustomTextBoxForToolTip={dataTipTypeArray:"",dataTipType:"",datatipData:""},IsBoolean(e[e.subElement].showTooltip)?e[e.subElement].CustomTextBoxForToolTip.dataTipType="Default":e[e.subElement].CustomTextBoxForToolTip.dataTipType="None")},F.addDefaultCustomTextBoxForToolTipFormatterProperties=function(e){void 0===e[e.subElement].CustomTextBoxForToolTip.dataTipTypeForDisplay&&(e[e.subElement].CustomTextBoxForToolTip.dataTipTypeForDisplay={}),void 0===e[e.subElement].CustomTextBoxForToolTip.dataTipTypeForDisplay.useComponentFormatter&&(e[e.subElement].CustomTextBoxForToolTip.dataTipTypeForDisplay.useComponentFormatter=!0),void 0===e[e.subElement].CustomTextBoxForToolTip.dataTipTypeForDisplay.formatter&&(e[e.subElement].CustomTextBoxForToolTip.dataTipTypeForDisplay.formatter={}),void 0===e[e.subElement].CustomTextBoxForToolTip.dataTipTypeForDisplay.displayWindow&&(e[e.subElement].CustomTextBoxForToolTip.dataTipTypeForDisplay.displayWindow="textBox")},F.ManageOldConfiguredDashboardGrouping=function(e){for(var o=F.modal.selectedDashboard.json.Dashboard.componentGroups||[],a=(e.groupings="",[]),t=0;t<o.length;t++)o[t].aCompIds.length&&-1!=o[t].aCompIds.indexOf(e.objectID)&&a.push(o[t].gName);a.length&&(e.groupings=a.join())},F.$on("getJsonFromOpenDashoardAndDrawComponent",function(){if(F.modal.getDashboardComponents)return F.RenderDashoardHiddenDrawComponent(),!0;F.modal.compCtr=0;function e(e,o){var a=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length,t=o.component,s=t.parent,n=t.designData.class,e=F.componentJson=DesignerUtil.prototype.ISJson(e)[t.designData.class],r=o.index,l=e.Properties.Object.objectID=t.objectID,i=(D.push(l),e.Properties.Object.x=t.x),d=e.Properties.Object.y=t.y,c=t.height,u=t.width,s=(e.Properties.Object.objectName=t.objectName,s&&-1==s.indexOf("dashboard")?F.chartContainerId=F.modal.getSelectedDashboardId()+"-"+s:F.chartContainerId=s,F.addDesignerComponentContainer(l,i,d,c,u,r));t.x=0,t.y=0,(c=ReflectUtil.newInstance(n,s,"inherit")).m_designMode=!0,c.setProperty({Object:o.component}),t.x=i,t.y=d,null!=e.Data&&null!=e.Fields&&(c.setDataProvider(e.Data),c.setFields(e.Fields));try{null!=F.modal.rawComponentJSONlist[n]&&null!=F.modal.rawComponentJSONlist[n]&&""!=F.modal.rawComponentJSONlist[n]||(F.modal.rawComponentJSONlist[n]=JSON.parse(JSON.stringify(e))),c.draw(),F.updateComponentShadowFromPreference(),F.addSettingBtns(l,e.Properties.Object.isDataSetAvailable,e.Properties.Object.enableScript)}catch(e){}if(F.handleComponentSelection(l,!1,!1,!0),F.isSelectedDashboardResponsive()||(F.initDragComponent(c),F.initResizeComponent(c)),F.AddInComponentObjectList(l,c),F.addDblClickEvent(l),F.modal.selectedComponentId=l,D.length==F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length)for(var p=F.modal.propertyData,m=0;m<D.length;m++){for(var b=F.getComponentbyId(D[m]),h=b.componentType,g=[],f=0;f<p.length;f++)if(null!=p[f].Info&&p[f].Info[0].class==b.designData.class){g=p[f];break}F.modal.propertyJsonList.hasOwnProperty(h)||(F.modal.propertyJsonList[h]=g)}IsBoolean(t.showLocked)&&F.lockComponent(!1,{lockComponent:!0,objectID:t.objectID},!0),IsBoolean(t.unShowHidden)&&F.hideComponent(!1,{hideComponent:!0,objectID:t.objectID},!0),F.modal.compCtr!=a-1?F.modal.compCtr++:F.modal.dashbaordLoadingInProgress=!1}var o,D=[],a=(delete F.updatedJson,delete F.themesOnLoad,F.updateOldConfiguredDashboardMetadata(),F.supportOldConfiguredDashboardSkeleton(),F.setSnapToGridSize(),F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object);if(0<a.length)for(var t=0;t<a.length;t++){var s=a[t],n=(delete s.newdrag,null);F.setSelectedVariable(void 0,s,"Component"),F.ManageOldConfiguredDashboardGrouping(s);try{s=F.SupportOldConfiguredDashboard(s)}catch(e){}s&&"object"==typeof s&&(n={component:s,index:t},F.dropCoordinates={x:s.x,y:s.y},e(F.modal.compMetaData[s.designData.class],n)),"AbsoluteLayout"==F.modal.layoutType&&F.registerInHistory("oldComp",s)}else F.modal.dashbaordLoadingInProgress=!1;for(o in F.modal.selectedDashboard.json.Dashboard)if("MobileLayout"===o||"TabletLayout"===o){var r=F.modal.selectedDashboard.json.Dashboard[o].Object;if(0<r.length)for(var l=0;l<r.length;l++){var i=r[l];try{F.SupportOldConfiguredDashboard(i)}catch(e){}}else F.modal.dashbaordLoadingInProgress=!1}F.initHintVariables(p.getSelectedDashboardId())}),F.RenderDashoardHiddenDrawComponent=function(){F.modal.compCtr=0;function e(e,o){var a=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length,t=o.component,s=t.parent,n=t.designData.class,e=F.componentJson=DesignerUtil.prototype.ISJson(e)[t.designData.class],r=o.index,l=e.Properties.Object.objectID=t.objectID,i=(D.push(l),e.Properties.Object.x=t.x),d=e.Properties.Object.y=t.y,c=t.height,u=t.width,s=(e.Properties.Object.objectName=t.objectName,s&&-1==s.indexOf("dashboard")?F.chartContainerId=F.modal.getSelectedDashboardId()+"-"+s:F.chartContainerId=s,F.addDesignerComponentContainer(l,i,d,c,u,r));t.x=0,t.y=0,(c=ReflectUtil.newInstance(n,s,"inherit")).m_designMode=!0,c.setProperty({Object:o.component}),t.x=i,t.y=d,null!=e.Data&&null!=e.Fields&&(c.setDataProvider(e.Data),c.setFields(e.Fields));try{null!=F.modal.rawComponentJSONlist[n]&&null!=F.modal.rawComponentJSONlist[n]&&""!=F.modal.rawComponentJSONlist[n]||(F.modal.rawComponentJSONlist[n]=JSON.parse(JSON.stringify(e))),c.draw(),F.updateComponentShadowFromPreference(),F.addSettingBtns(l,e.Properties.Object.isDataSetAvailable,e.Properties.Object.enableScript)}catch(e){}if(F.handleComponentSelection(l,!1,!1,!0),F.isSelectedDashboardResponsive()||(F.initDragComponent(c),F.initResizeComponent(c)),F.AddInComponentObjectList(l,c),F.addDblClickEvent(l),F.modal.selectedComponentId=l,D.length==F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length)for(var p=F.modal.propertyData,m=0;m<D.length;m++){for(var b=F.getComponentbyId(D[m]),h=b.componentType,g=[],f=0;f<p.length;f++)if(null!=p[f].Info&&p[f].Info[0].class==b.designData.class){g=p[f];break}F.modal.propertyJsonList.hasOwnProperty(h)||(F.modal.propertyJsonList[h]=g)}IsBoolean(t.showLocked)&&F.lockComponent(!1,{lockComponent:!0,objectID:t.objectID},!0),IsBoolean(t.unShowHidden)&&F.hideComponent(!1,{hideComponent:!0,objectID:t.objectID},!0),F.modal.compCtr!=a-1?F.modal.compCtr++:F.modal.dashbaordLoadingInProgress=!1}var o,D=[],a=(delete F.updatedJson,delete F.themesOnLoad,F.updateOldConfiguredDashboardMetadata(),F.supportOldConfiguredDashboardSkeleton(),F.setSnapToGridSize(),F.modal.dashboardVisibleComponents.length<1&&F.modal.dashboardHiddenComponents.length<1?F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object:F.modal.dashboardVisibleComponents.concat(F.modal.dashboardHiddenComponents));if(0<a.length)for(var t=0;t<a.length;t++){var s,n,r;delete(l=a[t]).newdrag;F.setSelectedVariable(void 0,l,"Component"),F.ManageOldConfiguredDashboardGrouping(l);try{var l=F.SupportOldConfiguredDashboard(l),i=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.findIndex(function(e){return e.objectID===l.objectID});-1!==i&&(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object[i]=l)}catch(e){}1==l.unShowHidden&&T.hideLoader(),l&&"object"==typeof l&&(s={component:l,index:a[t].zindex},F.dropCoordinates={x:l.x,y:l.y},n=F.modal.compMetaData[l.designData.class],void 0!==l.themeType&&"default-theme"!==l.themeType&&Array.isArray(n[l.designData.class].Fields)&&(r=F.modal.themeData.dashboardTheme,n[l.designData.class].Fields.forEach(function(e,o){void 0!==e.Color&&void 0!==r.datasetColors&&void 0!==r.datasetColors[o]&&(e.Color=r.datasetColors[o])})),e(n,s)),"AbsoluteLayout"==F.modal.layoutType&&F.registerInHistory("oldComp",l)}else F.modal.dashbaordLoadingInProgress=!1;for(o in F.modal.selectedDashboard.json.Dashboard)if("MobileLayout"===o||"TabletLayout"===o){var d=F.modal.selectedDashboard.json.Dashboard[o].Object;if(0<d.length)for(var c=0;c<d.length;c++){var u=d[c];try{F.SupportOldConfiguredDashboard(u)}catch(e){}}else F.modal.dashbaordLoadingInProgress=!1}F.initHintVariables(p.getSelectedDashboardId())},F.updateOldConfiguredDashboardMetadata=function(){var e,o;null==F.modal.selectedDashboard.json.Dashboard.MobileLayout?F.modal.selectedDashboard.json.Dashboard.MobileLayout={resolution:"375x663",width:"375",height:"663",border:"1px solid #a9a9a9",pinedObject:[],Object:[]}:null==F.modal.selectedDashboard.json.Dashboard.MobileLayout.pinedObject&&(F.modal.selectedDashboard.json.Dashboard.MobileLayout.pinedObject=[]),null==F.modal.selectedDashboard.json.Dashboard.TabletLayout?F.modal.selectedDashboard.json.Dashboard.TabletLayout={resolution:"1024x768",width:"1024",height:"768",border:"1px solid #a9a9a9",pinedObject:[],Object:[]}:null==F.modal.selectedDashboard.json.Dashboard.TabletLayout.pinedObject&&(F.modal.selectedDashboard.json.Dashboard.TabletLayout.pinedObject=[]),F.modal.selectedDashboard.json.Dashboard.GlobalVariable.Variable=[],null==F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.showShadow&&(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.showShadow="false",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.shadowColor="#000000",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.shadowOpacity="0.1"),null==F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties&&(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties={},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Background={},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title={},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle={},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Formatter={},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend={},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis={},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis={},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.BackgroundValue=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.TitleValue=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitleValue=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.LegendValue=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxisValue=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxisValue=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Background.showBorder=!0,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Background.borderColor="#EFF0F0",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Background.borderRadius="0",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.showTitle=!0,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.TitleBarHeight="48",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.FontColor="#000000",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.FontFamily="BizvizFont",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.FontSize="17",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.FontStyle="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.FontWeight="600",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.TextDecoration="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Title.Align="left",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle.showSubTitle=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle.FontColor="#000000",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle.FontFamily="BizvizFont",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle.FontSize="17",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle.FontStyle="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle.FontWeight="600",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle.TextDecoration="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.SubTitle.Align="left",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Formatter.NumberFormatter="number",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Formatter.Precision="default",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Formatter.Unit="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Formatter.SecondaryUnit="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Formatter.SignPosition="prefix",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend.showLegends=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend.legendfontColor="#494950",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend.legendfontFamily="BizvizFont",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend.legendfontSize="14",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend.legendfontStyle="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend.legendfontWeight="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend.legendtextDecoration="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.Legend.hideLegendOnStart=!0,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.CategoryMarkingColor="#FFFFFF",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.FontColor="#494950",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.FontFamily="BizvizFont",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.FontSize="14",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.FontStyle="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.FontWeight="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.TextDecoration="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.LabelFontColor="#494950",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.LabelFontFamily="BizvizFont",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.LabelFontSize="14",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.LabelFontStyle="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.LabelFontWeight="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.LabelTextDecoration="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.LabelTilted=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.Labelrotation="90",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.LineXAxisColor="#859EBE",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.ShowLineXAxis=!0,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.xAxis.TickMarks=!0,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.FontColor="#494950",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.FontFamily="BizvizFont",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.FontSize="14",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.FontStyle="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.FontWeight="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.TextDecoration="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.LabelFontColor="#494950",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.LabelFontFamily="BizvizFont",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.LabelFontSize="14",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.LabelFontStyle="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.LabelFontWeight="normal",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.LabelTextDecoration="none",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.LabelTilted=!1,F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.Labelrotation="90",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.LineXAxisColor="#859EBE",F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.globalProperties.yAxis.ShowLineYAxis="none",F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType]=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].globalProperties),null==F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.scalingView&&(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.scalingView="fitToPage"),null==F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.dashboardAlign&&(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.dashboardAlign="none"),null==F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.enableResize&&(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.enableResize="false"),null==F.modal.selectedDashboard.json.Dashboard.designConfig&&(F.modal.selectedDashboard.json.Dashboard.designConfig={},F.modal.selectedDashboard.json.Dashboard.designConfig.snapGridSize=1),null==F.modal.selectedDashboard.json.Dashboard.PublicFilters&&(F.modal.selectedDashboard.json.Dashboard.PublicFilters=[]),void 0!==F.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection&&(e=(F.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection[0]||F.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection).id,o=F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,F.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection=DesignerUtil.prototype.findInArray(o,"id",e),void 0!==F.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection)&&null==F.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.ClarityOptionalCondition&&(F.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.ClarityOptionalCondition={ClaritySort:{Columns:[{sortField:"",sortDirection:""}]},ClaritySlice:{sliceIndex:"",sliceCount:""}});for(var a=0;a<F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL.length;a++){var t=F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL[a];if(t&&null==t.ClarityOptionalCondition&&(t.ClarityOptionalCondition={ClaritySort:{Columns:[{sortField:"",sortDirection:""}]},ClaritySlice:{sliceIndex:"",sliceCount:""}}),"web"===t.Type)for(var s=0;s<t.availableConditionSet.length;s++)void 0===t.availableConditionSet[s].displayName&&(t.availableConditionSet[s].displayName=IsBoolean("_"===t.availableConditionSet[s].name[0])?t.availableConditionSet[s].name.slice(1,t.availableConditionSet[s].name.length):t.availableConditionSet[s].name),void 0===t.availableConditionSet[s].mandatoryField&&(t.availableConditionSet[s].mandatoryField=!!IsBoolean("_"===t.availableConditionSet[s].name[0]))}null==F.modal.selectedDashboard.json.Dashboard.LanguageMapping&&(F.modal.selectedDashboard.json.Dashboard.LanguageMapping={enable:"false",mappingName:"",mappingId:"",language:"all"})},F.supportOldConfiguredDashboardSkeleton=function(){try{for(var e=["AbsoluteLayout_Object_DataGrid_DataSet_Fields","AbsoluteLayout_Object_Scorecard_DataSet_Fields","AbsoluteLayout_Object_DynamicDataGrid_DataSet_Fields","AbsoluteLayout_Object_Chart_DataSet_Fields"],o=0;o<e.length;o++)void 0!==F.modal.selectedDashboard.json[e[o]]&&(F.modal.selectedDashboard.json[e[o]].formatter="Currency",F.modal.selectedDashboard.json[e[o]].secondformatter="Number",F.modal.selectedDashboard.json[e[o]].isfixedlabel="false",F.modal.selectedDashboard.json[e[o]].Precision=0,F.modal.selectedDashboard.json[e[o]].unitname="none",F.modal.selectedDashboard.json[e[o]].secondunitname="none",F.modal.selectedDashboard.json[e[o]].signposition="suffix",F.modal.selectedDashboard.json[e[o]].LineWidth="2",F.modal.selectedDashboard.json[e[o]].LineType="straight",F.modal.selectedDashboard.json[e[o]].cellType="none",F.modal.selectedDashboard.json[e[o]].rowAggregation="none",F.modal.selectedDashboard.json[e[o]].IndicatorType="sparkline",F.modal.selectedDashboard.json[e[o]].AdditionalField=F.modal.selectedDashboard.json[e[o]].Name,F.modal.selectedDashboard.json[e[o]].FanSeriesType="none",F.modal.selectedDashboard.json[e[o]].FillTransparency="0.6",F.modal.selectedDashboard.json[e[o]].Opacity="1",F.modal.selectedDashboard.json[e[o]].fontColor=void 0===F.modal.selectedDashboard.json[e[o]].fontColor?"#000000":F.modal.selectedDashboard.json[e[o]].fontColor,F.modal.selectedDashboard.json[e[o]].fontSize=void 0===F.modal.selectedDashboard.json[e[o]].fontSize?"16":F.modal.selectedDashboard.json[e[o]].fontSize,F.modal.selectedDashboard.json[e[o]].fontStyle=void 0===F.modal.selectedDashboard.json[e[o]].fontStyle?"normal":F.modal.selectedDashboard.json[e[o]].fontStyle,F.modal.selectedDashboard.json[e[o]].fontWeight=void 0===F.modal.selectedDashboard.json[e[o]].fontWeight?"normal":F.modal.selectedDashboard.json[e[o]].fontWeight,F.modal.selectedDashboard.json[e[o]].fontFamily=void 0===F.modal.selectedDashboard.json[e[o]].fontFamily?"BizvizFont":F.modal.selectedDashboard.json[e[o]].fontFamily,F.modal.selectedDashboard.json[e[o]].enableColumnStyle=void 0===F.modal.selectedDashboard.json[e[o]].enableColumnStyle?"false":F.modal.selectedDashboard.json[e[o]].enableColumnStyle,void 0===F.modal.selectedDashboard.json[e[o]].dstype?F.modal.selectedDashboard.json[e[o]].dstype="none":"none"===F.modal.selectedDashboard.json[e[o]].dstype&&"AbsoluteLayout_Object_Chart_DataSet_Fields"===e[o]&&(F.modal.selectedDashboard.json[e[o]].dstype="sum"),void 0===F.modal.selectedDashboard.json[e[o]].dsdate&&(F.modal.selectedDashboard.json[e[o]].dsdate="none"),void 0===F.modal.selectedDashboard.json[e[o]].dateformat&&(F.modal.selectedDashboard.json[e[o]].dateformat="none"),void 0===F.modal.selectedDashboard.json[e[o]].showcellmerge)&&(F.modal.selectedDashboard.json[e[o]].showcellmerge="false");for(var a=["AbsoluteLayout_Object_Chart_DataSet_Fields","AbsoluteLayout_Object_Funnel_DataSet_Fields"],t=0;t<a.length;t++)void 0!==F.modal.selectedDashboard.json[a[t]]&&(F.modal.selectedDashboard.json[a[t]].PlotTransparency="1",F.modal.selectedDashboard.json[a[t]].DataLabelCustomProperties={showDataLabel:"false",hideDataLabel:"false",hideDataLabelText:"",useFieldColor:"false",showPercentValue:"false",dataLabelTextAlign:"center",dataLabelFontColor:"#808080",dataLabelDefaultFontColor:"#ffffff",dataLabelRotation:"0",dataLabelFontSize:"12",datalabelFontStyle:"normal",datalabelFontWeight:"normal",datalabelFontFamily:"Roboto",datalabelField:"",datalabelPosition:"Top",dataLabelUseComponentFormater:!0,datalabelFormaterUnit:"none",datalabelFormaterPrecision:"default",datalabelFormaterCurrency:"none",datalabelFormaterPosition:"suffix",datalabelBackgroundRect:"false",datalabelBackgroundRectColor:"#ffffff",datalabelStrokeColor:"#000000"});for(var s=["AbsoluteLayout_Object_DataGrid_Alerts_AlertColumn","AbsoluteLayout_Object_Scorecard_Alerts_AlertColumn"],n=0;n<s.length;n++)void 0!==F.modal.selectedDashboard.json[s[n]]&&(F.modal.selectedDashboard.json[s[n]].minColor||(F.modal.selectedDashboard.json[s[n]].showDynamicRange="false",F.modal.selectedDashboard.json[s[n]].minColor="#f89406",F.modal.selectedDashboard.json[s[n]].maxColor="#00b16a"),void 0===F.modal.selectedDashboard.json[s[n]].customIcon)&&(F.modal.selectedDashboard.json[s[n]].customIcon="bd-down-arrow,bd-minus,bd-up-arrow");null==F.modal.selectedDashboard.json.DataProviders_DataURL.PredictiveJsonDef&&(F.modal.selectedDashboard.json.DataProviders_DataURL.PredictiveJsonDef=""),null==F.modal.selectedDashboard.json.DataProviders_DataURL.parentSource&&(F.modal.selectedDashboard.json.DataProviders_DataURL.parentSource=""),null==F.modal.selectedDashboard.json.DataProviders_DataURL.childSource&&(F.modal.selectedDashboard.json.DataProviders_DataURL.childSource=""),null==F.modal.selectedDashboard.json.DataProviders_DataURL.deriveConditions&&(F.modal.selectedDashboard.json.DataProviders_DataURL.deriveConditions={},F.modal.selectedDashboard.json.DataProviders_DataURL.deriveConditions.criteria=[""]),null==F.modal.selectedDashboard.json.DataProviders_DataURL.dataType&&(F.modal.selectedDashboard.json.DataProviders_DataURL.dataType="JSON"),null==F.modal.selectedDashboard.json.DataProviders_DataURL.ClarityOptionalCondition&&(F.modal.selectedDashboard.json.DataProviders_DataURL.ClarityOptionalCondition={ClaritySort:{Columns:[{sortField:"",sortDirection:""}]},ClaritySlice:{sliceIndex:"",sliceCount:""}}),null==F.modal.selectedDashboard.json.AbsoluteLayout_Object_DataGrid_DataSet_Fields.showTooltip&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_DataGrid_DataSet_Fields.showTooltip="false"),null==F.modal.selectedDashboard.json.AbsoluteLayout_Object_DataGrid_DataSet_Fields.sorting&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_DataGrid_DataSet_Fields.sorting="true"),"0"==F.modal.selectedDashboard.json.AbsoluteLayout_Object_DataGrid_DataSet_Fields.precision&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_DataGrid_DataSet_Fields.precision="default"),null==F.modal.selectedDashboard.json.AbsoluteLayout_Object_DataGrid_DataSet_Fields.numberFormatter&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_DataGrid_DataSet_Fields.numberFormatter="none"),null==F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.showTooltip&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.showTooltip="false"),null==F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.sorting&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.sorting="true"),"0"==F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.precision&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.precision="default"),null==F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.numberFormatter&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.numberFormatter="none"),null==F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.parentAggregation&&(F.modal.selectedDashboard.json.AbsoluteLayout_Object_Scorecard_DataSet_Fields.parentAggregation="none")}catch(e){}},F.loadPropertyPalettesInBg=function(e){F.loadPropertyPalette(e,0)},F.loadPropertyPalette=function(o,a){var t=F.getComponentbyId(o[a]).componentType;T.getJsonFileData("./resources/data/property/"+t+".data",function(e){F.modal.propertyJsonList.hasOwnProperty(t)||(F.modal.propertyJsonList[t]=e),++a<o.length&&F.loadPropertyPalette(o,a)})},F.onDropComplete=function(e,o,a){function t(e,o){404==e&&(y=C+D+"/"+b+"/"+h+".data",T.getJsonFileData(y,F.onGetJsonDataOfComponent,m,function(e,o){}))}var s,n,r,l,i,d,c,u,p,m=[e,a],b=e.type,h=e.class,e=e.subClass&&""!==e.subClass?e.subClass:e.class,g=F.getActiveDashboardId(),f=F.selectedTheme,D=(F.selectedGlobalProperty,"default-theme"),C="./resources/bizvizchart-themes/",y=null;try{F.chartContainerId=o.dropDestination?o.dropDestination[0].id:g,b&&b.trim()&&(i=(l=o).duplicating,d=$("#"+F.chartContainerId),c=+d[0].style.border.split("px")[0],u=i?(p=l.event.pageX,u=l.event.pageY,p=p>F.modal.bgGridSize?p-p%F.modal.bgGridSize:F.modal.bgGridSize,u>F.modal.bgGridSize?u-u%F.modal.bgGridSize:F.modal.bgGridSize):"redo"===l?(p=a.x,a.y):(i=d.offset().top-d.parent().parent().offset().top,d=d.offset().left-d.parent().parent().offset().left,p=l.event.pageX+Math.abs(d)-c,u=l.event.pageY+Math.abs(i)-c,p=p>F.modal.bgGridSize?p-p%F.modal.bgGridSize+c:F.modal.bgGridSize+c,u>F.modal.bgGridSize?u-u%F.modal.bgGridSize+c:F.modal.bgGridSize+c),p=p>F.modal.bgGridSize?p-p%F.modal.bgGridSize+c:F.modal.bgGridSize+c,u=u>F.modal.bgGridSize?u-u%F.modal.bgGridSize+c:F.modal.bgGridSize+c,F.dropCoordinates={x:p,y:u},y=C+"default-theme/"+b+"/"+e+".data",s="default-theme"!==f[g]?C+f[g]+"/themeConfig.data":C+f[g]+"/"+b+"/"+e+".data",n=F.getHttpCachedData(y),void 0===(r=F.getHttpCachedData(s))&&(m.filePath=y,m.errorCallback=t,T.getJsonFileData(s,F.getJsonDataOnLoad,m,t)),n&&r&&200==n[0]?(F.isDuplicate=void 0!==o.duplicating&&o.duplicating,m.themeData=JSON.parse(r[1]).DashboardObjects,m.gpData=F.selectedGlobalProperty[g][F.modal.layoutType],F.onGetJsonDataOfComponent(JSON.parse(n[1]),m)):void 0!==r&&(m.themeData=JSON.parse(r[1]).DashboardObjects,m.gpData=F.selectedGlobalProperty[g][F.modal.layoutType],T.getJsonFileData(y,F.onGetJsonDataOfComponent,m,t)))}catch(e){}finally{F.modal.selectedDashboard.json.Dashboard.importsStat=0}},F.getHttpCachedData=function(e){return a.get("$http").get(e)},F.updateDraggedComponentJson=function(e,o,a){var t,s,n=e.Properties.Object.subElement,r=e.Properties.Object[n];for(s in null!=a.Properties?(t=a.Properties.Object[n],e.Properties.Object.themeType=a.Properties.Object.themeType):t=a,e.Properties.Object.newdrag=!0,t)if(t.hasOwnProperty(s)){var l=typeof t[s];if(null!=r[s])if("object"==l)for(var i in t[s])r[s][i]=t[s][i];else r[s]=t[s]}},F.getJsonDataOnLoad=function(e,o){o.themeData=e,o.gpData=F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType],T.getJsonFileData(o.filePath,F.onGetJsonDataOfComponent,o,o.errorCallback)},F.onGetJsonDataOfComponent=function(e,o){void 0!==o.themeData&&F.updateDraggedComponentJson(e[o[0].class],o,o.themeData[o[0].class]),void 0!==o.gpData&&(t=(a=e[o[0].class]).Properties.Object.subElement,s=a.Properties.Object[t],a.Properties.Object.newdrag=!0,s=F.propertyUpdate(o.gpData,s,t),a.Properties.Object[t]=s);var a=o[0],t=o[1],s=(F.componentJson=DesignerUtil.prototype.ISJson(e),F.componentJson=F.componentJson[a.class],null!=t&&(F.componentJson=F.modifyComponentPropertiesForCopy(t,F.componentJson)),F.drawComponent(F.componentJson,a.class),F.updateComponentShadowFromPreference(),F.appendDesignData(F.componentJson,a),F.registerInHistory("add",F.componentJson.Properties.Object),F.componentJson.Properties.Object);s.groupings="",("chart"!==s.designData.type&&"datagrid"!==s.designData.type||F.isDuplicate)&&F.setSelectedVariable(null,s,"Component"),F.modal.notifyObjectListChange(),F.cacheAndEmitPropertyPalette()},F.updateComponentShadowFromPreference=function(){IsBoolean(F.modal.userPreference.defaultSettings.hideShadow)?$("#mainDesignerViewDiv #"+F.modal.selectedDashboard.id+" .draggableWidgetDiv").removeClass("enableShadow").addClass("disableShadow"):$("#mainDesignerViewDiv #"+F.modal.selectedDashboard.id+" .draggableWidgetDiv").addClass("enableShadow").removeClass("disableShadow")},F.modifyComponentPropertiesForCopy=function(e,o){e=angular.copy(e);return DesignerUtil.prototype.IsBoolean(e.isDataSetAvailable)&&null!=e[e.subElement].DataSet&&(e[e.subElement].DataSet.id=F.modal.getUniqueReference(e.shortName)),e[e.subElement].associatedLegendId&&(e[e.subElement].associatedLegendId="",e.defaultLegendFields)&&delete e.defaultLegendFields,o.Properties={Object:e},o},F.cacheAndEmitPropertyPalette=function(){var e=F.getComponentbyId(F.modal.selectedComponentId),o=e.componentType,e=e?AttributeMigration[e.objectType][0]:"Dashboard";F.$emit("cachePropertyInfo",{dataFilePath:"./resources/data/property/"+o+".data",propFileName:o,id:F.modal.selectedComponentId,objectType:e})},F.getPropertyPalette=function(){var e=F.getComponentbyId(F.modal.selectedComponentId),o=e.componentType,e=e?AttributeMigration[e.objectType][0]:"Dashboard";F.$emit("propertyInfo",{dataFilePath:"./resources/data/property/"+o+".data",propFileName:o,id:F.modal.selectedComponentId,objectType:e})},F.appendDesignData=function(e,o){e.Properties.Object.designData=o;o=F.getNewVariableJson({});o.Key=e.Properties.Object.referenceID,null!=e.autoAddScriptsFromDesigner&&(o.userScript.value=e.autoAddScriptsFromDesigner),e.Properties.Object.variable=o},F.toggleDesignArea=function(){F.reloadDefault()},F.cascadedParentsChild={},F.updateCascadedParent=function(e){F.cascadedParentsChild[e.cascadedChild]=e.value.child},F.onPropertyClick=function(e){F.gradientColorList=[];var o=[];""+e.value!="NaN"&&""!=e.value?o=(""+e.value).split(","):o[0]="#ffffff";for(var a=0;a<o.length;a++){var t={};t.index=a,t.value=convertColorToHex(o[a]),F.gradientColorList.push(t)}F.customprop=e,F.showModelPopup("customColorWindow"),-1==navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||C(function(){F.initSpectrumColorPicker("input[type='color']")},.01)},F.initSpectrumColorPicker=function(e){$(".sp-container").remove(),$(e).spectrum({})},F.customPropTypes={customColor:{title:"Add Colors",icon:"glyphicon-tint",callBack:"onPropertyClick"},customGridColor:{title:"Add Colors",icon:"glyphicon-tint",callBack:"onGridPropertyClick"},customText:{title:"Add Text",icon:"glyphicon-new-window",callBack:"onCustomTextClick"},customTextBox:{title:"Add Custom Text Box",icon:"glyphicon-new-window",callBack:"onCustomTextBoxClick"},customFile:{title:"Browse SVG file",icon:"glyphicon-new-window",callBack:"onCustomFileClick"},customFileFilterChips:{title:"Browse SVG file",icon:"glyphicon-new-window",callBack:"onCustomFileFilterChipsClick"},customImageBrowse:{title:"Add Image",icon:"glyphicon-new-window",callBack:"onCustomImageBrowseClick"},customRangeIndicatorWindow:{title:"Range Properties",icon:"glyphicon-new-window",callBack:"onCustomRangeIndicatorClick"},customLevelIndicatorWindow:{title:"Sankey Level Properties",icon:"glyphicon-new-window",callBack:"onCustomLevelIndicatorClick"},customAnnotationWindow:{title:"Manage Annotations",icon:"glyphicon-new-window",callBack:"onCustomAnnotationWindowClick"},customShapeSelectorWindow:{title:"Knowledge Shapes Selector",icon:"glyphicon-new-window",callBack:"onCustomShapeSelectorClick"},customColorSelectorWindow:{title:"Knowledge Color Selector",icon:"glyphicon-new-window",callBack:"onCustomColorSelectorClick"},customBulletBandWindow:{title:"Color Ranges",icon:"glyphicon-new-window",callBack:"onCustomBulletRangeClick"},customBubbleColorBandWindow:{title:"Band Properties",icon:"glyphicon-new-window",callBack:"onCustomBubbleColorBandClick"},customAssignChartWindow:{title:"Associate a Chart",icon:"glyphicon-new-window",callBack:"onCustomAssignChartClick"},customAssignFilterWindow:{title:"Associate Filters",icon:"glyphicon-new-window",callBack:"onCustomAssignFilterClick"},customAssignDSChartWindow:{title:"Associate a Chart",icon:"glyphicon-new-window",callBack:"onCustomAssignDSChartClick"},customManageTabsWindow:{title:"Manage Tabs",icon:"glyphicon-new-window",callBack:"onCustomTabClick"},customAssociateGroupsWindow:{title:"Associate Groups",icon:"glyphicon-new-window",callBack:"onAssociateGroupsClick"},customLegendsWindow:{title:"Associate a Chart",icon:"glyphicon-new-window",callBack:"onCustomLegendClick"},customCheckboxesWindow:{title:"Associate a Chart",icon:"glyphicon-new-window",callBack:"onCustomCheckboxClick"},customURLButtonParametersWindow:{title:"Add Parameters",icon:"glyphicon-new-window",callBack:"onCustomURLButtonParameterClick"},customTrendRangeWindow:{title:"Update Base Range",icon:"glyphicon-new-window",callBack:"onCustomTrendRangeClick"},customGaugeAlertWindow:{title:"Color Ranges",icon:"glyphicon-new-window",callBack:"onCustomGaugeIndicatorClick"},customBoxPlotFillColorWindow:{title:"Box Fill Color Properties",icon:"glyphicon-new-window",callBack:"onCustomBoxFillColorClick"},customThresholdFillWindow:{title:"Fill Threshold colors",icon:"glyphicon-new-window",callBack:"onCustomThresholdFillWindowClick"},customProjTimelineMilestoneWindow:{title:"Milestone Configuration",icon:"glyphicon-new-window",callBack:"onCustomProjTimelineMilestoneClick"},customProjTimelineTaskWindow:{title:"Task Configuration",icon:"glyphicon-new-window",callBack:"onCustomProjTimelineTaskClick"},customTextBoxForToolTip:{title:"Tool Tip",icon:"glyphicon-new-window",callBack:"onCustomTextBoxForToolTip"},customTextBoxForJSPaths:{title:"JS and CSS Source Paths",icon:"glyphicon-new-window",callBack:"onCustomTextBoxForJSPaths"},customTextBoxForJSContent:{title:"JS, HTML and CSS Content",icon:"glyphicon-new-window",callBack:"onCustomTextBoxForJSContent"},customPublishedWidgets:{title:"Published Widgets",icon:"glyphicon-new-window",callBack:"onCustomPublishedWidgets"},customTourWindow:{title:"Add Tour",icon:"glyphicon-new-window",callBack:"onTourClick"},customLanguageMappingDropdown:{title:"Select a Mapping",icon:"glyphicon-new-window",callBack:"onCustomLanguageMappingDropdown"},customThemeMappingDropdown:{title:"Select a Theme",icon:"glyphicon-new-window",callBack:"onCustomThemeMappingDropdown"},globalPropertyDropdown:{title:"Select Properties",icon:"glyphicon-new-window",callBack:"onglobalpropertymappingDropdown"},customAssignDateWindow:{title:"Associate a Date",icon:"glyphicon-new-window",callBack:"onCustomAssignDateClick"},customAnnotationMixedWindow:{title:"Manage Annotations",icon:"glyphicon-new-window",callBack:"onCustomAnnotationMixedWindowClick"},customAnnotationTimeLineWindow:{title:"Manage Annotations",icon:"glyphicon-new-window",callBack:"onCustomAnnotationTimeLineWindowClick"}},F.customAnnotationCOnnectionFilter=function(e,o){return e.filter(function(e){return e.Type===o})},F.onCustomAnnotationTimeLineWindowClick=function(e){if(!F.modal.selectedComponentId)return!1;F.custompropAnnotation=e,F.custompropAnnotation.value=[],F.modal.selectedConnectionsDataSet=[];var e=F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,e=F.customAnnotationCOnnectionFilter(e,"offline"),o=(F.modal.selectedDashboardDataProviders=e,F.getComponentbyId(F.modal.selectedComponentId)),a=o.Chart.Annotation.DataSource,t=o.Chart.Annotation.DataSourceId,s=o.Chart.Annotation.DataLabel,o=o.Chart.Annotation.DataValue,a=(F.modal.selectedAnnotationDatasource=a||"",F.modal.selectedAnnotationDatasourceId=t||"",F.modal.selectedAnnotationDataLabel=s||"",F.modal.selectedAnnotationDataValue=o||"",DesignerUtil.prototype.findInArray(e,"id",t));F.modal.selectedConnectionsDataSet=a?a.FieldSet:[],F.showModelPopup("customAnnotationTimeLineWindow")},F.changeTimeLineAnnotationDatasource=function(e){var o=F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,o=DesignerUtil.prototype.findInArray(o,"connectionName",e);F.modal.selectedAnnotationDatasource=e,F.modal.selectedAnnotationDatasourceId=o.id,F.modal.selectedConnectionsDataSet=o.FieldSet,F.modal.selectedAnnotationDataLabel="",F.modal.selectedAnnotationDataValue=""},F.changeTimeLineAnnotationDataFieldLabel=function(e){F.modal.selectedAnnotationDataLabel=e},F.changeTimeLineAnnotationDataFieldValue=function(e){F.modal.selectedAnnotationDataValue=e},F.UpdateTimeLineAnnottaionConnectionData=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);e.Chart.Annotation.DataSource=F.modal.selectedAnnotationDatasource,e.Chart.Annotation.DataSourceId=F.modal.selectedAnnotationDatasourceId,e.Chart.Annotation.DataLabel=F.modal.selectedAnnotationDataLabel,e.Chart.Annotation.DataValue=F.modal.selectedAnnotationDataValue},F.resetTimeLineAnnotationDataConnection=function(){F.modal.selectedAnnotationDatasource="",F.modal.selectedAnnotationDatasourceId="",F.modal.selectedConnectionsDataSet="",F.modal.selectedAnnotationDataLabel="",F.modal.selectedAnnotationDataValue=""},F.onCustomAnnotationMixedWindowClick=function(e){if(!F.modal.selectedComponentId)return!1;F.custompropAnnotation=e,F.custompropAnnotation.value=[],F.modal.selectedConnectionsDataSet=[];var e=F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,e=F.customAnnotationCOnnectionFilter(e,"offline"),o=(F.modal.selectedDashboardDataProviders=e,F.getComponentbyId(F.modal.selectedComponentId)),a=o.Chart.Annotation.DataSource,t=o.Chart.Annotation.DataSourceId,s=o.Chart.Annotation.DataLabel,o=o.Chart.Annotation.DataValue,a=(F.modal.selectedAnnotationDatasource=a||"",F.modal.selectedAnnotationDatasourceId=t||"",F.modal.selectedAnnotationDataLabel=s||"",F.modal.selectedAnnotationDataValue=o||"",DesignerUtil.prototype.findInArray(e,"id",t));F.modal.selectedConnectionsDataSet=a?a.FieldSet:[],F.showModelPopup("customAnnotationMixedWindow")},F.changeMixedAnnotationDatasource=function(e){var o=F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,o=DesignerUtil.prototype.findInArray(o,"connectionName",e);F.modal.selectedAnnotationDatasource=e,F.modal.selectedAnnotationDatasourceId=o.id,F.modal.selectedConnectionsDataSet=o.FieldSet,F.modal.selectedAnnotationDataLabel="",F.modal.selectedAnnotationDataValue=""},F.changeMixedAnnotationDataFieldLabel=function(e){F.modal.selectedAnnotationDataLabel=e},F.changeMixedAnnotationDataFieldValue=function(e){F.modal.selectedAnnotationDataValue=e},F.UpdateMixedAnnottaionConnectionData=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);e.Chart.Annotation.DataSource=F.modal.selectedAnnotationDatasource,e.Chart.Annotation.DataSourceId=F.modal.selectedAnnotationDatasourceId,e.Chart.Annotation.DataLabel=F.modal.selectedAnnotationDataLabel,e.Chart.Annotation.DataValue=F.modal.selectedAnnotationDataValue},F.resetMixedAnnotationDataConnection=function(){F.modal.selectedAnnotationDatasource="",F.modal.selectedAnnotationDatasourceId="",F.modal.selectedConnectionsDataSet="",F.modal.selectedAnnotationDataLabel="",F.modal.selectedAnnotationDataValue=""},F.onCustomAnnotationWindowClick=function(e){if(!F.modal.selectedComponentId)return!1;F.custompropAnnotation=e,F.custompropAnnotation.value=[],F.modal.selectedConnectionsDataSet=[];var e=F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,e=F.customAnnotationCOnnectionFilter(e,"offline"),o=(F.modal.selectedDashboardDataProviders=e,F.getComponentbyId(F.modal.selectedComponentId)),a=o.Chart.Annotation.DataSource,t=o.Chart.Annotation.DataSourceId,s=o.Chart.Annotation.DataLabel,o=o.Chart.Annotation.DataValue,a=(F.modal.selectedAnnotationDatasource=a||"",F.modal.selectedAnnotationDatasourceId=t||"",F.modal.selectedAnnotationDataLabel=s||"",F.modal.selectedAnnotationDataValue=o||"",DesignerUtil.prototype.findInArray(e,"id",t));F.modal.selectedConnectionsDataSet=a?a.FieldSet:[],F.showModelPopup("customAnnotationWindow")},F.changeAnnotationDatasource=function(e){var o=F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,o=DesignerUtil.prototype.findInArray(o,"connectionName",e);F.modal.selectedAnnotationDatasource=e,F.modal.selectedAnnotationDatasourceId=o.id,F.modal.selectedConnectionsDataSet=o.FieldSet,F.modal.selectedAnnotationDataLabel="",F.modal.selectedAnnotationDataValue=""},F.changeAnnotationDataFieldLabel=function(e){F.modal.selectedAnnotationDataLabel=e},F.changeAnnotationDataFieldValue=function(e){F.modal.selectedAnnotationDataValue=e},F.UpdateAnnottaionConnectionData=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);e.Chart.Annotation.DataSource=F.modal.selectedAnnotationDatasource,e.Chart.Annotation.DataSourceId=F.modal.selectedAnnotationDatasourceId,e.Chart.Annotation.DataLabel=F.modal.selectedAnnotationDataLabel,e.Chart.Annotation.DataValue=F.modal.selectedAnnotationDataValue},F.resetAnnotationDataConnection=function(){F.modal.selectedAnnotationDatasource="",F.modal.selectedAnnotationDatasourceId="",F.modal.selectedConnectionsDataSet="",F.modal.selectedAnnotationDataLabel="",F.modal.selectedAnnotationDataValue=""},F.getCustomIconClickCB=function(e){F[F.customPropTypes[e.type].callBack](e)},F.addColor=function(){var e={};e.index=F.gradientColorList.length,e.value=getRandomHexColor(),F.gradientColorList.push(e),-1==navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||C(function(){F.initSpectrumColorPicker("input[type='color']")},.01)},F.updateCustomColor=function(){for(var e="",o=0;o<F.gradientColorList.length;o++)e+=F.gradientColorList[o].value+",";e=e.substring(0,e.length-1),F.customprop.value=e,F.onPropertyChange(F.customprop)},F.removeCustomColor=function(e){e=F.gradientColorList.indexOf(e);F.gradientColorList.splice(e,1)},F.onCustomLanguageMappingDropdown=function(e){F.customLanguageMapping=angular.copy(e),F.customLanguageMapping.options=[],F.customLanguageMapping.heading="Language Mapping Selection",F.customLanguageMapping.mappingName=F.modal.selectedDashboard.json.Dashboard.LanguageMapping.mappingName,F.customLanguageMapping.mappingId=F.modal.selectedDashboard.json.Dashboard.LanguageMapping.mappingId,F.customLanguageMapping.value=F.modal.selectedDashboard.json.Dashboard.LanguageMapping.mappingId;var e=req_url.designer.getAllLanguageSetting,o={spacekey:T.AUTH_INFO.get("spacekey"),token:T.AUTH_INFO.get("token"),serviceName:"getAllLanguageSetting",data:""};BIZVIZ.SDK.secureRequest(e,o,function(e,o){if(o&&e&&e.languageSettings)if(0<e.languageSettings.length){for(var a=e.languageSettings,t=[],s=0;s<a.length;s++)t.push({key:a[s].id,value:a[s].name}),F.customLanguageMapping.value==a[s].id&&(F.customLanguageMapping.mappingId=a[s].id,F.customLanguageMapping.mappingName=a[s].name);F.customLanguageMapping.options=angular.copy(t),F.showModelPopup("customLanguageMappingDropdown")}else T.showNotification("Empty Language Mapping List","alert-info",3e3);else T.showNotification("Failed to get Language Mapping List","alert-danger",3e3)},function(e,o){T.showNotification("Failed to get Language Mappings","alert-danger",3e3)})},F.updateCustomLanguageMappingDropdown=function(){for(var e=F.customLanguageMapping.options,o=0;o<e.length;o++)if(F.customLanguageMapping.value==e[o].key){F.customLanguageMapping.mappingId=e[o].key,F.customLanguageMapping.mappingName=e[o].value;break}F.onPropertyChange(F.customLanguageMapping)},F.onglobalpropertymappingDropdown=function(e){F.globalPropertyMapping=angular.copy(e),F.globalPropertyMapping.options={},F.globalPropertyMapping.properties=[],F.globalPropertyMapping.heading="Global Property Selection",F.globalPropertyMapping.FontFamilyOptions=[],F.globalPropertyMapping.FontStyleOptions=[],F.globalPropertyMapping.FontWeightOptions=[],F.globalPropertyMapping.TextAlignOptions=[],F.globalPropertyMapping.TextDecorationOptions=[];e=F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType];F.globalPropertyMapping.FontFamilyOptions=angular.copy([{key:"Arial",value:"Arial"},{key:"BizvizFont",value:"BizvizFont"},{key:"BizvizFontRegular",value:"BizvizFontRegular"},{key:"Cambria",value:"Cambria"},{key:"Helvetica",value:"Helvetica"},{key:"Lucida Bright",value:"Lucida Bright"},{key:"Monotype Corsiva",value:"Monotype Corsiva"},{key:"Papyrus",value:"Papyrus"},{key:"'Raleway', sans-serif",value:"Raleway"},{key:"Roboto",value:"Roboto"},{key:"Times New Roman",value:"Times New Roman"},{key:"Ubuntu",value:"Ubuntu"},{key:"Verdana",value:"Verdana"}]),F.globalPropertyMapping.FontStyleOptions=angular.copy([{key:"normal",value:"Normal"},{key:"italic",value:"Italic"}]),F.globalPropertyMapping.FontWeightOptions=angular.copy([{key:"normal",value:"Normal"},{key:"bold",value:"Bold"},{key:"300",value:"300"},{key:"600",value:"600"},{key:"900",value:"900"}]),F.globalPropertyMapping.TextAlignOptions=angular.copy([{key:"left",value:"Left"},{key:"center",value:"Center"},{key:"right",value:"Right"}]),F.globalPropertyMapping.TextDecorationOptions=angular.copy([{key:"none",value:"None"},{key:"underline",value:"Underline"}]),F.globalPropertyMapping.UnitOptions=angular.copy([{key:"none",value:"None"},{key:"auto",value:"Auto"},{key:"Percent",value:"%"},{key:"Thousand",value:"K"},{key:"Million",value:"M"},{key:"Billion",value:"B"},{key:"Trillion",value:"T"},{key:"Quadrillion",value:"Q"},{key:"Lac",value:"Lacs"},{key:"Crore",value:"Cr"}]),F.globalPropertyMapping.PrecisionOptions=angular.copy([{key:"default",value:"Default"},{key:"0",value:"None"},{key:"1",value:".0"},{key:"2",value:".00"},{key:"3",value:".000"},{key:"4",value:".0000"},{key:"6",value:".000000"},{key:"8",value:".00000000"}]),F.globalPropertyMapping.CurrencyOptions=angular.copy([{key:"none",value:"None"},{key:"Cent",value:"CENT"},{key:"Euro",value:"EURO"},{key:"Rupees",value:"INR"},{key:"Pound",value:"POUND"},{key:"USD",value:"USD"},{key:"Yen",value:"YEN"}]),F.globalPropertyMapping.PositionOptions=angular.copy([{key:"prefix",value:"Prefix"},{key:"suffix",value:"Suffix"}]),F.globalPropertyMapping.NumbFormatterOptions=angular.copy([{key:"none",value:"None"},{key:"indiannumber",value:"Indian"},{key:"number",value:"International"}]),F.globalPropertyMapping.options.BackgroundValue=e.BackgroundValue,F.createVariables("Background"),F.globalPropertyMapping.options.TitleValue=e.TitleValue,F.createVariables("Title"),F.globalPropertyMapping.options.SubTitleValue=e.SubTitleValue,F.createVariables("SubTitle"),F.globalPropertyMapping.options.LegendValue=e.LegendValue,F.createVariables("Legend"),F.globalPropertyMapping.options.FormatterValue=e.FormatterValue,F.createVariables("Formatter"),F.globalPropertyMapping.options.xAxisValue=e.xAxisValue,F.createVariables("xAxis"),F.globalPropertyMapping.options.yAxisValue=e.yAxisValue,F.createVariables("yAxis"),F.showModelPopup("globalPropertyDropdown")},F.createVariables=function(e){F.globalPropertyMapping.properties[e]={};var o=F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType];"Legend"==e?(F.globalPropertyMapping.properties[e].showLegends=o[e].showLegends,F.globalPropertyMapping.properties[e].legendfontColor=o[e].legendfontColor,F.globalPropertyMapping.properties[e].legendfontFamily=o[e].legendfontFamily,F.globalPropertyMapping.properties[e].legendfontSize=o[e].legendfontSize,F.globalPropertyMapping.properties[e].legendfontStyle=o[e].legendfontStyle,F.globalPropertyMapping.properties[e].legendfontWeight=o[e].legendfontWeight,F.globalPropertyMapping.properties[e].legendtextDecoration=o[e].legendtextDecoration,F.globalPropertyMapping.properties[e].hideLegendOnStart=o[e].hideLegendOnStart):"Formatter"==e?(F.globalPropertyMapping.properties[e].NumberFormatter=o[e].NumberFormatter,F.globalPropertyMapping.properties[e].Precision=o[e].Precision,F.globalPropertyMapping.properties[e].Unit=o[e].Unit,F.globalPropertyMapping.properties[e].SecondaryUnit=o[e].SecondaryUnit,F.globalPropertyMapping.properties[e].SignPosition=o[e].SignPosition):"Background"==e?(F.globalPropertyMapping.properties[e].showBorder=o[e].showBorder,F.globalPropertyMapping.properties[e].borderColor=o[e].borderColor,F.globalPropertyMapping.properties[e].borderRadius=o[e].borderRadius):(F.globalPropertyMapping.properties[e].FontSize=o[e].FontSize,F.globalPropertyMapping.properties[e].FontColor=o[e].FontColor,F.globalPropertyMapping.properties[e].FontFamily=o[e].FontFamily,F.globalPropertyMapping.properties[e].FontWeight=o[e].FontWeight,F.globalPropertyMapping.properties[e].FontStyle=o[e].FontStyle,F.globalPropertyMapping.properties[e].TextDecoration=o[e].TextDecoration,F.globalPropertyMapping.properties[e].Align=o[e].Align),"Title"==e&&(F.globalPropertyMapping.properties[e].showTitle=o[e].showTitle,F.globalPropertyMapping.properties[e].TitleBarHeight=o[e].TitleBarHeight),"SubTitle"==e&&(F.globalPropertyMapping.properties[e].showSubTitle=o[e].showSubTitle),"xAxis"!=e&&"yAxis"!=e||(F.globalPropertyMapping.properties[e].LabelFontColor=o[e].LabelFontColor,F.globalPropertyMapping.properties[e].LabelFontFamily=o[e].LabelFontFamily,F.globalPropertyMapping.properties[e].LabelFontSize=o[e].LabelFontSize,F.globalPropertyMapping.properties[e].LabelFontStyle=o[e].LabelFontStyle,F.globalPropertyMapping.properties[e].LabelFontWeight=o[e].LabelFontWeight,F.globalPropertyMapping.properties[e].LabelTextDecoration=o[e].LabelTextDecoration,F.globalPropertyMapping.properties[e].LabelTilted=o[e].LabelTilted,F.globalPropertyMapping.properties[e].Labelrotation=o[e].Labelrotation),"xAxis"==e&&(F.globalPropertyMapping.properties[e].CategoryMarkingColor=o[e].CategoryMarkingColor,F.globalPropertyMapping.properties[e].LineXAxisColor=o[e].LineXAxisColor,F.globalPropertyMapping.properties[e].ShowLineXAxis=o[e].ShowLineXAxis,F.globalPropertyMapping.properties[e].TickMarks=o[e].TickMarks,F.globalPropertyMapping.properties[e].LabelTilted=o[e].LabelTilted,F.globalPropertyMapping.properties[e].Labelrotation=o[e].Labelrotation),"yAxis"==e&&(F.globalPropertyMapping.properties[e].LineYAxisColor=o[e].LineYAxisColor,F.globalPropertyMapping.properties[e].ShowLineYAxis=o[e].ShowLineYAxis)},F.updateGlobalPropertyDropdown=function(){for(var e=F.globalPropertyMapping.options,o=Object.keys(F.globalPropertyMapping.options),a=0;a<o.length;a++)F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType][o[a]]=e[o[a]];F.applyGlobalProperty(F.globalPropertyMapping.properties),F.setDashboardCSS(F.modal.userPreference)},F.toggleGpHeader=function(e){F.globalPropertyMapping.toggleValue!=e||IsBoolean(F.globalPropertyMapping.options[e+"Value"])?F.globalPropertyMapping.toggleValue=e:F.globalPropertyMapping.toggleValue=""},F.onCustomThemeMappingDropdown=function(e){F.customThemeMapping=e,F.customThemeMapping.options=[],F.customThemeMapping.heading="Dashboard Theme Selection",F.customThemeMapping.themeName=F.selectedTheme[F.getActiveDashboardId()],F.customThemeMapping.themeId=F.selectedTheme[F.getActiveDashboardId()],F.customThemeMapping.value=F.selectedTheme[F.getActiveDashboardId()];F.modal.globalThemeDbConfig;e=[{key:"default-theme",value:"default-theme"},{key:"dark-theme",value:"dark-theme"},{key:"material-theme",value:"material-theme"},{key:"EmeraldForest",value:"EmeraldForest"},{key:"BurnishedBronze",value:"BurnishedBronze"},{key:"SkyOasis",value:"SkyOasis"},{key:"CharcoalGrey",value:"CharcoalGrey"}];angular.forEach(e,function(e,o){F.customThemeMapping.value==e.name&&(F.customThemeMapping.themeId=e.name,F.customThemeMapping.themeName=e.name)}),F.customThemeMapping.options=e,F.showModelPopup("customThemeMappingDropdown")},F.onCustomThemeUpdateDropdown=function(){F.customThemeUpdateDropdown.heading="Update Dashboard Theme for Dark Mode",F.showModelPopup("customThemeUpdateDropdown")},F.updateCustomThemeUpdateDropdown=function(){F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].designerTheme="dark-theme",F.newDesignerTheme="dark-theme",F.applyDesignerTheme(F.newDesignerTheme),F.setDashboardCSS(F.modal.userPreference)},F.updateCustomThemeMappingDropdown=function(){F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType][F.customThemeMapping.attributeName]=F.customThemeMapping.value,F.themeProp=F.customThemeMapping,F.newDesignerTheme=F.customThemeMapping.value,F.applyDesignerTheme(F.newDesignerTheme),F.setDashboardCSS(F.modal.userPreference)},F.onGridPropertyClick=function(e){F.gridColorList=[];var o=[];""+e.value!="NaN"&&""!=e.value?o=(""+e.value).split(","):o[0]="#ffffff";for(var a=0;a<o.length;a++){var t={};t.index=a,t.value=convertColorToHex(o[a]),F.gridColorList.push(t)}F.customgridprop=e,F.showModelPopup("customGridColorWindow"),-1==navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||C(function(){F.initSpectrumColorPicker("input[type='color']")},.01)},F.updateGridColors=function(){for(var e="",o=0;o<F.gridColorList.length;o++)e+=F.gridColorList[o].value+",";e=e.substring(0,e.length-1),F.customgridprop.value=e,F.onPropertyChange(F.customgridprop)},F.onCustomFileClick=function(t){$("#browseSVG").click().on("change",function(e){e.stopImmediatePropagation();var a,e=e.target.files[0];"image/svg+xml"==e.type?((a=new FileReader).onload=function(e){var o=a.result;t.value=o,F.onPropertyChange(t)},a.readAsText(e)):T.showNotification("Please use SVG file instead of "+e.name,"alert-danger",3e3)})},F.onCustomFileFilterChipsClick=function(t){$("#browseSVGFilterchips").click().on("change",function(e){e.stopImmediatePropagation();var a,e=e.target.files[0];"image/svg+xml"==e.type?((a=new FileReader).onload=function(e){var o=a.result;t.value=o,F.onPropertyChange(t)},a.readAsText(e)):T.showNotification("Please use SVG file instead of "+e.name,"alert-danger",3e3)})},F.onCustomTextClick=function(e){F.customprop=e,F.customprop.text=e.value,F.showModelPopup("customTextWindow")},F.updateCustomTextValue=function(){F.customprop.value=F.customprop.text,F.onPropertyChange(F.customprop)},F.onCustomPublishedWidgets=function(e){if(F.customPropPublishedWidgets=angular.copy(e),!F.modal.selectedComponentId)return!1;var e=F.getComponentbyId(F.modal.selectedComponentId).Chart.associatedWidgetData,o=window.sessionStorage.getItem("bvz_spacekey"),e=(F.selectedWidgetData=e,{isPublished:1,spaceKey:o});T.showLoader(),BIZVIZ.SDK.secureRequest("/widget/getAllPublishWidgets/",e,function(e,o){var a=e.widgetResp.success;F.widgetData=a?e.widgetResp.bizvizWidgets.map(e=>{var o=JSON.parse(e.data);return{id:e.id,datasetname:F.getPublishedWidgetDatasetName(e.referenceId),properties:o.properties,viewData:o}}):[],F.showModelPopup("customPublishedWidgets"),T.hideLoader()},function(e,o){T.showNotification("Failed to load Publihsed Widgets","alert-danger",3e3),T.hideLoader()})},F.getPublishedWidgetDatasetName=function(e){var o=window.sessionStorage.getItem("bvz_spacekey");BIZVIZ.SDK.secureRequest("/datasource/vieweditqueryservice/",{serviceId:e,spaceKey:o},function(e,o){return e.queryServices.success?e.queryServices.queryService.queryName:"Default"},function(e,o){return"Default"})},F.setSelectedPublihsedWidget=function(e){F.selectedWidgetData=e},F.updateSelectedPublihsedWidget=function(){F.getComponentbyId(F.modal.selectedComponentId).Chart.associatedWidgetData=F.selectedWidgetData},F.onCustomTextBoxForJSPaths=function(e){if(F.customprop=angular.copy(e),F.customprop.activePath="JS",!F.modal.selectedComponentId)return!1;var o=F.getComponentbyId(F.modal.selectedComponentId);F.customprop.jspaths=o.Chart[e.attributeName.split("-")[0]]||[],F.customprop.csspaths=o.Chart[e.attributeName.split("-")[1]]||[],F.showModelPopup("customTextBoxForJSPaths")},F.addPathInJSPaths=function(){"JS"==F.customprop.activePath?F.customprop.jspaths.push({name:"",src:""}):"CSS"==F.customprop.activePath&&F.customprop.csspaths.push({name:"",src:""})},F.removeAllJSPaths=function(){"JS"==F.customprop.activePath?F.customprop.jspaths=[]:"CSS"==F.customprop.activePath&&(F.customprop.csspaths=[])},F.removeJSPath=function(e){var o;"JS"==F.customprop.activePath?(o=F.customprop.jspaths.indexOf(e),F.customprop.jspaths.splice(o,1)):"CSS"==F.customprop.activePath&&(o=F.customprop.csspaths.indexOf(e),F.customprop.csspaths.splice(o,1))},F.updateCustomTextBoxForJSPaths=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);"JS"==F.customprop.activePath&&(e.Chart.JSPaths=F.customprop.jspaths),"CSS"==F.customprop.activePath&&(e.Chart.CSSPaths=F.customprop.csspaths),F.redrawComponent(e),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateCustomTextBoxForJSPathsInMobileView(e)},F.syncUpdateCustomTextBoxForJSPathsInMobileView=function(e){var o=F.getComponentFromMobileLayout(e.objectID);o&&(o.Chart.JSPaths=F.customprop.jspaths,o.Chart.CSSPaths=F.customprop.csspaths),F.getComponentFromTabletLayout(e.objectID)&&(o.Chart.JSPaths=F.customprop.jspaths,o.Chart.CSSPaths=F.customprop.csspaths)},F.onCustomTextBoxForJSContent=function(e){if(F.customprop=angular.copy(e),F.customprop.activePath="JS",!F.modal.selectedComponentId)return!1;var o=F.getComponentbyId(F.modal.selectedComponentId);F.customprop.jstext=o.Chart[e.attributeName.split("-")[0]]||"",F.customprop.csstext=o.Chart[e.attributeName.split("-")[1]]||"",F.customprop.htmltext=o.Chart[e.attributeName.split("-")[2]]||"",F.showModelPopup("customTextBoxForJSContent")},F.updateCustomTextBoxForJSContent=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);e.Chart.JSContent=F.customprop.jstext,e.Chart.CSSContent=F.customprop.csstext,e.Chart.HTMLContent=F.customprop.htmltext,F.redrawComponent(e),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateCustomTextBoxForJSContentInMobileView(e)},F.syncUpdateCustomTextBoxForJSContentInMobileView=function(e){var o=F.getComponentFromMobileLayout(e.objectID),o=(o&&(o.Chart.JSContent=F.customprop.jstext,o.Chart.CSSContent=F.customprop.csstext,o.Chart.HTMLContent=F.customprop.htmltext),F.getComponentFromTabletLayout(e.objectID));o&&(o.Chart.JSContent=F.customprop.jstext,o.Chart.CSSContent=F.customprop.csstext,o.Chart.HTMLContent=F.customprop.htmltext)},F.onCustomTextBoxForToolTip=function(e){F.customprop=e,F.selectedFieldDisplayArray=[],F.customprop.text="",F.dataSetFields=[],F.dataSetFieldsName=[];var o="Funnel"==F.component.subElement?F.component.Funnel:F.component.Chart;if(o.DataSet&&0!==o.DataSet.Fields.length){for(var a=0;o.DataSet.Fields.length>a;a++)F.selectedFieldDisplayArray.push("<p>"+o.DataSet.Fields[a].DisplayName+" : ["+o.DataSet.Fields[a].Name+"]</p>");F.customprop.text=F.selectedFieldDisplayArray.join("\n");var t=F.fieldForSelection(F.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,o.DataSet.dataSource);F.dataSetFields=t.DataArraySelect,F.dataSetFieldsName=t.DataArray}F.version=s.getVersion(),F.versionNumber=F.version.substring(1),o.CustomTextBoxForToolTip&&o.CustomTextBoxForToolTip.datatipData?F.htmlcontent=o.CustomTextBoxForToolTip.datatipData:(F.orightml=F.customprop.text,F.htmlcontent=F.customprop.text,F.disabled=!1),F.customprop.value.dataTipTypeArray?(F.dataTipTypeForDisplay={},F.setFormatterTooltip(),F.dataTipTypeForDisplay.dataTipType=F.customprop.value.dataTipType,F.dataTipTypeForDisplay.dataTipTypeArray=F.customprop.value.dataTipTypeArray,F.dataTipTypeForDisplay.datatipData=F.customprop.value.datatipData,F.dataTipTypeForDisplay.useComponentFormatter=F.customprop.value.useComponentFormatter,F.dataTipTypeForDisplay.displayWindow=F.customprop.value.displayWindow):(F.dataTipTypeForDisplay={dataTipTypeArray:"",dataTipType:"",datatipData:"",formatter:{},useComponentFormatter:!0,displayWindow:"textBox"},null==o.showTooltip||IsBoolean(o.showTooltip)?F.dataTipTypeForDisplay.dataTipType="Default":F.dataTipTypeForDisplay.dataTipType="None",F.dataTipTypeForDisplay.dataTipTypeArray="true"==e.showcustom?["None","Default","Custom"]:["None","Default"],"MitoPlot"===o.Type&&(F.dataTipTypeForDisplay.dataTipTypeArray=["None","Custom"],F.dataTipTypeForDisplay.dataTipType="None"),"Decomposition"!==o.Type&&"KnowledgeGraph"!==o.Type&&"Sankey"!==o.Type||(F.dataTipTypeForDisplay.dataTipTypeArray=["None","Default"],F.dataTipTypeForDisplay.dataTipType="Default"),F.dataTipTypeForDisplay.datatipData=F.htmlcontent,F.setFormatterTooltip()),F.dataTipTypeForDisplay.showToolTipFormatter=F.getShowToolTipFormatter(F.component[F.component.subElement].Type),F.showModelPopup("customTextBoxForToolTip")},F.getShowToolTipFormatter=function(e){switch(e){case"Area":case"Line":case"Timeline":case"Column":case"Bar":case"Mixed":case"GroupBar":case"HeatMap":case"Bubble":case"TreeMap":case"Plot":case"WorldMap":return!0;default:return!1}},F.setFormatterTooltip=function(){if(void 0===F.dataTipTypeForDisplay.formatter&&(F.dataTipTypeForDisplay.formatter={}),0<F.dataSetFieldsName.length&&void 0!==F.modal.propertyJson.Formatter)for(var e=0;F.dataSetFieldsName.length>e;e++)if(void 0===F.customprop.value.formatter||void 0===F.customprop.value.formatter[F.dataSetFieldsName[e]])for(var o=0;F.modal.propertyJson.Formatter.length>o&&(void 0===F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]={}),void 0===F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]][F.modal.propertyJson.Formatter[o].attributeName]);o++)F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]][F.modal.propertyJson.Formatter[o].attributeName]={options:F.modal.propertyJson.Formatter[o].options,value:F.modal.propertyJson.Formatter[o].value.key};else{void 0===F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]={}),F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]=F.customprop.value.formatter[F.dataSetFieldsName[e]];for(var a=0;F.modal.propertyJson.Formatter.length>a;a++)F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]][F.modal.propertyJson.Formatter[a].attributeName].options=F.modal.propertyJson.Formatter[a].options}if(0<F.dataSetFieldsName.length&&"world_map"==F.component.componentType)for(e=0;F.dataSetFieldsName.length>e;e++)if(void 0===F.customprop.value.formatter||void 0===F.customprop.value.formatter[F.dataSetFieldsName[e]])for(var t=F.datasetDesignProperties[F.component.designData.class].FieldProperties,a=0;F.datasetDesignProperties[F.component.designData.class].FieldProperties.length>a;a++)void 0===F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]={}),"unitname"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].Unit={options:t[a].options,value:t[a].value}),"secondunitname"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].SecondaryUnit={options:t[a].options,value:t[a].value}),"numberFormatter"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].NumberFormatter={options:t[a].options,value:t[a].value}),"Precision"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].Precision={options:t[a].options,value:t[a].value}),"signposition"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].SignPosition={options:t[a].options,value:t[a].value});else{void 0===F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]={}),F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]]=F.customprop.value.formatter[F.dataSetFieldsName[e]];for(t=F.datasetDesignProperties[F.component.designData.class].FieldProperties,a=0;F.datasetDesignProperties[F.component.designData.class].FieldProperties.length>a;a++)"unitname"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].Unit.options=t[a].options,F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].Unit.value=t[a].value),"secondunitname"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].SecondaryUnit.options=t[a].options),"numberFormatter"==t[a].attributeName&&(void 0===F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].NumberFormatter?F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].NumberFormatter={options:t[a].options,value:t[a].value}:F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].NumberFormatter.options=t[a].options),"Precision"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].Precision.options=t[a].options),"signposition"==t[a].attributeName&&(F.dataTipTypeForDisplay.formatter[F.dataSetFieldsName[e]].SignPosition.options=t[a].options)}},F.fieldForSelection=function(e,o){for(var a=[],t=[],s={DataArraySelect:[],DataArray:[]},n=0,r=e.length;n<r;n++)if(e[n].id==o){for(var l=e[n].FieldSet,i=0,d=l.length;i<d;i++)a.push(l[i].name+" : ["+l[i].name+"]"),t.push(l[i].name);for(var c=e[n].calculatedFieldList,u=0,p=c.length;u<p;u++)a.push(c[u].name+" : ["+c[u].name+"]"),t.push(c[u].name);s.DataArraySelect=a,s.DataArray=t;break}return s},F.updateTextField=function(e){e="<p>"+(e=e.split(/\[+(.*?)\]+/g))[0]+"["+e[1]+"]</p>";F.dataTipTypeForDisplay.datatipData=F.dataTipTypeForDisplay.datatipData+e},F.updateCustomTextBoxForToolTip=function(e){if(e)for(var o in e.formatter)if(e.formatter.hasOwnProperty(o))for(var a in e.formatter[o])e.formatter[o].hasOwnProperty(a)&&delete e.formatter[o][a].options;F.customprop.value=e,F.onPropertyChange(F.customprop)},F.onCustomTextBoxClick=function(e){F.customprop=e,F.customprop.text=e.value,F.showModelPopup("customTextBoxWindow")},F.onCustomURLButtonParameterClick=function(e){F.customprop=e;e=F.getComponentbyId(F.modal.selectedComponentId);if(F.customprop.value=[],e.URLButton.Params.Param&&0!=e.URLButton.Params.Param.length)for(var o=e.URLButton.Params.Param,a=0;a<o.length;a++){var t={};t.name=o[a].name,t.value=o[a].value,F.customprop.value.push(t)}F.showModelPopup("customURLButtonParametersWindow")},F.addURLButtonParam=function(){F.customprop.value.push({name:"Name",value:""})},F.removeURLButtonParameter=function(e){e=F.customprop.value.indexOf(e);F.customprop.value.splice(e,1)},F.removeAllURLButtonParameter=function(){F.customprop.value=[]},F.updateComponentJsonWithURLParameter=function(){var e=F.customprop,o=F.getComponentbyId(F.modal.selectedComponentId);DesignerUtil.prototype.getInnerObjectbyString(o,e.propertyName)[e.attributeName]=e.value,IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateComponentJsonWithURLParameterInMobileView(o,e)},F.syncUpdateComponentJsonWithURLParameterInMobileView=function(e,o){var a=F.getComponentFromMobileLayout(e.objectID),a=(a&&(DesignerUtil.prototype.getInnerObjectbyString(a,o.propertyName)[o.attributeName]=o.value),F.getComponentFromTabletLayout(e.objectID));a&&(DesignerUtil.prototype.getInnerObjectbyString(a,o.propertyName)[o.attributeName]=o.value)},F.goToCDNLibraryPage=function(){window.open("//cdnjs.com/libraries/","_blank")},F.goToHTMLEditor=function(){window.open("./resources/help/HTMLEditor.html","_blank")},F.goToBizvizFontIconBrowser=function(){window.open("../charting/src/bizviz.charting/components/resources/font-icons.html","_blank")},F.onCustomBubbleColorBandClick=function(e){if(!F.modal.selectedComponentId)return!1;var o=F.getComponentbyId(F.modal.selectedComponentId);if(F.custompropBubbleBand=e,F.custompropBubbleBand.value=[],""!=o.Chart.BandDisplayNames)for(var a=o.Chart.BandDisplayNames.split(","),t=o.Chart.ColorBandRanges.split(","),s=o.Chart.BandColors.split(","),n=o.Chart.BandAlphas.split(","),r=0;r<a.length;r++){var l={};l.name=a[r],l.range=t[r],l.color=s[r],l.alpha=+n[r],F.custompropBubbleBand.value.push(l)}F.showModelPopup("customBubbleColorBandWindow")},F.addColorBandRange=function(){var e={name:"Band",range:0,color:"#08AEA8",alpha:.5};F.custompropBubbleBand.value.push(e)},F.UpdateBandColorRange=function(){for(var e=F.getComponentbyId(F.modal.selectedComponentId),o="",a="",t="",s="",n=F.custompropBubbleBand.value,r=0;r<n.length;r++){var l=r<n.length-1?",":"";o+=n[r].name+l,a+=n[r].range+l,t+=n[r].color+l,s+=n[r].alpha+l}e.Chart.BandDisplayNames=o,e.Chart.ColorBandRanges=a,e.Chart.BandColors=t,e.Chart.BandAlphas=s,F.redrawComponent(e),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateBandColorRangeInMobileView(e,o,a,t,s)},F.syncUpdateBandColorRangeInMobileView=function(e,o,a,t,s){var n=F.getComponentFromMobileLayout(e.objectID),n=(n&&(n.Chart.BandDisplayNames=o,n.Chart.ColorBandRanges=a,n.Chart.BandColors=t,n.Chart.BandAlphas=s),F.getComponentFromTabletLayout(e.objectID));n&&(n.Chart.BandDisplayNames=o,n.Chart.ColorBandRanges=a,n.Chart.BandColors=t,n.Chart.BandAlphas=s)},F.removeBandColorRange=function(e){e=F.custompropBubbleBand.value.indexOf(e);F.custompropBubbleBand.value.splice(e,1)},F.removeAllBandColorRange=function(){F.custompropBubbleBand.value=[]},F.onAssociateGroupsClick=function(e){F.custompropAssociateGroups=e,F.AssignedTab="",F.custompropAssociateGroups.value=[];var o=F.getComponentbyId(F.modal.selectedComponentId),a=o[o.subElement].tabObjectArr||[];if(""!=a)for(var t=0;t<a.length;t++)(o={}).name=a[t].tabName,o.id=a[t].tabId,F.custompropAssociateGroups.value.push(o);F.custompropAssociateGroups.groups=[],F.showModelPopup("customAssociateGroupsWindow")},F.onChangeAssociateDefaultTab=function(e){},F.onAddTabs=function(e){var o=F.getComponentbyId(F.modal.selectedComponentId),a=(F.assignedGroups=o[o.subElement].associateGroups||[],F.AssignedTab=e,F.modal.selectedDashboard.json.Dashboard.componentGroups||[]),t=F.assignedGroups.map(function(e){return e.key}).indexOf(e.id);F.custompropAssociateGroups.groups=[];for(var s,n=0;n<a.length;n++)a[n].aCompIds.length&&(s=-1!=t&&-1!=F.assignedGroups[t].value.indexOf(a[n].gName),F.custompropAssociateGroups.groups.push({key:a[n].$$hashKey,selected:s,value:a[n].gName}))},F.onAddRemoveGroups1=function(e){var o,a;e.groups?(o=e.$$hashKey,a=F.assignedGroupIds.findIndex(function(e){return e==o}),F.assignedGroupIds.splice(a,1)):F.assignedGroupIds.push(e)},F.UpdateAssociateGroup=function(e){F.getComponentbyId(F.modal.selectedComponentId);var o=[],a=F.assignedGroups.map(function(e){return e.key}).indexOf(F.AssignedTab.id);-1==a?(0==e.selected&&o.push(e.value),F.assignedGroups.push({key:F.AssignedTab.id,value:o})):(o=F.assignedGroups[a].value,0==e.selected?o.push(e.value):(i=o.indexOf(e.value),o.splice(i,1)),F.assignedGroups[a].value=o)},F.SaveAssociateGroup=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);e[e.subElement].associateGroups=F.assignedGroups},F.onAddRemovetabs=function(e){IsBoolean(e.selected)||(F.assignTabId=e.id)},F.onCustomTabClick=function(e){F.custompropTab=e,F.custompropTab.value=[];var o=F.getComponentbyId(F.modal.selectedComponentId),a=(F.assignTabId=o.TabComponent.assignTabId,o.TabComponent.tabObjectArr);if(""!=a)for(var t=0;t<a.length;t++)(o={}).name=a[t].tabName,o.selected=a[t].tabId===F.assignTabId?"true":"false",o.id=a[t].tabId,o.icon=a[t].tabIcon,F.custompropTab.value.push(o);F.showModelPopup("customManageTabsWindow")},F.addTab=function(){var e={},o=(F.count=null==F.count?0:F.count,F.getComponentbyId(F.modal.selectedComponentId).TabComponent.tabObjectArr);e.name="Tab",e.selected="false",e.id="Tab"+F.getComponentbyId(F.modal.selectedComponentId).objectID+(o.length+F.count),e.icon="bd-diamond",F.count++,F.custompropTab.value.push(e)},F.updateTabs=function(e){F.count=0;var o=F.getComponentbyId(F.modal.selectedComponentId),a=F.custompropTab.value;o.TabComponent.tabObjectArr=[];for(var t=0;t<a.length;t++){e={tabId:"Tab"+F.modal.selectedComponentId+t,tabName:a[t].name,tabDisplayName:a[t].name,tabIcon:a[t].icon};o.TabComponent.tabObjectArr.push(e)}o.TabComponent.assignTabId=F.assignTabId,o.TabComponent.redraw=!0,F.redrawComponent(o)},F.removeTab=function(e){e=F.custompropTab.value.indexOf(e);F.custompropTab.value.splice(e,1)},F.removeAllTabs=function(){F.custompropTab.value=[]},F.onCustomLegendClick=function(e){F.custompropLegend=e,F.custompropLegend.value=[],F.custompropLegend.shapes=["cube","cross","point","polygon","quad","star","triangle"];e=F.getComponentbyId(F.modal.selectedComponentId);if(""!=e.Legend.legendShapes)for(var o=e.Legend.legendNames.split(","),a=e.Legend.legendColors.split(","),t=e.Legend.legendShapes.split(","),s=0;s<o.length;s++){var n={};n.name=o[s],n.color=a[s],n.shape=t[s],F.custompropLegend.value.push(n)}F.showModelPopup("customLegendsWindow")},F.addLegend=function(){var e={name:"Series",color:"#08AEA8",shape:"cube"};F.custompropLegend.value.push(e)},F.updateLegends=function(){for(var e=F.getComponentbyId(F.modal.selectedComponentId),o="",a="",t="",s=F.custompropLegend.value,n=0;n<s.length;n++){var r=n<s.length-1?",":"";o+=s[n].name+r,a+=s[n].color+r,t+=s[n].shape+r}e.Legend.legendNames=o,e.Legend.legendColors=a,e.Legend.legendShapes=t,F.redrawComponent(e),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateLegendsInMobileView(e,o,a,t)},F.syncUpdateLegendsInMobileView=function(e,o,a,t){var s=F.getComponentFromMobileLayout(e.objectID),s=(s&&(s.Legend.legendNames=o,s.Legend.legendColors=a,s.Legend.legendShapes=t),F.getComponentFromTabletLayout(e.objectID));s&&(s.Legend.legendNames=o,s.Legend.legendColors=a,s.Legend.legendShapes=t)},F.removeLegend=function(e){e=F.custompropLegend.value.indexOf(e);F.custompropLegend.value.splice(e,1)},F.removeAllLegends=function(){F.custompropLegend.value=[]},F.onCustomCheckboxClick=function(e){F.custompropCheckbox=e,F.custompropCheckbox.value=[],F.custompropCheckbox.shapes=["checked","unchecked"];e=F.getComponentbyId(F.modal.selectedComponentId);if(""!=e.Filter.checkboxShapes)for(var o=e.Filter.checkboxNames.split(","),a=e.Filter.checkboxColors.split(","),t=e.Filter.checkboxValue.split(","),s=e.Filter.checkboxShapes.split(","),n=0;n<o.length;n++){var r={};r.name=o[n],r.color=a[n],r.value=t[n],r.shape=s[n],F.custompropCheckbox.value.push(r)}F.showModelPopup("customCheckboxesWindow")},F.addCheckbox=function(){var e={name:"Label",color:"#08AEA8",value:"1",shape:"unchecked"};F.custompropCheckbox.value.push(e)},F.removeCheckbox=function(e){e=F.custompropCheckbox.value.indexOf(e);F.custompropCheckbox.value.splice(e,1)},F.updateCheckboxes=function(){for(var e=F.getComponentbyId(F.modal.selectedComponentId),o="",a="",t="",s="",n=F.custompropCheckbox.value,r=0;r<n.length;r++){var l=r<n.length-1?",":"";o+=n[r].name+l,a+=n[r].color+l,t+=n[r].value+l,s+=n[r].shape+l}e.Filter.checkboxNames=o,e.Filter.checkboxColors=a,e.Filter.checkboxValue=t,e.Filter.checkboxShapes=s,F.redrawComponent(e),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateFiltersInMobileView(e,o,a,t,s)},F.syncUpdateFiltersInMobileView=function(e,o,a,t){var s=F.getComponentFromMobileLayout(e.objectID),s=(s&&(s.Filter.checkboxNames=o,s.Filter.checkboxColors=a,s.Filter.checkboxValue=values,s.Filter.checkboxShapes=t),F.getComponentFromTabletLayout(e.objectID));s&&(s.Filter.checkboxNames=o,s.Filter.checkboxColors=a,s.Filter.checkboxValue=values,s.Filter.checkboxShapes=t)},F.onCustomAssignFilterClick=function(e){F.custompropAssignChart=e,F.componentListMap={};var o=[],a=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,e=F.getComponentbyId(F.modal.selectedComponentId);F.assignedFilterIds=e[e.subElement].assignedFilters;for(var t,s=0;s<a.length;s++)"filter"!=a[s].objectType&&"date_picker"!=a[s].componentType||(t=-1!=F.assignedFilterIds.indexOf(a[s].objectID),o.push({key:a[s].objectID,selected:t,value:a[s].objectName}));F.componentListMap.options=o,F.showModelPopup("customAssignFilterWindow")},F.UpdateAssociateFilter=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);e[e.subElement].assignedFilters=F.assignedFilterIds},F.onAddRemoveFilters=function(e){var o,a;e.selected?(o=e.key,a=F.assignedFilterIds.findIndex(function(e){return e==o}),F.assignedFilterIds.splice(a,1)):F.assignedFilterIds.push(e.key)},F.onAddRemoveFiltersDS=function(e){F.assignedChartId="none"==e.key?"":e.key},F.onCustomAssignDateClick=function(e){F.custompropAssignChart=e,F.componentListMap={};var o=[],a=(o.push({key:"none",value:"None"}),F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object),e=F.getComponentbyId(F.modal.selectedComponentId),t=(F.associatedDateIds=e[e.subElement].associatecomp,F.modal.selectedComponentId),e={key:F.associatedDateIds};""!==F.associatedDateIds&&F.onChangeAssociateDateDS(e),""===F.associatedDateIds&&(F.associatedDateIdsDataSetFields=[]);for(var s=0;s<a.length;s++)"date"==a[s].objectType&&a[s].objectID!=t&&o.push({key:a[s].objectName,value:a[s].objectName});F.componentListMap.options=o,F.showModelPopup("customAssignDateWindow")},F.onChangeAssociateDate=function(e){F.assignedDateIds="none"==e.key?"":e.key,F.showSelectAll=!1,F.componentType=!0;e=F.assignedDateIds;void 0!==e&&"date"===e.subElement&&(F.assignedComponentDataSet=e.date)},F.onChangeAssociateDateDS=function(e){F.associatedDateIds="none"==e.key?"":e.key},F.updateAssociatedDate=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);e[e.subElement].associatecomp=F.assignedDateIds},F.onCustomAssignChartClick=function(e){F.custompropAssignChart=e,F.componentListMap={};var o=[],a=(o.push({key:"none",value:"None"}),F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object),e=F.getComponentbyId(F.modal.selectedComponentId),e=(F.AssignedComponent=e[e.subElement].associatedChartId,F.showSelectAll=!1,{key:F.AssignedComponent});""!==F.AssignedComponent&&F.onChangeAssociateChart(e),""===F.AssignedComponent&&(F.assignedChartDataSetFields=[]);for(var t=0;t<a.length;t++)"chart"!=a[t].objectType&&"funnel"!=a[t].objectType&&"datagrid"!=a[t].objectType&&"scorecard"!=a[t].objectType||"SentimentPlot"==a[t][a[t].subElement].Type||"Progress"==a[t][a[t].subElement].Type||"WordCloud"==a[t][a[t].subElement].Type||"TreeMap"==a[t][a[t].subElement].Type||"Chevron"==a[t][a[t].subElement].Type||"BoxPlot"==a[t][a[t].subElement].Type||"Plot"==a[t][a[t].subElement].Type||"Waterfall"==a[t][a[t].subElement].Type||"Histogram"==a[t][a[t].subElement].Type||"SparkLine"==a[t][a[t].subElement].Type||"Sankey"==a[t][a[t].subElement].Type||"NewWordCloud"==a[t][a[t].subElement].Type||"Decomposition"==a[t][a[t].subElement].Type||"KnowledgeGraph"==a[t][a[t].subElement].Type||"ProjectTimeline"==a[t][a[t].subElement].Type||"MitoPlot"==a[t][a[t].subElement].Type||"CandleStick"==a[t][a[t].subElement].Type||"DTC"==a[t][a[t].subElement].Type||"Trellis"==a[t][a[t].subElement].Type||o.push({key:a[t].objectID,value:a[t].objectName});F.componentListMap.options=o,F.showModelPopup("customAssignChartWindow")},F.onCustomAssignDSChartClick=function(e){F.custompropAssignChart=e,F.componentListMap={};var o=[],a=(o.push({key:"none",value:"None"}),F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object),e=F.getComponentbyId(F.modal.selectedComponentId),e=(F.AssignedComponent=e[e.subElement].associatedDSChartId,F.showSelectAll=!1,{key:F.AssignedComponent});""!==F.AssignedComponent&&F.onChangeAssociateChart(e),""===F.AssignedComponent&&(F.assignedChartDataSetFields=[]);for(var t=0;t<a.length;t++)"chart"!=a[t].objectType&&"funnel"!=a[t].objectType&&"datagrid"!=a[t].objectType&&"scorecard"!=a[t].objectType||"SentimentPlot"==a[t][a[t].subElement].Type||"Progress"==a[t][a[t].subElement].Type||"WordCloud"==a[t][a[t].subElement].Type||"TreeMap"==a[t][a[t].subElement].Type||"Chevron"==a[t][a[t].subElement].Type||"BoxPlot"==a[t][a[t].subElement].Type||"Plot"==a[t][a[t].subElement].Type||"Waterfall"==a[t][a[t].subElement].Type||"Histogram"==a[t][a[t].subElement].Type||"SparkLine"==a[t][a[t].subElement].Type||"ProjectTimeline"==a[t][a[t].subElement].Type||"MitoPlot"==a[t][a[t].subElement].Type||"CandleStick"==a[t][a[t].subElement].Type||"DTC"==a[t][a[t].subElement].Type||"Trellis"==a[t][a[t].subElement].Type||o.push({key:a[t].objectID,value:a[t].objectName});F.componentListMap.options=o,F.showModelPopup("customAssignChartWindow")},F.onChangeAssociateChart=function(e){F.assignedChartId="none"==e.key?"":e.key,F.showSelectAll=!1,F.componentType=!0;var e=F.getComponentbyId(F.assignedChartId);void 0!==e&&"Chart"===e.subElement?(F.assignedComponentDataSet=e.Chart,F.componentType="Pie"!==e.Chart.Type):void 0!==e&&"Funnel"===e.subElement?(F.assignedComponentDataSet=e.Funnel,F.componentType=!1):void 0!==e&&"DataGrid"===e.subElement?F.assignedComponentDataSet=e.DataGrid:void 0!==e&&"Scorecard"===e.subElement&&(F.assignedComponentDataSet=e.Scorecard),""!==F.assignedChartId&&F.assignedComponentDataSet.DataSet&&void 0!==e?(F.assignedChartDataSetFields=[],F.showSelectAll=0!==F.assignedComponentDataSet.DataSet.Fields.length||F.showSelectAll,F.selected=[],e=e.defaultLegendFields,F.assignedChartDataSetFields=F.getSelectedComponentDatasetFields(F.assignedComponentDataSet.DataSet.Fields,e),F.selected=F.assignedChartDataSetFields.slice(0),F.selectedLegendFields=F.assignedChartDataSetFields.slice(0)):F.assignedChartDataSetFields=[]},F.onChangeAssociateChartDS=function(e){F.assignedChartId="none"==e.key?"":e.key},F.getSelectedComponentDatasetFields=function(e,o){for(var a=[],t=0;t<e.length;t++)"Series"!=e[t].Type&&"Values"!=e[t].Type||!e[t].visible||"parent"===e[t].hierarchyType||a.push({key:e[t].Name,value:F.getValueForField(e[t].Name,o)});return a},F.getValueForField=function(e,o,a){var t=!0;if(o&&0!==o.length)for(var s=0;s<o.length;s++)if(e==o[s].key){t=o[s].value;break}return t},F.isIndeterminate=function(){return 0!==F.selected.length&&F.selected.length!==F.selectedLegendFields.length},F.isChecked=function(){for(var e=!1,o=0;o<F.selectedLegendFields.length;o++)for(var a=0;a<F.selected.length;a++){if(1!=F.selectedLegendFields[o].value||1!=F.selected[a].value){e=!1;break}e=!0}return e},F.toggleAll=function(e){for(var o=$(e.currentTarget).hasClass("md-checked"),a=0;a<F.selectedLegendFields.length;a++)F.selectedLegendFields[a].value=!o;(0===F.selected.length||0<F.selected.length)&&(F.selected=F.selectedLegendFields.slice(0))},F.toggle=function(e,o){var a=o.indexOf(e);-1<a?o[a].value=!o[a].value:o.push(e),F.selectedLegendFields=o},F.exists=function(e,o){for(var a=0;a<o.length;a++)if(o[a].key==e.key)return!!(e.value=o[a].value)},F.UpdateAssociateChart=function(){var e,o=F.getComponentbyId(F.modal.selectedComponentId);"DataSearch"===o.subElement?F.UpdateDataSearchAssociateChart():(o[o.subElement].associatedChartId=F.assignedChartId,""!=F.assignedChartId&&((e=F.getComponentbyId(F.assignedChartId))[e.subElement].associatedLegendId=F.modal.selectedComponentId,F.getComponentbyId(F.assignedChartId).defaultLegendFields=F.selectedLegendFields,IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty))&&"AbsoluteLayout"==F.modal.layoutType&&((e=F.getComponentFromMobileLayout(F.assignedChartId))&&(e[e.subElement].associatedLegendId=F.modal.selectedComponentId,(e=F.getComponentFromMobileLayout(F.assignedChartId)).defaultLegendFields=F.getSelectedLegendFieldsForMobileLayout(e,F.selectedLegendFields)),e=F.getComponentFromTabletLayout(F.assignedChartId))&&(e[e.subElement].associatedLegendId=F.modal.selectedComponentId,(e=F.getComponentFromTabletLayout(F.assignedChartId)).defaultLegendFields=F.getSelectedLegendFieldsForMobileLayout(e,F.selectedLegendFields)),F.removeAssociateChart(F.assignedChartId,F.modal.selectedComponentId),F.redrawComponent(o))},F.UpdateDataSearchAssociateChart=function(){var e,o=F.getComponentbyId(F.modal.selectedComponentId);o[o.subElement].associatedDSChartId=F.assignedChartId,""!=F.assignedChartId&&((e=F.getComponentbyId(F.assignedChartId))[e.subElement].associatedDSId=F.modal.selectedComponentId,IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty))&&"AbsoluteLayout"==F.modal.layoutType&&((e=F.getComponentFromMobileLayout(F.assignedChartId))&&(e[e.subElement].associatedDSId=F.modal.selectedComponentId),e=F.getComponentFromTabletLayout(F.assignedChartId))&&(e[e.subElement].associatedDSId=F.modal.selectedComponentId),F.removeDSAssociateChart(F.assignedChartId,F.modal.selectedComponentId),F.redrawComponent(o)},F.removeAssociateChart=function(e,o){for(var a,t=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,s=0;s<t.length;s++)t[s][t[s].subElement].associatedLegendId==o&&t[s].objectID!=e&&(t[s][t[s].subElement].associatedLegendId="",IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty))&&"AbsoluteLayout"==F.modal.layoutType&&((a=F.getComponentFromMobileLayout(t[s].objectID))&&(a[a.subElement].associatedLegendId=""),a=F.getComponentFromTabletLayout(t[s].objectID))&&(a[a.subElement].associatedLegendId="")},F.removeDSAssociateChart=function(e,o){for(var a,t=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,s=0;s<t.length;s++)t[s][t[s].subElement].associatedDSId==o&&t[s].objectID!=e&&(t[s][t[s].subElement].associatedDSId="",IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty))&&"AbsoluteLayout"==F.modal.layoutType&&((a=F.getComponentFromMobileLayout(t[s].objectID))&&(a[a.subElement].associatedDSId=""),a=F.getComponentFromTabletLayout(t[s].objectID))&&(a[a.subElement].associatedDSId="")},F.getSelectedLegendFieldsForMobileLayout=function(e,o){for(var a=e[e.subElement].DataSet.Fields,t=[],s=0;s<a.length;s++)if("Series"==a[s].Type)for(var n=0;n<o.length;n++)a[s].Name==o[n].key&&t.push(o[n]);return t},F.onCustomThresholdFillWindowClick=function(e){for(var o=F.getComponentbyId(F.modal.selectedComponentId),e=(F.custompropThresholdFillColors=e,F.custompropThresholdFillColors.componentType=o.componentType,F.custompropThresholdFillColors.value=[],DesignerUtil.prototype.getInnerObjectbyString(o,F.custompropThresholdFillColors.propertyName)),a=e[F.custompropThresholdFillColors.attributes.level].split(","),t=e[F.custompropThresholdFillColors.attributes.color].split(","),s=e[F.custompropThresholdFillColors.attributes.label].split(","),n=e[F.custompropThresholdFillColors.attributes.opacity].split(","),r=e[F.custompropThresholdFillColors.attributes.labelcolor].split(","),l=a.length,i=0;i<l;i++){var d={};d.level=a[i],d.color=t[i],d.label=s[i],d.opacity=+n[i],d.labelcolor=r[i],F.custompropThresholdFillColors.value.push(d)}F.showModelPopup("CustomThresholdFillWindow")},F.UpdateThresholdBoxFillColors=function(){for(var e=F.getComponentbyId(F.modal.selectedComponentId),o="",a="",t="",s="",n="",r=F.custompropThresholdFillColors.value,l=0;l<r.length;l++){var i=l<r.length-1?",":"";o+=r[l].level+i,a+=r[l].color+i,t+=r[l].label+i,s+=r[l].opacity+i,n+=r[l].labelcolor+i}var d=DesignerUtil.prototype.getInnerObjectbyString(e,F.custompropThresholdFillColors.propertyName);d[F.custompropThresholdFillColors.attributes.level]=o,d[F.custompropThresholdFillColors.attributes.color]=a,d[F.custompropThresholdFillColors.attributes.label]=t,d[F.custompropThresholdFillColors.attributes.opacity]=s,d[F.custompropThresholdFillColors.attributes.labelcolor]=n,F.redrawComponent(e)},F.removeAllThresholdFillColors=function(){F.custompropThresholdFillColors.value=[]},F.onCustomBoxFillColorClick=function(e){var o=F.getComponentbyId(F.modal.selectedComponentId);if(F.custompropBoxFillColors=e,F.custompropBoxFillColors.componentType=o.componentType,F.custompropBoxFillColors.value=[],""!=o.Chart.boxGroupNames){var e=DesignerUtil.prototype.getInnerObjectbyString(o,F.custompropBoxFillColors.propertyName),a=e[F.custompropBoxFillColors.attributes.names].split(","),t=e[F.custompropBoxFillColors.attributes.lowerColors].split(","),s=e[F.custompropBoxFillColors.attributes.upperColors].split(","),n=e[F.custompropBoxFillColors.attributes.opacity].split(","),r=a.length;"benchmark_analysis_chart"==o.componentType&&(r=1);for(var l=0;l<r;l++){var i={};i.name=a[l],i.lower=t[l],i.upper=s[l],i.opacity=+n[l],F.custompropBoxFillColors.value.push(i)}}F.showModelPopup("customBoxFillColorWindow")},F.addBoxFillColor=function(){var e={name:"Group",lower:"#f89406",upper:"#6c7a89",opacity:.8};F.custompropBoxFillColors.value.push(e)},F.UpdateBoxFillColors=function(){for(var e=F.getComponentbyId(F.modal.selectedComponentId),o="",a="",t="",s="",n=F.custompropBoxFillColors.value,r=0;r<n.length;r++){var l=r<n.length-1?",":"";o+=n[r].name+l,a+=n[r].lower+l,t+=n[r].upper+l,s+=n[r].opacity+l}var i=DesignerUtil.prototype.getInnerObjectbyString(e,F.custompropBoxFillColors.propertyName);i[F.custompropBoxFillColors.attributes.names]=o,i[F.custompropBoxFillColors.attributes.lowerColors]=a,i[F.custompropBoxFillColors.attributes.upperColors]=t,i[F.custompropBoxFillColors.attributes.opacity]=s,F.redrawComponent(e),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateBoxFillColorsInMobileView(e,o,a,t,s)},F.syncUpdateBoxFillColorsInMobileView=function(e,o,a,t,s){var n=F.getComponentFromMobileLayout(e.objectID),n=(n&&((n=DesignerUtil.prototype.getInnerObjectbyString(n,F.custompropBoxFillColors.propertyName))[F.custompropBoxFillColors.attributes.names]=o,n[F.custompropBoxFillColors.attributes.lowerColors]=a,n[F.custompropBoxFillColors.attributes.upperColors]=t,n[F.custompropBoxFillColors.attributes.opacity]=s),F.getComponentFromTabletLayout(e.objectID));n&&((e=DesignerUtil.prototype.getInnerObjectbyString(n,F.custompropBoxFillColors.propertyName))[F.custompropBoxFillColors.attributes.names]=o,e[F.custompropBoxFillColors.attributes.lowerColors]=a,e[F.custompropBoxFillColors.attributes.upperColors]=t,e[F.custompropBoxFillColors.attributes.opacity]=s)},F.removeBoxFillColor=function(e){e=F.custompropBoxFillColors.value.indexOf(e);F.custompropBoxFillColors.value.splice(e,1)},F.removeAllBoxFillColors=function(){F.custompropBoxFillColors.value=[]},F.onCustomProjTimelineMilestoneClick=function(e){if(!F.modal.selectedComponentId)return!1;var o=F.getComponentbyId(F.modal.selectedComponentId),e=(F.custompropRangeIndicator=e,F.custompropRangeIndicator.value=[],DesignerUtil.prototype.getInnerObjectbyString(o,F.custompropRangeIndicator.propertyName)),a=e[F.custompropRangeIndicator.attributes.names].split(","),t=e[F.custompropRangeIndicator.attributes.shapes].split(","),s=e[F.custompropRangeIndicator.attributes.colors].split(","),n=e[F.custompropRangeIndicator.attributes.positions].split(",");if(""!=t[0])for(var r=0;r<a.length;r++){var l={};l.name=a[r],l.shape=t[r],l.position=IsBoolean(n[r]),l.color=s[r],F.custompropRangeIndicator.value.push(l)}F.showModelPopup("customProjTimelineMilestoneWindow")},F.addProjTimelineMilestone=function(){var e={name:"Milestone",shape:"arrowup",position:"true",color:"#08AEA8"};F.custompropRangeIndicator.value.push(e)},F.UpdateProjTimelineMilestone=function(e){for(var o=F.getComponentbyId(F.modal.selectedComponentId),a="",t="",s="",n="",r=F.custompropRangeIndicator.value,l=0;l<r.length;l++){var i=l<r.length-1?",":"";a+=r[l].name+i,t+=r[l].shape+i,n+=r[l].color+i,s+=r[l].position+i}var d=DesignerUtil.prototype.getInnerObjectbyString(o,F.custompropRangeIndicator.propertyName);d[F.custompropRangeIndicator.attributes.names]=a,d[F.custompropRangeIndicator.attributes.shapes]=t,d[F.custompropRangeIndicator.attributes.colors]=n,d[F.custompropRangeIndicator.attributes.positions]=s,F.redrawComponent(o)},F.onCustomProjTimelineTaskClick=function(e){if(!F.modal.selectedComponentId)return!1;var o=F.getComponentbyId(F.modal.selectedComponentId),e=(F.custompropRangeIndicator=e,F.custompropRangeIndicator.value=[],DesignerUtil.prototype.getInnerObjectbyString(o,F.custompropRangeIndicator.propertyName)),a=e[F.custompropRangeIndicator.attributes.names].split(","),t=e[F.custompropRangeIndicator.attributes.shapes].split(","),s=e[F.custompropRangeIndicator.attributes.colors].split(",");if(""!=t[0])for(var n=0;n<a.length;n++){var r={};r.name=a[n],r.shape=t[n],r.color=s[n],F.custompropRangeIndicator.value.push(r)}F.showModelPopup("customProjTimelineTaskWindow")},F.addProjTimelineTask=function(){var e={name:"Task",shape:"rectangle",color:"#08AEA8"};F.custompropRangeIndicator.value.push(e)},F.UpdateProjTimelineTask=function(e){for(var o=F.getComponentbyId(F.modal.selectedComponentId),a="",t="",s="",n=F.custompropRangeIndicator.value,r=0;r<n.length;r++){var l=r<n.length-1?",":"";a+=n[r].name+l,t+=n[r].shape+l,s+=n[r].color+l}var i=DesignerUtil.prototype.getInnerObjectbyString(o,F.custompropRangeIndicator.propertyName);i[F.custompropRangeIndicator.attributes.names]=a,i[F.custompropRangeIndicator.attributes.shapes]=t,i[F.custompropRangeIndicator.attributes.colors]=s,F.redrawComponent(o)},F.onCustomLevelIndicatorClick=function(e){if(!F.modal.selectedComponentId)return!1;var o="",a="",t=F.getComponentbyId(F.modal.selectedComponentId);if(F.custompropLevelIndicator=e,F.custompropLevelIndicator.value=[],""!=t.Chart.Level.DisplayLevelName&&(o=(e=DesignerUtil.prototype.getInnerObjectbyString(t,F.custompropLevelIndicator.propertyName))[F.custompropLevelIndicator.attributes.names].split(","),a=e[F.custompropLevelIndicator.attributes.colors].split(",")),""!=o[0])for(var s=0;s<o.length;s++){var n={};n.name=o[s],n.color=a[s],F.custompropLevelIndicator.value.push(n)}F.showModelPopup("customLevelIndicatorWindow")},F.onCustomShapeSelectorClick=function(e){if(!F.modal.selectedComponentId)return!1;var o,a,t,s,n,r,l,i,d=F.getComponentbyId(F.modal.selectedComponentId);if(F.custompropShapeSelector=e,F.custompropShapeSelector.typevalue=[],F.custompropShapeSelector.rangevalue=[],F.custompropShapeSelector.levelvalue=[],F.custompropShapeSelector.SVGshape=!1,F.custompropShapeSelector.shape=["dot","box","ellipsis","text","star","circle","diamond","square","triangle","triangledown","database"],F.custompropShapeSelector.shapeIndicatorTypeOptions=["type","value","level"],F.custompropShapeSelector.shapeTypeOptions=["Default","Custom","SVG"],""==d.Chart.nodeTypes&&""==d.Chart.DisplayName||(a=(o=DesignerUtil.prototype.getInnerObjectbyString(d,F.custompropShapeSelector.propertyName))[F.custompropShapeSelector.attributes.tnames].split(","),t=o[F.custompropShapeSelector.attributes.typeShapes].split(","),s=o[F.custompropShapeSelector.attributes.rangeShapes].split(","),n=o[F.custompropShapeSelector.attributes.rnames].split(","),r=o[F.custompropShapeSelector.attributes.ranges].split(","),l=o[F.custompropShapeSelector.attributes.lnames].split(","),i=o[F.custompropShapeSelector.attributes.levelShapes].split(",")),F.custompropShapeSelector.shapeIndicatorType=o[F.custompropShapeSelector.attributes.indicatorType],F.custompropShapeSelector.shapeType=o[F.custompropShapeSelector.attributes.shapeType],F.custompropShapeSelector.SVGshape=o.svgShape,""!=n[0])for(var c=0;c<n.length;c++){(p={}).rname=n[c],p.shape=s[c],p.ranges=r[c];var u=r[c].split("~");p.rangeFrom=u[0],p.rangeUpTo=u[1],F.custompropShapeSelector.rangevalue.push(p)}if(""!=a[0])for(c=0;c<a.length;c++)(p={}).tname=a[c],p.shape=t[c],F.custompropShapeSelector.typevalue.push(p);if(""!=l[0])for(var p,c=0;c<l.length;c++)(p={}).lname=l[c],p.shape=i[c],F.custompropShapeSelector.levelvalue.push(p);F.showModelPopup("customShapeSelectorWindow")},F.onCustomSVGFileClick=function(t){var e="browseSVGShape"+Object.values(t)[0],e=document.getElementById(e);$(e).click().change(function(e){e.stopImmediatePropagation();var a,e=e.target.files[0];"image/svg+xml"==e.type?((a=new FileReader).onload=function(e){var o=a.result.replace(/,/g," ");t.shape=o},a.readAsText(e)):T.showNotification("Please use SVG file instead of "+e.name,"alert-danger",3e3)})},F.onCustomColorSelectorClick=function(e){if(!F.modal.selectedComponentId)return!1;var o,a,t,s,n,r,l,i,d=F.getComponentbyId(F.modal.selectedComponentId);if(F.custompropColorSelector=e,F.custompropColorSelector.typevalue=[],F.custompropColorSelector.rangevalue=[],F.custompropColorSelector.levelvalue=[],F.custompropColorSelector.colorIndicatorTypeOptions=["type","value","level"],""==d.Chart.colorTypes&&""==d.Chart.DisplayName||((o=DesignerUtil.prototype.getInnerObjectbyString(d,F.custompropColorSelector.propertyName))[F.custompropColorSelector.attributes.tnames].split(","),a=o[F.custompropColorSelector.attributes.typeColors].split(","),t=o[F.custompropColorSelector.attributes.rangeColors].split(","),s=o[F.custompropColorSelector.attributes.rnames].split(","),n=o[F.custompropColorSelector.attributes.tnames].split(","),r=o[F.custompropColorSelector.attributes.lnames].split(","),l=o[F.custompropColorSelector.attributes.ranges].split(","),i=o[F.custompropColorSelector.attributes.levelColors].split(",")),F.custompropColorSelector.colorIndicatorType=o[F.custompropColorSelector.attributes.indicatorType],""!=s[0])for(var c=0;c<s.length;c++){(p={}).color=t[c],p.rname=s[c],p.ranges=l[c];var u=l[c].split("~");p.rangeFrom=u[0],p.rangeUpTo=u[1],F.custompropColorSelector.rangevalue.push(p)}if(""!=n[0])for(c=0;c<n.length;c++)(p={}).tname=n[c],p.color=a[c],F.custompropColorSelector.typevalue.push(p);if(""!=r[0])for(var p,c=0;c<r.length;c++)(p={}).lname=r[c],p.color=i[c],F.custompropColorSelector.levelvalue.push(p);F.showModelPopup("customColorSelectorWindow")},F.onCustomRangeIndicatorClick=function(e){if(!F.modal.selectedComponentId)return!1;var o=F.getComponentbyId(F.modal.selectedComponentId);if(F.custompropRangeIndicator=e,F.custompropRangeIndicator.value=[],""!=o.Chart.rangedSeriesDisplayNames){var e=DesignerUtil.prototype.getInnerObjectbyString(o,F.custompropRangeIndicator.propertyName),a=e[F.custompropRangeIndicator.attributes.names].split(","),t=e[F.custompropRangeIndicator.attributes.ranges].split(","),s=e[F.custompropRangeIndicator.attributes.colors].split(",");if(""!=t[0])for(var n=0;n<a.length;n++){var r={},l=(r.name=a[n],t[n].split("~"));r.rangeFrom=l[0],r.rangeUpTo=l[1],r.color=s[n],F.custompropRangeIndicator.value.push(r)}}F.custompropRangeIndicator.dynamicColorRange={},F.custompropRangeIndicator.dynamicColorRange.componentType=o.componentType,F.custompropRangeIndicator.dynamicColorRange.showDynamicRange=IsBoolean(o.Chart.showDynamicRange),F.custompropRangeIndicator.dynamicColorRange.minRangeColor=o.Chart.minRangeColor,F.custompropRangeIndicator.dynamicColorRange.maxRangeColor=o.Chart.maxRangeColor,F.showModelPopup("customRangeIndicatorWindow")},F.addRangeIndicatorRange=function(){var e={},o=F.custompropRangeIndicator.value.length;0==o?(e.name="Range",e.rangeFrom="0",e.rangeUpTo="20"):(o=parseFloat(F.custompropRangeIndicator.value[o-1].rangeUpTo),e.name="Range",e.rangeFrom=o.toString(),e.rangeUpTo=(o+20).toString()),e.color="#08AEA8",F.custompropRangeIndicator.value.push(e)},F.addLevelIndicatorRange=function(){var e={},o=F.custompropLevelIndicator.value.length;e.name=0==o?"Level 1":"Level "+(o+1),e.color="#08AEA8",F.custompropLevelIndicator.value.push(e)},F.addCustomShapesLevel=function(){var e,o,a={};"value"==F.custompropShapeSelector.shapeIndicatorType?(0==(o=F.custompropShapeSelector.rangevalue.length)?(a.rname="Range",a.rangeFrom="0",a.rangeUpTo="5"):(e=parseFloat(F.custompropShapeSelector.rangevalue[o-1].rangeUpTo),a.rname="Range",a.rangeFrom=e.toString(),a.rangeUpTo=(e+20).toString()),a.shape="dot",F.custompropShapeSelector.rangevalue.push(a)):"level"==F.custompropShapeSelector.shapeIndicatorType?(o=F.custompropShapeSelector.levelvalue.length,a.lname="Level "+(o+1),a.shape="dot",F.custompropShapeSelector.levelvalue.push(a)):"type"==F.custompropShapeSelector.shapeIndicatorType&&(o=F.custompropShapeSelector.typevalue.length,a.tname="Type "+(o+1),a.shape="dot",F.custompropShapeSelector.typevalue.push(a))},F.addCustomColorsLevel=function(){var e,o,a={};"value"==F.custompropColorSelector.colorIndicatorType?(0==(o=F.custompropColorSelector.rangevalue.length)?(a.rname="Range",a.rangeFrom="0",a.rangeUpTo="5"):(e=parseFloat(F.custompropColorSelector.rangevalue[o-1].rangeUpTo),a.rname="Range",a.rangeFrom=e.toString(),a.rangeUpTo=(e+20).toString()),a.color="#08AEA8",F.custompropColorSelector.rangevalue.push(a)):"level"==F.custompropColorSelector.colorIndicatorType?(o=F.custompropColorSelector.levelvalue.length,a.lname="Level "+(o+1),a.color="#08AEA8",F.custompropColorSelector.levelvalue.push(a)):"type"==F.custompropColorSelector.colorIndicatorType&&(o=F.custompropColorSelector.typevalue.length,a.tname="Type "+(o+1),a.color="#08AEA8",F.custompropColorSelector.typevalue.push(a))},F.UpdateRangeIndicatorRange=function(){for(var e=F.getComponentbyId(F.modal.selectedComponentId),o="",a="",t="",s=F.custompropRangeIndicator.value,n=!0,r=!0,l=!0,i=0;i<s.length;i++){var d=i<s.length-1?",":"";o+=s[i].name+d,""!=s[i].rangeFrom&&""!=s[i].rangeUpTo||(n=!1),""!=s[i].rangeFrom&&""!=s[i].rangeUpTo&&parseFloat(s[i].rangeFrom)>=parseFloat(s[i].rangeUpTo)&&(r=!1),(isNaN(s[i].rangeFrom)||isNaN(s[i].rangeUpTo))&&""!=s[i].rangeFrom&&""!=s[i].rangeUpTo&&(l=!1),a+=s[i].rangeFrom+"~"+s[i].rangeUpTo+d,t+=s[i].color+d}if(!IsBoolean(n))return T.showNotification("Range values must not be empty","alert-warning",3e3),F.onCustomRangeIndicatorClick(F.custompropRangeIndicator),!1;if(!IsBoolean(l))return T.showNotification("Range values only accepts numbers","alert-warning",3e3),F.onCustomRangeIndicatorClick(F.custompropRangeIndicator),!1;if(!IsBoolean(r))return T.showNotification("RangeFrom should be less than RangeUpto","alert-warning",3e3),F.onCustomRangeIndicatorClick(F.custompropRangeIndicator),!1;for(var c=!0,u=a.split(","),i=0;i<u.length-1;i++){var p=u[i].split("~"),m=u[i+1].split("~");parseInt(p[1])!==parseInt(m[0])&&(c=!1)}if(!IsBoolean(c)&&"heat_map_chart"==F.custompropRangeIndicator.dynamicColorRange.componentType)return T.showNotification("Color Range must in continues series for Heat Map.","alert-warning",3e3),F.onCustomRangeIndicatorClick(F.custompropRangeIndicator),!1;var b=DesignerUtil.prototype.getInnerObjectbyString(e,F.custompropRangeIndicator.propertyName);b[F.custompropRangeIndicator.attributes.names]=o,b[F.custompropRangeIndicator.attributes.ranges]=a,b[F.custompropRangeIndicator.attributes.colors]=t,e.Chart.showDynamicRange=F.custompropRangeIndicator.dynamicColorRange.showDynamicRange,e.Chart.minRangeColor=F.custompropRangeIndicator.dynamicColorRange.minRangeColor,e.Chart.maxRangeColor=F.custompropRangeIndicator.dynamicColorRange.maxRangeColor,F.redrawComponent(e),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateRangeIndicatorRangeInMobileView(e,o,a,t)},F.UpdateLevelIndicatorColor=function(){for(var e="",o="",a=F.getComponentbyId(F.modal.selectedComponentId),t=F.custompropLevelIndicator.value,s=0;s<t.length;s++){var n=s<t.length-1?",":"";e+=t[s].color+n,o+=t[s].name+n}var r=DesignerUtil.prototype.getInnerObjectbyString(a,F.custompropLevelIndicator.propertyName);r[F.custompropLevelIndicator.attributes.colors]=e,r[F.custompropLevelIndicator.attributes.names]=o,F.redrawComponent(a)},F.UpdateCustomShapes=function(){var e="",o="",a="",t=F.getComponentbyId(F.modal.selectedComponentId),s=DesignerUtil.prototype.getInnerObjectbyString(t,F.custompropShapeSelector.propertyName);if(s[F.custompropShapeSelector.attributes.indicatorType]=F.custompropShapeSelector.shapeIndicatorType,s[F.custompropShapeSelector.attributes.shapeType]=F.custompropShapeSelector.shapeType,"value"==F.custompropShapeSelector.shapeIndicatorType){for(var n=F.custompropShapeSelector.rangevalue,r=0;r<n.length;r++){var l=r<n.length-1?",":"";o+=n[r].shape+l,e+=n[r].rname+l,a+=n[r].rangeFrom+"~"+n[r].rangeUpTo+l}s[F.custompropShapeSelector.attributes.ranges]=a,s[F.custompropShapeSelector.attributes.rnames]=e,s[F.custompropShapeSelector.attributes.rangeShapes]=o}else if("level"==F.custompropShapeSelector.shapeIndicatorType){for(n=F.custompropShapeSelector.levelvalue,r=0;r<n.length;r++){l=r<n.length-1?",":"";o+=n[r].shape+l,e+=n[r].lname+l}s[F.custompropShapeSelector.attributes.lnames]=e,s[F.custompropShapeSelector.attributes.levelShapes]=o}else{for(n=F.custompropShapeSelector.typevalue,r=0;r<n.length;r++){l=r<n.length-1?",":"";o+=n[r].shape+l,e+=n[r].tname+l}s[F.custompropShapeSelector.attributes.tnames]=e,s[F.custompropShapeSelector.attributes.typeShapes]=o}F.redrawComponent(t)},F.UpdateCustomColors=function(){var e="",o="",a="",t=F.getComponentbyId(F.modal.selectedComponentId),s=DesignerUtil.prototype.getInnerObjectbyString(t,F.custompropColorSelector.propertyName);if(s[F.custompropColorSelector.attributes.indicatorType]=F.custompropColorSelector.colorIndicatorType,"value"==F.custompropColorSelector.colorIndicatorType){for(var n=F.custompropColorSelector.rangevalue,r=0;r<n.length;r++){var l=r<n.length-1?",":"";e+=n[r].color+l,o+=n[r].rname+l,a+=n[r].rangeFrom+"~"+n[r].rangeUpTo+l}s[F.custompropColorSelector.attributes.ranges]=a,s[F.custompropColorSelector.attributes.rnames]=o,s[F.custompropColorSelector.attributes.rangeColors]=e}else if("level"==F.custompropColorSelector.colorIndicatorType){for(n=F.custompropColorSelector.levelvalue,r=0;r<n.length;r++){l=r<n.length-1?",":"";e+=n[r].color+l,o+=n[r].lname+l}s[F.custompropColorSelector.attributes.lnames]=o,s[F.custompropColorSelector.attributes.levelColors]=e}else{for(n=F.custompropColorSelector.typevalue,r=0;r<n.length;r++){l=r<n.length-1?",":"";e+=n[r].color+l,o+=n[r].tname+l}s[F.custompropColorSelector.attributes.tnames]=o,s[F.custompropColorSelector.attributes.typeColors]=e}F.redrawComponent(t)},F.syncUpdateRangeIndicatorRangeInMobileView=function(e,o,a,t){var s,n=F.getComponentFromMobileLayout(e.objectID),n=(n&&((s=DesignerUtil.prototype.getInnerObjectbyString(n,F.custompropRangeIndicator.propertyName))[F.custompropRangeIndicator.attributes.names]=o,s[F.custompropRangeIndicator.attributes.ranges]=a,s[F.custompropRangeIndicator.attributes.colors]=t,n.Chart.showDynamicRange=F.custompropRangeIndicator.dynamicColorRange.showDynamicRange,n.Chart.minRangeColor=F.custompropRangeIndicator.dynamicColorRange.minRangeColor,n.Chart.maxRangeColor=F.custompropRangeIndicator.dynamicColorRange.maxRangeColor),F.getComponentFromTabletLayout(e.objectID));n&&((s=DesignerUtil.prototype.getInnerObjectbyString(n,F.custompropRangeIndicator.propertyName))[F.custompropRangeIndicator.attributes.names]=o,s[F.custompropRangeIndicator.attributes.ranges]=a,s[F.custompropRangeIndicator.attributes.colors]=t,n.Chart.showDynamicRange=F.custompropRangeIndicator.dynamicColorRange.showDynamicRange,n.Chart.minRangeColor=F.custompropRangeIndicator.dynamicColorRange.minRangeColor,n.Chart.maxRangeColor=F.custompropRangeIndicator.dynamicColorRange.maxRangeColor)},F.removeRangeIndicatorRange=function(e){e=F.custompropRangeIndicator.value.indexOf(e);F.custompropRangeIndicator.value.splice(e,1)},F.removeLevelIndicator=function(e){e=F.custompropLevelIndicator.value.indexOf(e);F.custompropLevelIndicator.value.splice(e,1)},F.removeCustomShapeLevel=function(e){var o;"type"==F.custompropShapeSelector.shapeIndicatorType?(o=F.custompropShapeSelector.typevalue.indexOf(e),F.custompropShapeSelector.typevalue.splice(o,1)):"value"==F.custompropShapeSelector.shapeIndicatorType?(o=F.custompropShapeSelector.rangevalue.indexOf(e),F.custompropShapeSelector.rangevalue.splice(o,1)):"level"==F.custompropShapeSelector.shapeIndicatorType&&(o=F.custompropShapeSelector.levelvalue.indexOf(e),F.custompropShapeSelector.levelvalue.splice(o,1))},F.removeCustomColorLevel=function(e){var o;"type"==F.custompropColorSelector.colorIndicatorType?(o=F.custompropColorSelector.typevalue.indexOf(e),F.custompropColorSelector.typevalue.splice(o,1)):"value"==F.custompropColorSelector.colorIndicatorType?(o=F.custompropColorSelector.rangevalue.indexOf(e),F.custompropColorSelector.rangevalue.splice(o,1)):"level"==F.custompropColorSelector.colorIndicatorType&&(o=F.custompropColorSelector.levelvalue.indexOf(e),F.custompropColorSelector.levelvalue.splice(o,1))},F.removeCustomShapeIndicatorRange=function(e){e=F.custompropShapeSelector.rangevalue.indexOf(e);F.custompropShapeSelector.rangevalue.splice(e,1)},F.removeCustomColorIndicatorRange=function(e){e=F.custompropColorSelector.rangevalue.indexOf(e);F.custompropColorSelector.rangevalue.splice(e,1)},F.updateNextRangeIndicatorRange=function(e,o){""!=e&&null!=F.custompropRangeIndicator.value[o+1]&&(F.custompropRangeIndicator.value[o+1].rangeFrom=e)},F.removeAllRangeIndicatorRange=function(){F.custompropRangeIndicator.value=[]},F.removeAllLevelIndicatorRange=function(){F.custompropLevelIndicator.value=[]},F.removeAllCustomShapeSelector=function(){"value"==F.custompropShapeSelector.shapeIndicatorType?F.custompropShapeSelector.rangevalue=[]:"level"==F.custompropShapeSelector.shapeIndicatorType?F.custompropShapeSelector.levelvalue=[]:F.custompropShapeSelector.typevalue=[]},F.removeAllCustomColorSelector=function(){"value"==F.custompropColorSelector.colorIndicatorType?F.custompropColorSelector.rangevalue=[]:"level"==F.custompropColorSelector.colorIndicatorType?F.custompropColorSelector.levelvalue=[]:F.custompropColorSelector.typevalue=[]},F.onCustomBulletRangeClick=function(e){var o=F.getComponentbyId(F.modal.selectedComponentId),a=e.propertyName;if(F.custompropBulletBand=e,F.custompropBulletBand.value=[],""!=o[a].rangedSeriesDisplayNames)for(var t=o[a].rangedSeriesDisplayNames.split(","),s=o[a].rangesOfSeries.split(","),n=o[a].rangedColors.split(","),r=o[a].alphas.split(","),l=0;l<t.length;l++){var i={},d=s[l].split("~");i.name=t[l],i.rangeFrom=d[0],i.rangeUpTo=d[1],i.color=n[l],i.alpha=+r[l],F.custompropBulletBand.value.push(i)}F.showModelPopup("customBulletBandWindow")},F.addBulletBandRange=function(){var e={name:"Range",rangeFrom:0,rangeUpTo:0,color:"#08AEA8",alpha:.5};F.custompropBulletBand.value.push(e)},F.UpdateBulletRange=function(){for(var e=F.getComponentbyId(F.modal.selectedComponentId),o="",a="",t="",s="",n=F.custompropBulletBand.propertyName,r=F.custompropBulletBand.value,l=0;l<r.length;l++){var i=l<r.length-1?",":"";o+=r[l].name+i,a+=r[l].rangeFrom+"~"+r[l].rangeUpTo+i,t+=r[l].color+i,s+=r[l].alpha+i}e[n].rangedSeriesDisplayNames=o,e[n].rangesOfSeries=a,e[n].rangedColors=t,e[n].alphas=s,F.redrawComponent(e),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateBulletRangeInMobileView(e,o,a,t,s)},F.syncUpdateBulletRangeInMobileView=function(e,o,a,t,s){var n=F.custompropBulletBand.propertyName,r=F.getComponentFromMobileLayout(e.objectID),r=(r&&(r[n].rangedSeriesDisplayNames=o,r[n].rangesOfSeries=a,r[n].rangedColors=t,r[n].alphas=s),F.getComponentFromTabletLayout(e.objectID));r&&(r[n].rangedSeriesDisplayNames=o,r[n].rangesOfSeries=a,r[n].rangedColors=t,r[n].alphas=s)},F.removeBulletBandColorRange=function(e){e=F.custompropBulletBand.value.indexOf(e);F.custompropBulletBand.value.splice(e,1)},F.removeAllBulletRange=function(){F.custompropBulletBand.value=[]},F.onCustomTrendRangeClick=function(e){F.customprop=e;e=F.getComponentbyId(F.modal.selectedComponentId)[F.customprop.propertyName][F.customprop.attributeName].split(",");F.customprop.from=+e[0],F.customprop.upTo=+e[1],F.showModelPopup("customTrendRangeWindow")},F.updateTrendRange=function(){var e=F.customprop,o=(""==e.from?"0":e.from)+","+(""==e.upTo?"0":e.upTo),a=F.getComponentbyId(F.modal.selectedComponentId);DesignerUtil.prototype.getInnerObjectbyString(a,e.propertyName)[e.attributeName]=o,F.redrawComponent(a),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateTrendRangeInMobileView(a,e,o)},F.syncUpdateTrendRangeInMobileView=function(e,o,a){var t=F.getComponentFromMobileLayout(e.objectID),t=(t&&(DesignerUtil.prototype.getInnerObjectbyString(t,o.propertyName)[o.attributeName]=a),F.getComponentFromTabletLayout(e.objectID));t&&(DesignerUtil.prototype.getInnerObjectbyString(t,o.propertyName)[o.attributeName]=a)},F.onCustomGaugeIndicatorClick=function(e){F.custompropGaugeIndicator=e,F.custompropGaugeIndicator.value=[];var o=F.getComponentbyId(F.modal.selectedComponentId);if(""!=o[e.propertyName].colors)for(var a=o[e.propertyName].colors.split(","),t=o[e.propertyName].ratios.split(","),s=o[e.propertyName].alphas.split(","),n=0;n<a.length;n++){var r={};r.color=a[n],r.ratio=+t[n],r.alpha=+s[n],F.custompropGaugeIndicator.value.push(r)}F.showModelPopup("customGaugeAlertWindow"),-1==navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||F.initSpectrumColorPicker("input[type='color']")},F.addGaugeIndicator=function(){var e={ratio:0,alpha:1,color:"#08AEA8"};F.custompropGaugeIndicator.value.push(e),C(function(){-1==navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||F.initSpectrumColorPicker("input[type='color']")},.01)},F.updateGaugeIndicator=function(){for(var e="",o="",a="",t=F.custompropGaugeIndicator.value,s=0;s<t.length;s++){var n=s<t.length-1?",":"";e+=t[s].ratio+n,o+=t[s].color+n,a+=t[s].alpha+n}var r=F.getComponentbyId(F.modal.selectedComponentId),l=DesignerUtil.prototype.getInnerObjectbyString(r,F.custompropGaugeIndicator.propertyName);l.ratios=e,l.colors=o,l.alphas=a,F.redrawComponent(r),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncUpdateGaugeIndicatorInMobileView(r,e,o,a)},F.syncUpdateGaugeIndicatorInMobileView=function(e,o,a,t){var s,n=F.getComponentFromMobileLayout(e.objectID),n=(n&&((s=DesignerUtil.prototype.getInnerObjectbyString(n,F.custompropGaugeIndicator.propertyName)).ratios=o,s.colors=a,s.alphas=t),F.getComponentFromTabletLayout(e.objectID));n&&((s=DesignerUtil.prototype.getInnerObjectbyString(n,F.custompropGaugeIndicator.propertyName)).ratios=o,s.colors=a,s.alphas=t)},F.removeGaugeIndicator=function(e){e=F.custompropGaugeIndicator.value.indexOf(e);F.custompropGaugeIndicator.value.splice(e,1)},F.removeAllGaugeIndicator=function(){F.custompropGaugeIndicator.value=[]},F.onCustomImageBrowseClick=function(e){var o=F.getComponentbyId(F.modal.selectedComponentId);F.inputMode=o[o.subElement].imageSourceType,F.custompropImageComp=e,F.inputModeBase64=!0,F.customInputImageName=o[o.subElement].imageSourceName,F.oldImage=F.customInputImageName,"URL"==F.inputMode&&(F.inputModeBase64=!1,F.customInputImageURL=e.value),F.showModelPopup("customImageBrowseWindow")},F.HandleImageBrowseClick=function(){$("#customImageBrowse").click()},F.customImageBrowseSelection=function(e,o){e?F.inputMode="base64":(null!=o&&0<o.length?F.custompropImageComp.value=o:T.showNotification("Enter a valid URL","alert-warning",3e3),F.inputMode="URL");e=F.getComponentbyId(F.modal.selectedComponentId);e[e.subElement].imageSourceName=F.customInputImageName,e[e.subElement].imageSourceType=F.inputMode,F.redrawComponent(e),F.onPropertyChange(F.custompropImageComp),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&F.syncCustomImageBrowseSelectionInMobileView(e)},F.syncCustomImageBrowseSelectionInMobileView=function(e){var o=F.getComponentFromMobileLayout(e.objectID),o=(o&&(o[o.subElement].imageSourceName=F.customInputImageName,o[o.subElement].imageSourceType=F.inputMode),F.getComponentFromTabletLayout(e.objectID));o&&(o[o.subElement].imageSourceName=F.customInputImageName,o[o.subElement].imageSourceType=F.inputMode)},F.getImageSourceType=function(e){return{label:"type : ",type:"text",value:e,attributeName:"imageSourceType",propertyName:"Image"}},F.loadImageFile=function(e){var o=e.fileData;null!=o&&(-1<o.substring(0,23).indexOf("jpeg")?o=o.split("data:image/jpeg;base64,")[1]:-1<o.substring(0,23).indexOf("png")&&(o=o.split("data:image/png;base64,")[1])),F.customInputImageName=e.fileName,F.custompropImageComp.value=o},F.onPropertyChange=function(e){var o,a;"absoluteLayout"==e.propertyName?F.updateDashboardLayoutProperty(e):"Dashboard"==e.propertyName?F.updateDashboardProperty(e):(F.updateObjectWithPropertyValue(e),(o=F.getComponentbyId(F.modal.selectedComponentId))?(IsBoolean(o.showLocked)&&-1<["x","y","width","height"].indexOf(e.attributeName)?T.showNotification(o.objectName+" is locked","alert-info",3e3):"x"!=e.attributeName&&"y"!=e.attributeName?(a={},a={X:o.x,Y:o.y},IsBoolean(F.modal.userPreference.defaultSettings.enableMultipleDrag)&&IsBoolean(F.multiSelected)&&(o.x=$("#dcc_"+F.modal.selectedComponentId)[0].offsetLeft,o.y=$("#dcc_"+F.modal.selectedComponentId)[0].offsetTop),F.redrawComponent(o),IsBoolean(F.multiSelected)&&IsBoolean(F.modal.userPreference.defaultSettings.enableMultipleDrag)&&(o.x=a.X,o.y=a.Y)):IsBoolean(F.modal.userPreference.defaultSettings.enableMultipleDrag)&&IsBoolean(F.multiSelected)||$("#dcc_"+F.modal.selectedComponentId).css("x"==e.attributeName?"left":"top",e.value+"px"),DesignerUtil.prototype.findInArray(F.componentsList,"objectID",o.objectID).objectName=o.objectName):T.showNotification("Component is not selected","alert-danger",3e3),"objectName"==e.attributeName&&F.syncObjectNameInObjectBrowser(e.value),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&-1==["x","y","width","height"].indexOf(e.attributeName)&&(F.syncComponentPropertyInMobileView("compProperty",o,e),F.syncComponentPropertyInTabletView("compProperty",o,e))),F.modal.updateDashboardStatus(1)},F.onLockPropertyDisable=function(e){var o,a=0;return a=void 0!==F.modal.selectedDashboard&&""!==F.modal.selectedDashboard&&void 0!==(o=F.getComponentbyId(F.modal.selectedComponentId))&&IsBoolean(o.showLocked)&&-1<["x","y","width","height"].indexOf(e.attributeName)?1:a},F.syncObjectNameInObjectBrowser=function(e){var o,a;o=F.modal.componentListInObjectBrowser,a=F.getSelectedComponents()[0],$.grep(o,function(e,o){return e.objectID==a})[0].objectName=e},F.syncComponentPropertyInMobileView=function(e,o,a){try{var t=F.getComponentFromMobileLayout(o.objectID);if(t)switch(e){case"compProperty":F.updateMVObjectWithDVPropertyValue(t,a);break;case"compFieldProperty":var s=t[t.subElement].DataSet;F.syncMobileViewCompFieldProperty(s,a);break;case"dataLabelProperty":F.updateCustomDataLabelPropertiesJsonForMobileView(t,a);break;case"indicatorProperty":break;case"alertProperty":F.syncComponentAlertProperty(t,a)}}catch(e){}},F.syncComponentPropertyInTabletView=function(e,o,a){try{var t=F.getComponentFromTabletLayout(o.objectID);if(t)switch(e){case"compProperty":F.updateMVObjectWithDVPropertyValue(t,a);break;case"compFieldProperty":var s=t[t.subElement].DataSet;F.syncMobileViewCompFieldProperty(s,a);break;case"dataLabelProperty":F.updateCustomDataLabelPropertiesJsonForMobileView(t,a);break;case"indicatorProperty":break;case"alertProperty":F.syncComponentAlertProperty(t,a)}}catch(e){}},F.updateMVObjectWithDVPropertyValue=function(e,o){var a;e&&("Object"==o.propertyName?e[o.attributeName]=o.value:"object"==typeof o.value?"gradient"==o.type?(a=o.value.gColor_1+","+o.value.gColor_1,DesignerUtil.prototype.getInnerObjectbyString(e,o.propertyName)[o.attributeName]=a):"date"==o.type||"customTextBoxForToolTip"==o.type?DesignerUtil.prototype.getInnerObjectbyString(e,o.propertyName)[o.attributeName]=o.value:DesignerUtil.prototype.getInnerObjectbyString(e,o.propertyName)[o.attributeName]=o.value.key:DesignerUtil.prototype.getInnerObjectbyString(e,o.propertyName)[o.attributeName]=o.value)},F.syncMobileViewCompFieldProperty=function(e,o){if(e)for(var a=e.Fields,t=0;t<a.length;t++)a[t][F.datasetDesignProperties[F.component.designData.class].name]===F.selectedField.name&&a[t].Type===F.selectedField.fieldJson.Type&&("object"==typeof o.value&&null!==o.value?a[t][o.attributeName]=o.value.key:(a[t][o.attributeName]=o.value,"Category"==F.selectedField.fieldJson.Type&&"Color"==o.attributeName&&F.updateDefaultCategoryColorIndicator(o.value)))},F.syncComponentScriptingandGroupingProperty=function(e){var o=angular.copy(DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,"objectID",e.objectID));e.objectID==o.objectID&&(e.groupings=o.groupings,e.variable=o.variable)},F.updateCustomDataLabelPropertiesJsonForMobileView=function(e,o){for(var a=0;a<e[e.subElement].DataSet.Fields.length;a++)IsBoolean(e[e.subElement].DataSet.Fields[a].Name==F.selectedField.name)&&(e[e.subElement].DataSet.Fields[a].DataLabelCustomProperties=F.selectedField.fieldJson.DataLabelCustomProperties)},F.syncComponentAlertProperty=function(e,o){void 0===e[e.subElement].Alerts.AlertColumn&&(e[e.subElement].Alerts.AlertColumn=[]);for(var a=e[e.subElement].Alerts.AlertColumn,t=!1,s=0;s<a.length;s++)if(a[s].name===F.alertJson.name){IsBoolean(F.alertJson.showAlert)?e[e.subElement].Alerts.AlertColumn.splice(s,1,F.alertJson):e[e.subElement].Alerts.AlertColumn.splice(s,1),t=!0;break}!IsBoolean(t)&&IsBoolean(F.alertJson.showAlert)&&e[e.subElement].Alerts.AlertColumn.push(F.alertJson)},F.updateDashboardLayoutProperty=function(e){var o,a=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType];"resolution"==e.attributeName&&("Auto"!=e.value.value?(o=e.value.key.split("x"),a.width=o[0],a.height=o[1]):(a.width=$(".rw-container").get(0).clientWidth-10,a.height=$(".rw-container").get(0).clientHeight-10)),"designerTheme"===e.attributeName&&(F.themeProp=e,F.newDesignerTheme=e.value.key,F.showModelPopup("changeThemeDialog")),a[e.attributeName]="object"==typeof e.value?e.value.key:e.value,F.setDashboardCSS(F.modal.userPreference)},F.updateThemeDesigner=function(){F.hideModelPopup("changeThemeDialog"),F.applyDesignerTheme(F.newDesignerTheme)},F.resetThemeDesigner=function(){var e=F.selectedTheme[F.getActiveDashboardId()];F.newDesignerTheme=e;for(var o=0;o<F.themeProp.options.length;o++)e==F.themeProp.options[o].key&&(F.themeProp.value=F.themeProp.options[o])},F.updateDashboardProperty=function(e){var o,a=F.modal.selectedDashboard.json.Dashboard;"LanguageMapping.mappingId"==e.attributeName?(F.modal.selectedDashboard.json.Dashboard.LanguageMapping.mappingId=e.mappingId,F.modal.selectedDashboard.json.Dashboard.LanguageMapping.mappingName=e.mappingName):-1<e.attributeName.indexOf("LanguageMapping.")?(o=e.attributeName.split(".")[1],F.modal.selectedDashboard.json.Dashboard.LanguageMapping[o]=e.value):a[e.attributeName]="object"==typeof e.value?e.value.key:e.value},F.addSettingBtns=function(e,o,a){var t=0;F.addPropertySettingBtn(e,t),t+=25,null!=o&&0!=o&&"false"!=o&&(F.addDatasetSettingBtn(e,t),t+=25),t+=25,IsBoolean(a)&&F.addFnBtn(e,t),F.addRemoveBtn(e,t)},F.addDblClickEvent=function(a){$("#draggableDiv"+a).on("dblclick",function(e){var o=global.componetIDPrefix+e.currentTarget.id.split(global.componetIDPrefix)[1];F.isSelectedComponent(a)?e.stopPropagation():F.selectComponent(a),DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,"objectID",a).showLocked||F.executeAction(o,"openPropWindow")})},F.addPropertySettingBtn=function(e,o){var a='<div class="comp-settings-btn" id="propCtrlDiv'+e+'"><img id="propCtrlBtn'+e+'" src="./resources/images/svg/Properties.svg" title="Properties" /></div>';$("#cbc_"+e).append(a),$("#propCtrlDiv"+e).css({top:o+"px",display:"block"}).on("click",function(e){var o=global.componetIDPrefix+e.target.id.split(global.componetIDPrefix)[1];F.isSelectedComponent(o)?e.stopPropagation():F.selectComponent(o),F.executeAction(o,"openPropWindow"),"date_picker"==F.getComponentbyId(o).componentType&&F.initializeDatePickerCalendarProperty()}).on("dblclick",function(e){e.stopPropagation()})},F.addDatasetSettingBtn=function(e,o){var a='<div class="comp-settings-btn" id="dataCtrlDiv'+e+'"><img id="dataCtrlBtn'+e+'" src="./resources/images/svg/data_settings.svg" title="Dataset"/></div>';$("#cbc_"+e).append(a),$("#dataCtrlDiv"+e).css({top:o+"px",display:"block"}).on("click",function(e){var o=global.componetIDPrefix+e.target.id.split(global.componetIDPrefix)[1];F.isSelectedComponent(o)?e.stopPropagation():F.selectComponent(o),F.executeAction(o,"openDatasetWindow")}).on("dblclick",function(e){e.stopPropagation()})},F.addFnBtn=function(e,o){var a='<div class="comp-settings-btn" id="fnDiv'+e+'"><img id="fnBtn'+e+'" src="./resources/images/svg/f_x.svg" title="Script on Load"/></div>';$("#cbc_"+e).append(a),$("#fnDiv"+e).css({top:o+"px",display:"block"}).on("click",function(e){var o=global.componetIDPrefix+e.target.id.split(global.componetIDPrefix)[1];F.isSelectedComponent(o)?e.stopPropagation():F.selectComponent(o),F.executeAction(o,"openFnWindow")}).on("dblclick",function(e){e.stopPropagation()})},F.addRemoveBtn=function(e,o){var a='<div class="comp-settings-btn" id="compRemoveDiv'+e+'"><img id="compRemoveBtn'+e+'" src="./resources/images/svg/Close.svg" title="Remove"/></div>';$("#cbc_"+e).append(a),$("#compRemoveDiv"+e).css({top:o+"px",display:"block"}).on("click",function(e){var o=global.componetIDPrefix+e.target.id.split(global.componetIDPrefix)[1];F.isSelectedComponent(o)?e.stopPropagation():F.selectComponent(o),1!=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,"objectID",o).showLocked&&F.executeAction(o,"removeComponent")}).on("dblclick",function(e){e.stopPropagation()})},F.addtempBtn=function(e,o){var a='<div class="comp-settings-btn" id="tempDiv'+e+'"><img id="tempBtn'+e+'" src="./resources/images/svg/showAll.svg" title="Script -on-change"/></div>';$("#cbc_"+e).append(a),$("#tempDiv"+e).css({width:"20px",height:"20px",top:o+"px",left:"100%",border:"1px solid #816666",cursor:"pointer",display:"none"}).on("click",function(e){F.alignVerticalLeft()}).on("dblclick",function(e){e.stopPropagation()})},F.executeAction=function(e,o){switch(o){case"openPropWindow":F.createPropertyPalette(e),F.rcc=e;break;case"openDatasetWindow":F.toggleDatasetPalette(e),F.invokeDatasetpaletteUpdation(e),F.rcc=e;break;case"removeComponent":F.modal.selectedComponentId&&F.doYouWantToDelete();break;case"openFnWindow":var a=F.getComponentbyId(e);F.toggleVariableWindow("0"),F.setSelectedVariable(null,a,"Component"),F.rcc=e;break;case"duplicateComponent":F.duplicateComponent(e)}},F.addDesignerComponentContainer=function(o,e,a,t,s,n){for(var r=void 0!==n?n:F.getMaxZindex(),l=$("#"+F.modal.selectedDashboard.id),i=null,d=$("#dcc_"+o),c=$("<div></div>"),u=$("<div></div>");F.isAssignedZindex(r);)r++;return d.length&&null==n&&(r=d.zIndex()),u.attr("id","cbc_"+o).addClass("cbc"),c.attr("id","dcc_"+o).addClass("bizvizComponent").css({left:F.isSelectedDashboardResponsive()?"0":e+"px",top:F.isSelectedDashboardResponsive()?"0":a+"px",height:F.isSelectedDashboardResponsive()?"100%":+t+4+"px",width:F.isSelectedDashboardResponsive()?"100%":+s+4+"px"}).on("click",function(e){e.stopPropagation(),$(".c-group").removeClass("selected-group"),$("#designerCxtMenuContainer .dropdown-menu").hide(),F.handleComponentSelection(o,e.ctrlKey||e.metaKey),IsBoolean(F.isBoxVisible)&&(F.executeAction(o,"openPropWindow"),"date_picker"==F.getComponentbyId(o).componentType)&&F.initializeDatePickerCalendarProperty()}).append(u),F.isSelectedDashboardResponsive()?(i=$("#"+F.chartContainerId),F.cSpaceMap[F.chartContainerId]=!1,c.css("position","relative")):(i=l,n=F.createResizableHandles(),c.css("z-index",r).append(n)),d.length&&d.remove(),i.append(c),c},F.updateComponentContainerSizeAndCoordinates=function(e,o,a,t,s){$("#dcc_"+e).css({left:o+"px",top:a+"px",height:+t+2*F.modal.userPreference.compSelcOpts.thickness+"px",width:+s+2*F.modal.userPreference.compSelcOpts.thickness+"px"})},F.showSettingsBtn=function(e){"AbsoluteLayout"==F.modal.layoutType&&$("#dcc_"+e+" #cbc_"+e).css({display:"block"})},F.hideSettingsBtn=function(e){$("#dcc_"+e+" #cbc_"+e).css({display:"none"})},F.showResizableHandles=function(e){$("#dcc_"+e+" .ui-resizable-handle").css({display:"block"})},F.hideResizableHandles=function(e){$("#dcc_"+e+" .ui-resizable-handle").css({display:"none"})},F.initializeDatePickerCalendarProperty=function(){$(".datePickerInProperty").each(function(){$(this).datepicker({changeMonth:!0,changeYear:!0})})},F.createResizableHandles=function(){return $('<div class="wrh ui-resizable-handle corner-handle ui-resizable-nw nw-handle"></div><div class="wrh ui-resizable-handle ui-resizable-ne corner-handle ne-handle"></div><div class="wrh ui-resizable-handle ui-resizable-sw corner-handle sw-handle"></div><div class="wrh ui-resizable-handle ui-resizable-se corner-handle se-handle"></div><div class="wrh ui-resizable-handle ui-resizable-n n-handle"></div><div class="wrh ui-resizable-handle ui-resizable-s s-handle"></div><div class="wrh ui-resizable-handle ui-resizable-e e-handle"></div><div class="wrh ui-resizable-handle ui-resizable-w w-handle"></div>').on("click",function(e){e.stopPropagation()}).css("border-color",F.modal.userPreference.compSelcOpts.color)},F.drawComponent=function(e,o){null!=e.Properties.Object.themeType&&"default-theme"!==e.Properties.Object.themeType&&(a=F.designerThemeInfo[e.Properties.Object.themeType].datasetColors,void 0!==e.Fields)&&e.Fields.forEach(function(e,o){void 0!==e.Color&&void 0!==a&&void 0!==a[o]&&(e.Color=a[o])});var a,t,s=F.getActiveDashboardId(),s=$("#"+s),n=e.Properties,r=e.Data,l=e.Fields,i=n.Object,d=i.objectName,c=i.isDataSetAvailable,u=i.enableScript,p=F.modal.rawComponentJSONlist,m=F.modal.userPreference.compSelcOpts.thickness,b=i.shortName,h=F.dropCoordinates,g=s.parent().parent().offset().left,s=s.parent().parent().offset().top,f=i.height,D=i.width,C=null,y=null,v=null,S=null,I=null,w=null;try{if(F.cSpaceMap[F.chartContainerId])return T.showNotification("Can not add more than one component in a container","alert-danger",3e3),!1;p[o]||(p[o]=JSON.parse(JSON.stringify(e))),I=F.modal.currentHistoryProperties().skipHistoryRegister?(C=e.Properties.Object.objectID,y=e.Properties.Object.referenceID,S=h.x,h.y):(C=F.modal.getUniqueComponentID(),y=F.modal.getUniqueReference(b),S=h.x-g,h.y-s),t=F.addDesignerComponentContainer(C,S,I,f,D),(v=ReflectUtil.newInstance(o,t,"inherit")).m_designMode=!0,i.objectID=C,i.referenceID=y,i.objectName=y,i.showLocked=!1,i.unShowHidden=!1,F.isSelectedDashboardResponsive()&&(i.parent=F.chartContainerId,i.bootstrap=!0,w=i.bootstrap),i.x=0,i.y=0,v.setProperty(n),i.x=S,i.y=I,r&&l&&(v.setDataProvider(r),v.setFields(l)),IsBoolean(F.isDuplicate)&&"default-theme"===i.themeType&&(F.updatedJson=void 0===F.updatedJson?{}:F.updatedJson,F.updatedJson[i.objectID]=getDuplicateObject(i)),v.draw(),F.addSettingBtns(C,c,u),F.addDblClickEvent(C),w?F.cSpaceMap[F.chartContainerId]=!0:(F.initDragComponent(v),F.initResizeComponent(v)),i.x-=m,i.y-=m,IsBoolean(i.showLocked)&&F.lockComponent(!1,{lockComponent:!0,objectID:C}),IsBoolean(i.unShowHidden)&&F.hideComponent(!1,{hideComponent:!0,objectID:C}),F.AddComponentJsonToDashboardJson(e),d=e.Properties.Object.objectName,F.AddInComponentObjectList(C,v),F.modal.selectedComponentId=C,F.handleComponentSelection(C,!1,!1,!0),T.showNotification(d+" has been added","alert-info",3e3)}catch(e){}},F.reDrawActiveDashboard=function(){var e,o=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object;try{for(var a=0;a<o.length;a++)e=o[a],F.redrawComponent(e)}catch(e){}},F.redrawComponent=function(e,o){var a,t,s=e.objectID,n=e.x,r=e.y,l=e.height,i=e.width,d=null,c=null,u=null;try{a=(d=F.getComponentbyId(s)).componentType,t=F.modal.propertyJsonList[a].Info[0].class,void 0!==(u=F.getRawJSONbyClass(t)).Fields&&(u.Fields=F.modal.selectedDashboard.componentObjectList[e.objectID].m_fieldsJson),(c=F.getComponentObjectFromComponentObjectList(s)).m_designMode=!0,c.m_objectid=s,d.x=0,d.y=0,c.setIsResizedInDesigner(d.width!=c.m_width||d.height!=c.m_height),c.ParseJsonAttributes(d,c),d.x=n,d.y=r,u.Data&&u.Fields&&(c.setDataProvider(u.Data),c.setFields(u.Fields)),F.modal.currentHistoryProperties().skipHistoryRegister||"AbsoluteLayout"!=F.modal.layoutType||F.registerInHistory("change",d),F.isSelectedDashboardResponsive()?c.initializeForBootstrap():F.updateComponentContainerSizeAndCoordinates(s,n,r,l,i),c.setDraggableDivSize(),c.setDraggableDivShadow(),c.setDraggableCanvasSize(),c.reSetCanvasCoordinates(),c.draw(),IsBoolean(e.showLocked)&&F.lockComponent(!1,{lockComponent:!0,objectID:s},!0),IsBoolean(e.unShowHidden)&&F.hideComponent(!1,{hideComponent:!0,objectID:s},!0)}catch(e){}},F.updateObjectWithPropertyValue=function(e){F.updatedJson=void 0===F.updatedJson?{}:F.updatedJson;var o,a=F.getComponentbyId(F.modal.selectedComponentId);if(a)if("Object"==e.propertyName)a[e.attributeName]=e.value;else{if("object"==typeof e.value)if("gradient"==e.type){var t=e.value.gColor_1+","+e.value.gColor_1;DesignerUtil.prototype.getInnerObjectbyString(a,e.propertyName)[e.attributeName]=t}else if("date"==e.type||"customTextBoxForToolTip"==e.type)DesignerUtil.prototype.getInnerObjectbyString(a,e.propertyName)[e.attributeName]=e.value;else try{DesignerUtil.prototype.getInnerObjectbyString(a,e.propertyName)[e.attributeName]=e.value.key}catch(e){}else DesignerUtil.prototype.getInnerObjectbyString(a,e.propertyName)[e.attributeName]=e.value;"default-theme"===a.themeType?F.updatedJson[a.objectID]=getDuplicateObject(a):(t="default-theme"!==a.themeType?"./resources/bizvizchart-themes/"+a.themeType+"/themeConfig.data":"./resources/bizvizchart-themes/"+a.themeType+"/"+a.designData.type+"/"+a.designData.class+".data",t=F.getHttpCachedData(t),void 0===F.updatedJson[a.objectID]&&null!=(o=F.getHttpCachedData("./resources/bizvizchart-themes/default-theme/AllComponentsData.data"))&&(F.updatedJson[a.objectID]=JSON.parse(o[1])[a.designData.class][a.designData.class].Properties.Object),t&&200==t[0]&&(o="default-theme"!==a.themeType?JSON.parse(t[1]).DashboardObjects:JSON.parse(t[1]),t=F.configureJson(getDuplicateObject(F.updatedJson[a.objectID]),getDuplicateObject(a),o[a.designData.class].Properties.Object,e),F.updatedJson[a.objectID]=t))}},F.configureJson=function(e,o,a,t){var s=t.propertyName.split(".");return 1==s.length?a[s[0]].hasOwnProperty(t.attributeName)||(e[s[0]][t.attributeName]=o[s[0]][t.attributeName]):e[s[0]][s[1]][t.attributeName]=o[s[0]][s[1]][t.attributeName],e},F.getRawJSONbyClass=function(e){return F.modal.rawComponentJSONlist[e]},F.getComponentbyId=function(e){return DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,"objectID",e)},F.getComponentbyReferenceId=function(e){return DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,"referenceID",e)},F.getComponentFromMobileLayout=function(e){if(F.modal.selectedDashboard.json.Dashboard.MobileLayout)return DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard.MobileLayout.Object,"objectID",e)},F.getComponentFromTabletLayout=function(e){if(F.modal.selectedDashboard.json.Dashboard.TabletLayout)return DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard.TabletLayout.Object,"objectID",e)},F.getDashboardByTimeStampId=function(e){return DesignerUtil.prototype.findInArray(F.modal.dashboards,"id",e).json.Dashboard},F.removeComponentbyId=function(e){var o=F.getComponentbyId(e),a=$("#dcc_"+e),t=a.parent().attr("id"),s=null,n=!1,r=!1,l=F.modal.selectedDashboard.json.Dashboard.MobileLayout?.Object||[];if(l&&0<l.length)for(var i=0;i<l.length;i++)(b=l[i])&&"object"==typeof b&&b.objectID==e&&(n=l[i].isPined);var d=F.modal.selectedDashboard.json.Dashboard.TabletLayout?.Object||[];if(d&&0<d.length)for(i=0;i<d.length;i++)(m=d[i])&&"object"==typeof m&&m.objectID==e&&(r=d[i].isPined);if(IsBoolean(n)||IsBoolean(r))return"pinned";for(i=0;i<F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length;i++)if((s=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object[i])&&"object"==typeof s&&s.objectID==e){if(s.hasOwnProperty("groupings"))for(var c=s.groupings.split(","),u=0;u<c.length;u++)F.removeComponentFromDashboardGroup(e,c[u]);F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.splice(i,1),F.populateGvarDefaultValueList(),T.showNotification(o.objectName+" has been deleted","alert-info",3e3),0;break}var p=F.modal.selectedDashboard.json.Dashboard.TabletLayout;if(p&&0<p.Object.length)for(var m,i=0;i<F.modal.selectedDashboard.json.Dashboard.TabletLayout.Object.length;i++)if((m=F.modal.selectedDashboard.json.Dashboard.TabletLayout.Object[i])&&"object"==typeof m&&m.objectID==e){F.modal.selectedDashboard.json.Dashboard.TabletLayout.Object.splice(i,1),0;break}p=F.modal.selectedDashboard.json.Dashboard.MobileLayout;if(p&&0<p.Object.length)for(var b,i=0;i<F.modal.selectedDashboard.json.Dashboard.MobileLayout.Object.length;i++)if((b=F.modal.selectedDashboard.json.Dashboard.MobileLayout.Object[i])&&"object"==typeof b&&b.objectID==e){F.modal.selectedDashboard.json.Dashboard.MobileLayout.Object.splice(i,1),0;break}a.remove(),F.deselectComponent(e),F.modal.notifyObjectListChange(),F.cSpaceMap[t]=!1},F.$watch("modal.userPreference.compSelcOpts.color",function(e,o){$(".bizvizComponent").css("border-color",e),$(".wrh").css("border-color",e)}),F.handleComponentSelection=function(e,o,a,t){a&&a.stopPropagation(),o?F.isSelectedComponent(e)?(F.deselectComponent(e),F.multiSelected&&(F.removeMultiSelectedWrapDiv(),F.multiSelectDragConfiguration())):F.selectComponent(e):F.isSelectedComponent(e)?1<F.modal.listOfSelectedComponents.length&&(F.deselectAllComponent(),F.selectComponent(e)):(F.deselectAllComponent(),F.selectComponent(e,t))},F.deselectAllComponent=function(){for(var e=F.modal.listOfSelectedComponents,o=0,a=e.length;o<a;o++)F.deselectComponent(e[0])},F.hideSettingsBtnFromAllSelectedComponentsExceptLastOne=function(){for(var e=F.modal.listOfSelectedComponents,o=0,a=e.length;o<a;o++)F.hideSettingsBtn(e[o])},F.selectComponent=function(e,o){var a,t=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,"objectID",e),s=t.showLocked,t=t.unShowHidden;if(window.cxtMenuEnabled=!0,IsBoolean(t)&&!o)return T.showNotification("Component is hidden","alert-info",3e3),!1;F.modal.selectedComponentId=e,F.modal.selectedComponentContainer="#"+F.modal.selectedDashboard.id,F.addToSelectedComponentList(e),C(function(){F.hideSettingsBtnFromAllSelectedComponentsExceptLastOne(),F.displayAsSelected(e),IsBoolean(s)||F.showResizableHandles(e),IsBoolean(F.modal.userPreference.defaultSettings.showSettingsButton)&&!IsBoolean(s)&&F.showSettingsBtn(e)},0),F.modal.isDatasetEnabled=IsBoolean(F.getComponentbyId(e).isDataSetAvailable),F.modal.isScriptEnabled=IsBoolean(F.getComponentbyId(e).enableScript),$(".comp-appearance-icon").popover("hide"),$(".bizVizControlBoxBody .popover").remove(),void 0===o||o||F.$apply(),IsBoolean(F.modal.userPreference.defaultSettings.enableMultipleDrag)&&(F.multiSelected?F.multiSelectDragConfiguration():null!=(t=$("#dcc_"+F.modal.listOfSelectedComponents[0]))[0]&&null!=t[0].parentNode&&-1!==(o=t[0].parentNode.id).indexOf("WrapDivForMultiSelect")&&(o=$("#"+o),a=$("#"+o[0].parentNode.id),t[0].childNodes[0].draggable("option","disabled",!1),t[0].childNodes[0].css({"background-image":"none",opacity:"1.0"}),a.append(t[0].childNodes[0]),o.remove()))},F.multiSelectDragConfiguration=function(e){if(F.modal.userPreference.defaultSettings.enableMultipleDrag){e=void 0!==e&&e;$("#dcc_"+F.modal.listOfSelectedComponents[0]),F.modal.listOfSelectedComponents.length;var o,a=[],t=[],s=[],n=[],r=[],l=[],i=(o=F.deleteFromObjectBrowserUpdate(F.modal.listOfSelectedComponents,e)).length;if(void 0!==(e=$("#dcc_"+o[0]))[0]){var d,e=e[0].parentNode.id;if(-1==e.indexOf("WrapDivForMultiSelect")?((d=$("<div></div>")).attr("id","WrapDivForMultiSelect"+e),$("#"+e).append(d)):d=$("#"+e),void 0!==d&&void 0!==d[0].childNodes&&d[0].childNodes.length!==i){for(var c=0;c<i;c++){var u=o[c],p=$("#dcc_"+u),m="",b="",h="",g="",f=F.getComponentbyId(u);void 0===f||IsBoolean(f.showLocked)||(p.draggable("option","disabled",!0),t.push(+f.x+ +f.width),a.push(+f.y+ +f.height),n.push(+f.y),s.push(+f.x),m=a.reduce(function(e,o){return Math.max(e,o)}),b=t.reduce(function(e,o){return Math.max(e,o)}),h=n.reduce(function(e,o){return Math.min(e,o)}),g=s.reduce(function(e,o){return Math.min(e,o)}),p.css({"background-image":"none",opacity:"0.9"}),l.push(f),r.push(p),d.append(p))}$(d).css({left:g+"px",top:h+"px",height:m-h+"px",width:b-g+"px","z-index":"auto"});for(var D=0;D<r.length;D++)r[D].css({top:l[D].y-h+"px",left:l[D].x-g+"px"});F.wrapdivstarty=h,F.wrapdivstartx=g}e={grid:[F.modal.bgGridSize,F.modal.bgGridSize],containment:"parent",stop:function(e,o){var a,t=F.modal.listOfSelectedComponents.length,s=$("#"+e.target.parentElement.id),n=$(this).parent().offset(),r=e.pageX-n.left,n=e.pageY-n.top,l=+F.origionalPositionWrapDivForMultiSelect.pageX-F.wrapdivstartx,i=+F.origionalPositionWrapDivForMultiSelect.pageY-F.wrapdivstarty,d=s[0].offsetWidth,s=s[0].offsetHeight,c=void 0!==F.modal.layoutType&&"AbsoluteLayout"!==F.modal.layoutType?n<i?i-+F.origionalPositionWrapDivForMultiSelect.pageY:o.position.top-o.originalPosition.top:n<i?i-+F.origionalPositionWrapDivForMultiSelect.pageY:n-i+e.target.offsetHeight>s?s+i-(+F.origionalPositionWrapDivForMultiSelect.pageY+e.target.offsetHeight):n-+F.origionalPositionWrapDivForMultiSelect.pageY,u=r<l?l-+F.origionalPositionWrapDivForMultiSelect.pageX:r-l+e.target.offsetWidth>d?d+l-(+F.origionalPositionWrapDivForMultiSelect.pageX+e.target.offsetWidth):r-+F.origionalPositionWrapDivForMultiSelect.pageX,o=0<c?1:-1,s=0<u?1:-1,i=Math.abs(c),n=Math.abs(u);c=Math.abs(i-F.wrapdivstarty)>F.modal.bgGridSize?i-i%F.modal.bgGridSize:i>F.modal.bgGridSize?i-F.modal.bgGridSize:0,c*=o,u=Math.abs(n-F.wrapdivstartx)>F.modal.bgGridSize?n-n%F.modal.bgGridSize:n>F.modal.bgGridSize?n-F.modal.bgGridSize:0,u*=s;for(var p=0;p<t;p++){var m=F.modal.listOfSelectedComponents[p],b=F.getComponentbyId(F.modal.listOfSelectedComponents[p]);void 0!==b&&(b.x=0<=+b.x+u?+b.x+u:+b.x,a=b.y,b.y=0<+b.y+c?+b.y+c:-1*(+b.y+c),b.y=c<0&&+a<-1*c?-1*b.y:+b.y,b.y=0<=b.y?b.y:+a,$(e.target).css("cursor","auto"),void 0===f||void 0===f.showLocked||IsBoolean(f.showLocked)||(F.updatePosition(m,b.y,b.x),F.initPropertyPalette(m)))}F.deselectAllComponent(),F.modal.updateDashboardStatus(1)},start:function(e,o){var a=$(this).parent().offset();F.origionalPositionWrapDivForMultiSelect={pageX:e.pageX-a.left,pageY:e.pageY-a.top}}};d.draggable(e),d.unbind("click").click(function(o){var a;o.ctrlKey?(a=[],C(function(){var e;a=$(document.elementsFromPoint(o.clientX,o.clientY)),F.removeMultiSelectedWrapDiv(),void 0!==a[3]&&void 0!==a[3].id&&-1!==a[3].id.indexOf("dcc_")&&-1===F.modal.listOfSelectedComponents.indexOf(a[3].id)?(e=a[3].id.split("dcc_")[1],F.selectComponent(e)):(F.deselectAllComponent(),$(".c-group").removeClass("selected-group"))},0)):(F.deselectAllComponent(),$(".c-group").removeClass("selected-group"))})}}},F.deleteFromObjectBrowserUpdate=function(e,o){var a=[],t="";if(IsBoolean(o))for(var t=e.length-1,s=0;s<t;s++)void 0!==(component=F.getComponentbyId(e[s]))&&e[s]!==e[t]&&a.push(e[s]);else{t=e.length;for(var n=0;n<t;n++)void 0===(component=F.getComponentbyId(e[n]))||IsBoolean(component.showLocked)||a.push(e[n])}return a},F.deselectComponent=function(e,o){var a,t,s,n;F.modal.userPreference.defaultSettings.enableMultipleDrag&&(o=void 0!==o&&o,null!=(a=$("#dcc_"+e))[0]&&null!=a[0].parentNode&&-1!==(t=a[0].parentNode.id).indexOf("WrapDivForMultiSelect")&&(t=$("#"+t),s=F.getComponentbyId(e),n=$("#"+t[0].parentNode.id),void 0!==s&&(IsBoolean(s.showLocked)?a.draggable("option","disabled",!0):a.draggable("option","disabled",!1),a.css({left:+s.x,top:+s.y,"background-image":"none",opacity:"1.0"})),n.append(a),0===t[0].childNodes.length)&&t.remove(),o)||(F.removeFromSelectedComponentList(e),C(function(){F.displayAsDeSelected(e),F.hideResizableHandles(e),F.hideSettingsBtn(e)},0))},F.addToSelectedComponentList=function(e){-1==F.modal.listOfSelectedComponents.indexOf(e)&&F.modal.listOfSelectedComponents.push(e),1<F.modal.listOfSelectedComponents.length&&(F.multiSelected=!0)},F.removeFromSelectedComponentList=function(e){e=F.modal.listOfSelectedComponents.indexOf(e);F.modal.listOfSelectedComponents.splice(e,1),F.multiSelected=1<F.modal.listOfSelectedComponents.length},F.displayAsSelected=function(e){var o=$("#dcc_"+e),a=$("#draggableDiv"+e),t=F.modal.userPreference.compSelcOpts.thickness,s=F.modal.userPreference.compSelcOpts.color,n=t+"px dashed "+s;o.length&&(o.css("border",t+"px solid "+s),F.isSelectedDashboardResponsive()||o.css({height:+a.height()+2*t,width:+a.width()+2*t,left:+o.css("left").split("px")[0]-t+"px",top:+o.css("top").split("px")[0]-t+"px"}),1<F.modal.listOfSelectedComponents.length)&&(e=F.modal.listOfSelectedComponents[0],$("#dcc_"+e).css({border:n}))},F.displayAsDeSelected=function(e){var o=$("#dcc_"+e),e=$("#draggableDiv"+e),a=F.modal.userPreference.compSelcOpts.thickness;o.length&&(o.css("border","none"),F.isSelectedDashboardResponsive()||o.css({height:+e.height()-2*a,width:+e.width()-2*a,left:+o.css("left").split("px")[0]+a+"px",top:+o.css("top").split("px")[0]+a+"px"}))},F.isSelectedComponent=function(e){var o=!1;return o=-1!==F.modal.listOfSelectedComponents.indexOf(e)?!0:o};F.initDragComponent=function(e){var s=$("#dcc_"+e.m_objectid),n=$("#cbc_"+e.m_objectid),e={grid:[F.modal.bgGridSize,F.modal.bgGridSize],containment:"parent",ghost:!0,cancel:!1,stop:function(e,o){var a=this.style.top.split("px")[0],t=this.style.left.split("px")[0],s=global.componetIDPrefix+e.target.id.split(global.componetIDPrefix)[1],a=a>F.modal.bgGridSize?a-a%F.modal.bgGridSize:F.modal.bgGridSize,t=t>F.modal.bgGridSize?t-t%F.modal.bgGridSize:F.modal.bgGridSize;$(e.target).css({left:t+"px",top:a+"px",opacity:1,cursor:"auto"}),F.updatePosition(s,a,t),F.initPropertyPalette(s),F.modal.updateDashboardStatus(1)},drag:function(e,o){var a,t=$("#"+e.target.id),e=$("#"+e.target.parentElement.id);t.css({opacity:.9,cursor:"move"}),F.prePos.top==o.position.top&&F.prePos.left==o.position.left?(t.offset().left+t.width()>e.width()?(a=n.width()+5,n.css("left","calc( 0% - "+a+"px )")):n.css("left","100%"),t.offset().top+t.height()>e.height()&&n.outerHeight()>=s.outerHeight()?n.css("top","-"+n.height()+"px"):n.css("top","0%")):n.css({left:"100%",top:"0px"}),F.prePos=o.position}};s.draggable(e)},F.updatePosition=function(e,o,a){e=F.getComponentbyId(e);e.x=a,e.y=o,"AbsoluteLayout"==F.modal.layoutType&&F.registerInHistory("change",e)},F.updateDimention=function(e,o,a){e=F.getComponentbyId(e);e.height=o,e.width=a,"AbsoluteLayout"==F.modal.layoutType&&F.registerInHistory("change",e)},F.initResizeComponent=function(n){var e={grid:F.modal.bgGridSize,handles:{nw:".nw-handle",ne:".ne-handle",sw:".sw-handle",se:".se-handle",n:".n-handle",e:".e-handle",s:".s-handle",w:".w-handle"},delay:100,distance:5};$("#dcc_"+n.m_objectid).resizable(e),$("#dcc_"+n.m_objectid).on("resizestart",function(e,o){$(this).css({opacity:.9})}),$("#dcc_"+n.m_objectid).on("resizestop",function(e,o){var a,t,e=global.componetIDPrefix+e.target.id.split(global.componetIDPrefix)[1],s=F.getComponentbyId(e),o=(-1==$.inArray(e,F.modal.listOfSelectedComponents)&&F.modal.listOfSelectedComponents.push(targerComponentId),s.x=o.position.left,s.y=o.position.top,1===F.modal.bgGridSize?(t=$(this).width(),a=$(this).height()):(e=1!==F.modal.bgGridSize?+s[s.subElement].borderThickness:0,t=$(this).width()+2*e,t-=t%F.modal.bgGridSize,a=$(this).height()+2*e,a-=a%F.modal.bgGridSize),$(this).css({opacity:1,width:t+"px",height:a+"px"}),s.width=t,s.height=a,!1);IsBoolean(F.multiSelected)&&IsBoolean(F.modal.userPreference.defaultSettings.enableMultipleDrag)&&(s.y=s.y+F.wrapdivstarty,s.x=s.x+F.wrapdivstartx,F.deselectComponent(s.objectID),o=!0),F.redrawComponent(s),o&&F.selectComponent(s.objectID),F.initPropertyPalette(n.m_objectid),F.modal.updateDashboardStatus(1)}),F.isSelectedComponent(n.m_objectid)||F.hideResizableHandles(n.m_objectid)},F.modal.componentObjectList={},F.AddInComponentObjectList=function(e,o){F.modal.selectedDashboard.componentObjectList[e]=o},F.getComponentObjectFromComponentObjectList=function(e){return F.modal.selectedDashboard.componentObjectList[e]},F.AddComponentJsonToDashboardJson=function(e){F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.push(e.Properties.Object)},F.createPropertyPalette=function(e,o){F.toggleDashboardPropertyPalette(e),F.initPropertyPalette(e,o),C(function(){applyPropertyWindowColorScheme(T.AUTH_INFO.get("preferenceObject")),-1==navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||F.initSpectrumColorPicker("input[type='color']")},100)},F.getNewVariableJson=function(e){return angular.copy(F.modal.selectedDashboard.json.GlobalVariable_Variable,e)},F.getDashboardJson=function(){T.getJsonFileData("./resources/data/dashboard.data",function(e){return e})},F.alignHorizontalLeft=function(){F.removeMultiSelectedWrapDiv();var a=$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().left,e=$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().top,t={attributeName:"x",propertyName:"Object",type:"Number",value:4},s={attributeName:"y",propertyName:"Object",type:"Number",value:e};$.each(F.modal.listOfSelectedComponents,function(e,o){F.modal.selectedComponentId=o,F.updateObjectWithPropertyValue(t),F.updateObjectWithPropertyValue(s),a+=$("#dcc_"+F.modal.listOfSelectedComponents[e]).width(),t.value=a;o=F.getComponentbyId(F.modal.selectedComponentId);IsBoolean(o.showLocked)||F.redrawComponent(o)}),F.multiSelectDragConfiguration(),T.showNotification("Horizontally Aligned","alert-info",3e3)},F.alignVerticalLeft=function(){F.removeMultiSelectedWrapDiv();var a=$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().top,t={attributeName:"x",propertyName:"Object",type:"Number",value:4},s={attributeName:"y",propertyName:"Object",type:"Number",value:a};$.each(F.modal.listOfSelectedComponents,function(e,o){F.modal.selectedComponentId=o,F.updateObjectWithPropertyValue(t),F.updateObjectWithPropertyValue(s),a+=$("#dcc_"+F.modal.listOfSelectedComponents[e]).height(),s.value=a;o=F.getComponentbyId(F.modal.selectedComponentId);IsBoolean(o.showLocked)||F.redrawComponent(o)}),F.multiSelectDragConfiguration(),T.showNotification("Vertically Aligned","alert-info",3e3)},F.equalHorizontal=function(){F.removeMultiSelectedWrapDiv();for(var e,o,a=$("#dcc_"+F.modal.listOfSelectedComponents[0]),t=$("#dcc_"+F.modal.listOfSelectedComponents[1]).position().left-(a.position().left+a.width()),s=0;s<F.modal.listOfSelectedComponents.length;s++)1<s&&(o=$("#dcc_"+F.modal.listOfSelectedComponents[s]),e={attributeName:"x",propertyName:"Object",type:"Number",value:(e=$("#dcc_"+F.modal.listOfSelectedComponents[s-1])).position().left+e.width()+t},F.modal.selectedComponentId=F.modal.listOfSelectedComponents[s],F.updateObjectWithPropertyValue(e),e=F.getComponentbyId(F.modal.selectedComponentId),IsBoolean(e.showLocked)||F.redrawComponent(e),e=$("#"+F.modal.selectedDashboard.id),(o=o.position().left+o.width())>e.width())&&e.css("width",o);F.multiSelectDragConfiguration(),T.showNotification("Equal Space Horizontally","alert-info",3e3)},F.equalVertical=function(){F.removeMultiSelectedWrapDiv();for(var e,o,a=$("#dcc_"+F.modal.listOfSelectedComponents[0]),t=$("#dcc_"+F.modal.listOfSelectedComponents[1]),s="AbsoluteLayout"!==F.modal.layoutType?t[0].offsetTop-(a[0].offsetTop+a.height()):t.position().top-(a.position().top+a.height()),n=0;n<F.modal.listOfSelectedComponents.length;n++)1<n&&(o=$("#dcc_"+F.modal.listOfSelectedComponents[n]),e=$("#dcc_"+F.modal.listOfSelectedComponents[n-1]),e={attributeName:"y",propertyName:"Object",type:"Number",value:"AbsoluteLayout"!==F.modal.layoutType?e[0].offsetTop+e.height()+s:e.position().top+e.height()+s},F.modal.selectedComponentId=F.modal.listOfSelectedComponents[n],F.updateObjectWithPropertyValue(e),e=F.getComponentbyId(F.modal.selectedComponentId),IsBoolean(0==e.showLocked)&&F.redrawComponent(e),e=$("#"+F.modal.selectedDashboard.id),(o="AbsoluteLayout"!==F.modal.layoutType?o[0].offsetTop+o.height():o.position().top+o.height())>e.height())&&e.css("height",o);F.multiSelectDragConfiguration(),T.showNotification("Equal Space Vetically","alert-info",3e3)},F.alignLeft=function(){F.removeMultiSelectedWrapDiv();var a={attributeName:"x",propertyName:"Object",type:"Number",value:$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().left};$.each(F.modal.listOfSelectedComponents,function(e,o){F.modal.selectedComponentId=o,F.updateObjectWithPropertyValue(a);o=F.getComponentbyId(F.modal.selectedComponentId);IsBoolean(o.showLocked)||F.redrawComponent(o)}),F.multiSelectDragConfiguration(),T.showNotification("Left Aligned","alert-info",3e3)},F.alignRight=function(){F.removeMultiSelectedWrapDiv();var e=$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().left,a=e+$("#dcc_"+F.modal.listOfSelectedComponents[0]).width(),t={attributeName:"x",propertyName:"Object",type:"Number",value:e};$.each(F.modal.listOfSelectedComponents,function(e,o){F.modal.selectedComponentId=o,t.value=a-$("#dcc_"+F.modal.listOfSelectedComponents[e]).width(),F.updateObjectWithPropertyValue(t);o=F.getComponentbyId(F.modal.selectedComponentId);IsBoolean(o.showLocked)||F.redrawComponent(o)}),F.multiSelectDragConfiguration(),T.showNotification("Right Aligned","alert-info",3e3)},F.alignTop=function(){F.removeMultiSelectedWrapDiv();var a={attributeName:"y",propertyName:"Object",type:"Number",value:"AbsoluteLayout"!==F.modal.layoutType?$("#dcc_"+F.modal.listOfSelectedComponents[0])[0].offsetTop:$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().top};$.each(F.modal.listOfSelectedComponents,function(e,o){0<e&&(F.modal.selectedComponentId=o,F.updateObjectWithPropertyValue(a),e=F.getComponentbyId(F.modal.selectedComponentId),IsBoolean(e.showLocked)||F.redrawComponent(e))}),F.multiSelectDragConfiguration(),T.showNotification("Top Aligned","alert-info",3e3)},F.duplicateComponents=function(e){for(var o=[],a=[],t=0;t<e.length;t++){o[t]=[];var s=F.getComponentbyId(e[t]),n=s.designData,r=$("#"+F.getActiveDashboardId()).parent().parent().offset(),l=parseInt(s.x)+30,i=(l=(l-=l%F.modal.bgGridSize)<10+r.left?30+r.left:l,parseInt(s.y)+30),l={event:{pageX:l,pageY:i=(i-=i%F.modal.bgGridSize)<10+r.top?30+r.top:i},duplicating:!0};o[t].push(n,l,s)}for(t=0;t<o.length;t++)F.onDropComplete(o[t][0],o[t][1],o[t][2]),a.push(F.modal.selectedComponentId);for(t=0;t<a.length;t++)F.selectComponent(a[t])},F.alignBottom=function(){F.removeMultiSelectedWrapDiv();var e,a=(e="AbsoluteLayout"!==F.modal.layoutType?$("#dcc_"+F.modal.listOfSelectedComponents[0])[0].offsetTop:$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().top)+$("#dcc_"+F.modal.listOfSelectedComponents[0]).height(),t={attributeName:"y",propertyName:"Object",type:"Number",value:e};$.each(F.modal.listOfSelectedComponents,function(e,o){0<e&&(F.modal.selectedComponentId=o,t.value=a-$("#dcc_"+F.modal.listOfSelectedComponents[e]).height(),F.updateObjectWithPropertyValue(t),o=F.getComponentbyId(F.modal.selectedComponentId),IsBoolean(o.showLocked)||F.redrawComponent(o))}),F.multiSelectDragConfiguration(),T.showNotification("Bottom Aligned","alert-info",3e3)},F.alignHorizontal=function(){F.removeMultiSelectedWrapDiv();var e=$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().top,a=e+(e+$("#dcc_"+F.modal.listOfSelectedComponents[0]).height()-e)/2,t={attributeName:"y",propertyName:"Object",type:"Number",value:e};$.each(F.modal.listOfSelectedComponents,function(e,o){0<e&&(F.modal.selectedComponentId=o,t.value=a-$("#dcc_"+F.modal.listOfSelectedComponents[e]).height()/2,F.updateObjectWithPropertyValue(t),o=F.getComponentbyId(F.modal.selectedComponentId),IsBoolean(o.showLocked)||F.redrawComponent(o))}),F.multiSelectDragConfiguration()},F.alignVertical=function(){F.removeMultiSelectedWrapDiv();var e=$("#dcc_"+F.modal.listOfSelectedComponents[0]).position().left,a=e+(e+$("#dcc_"+F.modal.listOfSelectedComponents[0]).width()-e)/2,t={attributeName:"x",propertyName:"Object",type:"Number",value:e};$.each(F.modal.listOfSelectedComponents,function(e,o){0<e&&(F.modal.selectedComponentId=o,t.value=a-$("#dcc_"+F.modal.listOfSelectedComponents[e]).width()/2,F.updateObjectWithPropertyValue(t),o=F.getComponentbyId(F.modal.selectedComponentId),IsBoolean(o.showLocked)||F.redrawComponent(o))}),F.multiSelectDragConfiguration()},F.equalWidth=function(){F.removeMultiSelectedWrapDiv();var a={attributeName:"width",propertyName:"Object",type:"Number",value:F.getComponentbyId(F.modal.listOfSelectedComponents[0]).width};$.each(F.modal.listOfSelectedComponents,function(e,o){0<e&&(F.modal.selectedComponentId=o,F.updateObjectWithPropertyValue(a),e=F.getComponentbyId(F.modal.selectedComponentId),IsBoolean(e.showLocked)||F.redrawComponent(e))}),F.multiSelectDragConfiguration(),T.showNotification("Equal Width","alert-info",3e3)},F.equalHeight=function(){F.removeMultiSelectedWrapDiv();var a={attributeName:"height",propertyName:"Object",type:"Number",value:F.getComponentbyId(F.modal.listOfSelectedComponents[0]).height};$.each(F.modal.listOfSelectedComponents,function(e,o){0<e&&(F.modal.selectedComponentId=o,F.updateObjectWithPropertyValue(a),e=F.getComponentbyId(F.modal.selectedComponentId),IsBoolean(e.showLocked)||F.redrawComponent(e))}),F.multiSelectDragConfiguration(),T.showNotification("Equal Height","alert-info",3e3)},F.removeMultiSelectedWrapDiv=function(){if(F.modal.userPreference.defaultSettings.enableMultipleDrag)for(var e=F.modal.listOfSelectedComponents,o=0,a=e.length;o<a;o++)F.deselectComponent(e[o],!0)},F.deleteAll=function(){var e,o=!1,a=F.modal.listOfSelectedComponents,t=$("#dcc_"+a[0]);null!=t[0]&&null!=t[0].parentNode&&(e=t[0].parentNode.id);for(var s=a.length-1;0<=s;s--){var n=F.getComponentbyId(a[0]);"AbsoluteLayout"==F.modal.layoutType&&F.registerInHistory("delete",n),"pinned"===F.removeComponentbyId(a[s])&&(o=!0)}IsBoolean(o)&&T.showNotification("Cannot remove: component(s) are pinned on mobile/tablet.","alert-danger",3e3),IsBoolean(F.modal.userPreference.defaultSettings.enableMultipleDrag)&&void 0!==e&&-1!==e.indexOf("WrapDivForMultiSelect")&&$("#"+e).remove()},F.selectAllComponents=function(){var e=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object;if(0<e.length&&e.length!=F.modal.listOfSelectedComponents.length){for(var o=0;o<e.length;o++){var a=e[o].objectID;IsBoolean(e[o].unShowHidden)||F.isSelectedComponent(a)||F.selectComponent(a)}T.showNotification("All components are selected","alert-info",3e3)}return e},F.historyCounter=0,F.registerInHistory=function(e,o){F.historyCounter++;var a=F.modal.currentHistoryProperties();if(a){if(a.historyActiveStack.length>a.historyLength&&(a.historyStack.shift(),a.historyActiveStack.shift(),a.historyStackPointer--),0<a.historyActiveStack.length&&a.skipHistoryRegister)a.skipHistoryRegister=!1;else{a.historyStackPointer!=a.historyStack.length-1&&a.historyStack.splice(a.historyStackPointer+1,a.historyStack.length);var t,s=angular.copy({action:e,object:o,executionID:F.historyCounter});switch(s.action){case"add":(t={})[(s=angular.copy({action:"change",object:o})).object.objectID]=new Array,t[s.object.objectID].push(s),a.compHistory.push(t),a.historyStack.push(s),a.historyActiveStack.push(s),a.historyStackPointer++;break;case"oldComp":(t={})[(s=angular.copy({action:"oldComp",object:o})).object.objectID]=new Array,t[s.object.objectID].push(s),a.compHistory.push(t),a.historyStack.push(s),a.historyActiveStack.push(s),a.historyStackPointer++;break;case"change":for(var n=0;n<a.compHistory.length;n++)if(Object.keys(a.compHistory[n])[0]===s.object.objectID){a.compHistory[n][s.object.objectID].push(angular.copy(s));break}a.historyStack.push(s),a.historyActiveStack.push(s),a.historyStackPointer++;break;case"groupAction":break;case"delete":for(n=0;n<a.compHistory.length;n++)if(Object.keys(a.compHistory[n])[0]===s.object.objectID){a.compHistory[n][s.object.objectID].push(angular.copy(s));break}a.historyStack.push(s),a.historyActiveStack.push(s),a.historyStackPointer++}}F.modal.currentHistoryProperties(a)}},F.executeHistory=function(e){switch(e.action){case"change":F.replaceComponentInJson(e.object),F.redrawComponent(e.object);break;case"groupAction":angular.forEach(e.object,function(e,o){e&&(F.replaceComponentInJson(e.object),F.redrawComponent(e.object))});break;case"add":case"delete":break;case"oldComp":F.replaceComponentInJson(e.object),F.redrawComponent(e.object)}},F.replaceComponentInJson=function(e){var a;e&&(a=angular.copy(e),angular.forEach(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,function(e,o){e.objectID==a.objectID&&(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object[o]=a)}))},F.copyProperties=function(e){var o,a=e.subElement;for(o in jsonObject=getDuplicateObject(F.modal.copyJson))if("General"==o)for(var t in jsonObject[o])switch(t){case"Title":for(var s in jsonObject[o][t])void 0!==e[a]&&void 0!==e[a][t]&&(jsonObject[o][t][s]=e[a][t][s]);break;case"SubTitle":for(var n in jsonObject[o][t])void 0!==e[a]&&void 0!==e[a][t]&&(jsonObject[o][t][n]=e[a][t][n]);break;default:void 0!==e[a]&&void 0!==e[a][t]&&(jsonObject[o][t]=e[a][t])}else if("Chart"==o)for(var t in jsonObject[o])switch(t){case"xAxis":for(var r in jsonObject[o][t])void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t][r]=e[o][t][r]);break;case"yAxis":for(var l in jsonObject[o][t])void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t][l]=e[o][t][l]);break;default:void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t]=e[o][t])}else if("Funnel"==o)for(var i in jsonObject[o])if("legends"===i)for(var d in jsonObject[o][i])void 0!==e[o]&&void 0!==e[o][i]&&(jsonObject[o][i][d]=e[o][i][d]);else void 0!==e[o]&&void 0!==e[o][i]&&(jsonObject[o][i]=e[o][i]);else if("DataGrid"==o)for(var t in jsonObject[o])switch(t){case"LinkButton":for(var c in jsonObject[o][t])void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t][c]=e[o][t][c]);break;case"Column":for(var u in jsonObject[o][t])void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t][u]=e[o][t][u]);break;case"DatagridStyles":for(var p in jsonObject[o][t])void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t][p]=e[o][t][p]);break;case"RowData":for(var m in jsonObject[o][t])void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t][m]=e[o][t][m]);break;case"LinkBar":for(var b in jsonObject[o][t])void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t][b]=e[o][t][b]);break;default:void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t]=e[o][t])}else if("Scorecard"==o)for(var t in jsonObject[o])switch(t){case"SummaryRows":case"value":break;default:void 0!==e[o]&&void 0!==e[o][t]&&(jsonObject[o][t]=e[o][t])}else jsonObject[o]=e[o];F.modal.copiedProperties=jsonObject},F.pasteProperties=function(e){var o,a,t,s=getDuplicateObject(F.modal.copiedProperties);for(o in s)if(e.hasOwnProperty(o)||"General"==o)if(dupkey="General"==o?e.subElement:o,"object"==typeof s[o]){for(var n in s[o])if(s[o].hasOwnProperty(n))if("object"!=(a=typeof s[o][n])||"Scorecard"!=dupkey||"Title"!=n&&"DatagridStyles"!=n)if("object"==a)for(var r in s[o][n])s[o][n].hasOwnProperty(r)&&""!==s[o][n][r]&&void 0!==e[dupkey][n]&&void 0!==e[dupkey][n][r]&&(e[dupkey][n][r]=s[o][n][r]);else""!==s[o][n]&&void 0!==e[dupkey][n]&&(e[dupkey][n]=s[o][n]);else for(var r in s[o][n])s[o][n].hasOwnProperty(r)&&""!==s[o][n][r]&&(t=r.toLocaleLowerCase(),"selectionColor"==r&&(e[dupkey].selectedrowcolor=s[o][n][r]),null!=e[dupkey][t]?e[dupkey][t]=s[o][n][r]:void 0!==e[dupkey][r]&&(e[dupkey][r]=s[o][n][r]))}else""!==s[o]&&void 0!==e[dupkey]&&(e[dupkey]=s[o]);F.redrawComponent(e)},F.duplicateComponent=function(e){var e=F.getComponentbyId(e),o=e.designData,a=$("#"+F.getActiveDashboardId()).parent().parent().offset(),t=parseInt(e.x)+30,s=(t=(t-=t%F.modal.bgGridSize)<10+a.left?30+a.left:t,parseInt(e.y)+30),t={event:{pageX:t,pageY:s=(s-=s%F.modal.bgGridSize)<10+a.top?30+a.top:s},duplicating:!0};F.onDropComplete(o,t,e)},F.sendToBack=function(e){var o,e=e||F.modal.selectedComponentId;1!=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.length&&(o=F.getBackComponentId(e),F.swapCompIndexes(e,o),F.swapZindexes(e,o),F.modal.notifyObjectListChange())},F.bringToFront=function(e){var o,e=e||F.modal.selectedComponentId;+$("#dcc_"+e)[0].style.zIndex!=F.getMaxZindexOriginal()&&(o=F.getFrontComponentId(e),F.swapCompIndexes(e,o),F.swapZindexes(e,o),F.modal.notifyObjectListChange())},F.sendBackward=function(){for(var e=F.modal.selectedComponentId,o=+$("#dcc_"+e)[0].style.zIndex,a=F.getMinZindex();a<o;)F.sendToBack(),o=+$("#dcc_"+e)[0].style.zIndex},F.bringForward=function(){for(var e=F.modal.selectedComponentId,o=+$("#dcc_"+e)[0].style.zIndex,a=F.getMaxZindexOriginal();o<a;)F.bringToFront(),o=+$("#dcc_"+e)[0].style.zIndex},F.swapCompIndexes=function(e,o){var a,t,e=F.getComponentIndex(e),o=F.getComponentIndex(o),s=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object;null!=e&&null!=o&&null!=s&&"object"==typeof s&&(a=s[e],t=s[o],s[e]=t,s[o]=a)},F.swapZindexes=function(e,o){var a=$("#dcc_"+e)[0].style.zIndex,t=void 0===o?void 0:$("#dcc_"+o)[0].style.zIndex;a&&t&&($("#dcc_"+e).css("zIndex",t),$("#dcc_"+o).css("zIndex",a))},F.getComponentIndex=function(e){var o=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object;if(o&&"object"==typeof o)for(var a=0;a<o.length;a++){var t=o[a];if(t&&t.objectID==e)return a}return null},F.getBackComponentId=function(e){for(var o=F.modal.selectedDashboard.id,a=+$("#"+o+" #dcc_"+e)[0].style.zIndex-1;!F.isAssignedZindex(a)&&-1<a;)a--;for(var t=$("#"+o+" .bizvizComponent"),s=0;s<t.length;s++)if(+t[s].style.zIndex==a)return t[s].id.split("dcc_")[1]},F.isAssignedZindex=function(e){for(var o=F.modal.selectedDashboard.id,a=$("#"+o+" .bizvizComponent"),t=0;t<a.length;t++)if(e==+a[t].style.zIndex)return!0;return!1},F.getMinZindex=function(){for(var e=F.modal.selectedDashboard.id,o=$("#"+e+" .bizvizComponent"),a=0!=o.length?+o[0].style.zIndex:0,t=1;t<o.length;t++){var s=+o[t].style.zIndex;s<a&&(a=s)}return a},F.getMaxZindex=function(){for(var e=F.modal.selectedDashboard.id,o=$("#"+e+" .bizvizComponent"),a=0!=o.length?+o[o.length-1].style.zIndex+1:0,t=1;t<o.length;t++){var s=+o[t].style.zIndex;a<s&&(a=s)}return a},F.getMaxZindexOriginal=function(){for(var e=F.modal.selectedDashboard.id,o=$("#"+e+" .bizvizComponent"),a=0!=o.length?+o[o.length-1].style.zIndex:0,t=0;t<o.length;t++){var s=+o[t].style.zIndex;a<s&&(a=s)}return a},F.getFrontComponentId=function(e){for(var o=F.modal.selectedDashboard.id,a=1+ +$("#"+o+" #dcc_"+e)[0].style.zIndex;!F.isAssignedZindex(a);)a++;for(var t=$("#"+o+" .bizvizComponent"),s=0;s<t.length;s++)if(+t[s].style.zIndex==a)return t[s].id.split("dcc_")[1]},F.getForwardComponentId=function(){for(var e=F.modal.selectedDashboard.id,o=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length,a=$("#"+e+" .bizvizComponent"),t=0;t<a.length;t++)if(+a[t].style.zIndex==o)return a[t].id.split("dcc_")[1]},F.getBackwardComponentId=function(){for(var e=F.modal.selectedDashboard.id,o=$("#"+e+" .bizvizComponent"),a=F.getMinZindex(),t=0;t<o.length;t++)if(+o[t].style.zIndex==a)return o[t].id.split("dcc_")[1]},F.selectedGroup="",F.newGroup=null,F.fromExistingGroup=!1,F.getDashboardGroups=function(){return F.modal.selectedDashboard.json.Dashboard.componentGroups},F.getGroupByGroupName=function(e){for(var o=F.getDashboardGroups(),a=0;a<o.length;a++)if(o[a].gName===e)return o[a];return null},F.resetGroupManagement=function(){F.selectedGroup="",F.newGroup="",F.fromExistingGroup=!1},F.getSelectedComponents=function(){return F.modal.listOfSelectedComponents},F.getSelectedGroup=function(){return F.selectedGroup},F.isNewDashboardGroup=function(e){for(var o=!0,a=F.getDashboardGroups(),t=0;t<a.length;t++)if(a[t].gName===e){o=!1;break}return o},F.addToDashboardGroups=function(e){F.isNewDashboardGroup(e.gName)?(F.getDashboardGroups().push(e),F.newGroup="",C(function(){F.selectGroup(null,e.gName),F.$apply()},10)):T.showNotification("Group name is already exist","alert-warning",3e3)},F.createNewDashboardGroup=function(e){e=e.replace(/\s/g,"");if(""==e)return T.showNotification("Group name can not be empty","alert-danger",3e3),!1;for(var o,a=e.split(","),t=0;t<a.length;t++)o={gName:a[t],aCompIds:[]},F.addToDashboardGroups(o)},F.manageGroupingInComponent=function(e,o,a){var t=e.groupings,s=t?t.replace(/\s/g,"").split(","):[],n="",r=-1;if(a&&"ADD"===a){if(o&&"string"==typeof o){if(-1!=o.indexOf(","))return F.manageGroupingInComponent(e,o.split(","),"ADD");T.isArrayContains(s,o)||s.push(o)}else if(o&&T.isArray(o))for(var l=0;l<o.length;l++)T.isArrayContains(s,o[l])||s.push(o[l]);F.newGroup=""}else if(a&&"REMOVE"===a)if(o&&"string"==typeof o)r=s.indexOf(o),s.splice(r,1);else if(o&&T.isArray(o))for(var i=0;i<o.length;i++)r=s.indexOf(o[i]),s.splice(r,1);for(var d=0;d<s.length;d++)n+=s[d]+",";return n=n.substring(0,n.length-1)},F.addSelectedComponentToSelectedGroup=function(){for(var e,o=F.getSelectedComponents(),a=F.getGroupByGroupName(F.selectedGroup).aCompIds,t=0;t<o.length;t++)T.isArrayContains(a,o[t])||((e=F.getComponentbyId(o[t])).groupings=F.manageGroupingInComponent(e,F.selectedGroup,"ADD"),a.push(o[t]))},F.removeComponentFromDashboardGroup=function(e,o){var a,t,s,n,r,l;try{(l=F.getGroupByGroupName(o))&&-1!=(r=(n=l.aCompIds).indexOf(e))&&((a=F.getComponentbyId(e)).groupings=F.manageGroupingInComponent(a,o,"REMOVE"),(t=F.getComponentFromMobileLayout(e))&&(t.groupings=F.manageGroupingInComponent(t,o,"REMOVE")),(s=F.getComponentFromTabletLayout(e))&&(s.groupings=F.manageGroupingInComponent(s,o,"REMOVE")),n.splice(r,1))}catch(e){}},F.removeGroup=function(e,o){var a;e.stopPropagation();try{if(a=F.getDashboardGroups(),o.aCompIds.length)for(var t=0;t<o.aCompIds.length;t++)F.removeComponentFromDashboardGroup(o.aCompIds[t],o.gName);a.splice(a.indexOf(o),1),0==a.length&&(F.fromExistingGroup=!1)}catch(e){}},F.selectGroup=function(e,o){var a=null,e=(a=e?$(e.currentTarget):$("#"+o)).hasClass("c-active-group");$(".c-group").removeClass("c-active-group"),$(".a-comps").hide(),e?(a.removeClass("c-active-group"),a.parent().find(".a-comps").hide(),F.selectedGroup="",F.fromExistingGroup=!1):(a.addClass("c-active-group"),a.parent().find(".a-comps").show(),F.selectedGroup=o,F.fromExistingGroup=!0)},F.showAddToGroupDialog=function(){F.newGroup="",F.showModelPopup("addGroupDialog")},F.applyGlobalProperty=function(e){var o=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,a=0<o.length,t=null,e=(void 0===F.updatedJson&&(F.updatedJson={}),Object.assign(e,F.globalPropertyMapping.options));if(F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType]=F.propertyUpdate(e,F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType]),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&(F.selectedGlobalProperty[F.getActiveDashboardId()].MobileLayout=F.propertyUpdate(e,F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType]),F.selectedGlobalProperty[F.getActiveDashboardId()].TabletLayout=F.propertyUpdate(e,F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType]),F.modal.selectedDashboard.json.Dashboard.MobileLayout.globalProperties=F.selectedGlobalProperty[F.getActiveDashboardId()].MobileLayout,F.modal.selectedDashboard.json.Dashboard.TabletLayout.globalProperties=F.selectedGlobalProperty[F.getActiveDashboardId()].TabletLayout),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].globalProperties=F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType],a)for(var s=0;s<o.length;s++){void 0===(t=o[s]).newdrag?F.updatedJson[t.objectID]=getDuplicateObject(t):delete t.newdrag;var n=F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType];F.onGetGloalPropertyJsonDataOfComponent(n,t)}},F.getActiveDashboardId=function(){return F.modal.selectedDashboard.id},F.getThemeJson=function(a,t,s){var e=F.selectedTheme[F.getActiveDashboardId()],e="default-theme"!==e?"./resources/bizvizchart-themes/"+e+"/themeConfig.data":"./resources/bizvizchart-themes/"+e+"/"+a.designData.type+"/"+a.designData.class+".data";T.getJsonFileData(e,function(e){s&&s(e,t)},t||null,function(e,o){404===e&&(T.showNotification(F.selectedTheme[F.getActiveDashboardId()]+" configuration not found. Rendering from default-theme","alert-info",3e3),T.getJsonFileData("./resources/bizvizchart-themes/default-theme/"+a.designData.type+"/"+a.designData.class+".data",function(e){s&&s(e,t)},t||null,function(e,o){}))})},F.getThemeJsonOnImport=function(a,t,s){var e="./resources/bizvizchart-themes/default-theme/"+a.designData.type+"/"+a.designData.class+".data";T.getJsonFileData(e,function(e){s&&s(e,t)},t||null,function(e,o){404===e&&(T.showNotification(F.selectedTheme[F.getActiveDashboardId()]+" configuration not found. Rendering from default-theme","alert-info",3e3),T.getJsonFileData("./resources/bizvizchart-themes/default-theme/"+a.designData.type+"/"+a.designData.class+".data",function(e){s&&s(e,t)},t||null,function(e,o){}))})},F.getDatasetColorsFromTheme=function(e){return F.designerThemeInfo[e].datasetColors||[]},F.applyDesignerTheme=function(l){var i=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,d=0<i.length,c=null;if(void 0===F.updatedJson&&(F.updatedJson={}),void 0===F.themesOnLoad&&(F.themesOnLoad=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.designerTheme),void 0!==F.globalPropertyMapping){for(var e=Object.keys(F.globalPropertyMapping.options),o=0;o<e.length;o++)F.selectedGlobalProperty[F.getActiveDashboardId()][F.modal.layoutType][e[o]]=!1,F.globalPropertyMapping.options[e[o]]=!1;F.applyGlobalProperty(F.globalPropertyMapping.properties)}F.selectedTheme[F.getActiveDashboardId()]=l,F.loadDesignerThemeInfo(l,function(){var e,o="default-theme"!==(s=F.selectedTheme[F.getActiveDashboardId()])?"./resources/bizvizchart-themes/"+s+"/themeConfig.data":"",a="default-theme"!==s?F.getHttpCachedData(o):"";if(e="default-theme"!==s&&a&&200==a[0]?JSON.parse(a[1]).dashboardTheme.Dashboard.backgroundColor:"#FFFFFF",F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].gradients=e,F.modal.selectedDashboard.json.Dashboard.MobileLayout.gradients=e,F.modal.selectedDashboard.json.Dashboard.TabletLayout.gradients=e,F.setDashboardCSS(F.modal.userPreference),d)for(var t=0;t<i.length;t++){void 0!==(c=i[t]).newdrag||c.themeType!==F.themesOnLoad&&void 0!==c.themeType?(delete c.newdrag,F.themesOnLoad=t===i.length-1?"":F.themesOnLoad):F.updatedJson[c.objectID]=getDuplicateObject(c),c.themeType=l;var s,n,r,o="default-theme"!==(s=F.selectedTheme[F.getActiveDashboardId()])?"./resources/bizvizchart-themes/"+s+"/themeConfig.data":"./resources/bizvizchart-themes/"+s+"/"+c.designData.type+"/"+c.designData.class+".data";(a=F.getHttpCachedData(o))&&200==a[0]?(n="default-theme"!==s?JSON.parse(a[1]).DashboardObjects:JSON.parse(a[1]),r="default-theme"!==s?JSON.parse(a[1]).dashboardTheme:JSON.parse(a[1]),F.onGetThemeJsonDataOfComponent(n,c,r)):F.getThemeJson(c,i[t],function(e,o){F.onGetThemeJsonDataOfComponent(e,o)})}})},F.onGetThemeJsonDataOfComponent=function(e,o,a){var t,s=e[o.designData.class].Properties.Object,s=(F.updatedJson&&"default-theme"===s.themeType&&void 0!==F.updatedJson[o.objectID]&&(e[o.designData.class].Properties.Object=getDuplicateObject(F.updatedJson[o.objectID])),F.newjson=F.themeUpdate(e,o),F.modal.rawComponentJSONlist[o.designData.class].Properties=e[o.designData.class].Properties,void 0!==a&&"default-theme"!==s.themeType&&Array.isArray(F.modal.selectedDashboard.componentObjectList[o.objectID].m_fieldsJson)?F.modal.selectedDashboard.componentObjectList[o.objectID].m_fieldsJson.forEach(function(e,o){void 0!==e.Color&&void 0!==a.datasetColors&&void 0!==a.datasetColors[o]&&(e.Color=a.datasetColors[o])}):"default-theme"==s.themeType&&Array.isArray(F.modal.selectedDashboard.componentObjectList[o.objectID].m_fieldsJson)&&(t=(void 0!==a?a:e)[o.designData.class].Fields,F.modal.selectedDashboard.componentObjectList[o.objectID].m_fieldsJson.forEach(function(e,o){void 0!==e.Color&&void 0!==t[o].Color&&(e.Color=t[o].Color)})),o[o.subElement].id||""),e=o[o.subElement].DataSet||"",n=o[o.subElement].ConditionalColors||{},r=o[o.subElement].CategoryColors||{},l=F.newjson,s=(l.id=s,l.DataSet=e,l.ConditionalColors=n,l.CategoryColors=r,F.updateDatasetColorsWithTheme(o));s[o.subElement]=l,F.redrawComponent(s)},F.themeUpdate=function(e,o){var a,t=getDuplicateObject(o[o.subElement]),s=getDuplicateObject(e[o.designData.class].Properties.Object[o.subElement]);for(a in s)if(s.hasOwnProperty(a))if("object"==typeof s[a])for(var n in s[a])t[a][n]=s[a][n];else t[a]=s[a];return t},F.onGetGloalPropertyJsonDataOfComponent=function(e,o){F.newjson=F.propertyUpdate(e,o[o.subElement],o.subElement),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==F.modal.layoutType&&(-1!=(t=(a=F.modal.selectedDashboard.json.Dashboard.MobileLayout.Object).findIndex(function(e){return e.objectID===o.objectID}))&&(mocJson=a[t],a[t][mocJson.subElement]=F.propertyUpdate(e,mocJson[mocJson.subElement],mocJson.subElement)),-1!=(t=(a=F.modal.selectedDashboard.json.Dashboard.TabletLayout.Object).findIndex(function(e){return e.objectID===o.objectID})))&&(tocJson=a[t],a[t][tocJson.subElement]=F.propertyUpdate(e,tocJson[tocJson.subElement],tocJson.subElement));var a=o[o.subElement].id||"",t=o[o.subElement].DataSet||"",e=o[o.subElement].ConditionalColors||{},s=o[o.subElement].CategoryColors||{},n=F.newjson,a=(n.id=a,n.DataSet=t,n.ConditionalColors=e,n.CategoryColors=s,F.updateDatasetColorsWithTheme(o));a[o.subElement]=n,F.redrawComponent(a)},F.propertyUpdate=function(e,o,a){var t,s=getDuplicateObject(o),n=getDuplicateObject(e);if(null!=F.globalPropertyMapping){var r,l=F.globalPropertyMapping.options;for(r in l)if(IsBoolean(l[r])&&(t=r.replace("Value",""),null==a||"Background"==t||"Chart"==a||"DataGrid"==a||"Funnel"==a||"InvertedFunnel"==a||"Pyramid"==a||"Scorecard"==a)){var i,d=n[t],c=null!=s[t]?s[t]:s;for(i in"Scorecard"==a&&("Title"==t?c=s:"xAxis"!=t&&"yAxis"!=t||(c="")),d)if(d.hasOwnProperty(i))if("object"==typeof d[i])for(var u in d[i])null!=c[i][u]&&(c[i][u]=d[i][u]);else null!=c&&null!=c[i]&&(c[i]=d[i])}}return s},F.updateDatasetColorsWithTheme=function(e){for(var o=!!e[e.subElement].DataSet,a=o&&!!e[e.subElement].DataSet.Fields,t=o&&a?e[e.subElement].DataSet.Fields:[],s=F.getDatasetColorsFromTheme(F.selectedTheme[F.getActiveDashboardId()]),n=0,r=0;r<t.length;r++)r>s.length&&(n=0),F.datasetcolor&&F.datasetcolor[e.objectName]&&void 0!==F.datasetcolor[e.objectName][t[r].Name]&&"default-theme"===F.selectedTheme[F.getActiveDashboardId()]?(t[r].Color=F.datasetcolor[e.objectName][t[r].Name].Color,n++):t[r].Color=s[n++];return e},F.loadDesignerThemeInfo=function(a,t){var e;F.designerThemeInfo.hasOwnProperty(a)?t&&t():(e="default-theme"===a?"./resources/bizvizchart-themes/"+F.selectedTheme[F.getActiveDashboardId()]+"/dashboardTheme.data":"./resources/bizvizchart-themes/"+F.selectedTheme[F.getActiveDashboardId()]+"/themeConfig.data",T.getJsonFileData(e,function(e){F.designerThemeInfo[a]="default-theme"!==a?e.dashboardTheme:e,t&&t()},null,function(e,o){404===e&&T.getJsonFileData("./resources/bizvizchart-themes/default-theme/dashboardTheme.data",function(e){F.designerThemeInfo[a]=e,t&&t()},null,function(e,o){404===e&&t&&t()})}))},F.getHighlighterStyle=function(){var e=F.modal.userPreference;return{height:"100%",width:"3px",background:e?e.compSelcOpts.color:"var(--selected-state)",position:"absolute"}},F.setFocusOnInput=function(e,o){C(function(){$(e).find(o).focus()},100)},F.setSelectedLayout=function(){F.modal.layoutType=F.modal.selectedDashboard.json.Dashboard.layoutType||"AbsoluteLayout"},F.onTourClick=function(e){for(var o=[],a=F.getComponentbyId(F.modal.selectedComponentId),t=(F.allTourPropMap={customtour:e,tourListMap:{},tourComponentType:!1,selectedIndex:{tabValue:0},associateTourList:0===a.associatedTourList.length?[]:getDuplicateArray(a.associatedTourList),associateTourComponent:void 0===a.associatedTour?{}:getDuplicateObject(a.associatedTour),tourButton:void 0===a.associatedTourButtonList?{}:getDuplicateObject(a.associatedTourButtonList),placementDrop:{auto:"auto",top:"top",bottom:"bottom",right:"right",left:"left"}},F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object),s=0;s<t.length;s++)o.push({key:t[s].objectID,value:t[s].objectName});F.allTourPropMap.tourListMap.options=o,F.showModelPopup("customTourWindow"),F.tourSortCfg={axis:"y",tolerance:"pointer",containment:"parent",cursor:"move",revert:!0,placeholder:"s-o-p-h",scroll:!0,handle:".tourReorderDragDiv",start:function(e,o){F.oldTourIndex=o.item.index()},stop:function(e,o){var a=o.item.index();C(function(){F.updateTourindex(F,F.oldTourIndex,a)},0)}}},F.onApplyTourProperty=function(e){F.allTourPropMap.tourComponentType=!0,F.allTourPropMap.tourButton[e.value]=void 0===F.allTourPropMap.tourButton[e.value]||F.allTourPropMap.tourButton[e.value],F.allTourPropMap.titlePlaceholder="Title",F.allTourPropMap.tourObj={compName:e.value,title:"",content:"",placement:"",duration:"",orderIndex:""},-1<Object.keys(F.allTourPropMap.associateTourComponent).indexOf(e.value)&&(F.allTourPropMap.tourObj.title=F.allTourPropMap.associateTourComponent[e.value].title,F.allTourPropMap.tourObj.content=F.allTourPropMap.associateTourComponent[e.value].content,F.allTourPropMap.tourObj.placement=F.allTourPropMap.associateTourComponent[e.value].placement,F.allTourPropMap.tourObj.duration=F.allTourPropMap.associateTourComponent[e.value].duration,F.allTourPropMap.tourObj.orderIndex=F.allTourPropMap.associateTourComponent[e.value].orderIndex)},F.onChangeTourProperty=function(e){!1!==F.allTourPropMap.tourButton[e.compName]&&(F.allTourPropMap.tourButton[e.compName]=!1,F.allTourPropMap.titlePlaceholder="Title"),""===e.title&&(F.allTourPropMap.tourButton[e.compName]=!0,F.allTourPropMap.titlePlaceholder="*Title (Field can't be empty)"),F.allTourPropMap.associateTourComponent[e.compName]=getDuplicateObject(e)},F.onChangeTourDropdown=function(e,o){!1!==F.allTourPropMap.tourButton[e.compName]&&(F.allTourPropMap.tourButton[e.compName]=!1),e.placement=o,F.allTourPropMap.associateTourComponent[e.compName]=getDuplicateObject(e)},F.addToTourList=function(e){F.allTourPropMap.tourButton[e.compName]=!0,F.allTourPropMap.associateTourComponent[e.compName]=getDuplicateObject(e),F.allTourPropMap.associateTourComponent&&F.allTourPropMap.associateTourComponent[e.compName]&&""===F.allTourPropMap.associateTourComponent[e.compName].orderIndex&&(1===Object.keys(F.allTourPropMap.associateTourComponent).length?(F.allTourPropMap.tourObj.orderIndex=0,F.allTourPropMap.associateTourComponent[e.compName].orderIndex=0):(F.allTourPropMap.tourObj.orderIndex=Object.keys(F.allTourPropMap.associateTourComponent).length-1,F.allTourPropMap.associateTourComponent[e.compName].orderIndex=Object.keys(F.allTourPropMap.associateTourComponent).length-1));var o,a=getDuplicateObject(F.allTourPropMap.associateTourComponent),t=[];for(o in a)t[a[o].orderIndex]=a[o];t.sort(function(e,o){return e.orderIndex-o.orderIndex}),F.allTourPropMap.associateTourList=t,F.allTourPropMap.tourComponentType=!1,T.showNotification("Configuration has been added to the list","alert-info",3e3)},F.SaveTourProperty=function(){var e=F.getComponentbyId(F.modal.selectedComponentId);e.associatedTour=getDuplicateObject(F.allTourPropMap.associateTourComponent),e.associatedTourList=getDuplicateArray(F.allTourPropMap.associateTourList),e.associatedTourButtonList=getDuplicateObject(F.allTourPropMap.tourButton),delete F.allTourPropMap.associateTourComponent,delete F.associateTourList},F.onTourDelete=function(e){delete F.allTourPropMap.associateTourComponent[e.compName],F.allTourPropMap.associateTourList.splice(e.orderIndex,1);for(var o=0;o<F.allTourPropMap.associateTourList.length;o++)F.allTourPropMap.associateTourList[o].orderIndex=o,F.allTourPropMap.associateTourComponent[F.allTourPropMap.associateTourList[o].compName].orderIndex=o;delete F.allTourPropMap.tourButton[e.compName]},F.onTourEdit=function(e){F.allTourPropMap.selectedIndex.tabValue=0,F.allTourPropMap.tourComponentType=!0;F.getComponentbyId(F.modal.selectedComponentId);F.allTourPropMap.tourObj={compName:e.compName,title:"",content:"",placement:"",duration:"",orderIndex:""},F.allTourPropMap.tourObj.title=e.title,F.allTourPropMap.tourObj.content=e.content,F.allTourPropMap.tourObj.placement=e.placement,F.allTourPropMap.tourObj.duration=e.duration,F.allTourPropMap.tourObj.orderIndex=e.orderIndex},F.updateTourindex=function(e,o,a){var t=[];if(o!==a){if(a<o)for(var s=0,n=0;n<e.allTourPropMap.associateTourList.length;s++,n++)n===o?n!==e.allTourPropMap.associateTourList.length-1&&(e.allTourPropMap.associateTourList[n+1].orderIndex=s,e.allTourPropMap.associateTourComponent[e.allTourPropMap.associateTourList[n+1].compName].orderIndex=s,t.push(e.allTourPropMap.associateTourList[n+1]),n+=1):s===a?(e.allTourPropMap.associateTourList[o].orderIndex=a,e.allTourPropMap.associateTourComponent[e.allTourPropMap.associateTourList[o].compName].orderIndex=a,t.push(e.allTourPropMap.associateTourList[o]),n-=1):(e.allTourPropMap.associateTourList[n].orderIndex=s,e.allTourPropMap.associateTourComponent[e.allTourPropMap.associateTourList[n].compName].orderIndex=s,t.push(e.allTourPropMap.associateTourList[n]));else for(s=0,n=0;s<e.allTourPropMap.associateTourList.length;s++,n++)s===o?(e.allTourPropMap.associateTourList[n+1].orderIndex=s,e.allTourPropMap.associateTourComponent[e.allTourPropMap.associateTourList[n+1].compName].orderIndex=s,t.push(e.allTourPropMap.associateTourList[n+1]),n+=1):s===a?(e.allTourPropMap.associateTourList[o].orderIndex=s,e.allTourPropMap.associateTourComponent[e.allTourPropMap.associateTourList[o].compName].orderIndex=s,t.push(e.allTourPropMap.associateTourList[o]),n-=1):(e.allTourPropMap.associateTourList[n].orderIndex=s,e.allTourPropMap.associateTourComponent[e.allTourPropMap.associateTourList[n].compName].orderIndex=s,t.push(e.allTourPropMap.associateTourList[n]));e.allTourPropMap.associateTourList=[],e.allTourPropMap.associateTourList=t}},F.switchDashboardView=function(e){T.closeAllNotifications();var s,n,o,a,t,r=F.getActiveDashboardId();switch(e){case"Desktop":F.modal.layoutType="AbsoluteLayout",$("#"+r).css({width:F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.width+"px",height:F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.height+"px",top:"0px",left:"0px",border:F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].borderThickness+"px solid "+F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].borderColor,overflow:"hidden"}).resizable("enable"),F.setDashboardBGColor(),F.modal.currentHistoryProperties().skipHistoryRegister=!0,$("#"+r).find(".bizvizComponent").each(function(e,o){o=o.id.split("dcc_")[1],o=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,"objectID",o);F.redrawComponent(o),F.manageDashboardViewComponent(o)}),F.modal.currentHistoryProperties().skipHistoryRegister=!1;break;case"Tablet":F.modal.layoutType="TabletLayout",F.modal.isActiveBox=!0,F.reloadDefault(),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType]||(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType]={resolution:"1024x768",width:"1024",height:"768",border:o+"px solid #a9a9a9",pinedObject:[],Object:[]}),s=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].width/F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.width,n=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].height/F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.height,o=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.borderThickness,F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].borderThickness=o,a=(a=$("#"+r).parent().width()/2-F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].width/2)<0?0:a,t=(t=$("#"+r).parent().height()/2-F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].height/2)<0?0:t,$("#"+r).css({width:Number(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].width)+2*o+"px",height:Number(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].height)+2*o+"px",top:t+"px",left:a+"px",border:o+"px solid #a9a9a9","overflow-x":"hidden","overflow-y":"auto",opacity:"1"}).resizable("disable"),F.setDashboardBGColor(),0==F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.length?(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.filter(function(e){return null!=e}),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object=angular.copy(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object),$("#"+r).find(".bizvizComponent").each(function(e,o){var a=o.id.split("dcc_")[1],t=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,"objectID",a),a=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,"objectID",a);a&&(a.x=t.x*s,a.y=t.y*n,a.width=t.width*s,a.height=t.height*n,$(o).css({left:a.x+"px",top:a.y+"px",width:a.width+"px",height:a.height+"px"}),a.isPined=!1,F.redrawComponent(a),$(o).hide())})):(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length!==F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.length&&F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.map(function(o){var a,t=!0;F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.map(function(e){e.objectID===o.objectID&&(t=!1)}),t&&(a=angular.copy(o),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.some(function(e){return e.objectID===a.objectID})||(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.push(a),a.x=o.x*s,a.y=o.y*n,a.width=o.width*s,a.height=o.height*n,$("#"+r).find(".bizvizComponent #"+o.objectID).css({left:a.x+"px",top:a.y+"px",width:a.width+"px",height:a.height+"px"}),F.redrawComponent(a),F.manageDashboardViewComponent(a),void 0===a.isPined&&(a.isPined=!1,$("#dcc_"+o.objectID).hide())))}),$("#"+r).find(".bizvizComponent").each(function(e,o){o=o.id.split("dcc_")[1];try{var a=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,"objectID",o);if(a)if(F.redrawComponent(a),F.manageDashboardViewComponent(a),!1===a.isPined)$("#dcc_"+a.objectID).hide();else{a.isPined=!0;for(var t={objectID:a.objectID},s=($("#dcc_"+a.objectID).show(),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].pinedObject),n=!1,r=0;r<s.length;r++)s[r].objectID==a.objectID&&(n=!0);n||F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].pinedObject.push(t),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&F.syncComponentScriptingandGroupingProperty(a),F.isSelectedComponent(a.objectID)&&F.deselectComponent(a.objectID)}}catch(e){}}));break;case"Mobile":F.modal.layoutType="MobileLayout",F.modal.isActiveBox=!0,F.reloadDefault(),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType]||(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType]={resolution:"375x663",width:"375",height:"663",border:o+"px solid #a9a9a9",pinedObject:[],Object:[]}),s=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].width/F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.width,n=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].height/F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.height,o=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.borderThickness,F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].borderThickness=o,a=(a=$("#"+r).parent().width()/2-F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].width/2)<0?0:a,t=(t=$("#"+r).parent().height()/2-F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].height/2)<0?0:t,$("#"+r).css({width:Number(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].width)+2*o+"px",height:Number(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].height)+2*o+"px",top:t+"px",left:a+"px",border:o+"px solid #a9a9a9","overflow-x":"hidden","overflow-y":"auto",opacity:"1"}).resizable("disable"),F.setDashboardBGColor(),0==F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.length?(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object=F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.filter(function(e){return null!=e}),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object=angular.copy(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&(F.selectedGlobalProperty[r][F.modal.layoutType]=angular.copy(F.selectedGlobalProperty[r].AbsoluteLayout)),$("#"+r).find(".bizvizComponent").each(function(e,o){var a,t=o.id.split("dcc_")[1],s=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,"objectID",t),t=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,"objectID",t);t&&(a=F.componentDefaultWHForMobileView(t),t.y=s.y*n,t.x=a.x,t.width=a.width,t.height=a.height,$(o).css({left:t.x+"px",top:t.y+"px",width:t.width+"px",height:t.height+"px"}),t.isPined=!1,F.redrawComponent(t),$(o).hide())})):(F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length!==F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.length&&F.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.map(function(o){var a,e,t=!0;F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.map(function(e){e.objectID===o.objectID&&(t=!1)}),t&&(a=angular.copy(o),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.some(function(e){return e.objectID===a.objectID})||(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object.push(a),e=F.componentDefaultWHForMobileView(a),a.y=o.y*n,a.x=e.x,a.width=e.width,a.height=e.height,$("#"+r).find(".bizvizComponent #"+o.objectID).css({left:a.x+"px",top:a.y+"px",width:a.width+"px",height:a.height+"px"}),F.redrawComponent(a),F.manageDashboardViewComponent(a),void 0===a.isPined&&(a.isPined=!1,$("#dcc_"+a.objectID).hide())))}),$("#"+r).find(".bizvizComponent").each(function(e,o){o=o.id.split("dcc_")[1];try{var a=DesignerUtil.prototype.findInArray(F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].Object,"objectID",o);if(a)if(F.redrawComponent(a),F.manageDashboardViewComponent(a),!1===a.isPined)$("#dcc_"+a.objectID).hide();else{a.isPined=!0;for(var t={objectID:a.objectID},s=($("#dcc_"+a.objectID).show(),F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].pinedObject),n=!1,r=0;r<s.length;r++)s[r].objectID==a.objectID&&(n=!0);n||F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].pinedObject.push(t),IsBoolean(F.modal.userPreference.defaultSettings.syncComponentProperty)&&F.syncComponentScriptingandGroupingProperty(a),F.isSelectedComponent(a.objectID)&&F.deselectComponent(a.objectID)}}catch(e){}}))}F.modal.selectedDashboard.json.Dashboard.layoutType=F.modal.layoutType,F.reloadDefault()},F.manageDashboardViewComponent=function(e){F.lockComponent(!1,{lockComponent:e.showLocked,objectID:e.objectID},!0),F.hideComponent(!1,{hideComponent:e.unShowHidden,objectID:e.objectID},!0)},F.setDashboardBGColor=function(){var e=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].gradientRotation||"0",o=["rgba(255,255,255,1)","rgba(255,255,255,1)"],a=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].gradients||"#FFFFFF",t=F.modal.selectedDashboard.json.Dashboard[F.modal.layoutType].bgAlpha||"1";if(""!=a){var s=a.split(",");if(1==s.length)o[0]=hex2rgb(convertColorToHex(s[0]),t),o[1]=hex2rgb(convertColorToHex(s[0]),t);else for(var n=0;n<s.length;n++)o[n]=hex2rgb(convertColorToHex(s[n]),t)}for(var r="",l=0;l<o.length;l++)r+=o[l]+(l<o.length-1?" ,":"");a=F.modal.userPreference.showGridLines?"url(./resources/images/svg/bgGrid.png), ":"";$("#mainDesignerViewDiv #"+F.modal.selectedDashboard.id).css({background:a+"linear-gradient("+e+"deg,"+r+")"}),$("#mainDesignerViewDiv #"+F.modal.selectedDashboard.id).css({background:a+"-webkit-linear-gradient("+e+"deg, "+r+")"}),$("#mainDesignerViewDiv #"+F.modal.selectedDashboard.id).css({background:a+"-o-linear-gradient("+e+"deg, "+r+")"}),$("#mainDesignerViewDiv #"+F.modal.selectedDashboard.id).css({background:a+"-moz-linear-gradient("+e+"deg, "+r+")"})},F.componentDefaultWHForMobileView=function(e){switch(e.objectType){case"chart":switch(e[e.subElement].Type){case"SparkLine":return{width:250,height:120,x:10};case"Progress":return{width:150,height:150,x:10};case"KPITile":return{width:250,height:150,x:10};default:return{width:300,height:250,x:10}}break;case"funnel":return{width:200,height:250,x:10};case"datagrid":case"scorecard":return{width:300,height:250,x:10};case"filter":return"list"!==e[e.subElement].Type?{width:120,height:25,x:10}:{width:120,height:150,x:10};case"bullet":return{width:200,height:50,x:10};case"rectangle":return{width:160,height:70,x:10};case"gauge":case"semigauge":return{width:100,height:100,x:10};case"textbox":return{width:150,height:30,x:10};case"hslider":return{width:150,height:50,x:10};case"vslider":return{width:50,height:150,x:10};default:return{width:200<e.width?200:e.width,height:50<e.height?50:e.height,x:10}}}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("DatasetController",["$scope","$timeout","ServiceFactory",function(u,p,n){u.component="",u.selectedDataSet="",u.selectedField="",u.selectedDatasource="",u.datasetFieldList="",u.alertJson="",u.alertFieldProperties=[],u.datasetFieldTypes="",u.dataSetPage="",u.fieldContainer=[],u.datasetDesignProperties="",n.getJsonFileData("./resources/data/ComponentClassDatasetProperties.data",function(e){u.datasetDesignProperties=e}),u.invokeDatasetpaletteUpdation=function(e){u.component=DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",e),u.$apply(),u.component?IsBoolean(u.component.isValueFieldsAvailable)?u.loadValuesFields():(u.loadDataSet(),u.setDatasetFieldType()):n.showNotification("Component is not selected","alert-danger",3e3)},u.loadDataSet=function(){u.selectedDataSet=u.component[u.component.subElement].DataSet,u.selectedDatasource="",u.datasetFieldList=[],u.selectedField="",u.fieldContainer=[],u.alertJson="",u.alertFieldProperties=[],""!==u.selectedDataSet&&void 0!==u.selectedDataSet?(u.selectedDatasource=DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,"id",u.selectedDataSet.dataSource),u.setDatasetFieldList(),u.setFieldInContainers(),$.each(u.fieldContainer,function(e,o){u.syncPropertyWithJson(o.Fields)})):(u.datasetFieldList="",u.selectedDatasource="",u.selectedDataSet="",u.component[u.component.subElement].DataSet=void 0,u.setFieldInContainers(),u.syncPropertyWithJson(u.datasetFieldList)),u.$apply(),u.updateTabSelection("#field-properties"),u.setLiHoverIconCSS()},u.setDatasetFieldType=function(){u.datasetFieldTypes=u.datasetDesignProperties[u.component.designData.class].datasetFieldTypes,u.$apply()},u.onchangeOfFieldType=function(e){e.Type=e.typeObject.value},u.updateTabSelectionById=function(e){u.updateTabSelection(e.target.hash)},u.getFieldSortCfg=function(d){var c=-1;return{axis:"y",tolerance:"pointer",containment:"parent",cursor:"move",revert:!0,placeholder:"s-f-p-h",scroll:!0,start:function(e,o){c=o.item.index()},stop:function(e,o){var o=o.item.index(),a=c,t=o,s=u.fieldContainer[d].Fields,n=u.selectedDataSet.Fields,r=s[0].fieldJson,l=[];Array.prototype.move=function(e,o){if(o>=this.length)for(var a=o-this.length;1+a--;)this.push(void 0);this.splice(o,0,this.splice(e,1)[0])};for(var i=0;i<n.length;i++)n[i].Type==r.Type&&l.push(i);p(function(){s.move(a,t);for(var e=0;e<s.length;e++)n[l[e]]=s[e].fieldJson},0)}}},u.updateTabSelection=function(e){$(".dataSourceTypeTabs").find(".dataSourceTypeTab").removeClass("active"),$(".dataSourceTypeTabs").find(e).addClass("active"),$(".dataSourceTypeTabsContent").find(".tab-pane").removeClass("active"),$(".dataSourceTypeTabsContent").find(e).addClass("active")},u.changeDatasource=function(){u.destroyFromComponent(),void 0!==u.selectedDatasource?(void 0===u.selectedDataSet||""===u.selectedDataSet||void 0===u.selectedDataSet.dataSource?u.createDataSet():u.updateToDataUrlAvailableDataSet(u.selectedDataSet.dataSource),u.addToDataUrlAvailableDataSet(),u.selectedDataSet.dataSource=u.selectedDatasource.id,u.selectedDataSet.Fields=[],u.setDatasetFieldList(),u.setFieldInContainers(),u.syncPropertyWithJson(u.datasetFieldList)):(u.updateToDataUrlAvailableDataSet(u.selectedDataSet.dataSource),u.selectedDataSet=""),"AbsoluteLayout"==u.modal.layoutType&&u.registerInHistory("change",u.component)},u.setDatasetFieldList=function(){var e;u.datasetFieldList=[],void 0!==u.selectedDatasource&&(e=u.modal.getfieldSetFromConnection(u.selectedDatasource.id),u.colorCount=0,u.addFieldsToDatasetFieldList(e,"Field","name"),e=u.modal.getCalculatedFieldSetFromConnection(u.selectedDatasource.id),u.addFieldsToDatasetFieldList(e,"CalculatedField","id"),u.setAllAvailableFieldsName())},u.addFieldsToDatasetFieldList=function(e,a,t){var s=u.getDatasetColorsFromTheme(u.selectedTheme[u.getActiveDashboardId()]);angular.forEach(e,function(e){var o={};o.fieldJson=u.getNewFieldObject(),o.name=e[t],o.fieldJson[u.datasetDesignProperties[u.component.designData.class].name]=e[t],o.fieldJson[u.datasetDesignProperties[u.component.designData.class].displayName]=e[t],o.fieldJson.fieldType=a,o.fieldJson.expressionID=e.id,o.fieldJson.OtherField=e[t],o.fieldJson.OtherFieldDisplayName=e[t],o.fieldJson.ColorFieldDisplayName="Color",o.fieldJson.RadiusFieldDisplayName="Radius",o.fieldJson.AdditionalField=u.component.Funnel&&"InvertedFunnel"==u.component.Funnel.Type?"":e[t],o.fieldJson.tooltipField=e[t],u.colorCount===s.length&&(u.colorCount=0),u.datasetcolor&&u.datasetcolor[u.selectedDataSet.id]&&void 0!==u.datasetcolor[u.selectedDataSet.id][o.fieldJson.Name]&&"default-theme"===u.selectedTheme[u.getActiveDashboardId()]?o.fieldJson.Color=u.datasetcolor[u.selectedDataSet.id][o.fieldJson.Name].Color:o.fieldJson.Color=s[u.colorCount++],o.fieldProperties=angular.copy(u.datasetDesignProperties[u.component.designData.class].FieldProperties),u.datasetFieldList.push(o)})},u.setAllAvailableFieldsName=function(){for(var e=[],o=0;o<u.datasetFieldList.length;o++)e.push({key:u.datasetFieldList[o].name,value:u.datasetFieldList[o].name});e.unshift({key:"",value:"None"}),u.availableFieldsName=e},u.syncPropertyWithJson=function(e){$.each(e,function(e,s){$.each(s.fieldProperties,function(e,o){var a,t=s.fieldJson[o.attributeName];switch(o.type){case"select":o.value="object"==typeof t?DesignerUtil.prototype.findInArray(o.options,"key",t.key):DesignerUtil.prototype.findInArray(o.options,"key",t);break;case"customSelect":o.options=angular.copy(u.availableFieldsName),o.value="object"==typeof t?DesignerUtil.prototype.findInArray(o.options,"key",t.key):DesignerUtil.prototype.findInArray(o.options,"key",t);break;case"customSelectTextBox":o.options=angular.copy(u.availableFieldsName),"object"==typeof t?(a=DesignerUtil.prototype.findInArray(o.options,"key",t.key),o.value=a||{key:t.key,value:t.key}):(a=DesignerUtil.prototype.findInArray(o.options,"key",t),o.value=a||{key:t,value:t});break;case"CascadedParentSelect":o.value=DesignerUtil.prototype.findInArray(o.options,"key",t),u.cascadedParentsChild[o.cascadedChild]=[],void 0!==o.value&&(u.cascadedParentsChild[o.cascadedChild]=o.value.child);break;case"CascadedChildSelect":o.value=DesignerUtil.prototype.findInArray(u.cascadedParentsChild[o.attributeName],"key",t);break;case"color":isNaN(t)?n.isValidHexColorString(t)?o.value=t:o.value="#0DAEA7":o.value=convertColorToHex(t);break;case"checkbox":o.value=IsBoolean(t);break;case"number":o.value=parseFloat(t);break;default:o.value=t}})})},u.setFieldInContainers=function(){u.fieldContainer=[];for(var e=u.datasetDesignProperties[u.component.designData.class].datasetFieldTypes,o=0;o<e.length;o++){if(u.fieldContainer[o]={},u.fieldContainer[o].Type=e[o].value,u.fieldContainer[o].Label=e[o].label,u.fieldContainer[o].Fields=[],""!==u.selectedDataSet&&void 0!==u.selectedDataSet&&u.selectedDataSet.Fields)for(var a,t=0;t<u.selectedDataSet.Fields.length;t++)u.selectedDataSet.Fields[t].Type===e[o].value&&void 0!==(a=u.getDataSetFieldJsonWithProperties(u.selectedDataSet.Fields[t]))&&u.fieldContainer[o].Fields.push(a);var s=e[o].cssClass;IsBoolean(e[o].dynamicHide)&&0==u.fieldContainer[o].Fields.length&&(s+=" bvz-invisible"),u.fieldContainer[o].CSSClass=s}},u.getDataSetFieldJsonWithProperties=function(e){for(var o=e[u.datasetDesignProperties[u.component.designData.class].name],a=0;a<u.datasetFieldList.length;a++)if(u.datasetFieldList[a].name===o){for(var t in e)e.hasOwnProperty(t)&&(u.datasetFieldList[a].fieldJson[t]=e[t]);return u.datasetFieldList[a]}},u.setSelectedField=function(e){for(var o,a,t=0;t<e.fieldProperties.length;t++)-1<e.fieldProperties[t].attributeName.indexOf("fontFamily")&&(o=e.fieldProperties[t].value.key,a=u.modal.globalFontProperties.findIndex(function(e){return e.value===o}),e.fieldProperties[t].value=u.modal.globalFontProperties[a],e.fieldProperties[t].options=u.modal.globalFontProperties);u.selectedField=e,u.updateAlertJsonForSelectedField(e),-1!==navigator.appVersion.indexOf("Win")&&setTimeout(function(){u.initSpectrumColorPicker("input[type='color']")},.01)},u.addFieldToDataSet=function(e,o){u.isFieldExist(u.selectedDataSet.Fields,e.name,o)||(e.fieldJson[u.datasetDesignProperties[u.component.designData.class].name]=e.name,e.fieldJson[u.datasetDesignProperties[u.component.designData.class].displayName]=e.name,e.fieldJson.Name=e.name,e.fieldJson.Type=o,e.fieldJson.iconPath="Category"===o?"./resources/images/svg/Line.svg":"./resources/images/svg/Column.svg",u.selectedDataSet.Fields.push(angular.copy(e.fieldJson)),u.setSelectedVariable(void 0,u.component,"Component"),"datagrid"!==u.component.designData.type&&"scorecard"!==u.component.designData.type)||(u.alertJson=u.getNewAlertColumnObject(),u.alertJson.name=e.name,u.alertFieldProperties=angular.copy(u.datasetDesignProperties[u.component.designData.class].alertProperties),u.updateAlertFieldProperties()),u.syncPropertyWithJson([e]);for(var a=0;a<u.fieldContainer.length;a++)u.fieldContainer[a].Type!==o||0<u.fieldContainer[a].Fields.length&&u.isFieldJsonExist(u.fieldContainer[a].Fields,e.name,o)||(u.fieldContainer[a].Fields.push(angular.copy(e)),u.selectedField=angular.copy(e),u.$apply());u.setLiHoverIconCSS(),Modernizr.inputtypes.color||u.initSpectrumColorPicker("input[type='color']"),"AbsoluteLayout"==u.modal.layoutType&&u.registerInHistory("change",u.component)},u.setLiHoverIconCSS=function(){window.setTimeout(function(){$(".bvz-list-container li").find(".bvz-btn-icon").hide(),$(".bvz-list-container li").hover(function(){$(this).find(".bvz-btn-icon").show()},function(){$(this).find(".bvz-btn-icon").hide()})},10)},u.isFieldExist=function(e,o,a){for(var t=0;t<e.length;t++)if(e[t][u.datasetDesignProperties[u.component.designData.class].name]===o&&e[t].Type===a)return!0;return!1},u.isFieldJsonExist=function(e,o,a){for(var t=0;t<e.length;t++)if(e[t].fieldJson[u.datasetDesignProperties[u.component.designData.class].name]===o&&e[t].fieldJson.Type===a)return!0;return!1},u.removeField=function(e,o){for(var a=0;a<u.selectedDataSet.Fields.length;a++)if(u.selectedDataSet.Fields[a][u.datasetDesignProperties[u.component.designData.class].name]===e.name&&u.selectedDataSet.Fields[a].Type===o){var t=u.selectedDataSet.Fields.indexOf(u.selectedDataSet.Fields[a]);u.selectedDataSet.Fields.splice(t,1);break}for(var s,n=0;n<u.fieldContainer.length;n++)u.fieldContainer[n].Type===o&&-1!==(s=u.fieldContainer[n].Fields.indexOf(e))&&(u.fieldContainer[n].Fields.splice(s,1),u.selectedField="");u.setSelectedVariable(void 0,u.component,"Component"),"AbsoluteLayout"==u.modal.layoutType&&u.registerInHistory("change",u.component)},u.onChangeCustomSelect=function(e){e.value.key!==e.value.value&&"None"!=e.value.value&&(e.value.key=e.value.value),u.onFieldPropertyChange(e)},u.onFieldPropertyChange=function(e){var o=u.selectedDataSet.Fields,a="";u.datasetcolor=u.datasetcolor||{},u.datasetcolor[u.selectedDataSet.id]=u.datasetcolor[u.selectedDataSet.id]||{};for(var t=0;t<o.length;t++)o[t][u.datasetDesignProperties[u.component.designData.class].name]===u.selectedField.name&&o[t].Type===u.selectedField.fieldJson.Type&&("object"==typeof e.value&&null!==e.value?o[t][e.attributeName]=e.value.key:(o[t][e.attributeName]=e.value,"Category"==u.selectedField.fieldJson.Type&&"Color"==e.attributeName&&u.updateDefaultCategoryColorIndicator(e.value)),a=o[t].Type);for(var s=0;s<u.fieldContainer.length;s++)if(u.fieldContainer[s].Type===a)for(var n=0;n<u.fieldContainer[s].Fields.length;n++)u.fieldContainer[s].Fields[n].name===u.selectedField.name&&u.fieldContainer[s].Fields[n].fieldJson.Type===u.selectedField.fieldJson.Type&&("Color"===e.attributeName&&("default-theme"===u.selectedTheme[u.getActiveDashboardId()]&&(u.datasetcolor[u.selectedDataSet.id][u.fieldContainer[s].Fields[n].name]={},u.datasetcolor[u.selectedDataSet.id][u.fieldContainer[s].Fields[n].name][e.attributeName]=e.value),u.fieldContainer[s].Fields[n].fieldJson.Color=e.value),"object"==typeof e.value?u.fieldContainer[s].Fields[n].fieldJson[e.attributeName]=e.value.key:u.fieldContainer[s].Fields[n].fieldJson[e.attributeName]=e.value),u.syncPropertyWithJson([u.fieldContainer[s].Fields[n]]);"AbsoluteLayout"==u.modal.layoutType&&u.registerInHistory("change",u.component),IsBoolean(u.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==u.modal.layoutType&&(u.syncComponentPropertyInMobileView("compFieldProperty",u.component,e),u.syncComponentPropertyInTabletView("compFieldProperty",u.component,e))},u.removeComponentFromAssociatedataset=function(){if(null!=u.component.referenceID)for(var e=u.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,o=0;o<e.length;o++){for(var a=e[o].AssociatedDataSet,t=0;t<a.length;t++)a[t].id===u.component.referenceID&&a.splice(t,1);u.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL[o].AssociatedDataSet=a}},u.refreshConnection=function(){u.removeComponentFromAssociatedataset(),u.datasetFieldList=[],u.selectedDatasource="",u.selectedDataSet="",u.selectedField="",u.component[u.component.subElement].DataSet=void 0,u.alertJson="",u.alertFieldProperties=[],u.destroyFromComponent(),u.setFieldInContainers()},u.destroyFromComponent=function(){u.removeComponentFromAssociatedataset(),void 0!==u.component[u.component.subElement].Alerts&&(u.component[u.component.subElement].Alerts={}),void 0!==u.component[u.component.subElement].ConditionalColors&&(u.component[u.component.subElement].ConditionalColors.ConditionalColor=[]),void 0!==u.component[u.component.subElement].CategoryColors&&(u.component[u.component.subElement].CategoryColors.CategoryColor=[]),void 0!==u.component[u.component.subElement].SubCategoryColors&&(u.component[u.component.subElement].SubCategoryColors.subCategoryColor=[])},u.createDataSet=function(){u.selectedDataSet="",void 0!==u.selectedDatasource&&(u.component[u.component.subElement].DataSet=u.getNewDataSetObject(),u.selectedDataSet=u.component[u.component.subElement].DataSet,u.selectedDataSet.id=u.component.referenceID)},u.addToDataUrlAvailableDataSet=function(){var e=u.getNewAssociatedDataSetObject();e.id=u.selectedDataSet.id,e.component=u.component.referenceID,u.selectedDatasource.AssociatedDataSet.push(e)},u.updateToDataUrlAvailableDataSet=function(e){for(var o=DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,"id",e),a=angular.copy(o.AssociatedDataSet),t=0;t<a.length;t++)a[t].id===u.selectedDataSet.id&&o.AssociatedDataSet.splice(t,1)},u.removeFromDataUrlAvailableDataSet=function(e){e=u.selectedDatasource.AssociatedDataSet.indexOf(e);u.selectedDatasource.AssociatedDataSet.splice(e,1)},u.getNewDataSetObject=function(){return angular.copy(u.modal.selectedDashboard.json["AbsoluteLayout_Object_"+u.component.subElement+"_DataSet"],"")},u.getNewFieldObject=function(){return angular.copy(u.modal.selectedDashboard.json["AbsoluteLayout_Object_"+u.component.subElement+"_DataSet_Fields"],"")},u.getNewAssociatedDataSetObject=function(){return angular.copy(u.modal.selectedDashboard.json.DataProviders_DataURL_AssociatedDataSet,"")},u.availableValues=[],u.newValueField={label:"Label",value:"Value"},u.loadValuesFields=function(){u.availableValues=u.component[u.component.subElement].Values,u.$apply()},u.addRowAndValueField=function(){u.availableValues.push(angular.copy(u.newValueField)),u.redrawRadioFilter()},u.deleteAllRowAndValueField=function(){u.availableValues.length=0,u.redrawRadioFilter()},u.deleteRowAndValueField=function(e){e=u.availableValues.indexOf(e);u.availableValues.splice(e,1),u.redrawRadioFilter()},u.redrawRadioFilter=function(){u.modal.selectedComponentId&&u.redrawComponent(u.getComponentbyId(u.modal.selectedComponentId))},u.onDragSuccess=function(e,o){},u.onDropSuccess=function(e,o,a){return"scorecard"==u.component.objectType&&("id"==e.name||"name"==e.name||"state"==e.name)||"datagrid"==u.component.objectType&&"length"==e.name?(n.showNotification("These fields name are not supported","alert-info",3e3),!0):(u.addFieldToDataSet(e,a),void(-1===navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||setTimeout(function(){u.initSpectrumColorPicker("input[type='color']")},.01)))},u.onDropSuccessForFilterField=function(e,o,a){u.addFieldToFilterDataSetForFilter(e,a),u.setLiHoverIconCSS()},u.addFieldToFilterDataSetForFilter=function(e,o){if(e.fieldJson[u.datasetDesignProperties[u.component.designData.class].name]=e.name,e.fieldJson[u.datasetDesignProperties[u.component.designData.class].displayName]=e.name,"Value"===(e.fieldJson.Type=o)){for(var a=!1,t=0;t<u.selectedDataSet.Fields.length;t++)if(u.selectedDataSet.Fields[t].Type===o){u.selectedDataSet.Fields[t]=angular.copy(e.fieldJson),a=!0;break}a||u.selectedDataSet.Fields.push(angular.copy(e.fieldJson))}else if("DisplayField"===o){for(var s=!1,t=0;t<u.selectedDataSet.Fields.length;t++)if(u.selectedDataSet.Fields[t].Type===o){u.selectedDataSet.Fields[t]=angular.copy(e.fieldJson),s=!0;break}s||u.selectedDataSet.Fields.push(angular.copy(e.fieldJson))}for(var n=0;n<u.fieldContainer.length;n++)u.fieldContainer[n].Type===o&&(u.fieldContainer[n].Fields[0]=angular.copy(e),u.selectedField=angular.copy(e),u.$apply());u.setSelectedVariable(void 0,u.component,"Component")},u.updateAlertJsonForSelectedField=function(e){if("datagrid"===u.component.designData.type){var o=!1,a=u.component[u.component.subElement].Alerts.AlertColumn;if(void 0!==a)for(var t=0;t<a.length;t++)if(e.name===a[t].name){u.alertJson=a[t],u.alertFieldProperties=angular.copy(u.datasetDesignProperties[u.component.designData.class].alertProperties),u.updateAlertFieldProperties(),o=!0;break}IsBoolean(!o)&&(u.alertJson=u.getNewAlertColumnObject(),u.alertJson.name=e.name,u.alertFieldProperties=angular.copy(u.datasetDesignProperties[u.component.designData.class].alertProperties),u.updateAlertFieldProperties())}},u.onClickCustomAlertColor=function(e){"Comparison"===u.alertJson.mode?(u.updateCustomPropertiesJson(),u.onChangeCompareValue(),u.showModelPopup("customAlertColortWindow")):"Static Comparison"===u.alertJson.mode?(u.updateCustomPropertiesJson(),u.updateJsonforStaticComparision(),u.showModelPopup("customAlertStaticComparisonWindow")):(u.updateCustomPropertiesJson(),u.updateAlertRangeJson(),u.showModelPopup("AlertRangeColortWindow"))},u.onClickCustomCellMerge=function(e){u.cellMergeArray=[],u.updateCellMergeCustomPropertiesJson(),u.showModelPopup("customCellMergeWindow")},u.updateCellMergeCustomPropertiesJson=function(){u.cellMergeArray=[],u.datasetField=u.setdatasetField(),u.cellMergeArray=u.selectedField.fieldJson.CellMergeCustomProperties},u.updateCellMergePropertiesJson=function(e){u.selectedField.fieldJson.CellMergeCustomProperties=u.cellMergeArray;for(var o=0;o<u.component[u.component.subElement].DataSet.Fields.length;o++)IsBoolean(u.component[u.component.subElement].DataSet.Fields[o].Name==u.selectedField.name)&&(u.component[u.component.subElement].DataSet.Fields[o].CellMergeCustomProperties=u.selectedField.fieldJson.CellMergeCustomProperties)},u.addCellMergeRow=function(){var e={},o=Object.keys(u.cellMergeArray).length;e.rowIndex=o,e.index="1",e.rowspan="2",e.colspan="0",e.field=u.selectedField.fieldJson.fieldname,u.cellMergeArray[o]=e},u.deleteCellMerge=function(e){e=u.cellMergeArray.indexOf(e);u.cellMergeArray.splice(e,1)},u.deleteAllCellMerge=function(){u.cellMergeArray=[]},u.onClickCustomDataLabel=function(e){u.updateDataLabelCustomPropertiesJson(),u.showModelPopup("customDataLabelWindow")},u.updateDataLabelCustomPropertiesJson=function(){for(var e in u.customDataLabelProperty={},u.ShowPercentage=!0,"bar_chart"==u.component.componentType&&"100%"==u.component.Chart.ChartType||"group_bar_chart"==u.component.componentType&&"100%"==u.component.Chart.ChartType||"timeline_chart"==u.component.componentType&&"100%"==u.component.Chart.ColumnType?u.ShowPercentageValue=!0:(u.ShowPercentageValue=!1,u.selectedField.fieldJson.DataLabelCustomProperties.showPercentValue=!1),"pie_chart"==u.component.componentType&&(u.ShowPercentage=!IsBoolean(u.component.Chart.showSliceValue)),"funnel"==u.component.objectType&&(u.ShowPercentage=!IsBoolean(u.component.Funnel.showLayerValue)),u.datasetField=u.setdatasetField(),IsBoolean(""==u.selectedField.fieldJson.DataLabelCustomProperties.dataLabelFontColor||""==u.selectedField.fieldJson.DataLabelCustomProperties.datalabelField)&&(u.selectedField.fieldJson.DataLabelCustomProperties.datalabelField=u.selectedField.name),u.customDataLabelProperty.showDataLabel={value:IsBoolean(u.selectedField.fieldJson.DataLabelCustomProperties.showDataLabel),disabled:!1},u.customDataLabelProperty.hideDataLabel={value:IsBoolean(u.selectedField.fieldJson.DataLabelCustomProperties.hideDataLabel),disabled:!1},u.customDataLabelProperty.hideDataLabelText={value:u.selectedField.fieldJson.DataLabelCustomProperties.hideDataLabelText,disabled:!1},u.customDataLabelProperty.useFieldColor={value:IsBoolean(u.selectedField.fieldJson.DataLabelCustomProperties.useFieldColor),disabled:!1},u.customDataLabelProperty.showPercentValue={value:IsBoolean(u.selectedField.fieldJson.DataLabelCustomProperties.showPercentValue),disabled:!1},u.customDataLabelProperty.datalabelBackgroundRect={value:IsBoolean(u.selectedField.fieldJson.DataLabelCustomProperties.datalabelBackgroundRect),disabled:!1},u.customDataLabelProperty.datalabelBackgroundRectColor={value:u.selectedField.fieldJson.DataLabelCustomProperties.datalabelBackgroundRectColor},u.customDataLabelProperty.datalabelStrokeColor={value:u.selectedField.fieldJson.DataLabelCustomProperties.datalabelStrokeColor},u.customDataLabelProperty.dataLabelFontColor={value:u.selectedField.fieldJson.DataLabelCustomProperties.dataLabelFontColor},u.customDataLabelProperty.dataLabelDefaultFontColor={value:u.selectedField.fieldJson.DataLabelCustomProperties.dataLabelDefaultFontColor},u.customDataLabelProperty.dataLabelFontSize={value:u.selectedField.fieldJson.DataLabelCustomProperties.dataLabelFontSize},u.customDataLabelProperty.dataLabelUseComponentFormater={value:u.selectedField.fieldJson.DataLabelCustomProperties.dataLabelUseComponentFormater},u.datasetDesignProperties.DataLabelCustomProperties.datalabelField={},u.datasetDesignProperties.DataLabelCustomProperties.datalabelField.options=u.datasetField,u.datasetDesignProperties.DataLabelCustomProperties)u.customDataLabelProperty[e]={options:u.datasetDesignProperties.DataLabelCustomProperties[e].options,value:u.selectedField.fieldJson.DataLabelCustomProperties[e]}},u.setdatasetField=function(){for(var e=[],o=0,a=u.datasetFieldList.length;o<a;o++)e[o]={key:u.datasetFieldList[o].name,value:u.datasetFieldList[o].name};return e},u.updateCustomDataLabelPropertiesJson=function(e){for(var o in u.selectedField.fieldJson.DataLabelCustomProperties)u.selectedField.fieldJson.DataLabelCustomProperties[o]=u.customDataLabelProperty[o].value;for(var a=0;a<u.component[u.component.subElement].DataSet.Fields.length;a++)IsBoolean(u.component[u.component.subElement].DataSet.Fields[a].Name==u.selectedField.name)&&(u.component[u.component.subElement].DataSet.Fields[a].DataLabelCustomProperties=u.selectedField.fieldJson.DataLabelCustomProperties);IsBoolean(u.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==u.modal.layoutType&&(u.syncComponentPropertyInMobileView("dataLabelProperty",u.component,e),u.syncComponentPropertyInTabletView("dataLabelProperty",u.component,e))},u.onClickCustomRadiusRange=function(e){u.updateFixedRadius(),u.updateRadiusRangeAdvancePropertiesJson(),u.showModelPopup("customRadiusRangeWindow"),u.fixedRadiusValue=0},u.updateFixedRadius=function(){u.isFixedRadius=!1,u.datasetField=u.setdatasetField(),u.allFields=[];for(var e=0;e<u.datasetField.length;e++)u.allFields[e]=u.datasetField[e].value;"scattered_plot_chart"==u.component.componentType?(u.radiusField=u.selectedField.fieldJson.PlotRadius,u.fixedRadiusValue=u.radiusField):(u.radiusField=u.selectedField.fieldJson.RadiusField,u.fixedRadiusValue=isNaN(u.radiusField)?0:u.radiusField),""===u.radiusField&&(u.radiusField=u.selectedField.fieldJson.Name),-1!==u.allFields.indexOf(u.radiusField)?u.isFixedRadius=!1:u.isFixedRadius=!0,isNaN(u.radiusField)||u.radiusField===u.selectedField.fieldJson.Name||(u.radiusField=u.selectedField.fieldJson.Name)},u.updateRadiusRangeAdvancePropertiesJson=function(){u.customRangeColorPropertiesJson={};var e=u.datasetField.slice(0);e.unshift({key:"",value:"None"}),"timeline_chart"===u.component.componentType?(u.customRangeColorPropertiesJson.isFixedRadius={value:void 0===u.selectedField.fieldJson.isFixedRadius||u.selectedField.fieldJson.isFixedRadius,disabled:!1},u.customRangeColorPropertiesJson.fixedValue={value:void 0===u.selectedField.fieldJson.PlotRadius?3:u.selectedField.fieldJson.PlotRadius},u.customRangeColorPropertiesJson.radiusField={options:u.datasetField,value:(void 0!==u.selectedField.fieldJson.radiusField&&IsBoolean(u.selectedField.fieldJson.isFixedRadius)?u.selectedField.fieldJson:u).radiusField}):(u.customRangeColorPropertiesJson.isFixedRadius={value:u.isFixedRadius,disabled:!1},u.customRangeColorPropertiesJson.fixedValue={value:u.fixedRadiusValue},u.customRangeColorPropertiesJson.radiusField={options:u.datasetField,value:u.radiusField}),u.customRangeColorPropertiesJson.colorField={options:e,value:u.selectedField.fieldJson.ColorField},u.customRangeColorPropertiesJson.otherField={options:u.datasetField,value:u.selectedField.fieldJson.OtherField},u.customRangeColorPropertiesJson.otherFieldDisplayName={value:u.selectedField.fieldJson.OtherFieldDisplayName},u.customRangeColorPropertiesJson.radiusFieldDisplayName={value:u.selectedField.fieldJson.RadiusFieldDisplayName},u.customRangeColorPropertiesJson.colorFieldDisplayName={value:u.selectedField.fieldJson.ColorFieldDisplayName}},u.updateRadiusRangeCustomAdvancePropertiesJson=function(e){"scattered_plot_chart"==u.component.componentType?(u.selectedField.fieldJson.isFixedRadius=u.customRangeColorPropertiesJson.isFixedRadius.value,u.customRangeColorPropertiesJson.isFixedRadius.value?u.selectedField.fieldJson.PlotRadius=u.customRangeColorPropertiesJson.fixedValue.value:u.selectedField.fieldJson.PlotRadius=u.customRangeColorPropertiesJson.radiusField.value):"timeline_chart"==u.component.componentType?(u.selectedField.fieldJson.isFixedRadius=u.customRangeColorPropertiesJson.isFixedRadius.value,u.selectedField.fieldJson.PlotRadius=u.customRangeColorPropertiesJson.fixedValue.value,u.selectedField.fieldJson.RadiusField=u.customRangeColorPropertiesJson.radiusField.value):u.customRangeColorPropertiesJson.isFixedRadius.value?u.selectedField.fieldJson.RadiusField=u.customRangeColorPropertiesJson.fixedValue.value:u.selectedField.fieldJson.RadiusField=u.customRangeColorPropertiesJson.radiusField.value,u.selectedField.fieldJson.OtherField=u.customRangeColorPropertiesJson.otherField.value,u.selectedField.fieldJson.OtherFieldDisplayName=u.customRangeColorPropertiesJson.otherFieldDisplayName.value,u.selectedField.fieldJson.RadiusFieldDisplayName=u.customRangeColorPropertiesJson.radiusFieldDisplayName.value,u.selectedField.fieldJson.ColorFieldDisplayName=u.customRangeColorPropertiesJson.colorFieldDisplayName.value,u.selectedField.fieldJson.ColorField=u.customRangeColorPropertiesJson.colorField.value;for(var o=0;o<u.component[u.component.subElement].DataSet.Fields.length;o++)IsBoolean(u.component[u.component.subElement].DataSet.Fields[o].Name==u.selectedField.name)&&(u.component[u.component.subElement].DataSet.Fields[o].RadiusField=u.selectedField.fieldJson.RadiusField,u.component[u.component.subElement].DataSet.Fields[o].ColorField=u.selectedField.fieldJson.ColorField,u.component[u.component.subElement].DataSet.Fields[o].PlotRadius=u.selectedField.fieldJson.PlotRadius,u.component[u.component.subElement].DataSet.Fields[o].OtherField=u.selectedField.fieldJson.OtherField,u.component[u.component.subElement].DataSet.Fields[o].OtherFieldDisplayName=u.selectedField.fieldJson.OtherFieldDisplayName,u.component[u.component.subElement].DataSet.Fields[o].RadiusFieldDisplayName=u.selectedField.fieldJson.RadiusFieldDisplayName,u.component[u.component.subElement].DataSet.Fields[o].ColorFieldDisplayName=u.selectedField.fieldJson.ColorFieldDisplayName,u.component[u.component.subElement].DataSet.Fields[o].isFixedRadius=u.selectedField.fieldJson.isFixedRadius)},u.updateOtherFieldDpName=function(e){switch(e){case"OtherField":u.customRangeColorPropertiesJson.otherFieldDisplayName.value=u.customRangeColorPropertiesJson.otherField.value;break;case"ColorField":u.customRangeColorPropertiesJson.colorFieldDisplayName.value=u.customRangeColorPropertiesJson.colorField.value;break;case"RadiusField":u.customRangeColorPropertiesJson.radiusFieldDisplayName.value=u.customRangeColorPropertiesJson.radiusField.value}},u.updateCustomPropertiesJson=function(){switch(u.alertJson.mode){case"Comparison":u.customAlertPropertiesJson={},void 0===u.alertJson.alertSize&&(u.alertJson.alertSize=12),u.customAlertPropertiesJson.fixedValueCompare={value:IsBoolean(u.alertJson.fixedValueCompare),disabled:!1},u.customAlertPropertiesJson.fixedValue={value:parseFloat(u.alertJson.fixedValue)},u.customAlertPropertiesJson.compareColumn={options:u.datasetFieldList,value:u.alertJson.compareColumn},u.customAlertPropertiesJson.alertPosition={options:[{key:"left",value:"Left"},{key:"right",value:"Right"}],value:u.alertJson.alertPosition},u.customAlertPropertiesJson.alertSize={value:u.alertJson.alertSize},u.customAlertPropertiesJson.alertType={options:[{key:"arrow",value:"Arrow"},{key:"tick",value:"Check Mark"},{key:"dot",value:"Dot"},{key:"textcolor",value:"Text Color"},{key:"bar",value:"Bar"},{key:"colorfill",value:"Color Fill"}],value:u.alertJson.alertType};break;case"Static Comparison":u.StaticComparisionAlertPropertiesJson={},void 0===u.alertJson.alertSize&&(u.alertJson.alertSize=12),u.StaticComparisionAlertPropertiesJson.rowStaticIndicator="customshape"!==u.alertJson.alertType,u.StaticComparisionAlertPropertiesJson.columnName={value:u.alertJson.name},u.StaticComparisionAlertPropertiesJson.compareColumn={options:u.datasetFieldList,value:u.alertJson.compareColumn||u.alertJson.name},u.StaticComparisionAlertPropertiesJson.alertPosition={options:[{key:"left",value:"Left"},{key:"right",value:"Right"}],value:u.alertJson.alertPosition},u.StaticComparisionAlertPropertiesJson.alertSize={value:u.alertJson.alertSize},u.StaticComparisionAlertPropertiesJson.alertType={options:[{key:"star",value:"Star"},{key:"hexagon",value:"Hexagon"},{key:"diamond",value:"Diamond"},{key:"dot",value:"Dot"},{key:"textcolor",value:"Text Color"},{key:"colorfill",value:"Color Fill"},{key:"customshape",value:"Custom Shape"}],value:u.alertJson.alertType},u.StaticComparisionAlertPropertiesJson.customIcon={value:u.alertJson.customIcon};break;default:u.customPropertiesJson={},void 0===u.alertJson.alertSize&&(u.alertJson.alertSize=12),u.customPropertiesJson.showDynamicRange=IsBoolean(u.alertJson.showDynamicRange),u.customPropertiesJson.minColor=u.alertJson.minColor,u.customPropertiesJson.maxColor=u.alertJson.maxColor,u.customPropertiesJson.compareColumn={options:u.datasetFieldList,disabled:!0},u.customPropertiesJson.alertPosition={options:[{key:"left",value:"Left"},{key:"right",value:"Right"}],value:u.alertJson.alertPosition},u.customPropertiesJson.alertSize={value:u.alertJson.alertSize},u.customPropertiesJson.alertType={options:[{key:"star",value:"Star"},{key:"hexagon",value:"Hexagon"},{key:"diamond",value:"Diamond"},{key:"dot",value:"Dot"},{key:"textcolor",value:"Text Color"},{key:"bar",value:"Bar"},{key:"colorfill",value:"Color Fill"}],value:u.alertJson.alertType}}},u.checkRowStaticIndicator=function(e){u.StaticComparisionAlertPropertiesJson.rowStaticIndicator="customshape"!==e.key},u.onChangeCompareValue=function(){var e=IsBoolean(u.customAlertPropertiesJson.fixedValueCompare.value)?parseFloat(u.customAlertPropertiesJson.fixedValue.value):u.customAlertPropertiesJson.compareColumn.value,o=u.alertJson.colors.split(","),a=(u.numeralComparision=[],["<","=",">"]);u.updateCustomeAlertPropertiesJson();for(var t=0;t<3;t++){var s={};s.AlertColumn=u.alertJson.name,s.Operator=a[t],s.CompareColumn=e,s.AlertColor=convertColorToHex(o[t]),u.numeralComparision.push(s)}},u.updateCustomeAlertPropertiesJson=function(){"scorecard"==u.component.objectType&&("Comparison"===u.alertJson.mode?u.customAlertPropertiesJson.compareColumn.options=u.fieldContainer[0].Fields:"Static Comparison"===u.alertJson.mode&&(u.StaticComparisionAlertPropertiesJson.compareColumn.options=u.fieldContainer[0].Fields))},u.onAlertPropertyChange=function(e){u.alertJson.hasOwnProperty(e.attributeName)&&("object"==typeof e.value?u.alertJson[e.attributeName]=e.value.value:u.alertJson[e.attributeName]=e.value),"mode"!=e.attributeName||"datagrid"!==u.component.designData.type&&"scorecard"!==u.component.designData.type||(u.alertJson.alertType="colorfill"),u.saveAlert()},u.addAlertRange=function(){var e={};e.index=u.alertRangeArray.length,e.RangeFrom="",e.RangeUpTo="",e.AlertColor=getRandomHexColor(),e.Delete=u.alertRangeArray.length,u.alertRangeArray.push(e)},u.deleteAlertRange=function(e){e=u.alertRangeArray.indexOf(e);u.alertRangeArray.splice(e,1)},u.deleteAllAlertRanges=function(){u.alertRangeArray=[]},u.deleteAlertRangeForStaticComparision=function(e){e=u.numeralComparision.indexOf(e);u.numeralComparision.splice(e,1)},u.deleteAllAlertRangeForStaticComparision=function(){u.numeralComparision=[]},u.updateAlertRangeJson=function(){if(u.alertRangeArray=[],""!==u.alertJson.ranges)for(var e=u.alertJson.colors.split(","),o=u.alertJson.ranges.split(","),a=0;a<o.length;a++){var t={};t.index=a,t.RangeFrom=o[a].split("~")[0],t.RangeUpTo=o[a].split("~")[1],t.AlertColor=convertColorToHex(e[a]),t.Delete=a,u.alertRangeArray.push(t)}},u.updateAlertFieldProperties=function(){for(var e in u.alertJson)for(var o=0;o<u.alertFieldProperties.length;o++)if(u.alertFieldProperties[o].attributeName===e)if("compareColumn"===u.alertFieldProperties[o].attributeName)for(var a in u.alertFieldProperties[o].options=[],u.datasetFieldList)u.alertFieldProperties[o].options.push({key:u.datasetFieldList[a].name,value:u.datasetFieldList[a].name});else"checkbox"===u.alertFieldProperties[o].type?u.alertFieldProperties[o].value=IsBoolean(u.alertJson[e]):u.alertFieldProperties[o].value=u.alertJson[e]},u.updateAlertColor=function(e){if("Comparison"===u.alertJson.mode){for(var o="",a=0;a<u.numeralComparision.length;a++)o+=u.numeralComparision[a].AlertColor+",";u.alertJson.colors=o.substring(0,o.length-1),u.alertJson.alertType=u.customAlertPropertiesJson.alertType.value,u.alertJson.alertPosition=u.customAlertPropertiesJson.alertPosition.value,u.alertJson.alertSize=u.customAlertPropertiesJson.alertSize.value,u.alertJson.fixedValue=u.customAlertPropertiesJson.fixedValue.value,u.alertJson.fixedValueCompare=u.customAlertPropertiesJson.fixedValueCompare.value,u.alertJson.compareColumn=u.customAlertPropertiesJson.compareColumn.value}else if("Static Comparison"===u.alertJson.mode){u.alertJson.compareColumn=u.StaticComparisionAlertPropertiesJson.compareColumn.value,u.alertJson.alertType=u.StaticComparisionAlertPropertiesJson.alertType.value,u.alertJson.alertPosition=u.StaticComparisionAlertPropertiesJson.alertPosition.value,u.alertJson.alertSize=u.StaticComparisionAlertPropertiesJson.alertSize.value;for(var o="",t="",s="",n="",a=0;a<u.numeralComparision.length;a++)t+=u.numeralComparision[a].Range+",",o+=u.numeralComparision[a].AlertColor+",",s+=u.numeralComparision[a].SelectedOperator+",",n+=u.numeralComparision[a].customIcon+",";u.alertJson.staticRange=t.substring(0,t.length-1),u.alertJson.colors=o.substring(0,o.length-1),u.alertJson.operatorName=s.substring(0,s.length-1),u.alertJson.customIcon=n.substring(0,n.length-1),u.alertJson.fixedValueCompare="false"}else{u.alertJson.compareColumn=u.customPropertiesJson.compareColumn.value,u.alertJson.alertType=u.customPropertiesJson.alertType.value,u.alertJson.alertPosition=u.customPropertiesJson.alertPosition.value,u.alertJson.alertSize=u.customPropertiesJson.alertSize.value;for(o="",t="",a=0;a<u.alertRangeArray.length;a++)t+=u.alertRangeArray[a].RangeFrom+"~"+u.alertRangeArray[a].RangeUpTo+",",o+=u.alertRangeArray[a].AlertColor+",";u.alertJson.ranges=t.substring(0,t.length-1),u.alertJson.colors=o.substring(0,o.length-1),u.alertJson.showDynamicRange=u.customPropertiesJson.showDynamicRange}u.saveAlert()},u.updateJsonforStaticComparision=function(){if(u.numeralComparision=[],""!==u.alertJson.staticRange){u.updateCustomeAlertPropertiesJson();for(var e=u.StaticComparisionAlertPropertiesJson.compareColumn.value,o=u.alertJson.colors.split(","),a=(void 0===u.alertJson.staticRange&&(u.alertJson.staticRange="0,1,2"),void 0===u.alertJson.operatorName&&(u.alertJson.operatorName=">,==,<="),u.alertJson.staticRange.split(",")),t=u.alertJson.operatorName.split(","),s=(void 0===u.alertJson.customIcon&&(u.alertJson.customIcon="bd-down-arrow,bd-minus,bd-up-arrow"),void 0===u.alertJson.alertSize&&(u.alertJson.alertSize=12),u.alertJson.customIcon.split(",")),n={options:[{value:"<",key:"<"},{value:"<=",key:"<="},{value:"==",key:"=="},{value:"!=",key:"!="},{value:">",key:">"},{value:">=",key:">="}]},r=0;r<a.length;r++){var l={};l.index=r,l.Range=a[r],l.Operator=n,l.SelectedOperator=t[r],l.CompareColumn=e,l.Delete=r,l.customIcon=s[r],l.AlertColor=convertColorToHex(o[r]),u.numeralComparision.push(l)}}},u.addStaticAlertRange=function(){var e={};e.index=u.numeralComparision.length,e.Range="0",e.Operator={options:[{value:"<",key:"<"},{value:"<=",key:"<="},{value:"==",key:"=="},{value:"!=",key:"!="},{value:">",key:">"},{value:">=",key:">="}]},e.SelectedOperator="<",e.CompareColumn=u.StaticComparisionAlertPropertiesJson.compareColumn.value,e.Delete=u.numeralComparision.length,e.customIcon="bd-minus",e.AlertColor=getRandomHexColor(),u.numeralComparision.push(e)},u.saveAlert=function(e){void 0===u.component[u.component.subElement].Alerts.AlertColumn&&(u.component[u.component.subElement].Alerts.AlertColumn=[]);for(var o=u.component[u.component.subElement].Alerts.AlertColumn,a=!1,t=0;t<o.length;t++)if(o[t].name===u.alertJson.name){IsBoolean(u.alertJson.showAlert)?u.component[u.component.subElement].Alerts.AlertColumn.splice(t,1,u.alertJson):u.component[u.component.subElement].Alerts.AlertColumn.splice(t,1),a=!0;break}!IsBoolean(a)&&IsBoolean(u.alertJson.showAlert)&&u.component[u.component.subElement].Alerts.AlertColumn.push(u.alertJson),IsBoolean(u.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==u.modal.layoutType&&(u.syncComponentPropertyInMobileView("alertProperty",u.component,e),u.syncComponentPropertyInTabletView("alertProperty",u.component,e))},u.getNewAlertsObject=function(){return angular.copy(u.modal.selectedDashboard.json["AbsoluteLayout_Object_"+u.component.subElement+"_Alerts"],"")},u.getNewAlertColumnObject=function(){return angular.copy(u.modal.selectedDashboard.json["AbsoluteLayout_Object_"+u.component.subElement+"_Alerts_AlertColumn"],"")},u.onCustomMapFileClick=function(t){$("#browseMapSVG").click().on("change",function(e){e.stopImmediatePropagation();var a,e=e.target.files[0];"image/svg+xml"==e.type?((a=new FileReader).onload=function(e){var o=a.result;t.value=o,u.selectedIndicatorModal.icon=t.value},a.readAsText(e)):n.showNotification("Please use SVG file instead of "+e.name,"alert-danger",3e3)})},u.showSVG=function(e){u.browseMapSVG=e,u.selectedIndicatorModal.showSvg=e},u.updateOperatorList=function(e){u.compareOperators=[],u.compareOperators.push({value:"",key:""}),u.compareOperators.push({value:"<",key:"<"}),u.compareOperators.push({value:"<=",key:"<="}),u.compareOperators.push({value:"==",key:"=="}),u.compareOperators.push({value:"!=",key:"!="}),u.compareOperators.push({value:">",key:">"}),u.compareOperators.push({value:">=",key:">="}),e&&u.compareOperators.push({value:"between",key:"between"}),u.fixedValueComparison=e,void 0!==u.selectedIndicator&&(u.selectedIndicator.flag=e,u.selectedIndicatorModal.flag=e)},u.createNewConditionalColorIndicator=function(){if(""!==u.selectedField.fieldJson&&void 0!==u.selectedField.fieldJson){u.compareOperators=[],u.selectedIndicatorModal={},u.indicatorWindowMode="Create",u.fixedValueComparison=!0,u.browseMapSVG=!1,u.updateOperatorList(u.fixedValueComparison),u.selectedIndicator=u.getNewConditionalColorObject(),u.selectedIndicator.seriesName=u.selectedField.name,u.selectedIndicator.operator="==",u.selectedIndicator.compareTo="0",u.selectedIndicator.opacity=1,u.selectedIndicator.comparedField=u.selectedField.name,u.selectedIndicator.otherField=u.selectedField.fieldJson.OtherField,u.selectedIndicator.flag=u.fixedValueComparison,u.selectedIndicator.showSvg=u.browseMapSVG,u.compareColumnFields=[];for(var e=0;e<u.datasetFieldList.length;e++)("decomposition_chart"!=u.component.componentType||("Category"==u.datasetFieldList[e].fieldJson.Type&&u.compareColumnFields.push(u.datasetFieldList[e].name),u.datasetFieldList[e].name===u.selectedField.name))&&u.compareColumnFields.push(u.datasetFieldList[e].name);for(var o=[],e=0;e<u.compareColumnFields.length;e++)-1===o.indexOf(u.compareColumnFields[e])&&o.push(u.compareColumnFields[e]);u.compareColumnFields=o,u.selectedIndicator.color="#08aea8",u.selectedIndicator.icon="bd-cross",u.selectedIndicatorModal=angular.copy(u.selectedIndicator),u.showModelPopup("conditionalColorModel")}else n.showNotification("Select a field","alert-danger",3e3)},u.editChartIndicator=function(e){if(u.indicatorWindowMode="Update",u.selectedIndicatorModal=angular.copy(e),u.selectedIndicator=e,u.browseMapSVG=null==e.showSvg?u.browseMapSVG:e.showSvg,u.selectedIndicatorModal.opacity=null==e.opacity?"1":e.opacity,u.selectedIndicator.opacity=null==e.opacity?"1":e.opacity,"Series"===u.selectedField.fieldJson.Type||"YField"===u.selectedField.fieldJson.Type||"XField"===u.selectedField.fieldJson.Type){var o;o=!(isNaN(e.compareTo)&&e.compareTo.indexOf("~")<0),u.fixedValueComparison=null==e.flag?o:e.flag,u.selectedIndicatorModal.flag=null==e.flag?u.fixedValueComparison:e.flag,u.selectedIndicator.flag=null==e.flag?u.fixedValueComparison:e.flag,u.updateOperatorList(u.fixedValueComparison),u.compareColumnFields=[];for(var a=0;a<u.datasetFieldList.length;a++)("decomposition_chart"!=u.component.componentType||("Category"==u.datasetFieldList[a].fieldJson.Type&&u.compareColumnFields.push(u.datasetFieldList[a].name),u.datasetFieldList[a].name===u.selectedIndicatorModal.seriesName))&&u.compareColumnFields.push(u.datasetFieldList[a].name);for(var t=[],a=0;a<u.compareColumnFields.length;a++)-1===t.indexOf(u.compareColumnFields[a])&&t.push(u.compareColumnFields[a]);u.compareColumnFields=t,u.showModelPopup("conditionalColorModel")}},u.updateChartIndicator=function(e){"Series"!==u.selectedField.fieldJson.Type&&"YField"!==u.selectedField.fieldJson.Type&&"XField"!==u.selectedField.fieldJson.Type||(u.selectedIndicator.seriesName=e.seriesName,u.selectedIndicator.operator=e.operator,u.selectedIndicator.compareTo=String(e.compareTo),u.selectedIndicator.comparedField=e.comparedField,u.selectedIndicator.color=e.color,u.selectedIndicator.icon=e.icon,u.selectedIndicator.opacity=e.opacity)},u.updateConditionalColorList=function(){var e;u.component[u.component.subElement].ConditionalColors.ConditionalColor.push(u.selectedIndicatorModal),IsBoolean(u.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==u.modal.layoutType&&((e=u.getComponentFromTabletLayout(u.component.objectID))&&e[e.subElement].ConditionalColors.ConditionalColor.push(u.selectedIndicatorModal),e=u.getComponentFromMobileLayout(u.component.objectID))&&e[e.subElement].ConditionalColors.ConditionalColor.push(u.selectedIndicatorModal)},u.deleteConditionalIndicator=function(e){var o,e=u.component[u.component.subElement].ConditionalColors.ConditionalColor.indexOf(e);u.component[u.component.subElement].ConditionalColors.ConditionalColor.splice(e,1),IsBoolean(u.modal.userPreference.defaultSettings.syncComponentProperty)&&"AbsoluteLayout"==u.modal.layoutType&&((o=u.getComponentFromTabletLayout(u.component.objectID))&&o[o.subElement].ConditionalColors.ConditionalColor.splice(e,1),o=u.getComponentFromMobileLayout(u.component.objectID))&&o[o.subElement].ConditionalColors.ConditionalColor.splice(e,1)},u.getNewConditionalColorObject=function(){return angular.copy(u.modal.selectedDashboard.json.AbsoluteLayout_Object_Chart_ConditionalColors_ConditionalColor,"")},u.updateDefaultCategoryColorIndicator=function(e){IsBoolean(u.component[u.component.subElement].CategoryColors.showColorsFromCategoryName)&&(u.component[u.component.subElement].CategoryColors.categoryDefaultColor=e,u.component[u.component.subElement].CategoryColors.categoryDefaultColorSet=e)},u.createNewCategoryColorIndicator=function(){""!==u.selectedField.fieldJson&&void 0!==u.selectedField.fieldJson?(u.component[u.component.subElement].CategoryColors.showColorsFromCategoryName="true",u.component[u.component.subElement].CategoryColors.categoryDefaultColor=u.selectedField.fieldJson.Color,u.component[u.component.subElement].CategoryColors.categoryDefaultColorSet=u.selectedField.fieldJson.Color,u.selectedIndicator=u.getNewCategoryColorObject(),u.selectedIndicator.seriesName="",u.selectedIndicator.color="#08aea8",u.updateCategoryColorList()):n.showNotification("Select a field","alert-danger",3e3)},u.createNewSubCategoryColorIndicator=function(){""!==u.selectedField.fieldJson&&void 0!==u.selectedField.fieldJson?(u.component[u.component.subElement].SubCategoryColors.showColorsFromSubCategoryName="true",u.component[u.component.subElement].SubCategoryColors.subCategoryDefaultColor=u.selectedField.fieldJson.Color,u.component[u.component.subElement].SubCategoryColors.subCategoryDefaultColorSet=u.selectedField.fieldJson.Color,u.selectedIndicator=u.getNewSubCategoryColorObject(),u.selectedIndicator.seriesName="",u.selectedIndicator.color="#08aea8",u.updateSubCategoryColorList()):n.showNotification("Select a field","alert-danger",3e3)},u.updateCategoryColorList=function(){u.component[u.component.subElement].CategoryColors.CategoryColor.push(u.selectedIndicator)},u.updateSubCategoryColorList=function(){u.component[u.component.subElement].SubCategoryColors.subCategoryColor.push(u.selectedIndicator)},u.deleteCategoryIndicator=function(e){e=u.component[u.component.subElement].CategoryColors.CategoryColor.indexOf(e);u.component[u.component.subElement].CategoryColors.CategoryColor.splice(e,1)},u.deleteSubCategoryIndicator=function(e){e=u.component[u.component.subElement].SubCategoryColors.subCategoryColor.indexOf(e);u.component[u.component.subElement].SubCategoryColors.subCategoryColor.splice(e,1)},u.getNewCategoryColorObject=function(){return angular.copy(u.modal.selectedDashboard.json.AbsoluteLayout_Object_Chart_CategoryColors_CategoryColor,"")},u.getNewSubCategoryColorObject=function(){return angular.copy(u.modal.selectedDashboard.json.AbsoluteLayout_Object_Chart_SubCategoryColors_subCategoryColor,"")},u.isFieldInList=function(e){return void 0===u.modal.FieldsSearchkey||-1<e.name.toLowerCase().indexOf(u.modal.FieldsSearchkey.toLowerCase())},u.checkPropVisibilityForContainer=function(e,o){for(var a=0;a<o.propertyFor.length;a++)if(o.propertyFor[a]===e.fieldJson.Type)return!0;return!1},u.setDraggedField=function(e,o){e=(e=e||window.event).buttons;return e!==1&&e!==3&&e!==2&&(u.draggedField=o,!0)}}]),!function(){angular.module("designer").config(["$translateProvider",function(e){var o=BIZVIZ.SDK.language.get()||"en-US";if(o)switch(o){case"hi":o="hi-IN";break;case"en":o="en-US"}angular.element.ajaxSetup&&angular.element.ajaxSetup({cache:!0}),e.useSanitizeValueStrategy("escape"),e.useStaticFilesLoader({prefix:dGlobals.translateJSONUrl,suffix:".json"}),e.preferredLanguage(o)}]);angular.module("designer").controller("DesignerController",["$scope","$rootScope","ServiceFactory","hotkeys","notify","$translate",function(l,a,b,e,o,n){l.bizVizLogo=dGlobals.bizVizLogo,l.isMainMenuVisible=!0,l.previewLabel="Preview",l.previewStage=!1,l.dopreviewState="yes",l.dpIcon="",l.objectSearchKey="",l.actualTag="",l.selectedGlobalVariable={},l.defValFilterList=[],l.dataURL4removeConnection=null,l.enablePreviewButton=!1,l.scrRes={ht:"",wt:"100%"},l.dashboardView={viewIcon:"nt-preview-icon",isPreview:!1},l.showModelPopup=function(e){b.closeAllNotifications(),l.setModelWatcherStatus(e,!0),$("#"+e).modal("show")},l.hideModelPopup=function(e){$("#"+e).modal("hide"),l.setModelWatcherStatus(e,!1)},l.hideAllModelPopup=function(){$(".modal.show").each(function(){var e=$(this).attr("id");$("#"+e).modal("hide"),l.setModelWatcherStatus(e,!1)})},l.setModelWatcherStatus=function(e,o){l.modal.modelPopupStatus[e]=o;try{o?("$apply"!=a.$$phase&&"$digest"!=a.$$phase||(a.$$phase=null),l.$apply()):l.$evalAsync()}catch(e){}},l.isAnyModalDialogActive=function(){return!!$(".modal .in").length},l.lastScriptOnLoad=function(){l.isLastScriptLoaded=!0},l.setPreferedLanguage=function(e){if(e){switch(e){case"hi":e="hi-IN";break;case"en":e="en-US"}n.use(e)}},l.initAuthInfo=function(e){l.modal.AUTH_INFO=e,l.portalPreference=b.AUTH_INFO.get("preferenceObject"),l.portalPreference&&loadColorSchemeFromPortal(l.portalPreference)},l.updateToBDBThemeTest=function(){var e,o={headerBGColor:"#006684",headerTextAndIconColor:"#ffffff",headerTextAndIconBGHoverColor:"#006684",headerTextAndIconHoverColor:"#ffffff",menuPanelBGColor:"#86dff9",menuPanelTextAndIconColor:"#006684",menuPanelTextAndIconBGHoverColor:"#86dff9",menuPanelTextAndIconHoverColor:"#006684",navBarBGColor:"#e0dfdf",navBarTextAndIconColor:"#000000",navBarTextAndIconBGHoverColor:"#cecdcd",navBarTextAndIconHoverColor:"#000000",contextMenuBGColor:"#ffffff",contextMenuTextAndIconColor:"#006684",contextMenuTextAndIconBGHoverColor:"#cecdcd",contextMenuTextAndIconHoverColor:"#000000",folderTextColor:"#000",treeSlideBarColor:"#006488"};for(e in o)l.portalPreference[e]=o[e]},l.onDocumentClick=function(e){-1==navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||l.initSpectrumColorPicker("input[type='color']"),l.modal.sWsVisible=!1,l.modal.wsSearchKey=""},l.getDesignerRecords=function(e){var o=encryptText(window.sessionStorage.getItem("bvz_spacekey")),a=encryptText(window.sessionStorage.getItem("bvz_userid")),o={authtoken:window.sessionStorage.getItem("bvz_token"),spacekey:o,docid:e,userID:a};requestSuccessFn=function(e,o){e.success?l.dopreviewState="yes":l.dopreviewState="no"},requestFailedFn=function(e,o){l.dopreviewState="error"},b.showLoader(),BIZVIZ.SDK.secureRequestDocId("/designer/getDesignerRecords",{},o,requestSuccessFn,requestFailedFn)},l.togglePreview=function(){var e;b.closeAllNotifications(),l.hideAllModelPopup(),l.modal.selectedDashboard&&""!==l.modal.selectedDashboard?(e=""!=l.modal.selectedDashboard.json.Dashboard.backendId?l.modal.selectedDashboard.json.Dashboard.workspaceId+"_"+l.modal.selectedDashboard.json.Dashboard.backendId:0,l.previewStage||l.getDesignerRecords(e),"yes"==l.dopreviewState?(l.previewStage?(IsBoolean(l.modal.selectedDashboard.componentObjectList)||(l.modal.dashboards[l.modal.dashboards.length-1]="",l.modal.dashboards.length=l.modal.dashboards.length-1,l.modal.selectedDashboard=l.previewSelectedDashboard,l.modal.layoutType=l.modal.selectedDashboard?l.modal.selectedDashboard.json.Dashboard.layoutType:"",l.enablePreviewButton=!1),l.showHomeButton(),l.showSaveButton(),l.showDashboardTabs(),l.stopPreview()):(l.hideHomeButton(),l.hideSaveButton(),l.hideDashboardTabs(),l.doPreview()),l.previewStage=!l.previewStage):(l.dopreviewState,b.showNotification("Access Denied","alert-danger",3e3))):b.showNotification("No dashboard available for preview","alert-warning",3e3)},l.previewFromManagePage=function(a,e){if(e&&e.stopPropagation(),!a)return!1;e=(l.openProcessingItem=a).parentId+"_"+a.dashboardId;if(l.getDesignerRecords(e),"no"==l.dopreviewState)return b.showNotification("Dashboard Preview Permission denied","alert-danger",3e3),!1;if("error"==l.dopreviewState)return b.showNotification("Internal Server Error","alert-danger",3e3),!1;l.loadComps(),l.modal.selectedDashboard&&""!==l.modal.selectedDashboard&&(l.previewSelectedDashboard={},l.previewSelectedDashboard=l.modal.selectedDashboard);var e=req_url.designer.openDashboard,o={dashboardId:a.dashboardId.toString()},o={dashboardParameters:JSON.stringify(o)};l.enablePreviewButton=!0,BIZVIZ.SDK.secureRequest(e,o,function(e,o){e&&e.DesignerResp.success?l.loadDashboardInPreview(e.DesignerResp.params)?(a.isOpen=!0,b.closeAllNotifications(),b.showNotification("Dashboard has been loaded","alert-success",3e3)):b.closeAllNotifications():b.showNotification("Invalid dashboard configuration","alert-danger",3e3),l.hideHomeButton(),l.hideSaveButton(),l.hideDashboardTabs(),l.doPreview(),l.previewStage=!l.previewStage,l.$apply()})},l.previewThemeTemplate=function(e,o,a){l.previewOrEditThemeObj={url:o,name:a},l.showModelPopup("previewThemeTemplateModal")},l.previewOrEditThemeUrlFromWelcomePage=function(e,o){b.getJsonFileData(l.previewOrEditThemeObj.url,function(e){l.loadComps(),IsBoolean(o)?(l.modal.selectedDashboard&&""!==l.modal.selectedDashboard&&(l.previewSelectedDashboard={},l.previewSelectedDashboard=l.modal.selectedDashboard),l.enablePreviewButton=!0,l.openProcessingItem={dashboardId:e.dashboardJson.Dashboard.id,dashboardName:e.dashboardJson.Dashboard.name,parentId:e.dashboardJson.Dashboard.workspaceId},l.loadDashboardInPreview(e),l.hideHomeButton(),l.hideSaveButton(),l.hideDashboardTabs(),l.doPreview(),l.previewStage=!l.previewStage):l.browseBVZXDashboard({fileData:e,fileName:l.previewOrEditThemeObj.name+".bvzx"}),l.$apply()})},l.loadDashboardInPreview=function(e){var e=convertStringToJson(e).dashboardJson,o=(e.Dashboard.workspaceId=l.openProcessingItem.parentId,e.Dashboard.name=l.openProcessingItem.dashboardName,e.Dashboard.id),a=e.Dashboard.name;l.modal.layoutType=e.Dashboard.layoutType||"AbsoluteLayout",l.toggleMenu(),e.Dashboard.AbsoluteLayout.Object=DesignerUtil.prototype.removeNullFromObjectsArray(e.Dashboard.AbsoluteLayout.Object),l.modal.selectedDashboard={id:o,name:a,json:e},l.modal.dashboards.push(l.modal.selectedDashboard),l.initHintVariables(l.modal.selectedDashboard.id)},l.switchDevicesAndPreview=function(e){if(e.trim()){switch(e){case"LG":l.scrRes.ht="",l.scrRes.wt="100%";break;case"MD":l.scrRes.ht="",l.scrRes.wt="996";break;case"SM":l.scrRes.ht="",l.scrRes.wt="768";break;case"XS":l.scrRes.ht="",l.scrRes.wt="480"}l.stopPreview(),l.doPreview()}},l.changePreviewLayout=function(){var e=l.isSelectedDashboardResponsive()?l.scrRes.wt:"100%",o=$("#bizVizPreview"),a=$(".prevBackground"),t=o.parent(),s=$("<div></div>"),n=$(window).width()/2-e/2;s.addClass("prevBackground").css({"z-index":"1000"}),a.remove(),t.append(s),o.width(e),"100%"==e?o.css("left",0):o.css("left",n)},l.doPreview=function(){b.showNotification("Previewing dashboard","alert-info",3e3),l.changePreviewLayout(),$("#bizVizPreview").css("z-index",1001),l.previewLabel="Back to Design",$("#bizVizPreview").show(),l.loadSelectedDashboard(),l.dashboardView.viewIcon="nt-close-icon",l.dashboardView.isPreview=!0},l.stopPreview=function(){b.closeAllNotifications(),l.stopDashboardProcesses(),$("#bizVizPreview").hide(),$("#bizVizPreview").css("z-index",-999),l.previewLabel="Preview",l.dashboardView.viewIcon="nt-preview-icon",l.dashboardView.isPreview=!1,$(".prevBackground").remove()},l.stopDashboardProcesses=function(){$("#dashboardViewerFrame")[0]&&$("#dashboardViewerFrame")[0].contentWindow&&null!=$("#dashboardViewerFrame")[0].contentWindow.DashBoard&&$("#dashboardViewerFrame")[0].contentWindow.stopDashboardProcesses()},l.toggleMenu=function(){b.closeAllNotifications(),l.isMainMenuVisible?l.hideMenu():l.showMenu()},l.showMenu=function(){$(".file-menu").removeClass("hideSM").addClass("showSM"),l.hideDashboardHeader(),l.isMainMenuVisible=!0},l.hideMenu=function(){$(".file-menu").removeClass("showSM").addClass("hideSM"),l.showDashboardHeader(),l.isMainMenuVisible=!1},l.hideDashboardHeader=function(){l.hideDashboardTabs(),l.hidePreviewBtn(),l.hideSaveButton()},l.showDashboardHeader=function(){l.showDashboardTabs(),l.showPreviewBtn(),l.showSaveButton()},l.hideDashboardTabs=function(){$("#dashboardTabs").hide(),$(".rw-container").hide()},l.showDashboardTabs=function(){$("#dashboardTabs").show(),$(".rw-container").show()},l.hidePreviewBtn=function(){},l.showPreviewBtn=function(){},l.hideSaveButton=function(){$("#saveBtn").hide()},l.showSaveButton=function(){$("#saveBtn").show()},l.hideHomeButton=function(){$("#designerHomeIcon").hide()},l.showHomeButton=function(){$("#designerHomeIcon").show()},l.handleAlertConfirmation=function(e,o){switch(o){case"DEL-COMP":l.multiSelected&&l.multiSelectDragConfiguration(!0),l.delComp();break;case"DEL-ALL-COMP":l.delAllComp();break;case"DEL-CONN":l.delConn(l.dataURL4removeConnection)}},l.delComp=function(){var e=l.modal.selectedComponentId,o=l.getComponentbyId(e);l.toggleRemoveComponentWindow(e),"pinned"===l.removeComponentbyId(e)&&b.showNotification("Cannot remove: component(s) are pinned on mobile/tablet.","alert-danger",3e3),l.rcc=e,l.registerInHistory("delete",o)},l.toggleRemoveComponentWindow=function(e){l.removeMenuSelection(),l.reloadDefault("")},l.delAllComp=function(){l.deleteAll()},l.doYouWantToDelete=function(){l.showModelPopup("deleteCompConfirmation")},l.doYouWantToDeleteAll=function(){l.modal.listOfSelectedComponents.length==l.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object.length?l.showModelPopup("deleteAllCompConfirmation"):l.showModelPopup("deleteSelectedCompConfirmation")},l.delConn=function(e){l.deleteConnection(e)},l.doYouWantToDeleteConn=function(e,o){o.stopPropagation(),l.dataURL4removeConnection=e,l.showModelPopup("deleteConnConfirmation")},l.getUserPropsByToken=function(){var e=req_url.designer.getUserPropsByToken;try{BIZVIZ.SDK.secureRequest(e,{},function(e,o){e=e&&e.users&&e.users.userProps||"[]";l.loadSelectedDashboard(JSON.parse(e))},function(){l.loadSelectedDashboard()})}catch(e){}},l.loadSelectedDashboard=function(){try{l.updateObjectsForSaveAndPreview(),l.updateDashboardJSONForPreview(),null==$("#dashboardViewerFrame")[0].contentWindow.DashBoard?$("#dashboardViewerFrame").attr("src","./views/Preview.html"):$("#dashboardViewerFrame")[0].contentWindow.drawDashboard(global.dashboardJSONForPreview)}catch(e){b.showNotification("Preview Error: "+e+", "+e.message,"alert-warning",3e3)}},l.updateObjectsForSaveAndPreview=function(){l.setImportComponentsToDashboardJson(),l.updateAuthTokenInJSON()},l.updateDashboardJSONForPreview=function(){global.dashboardJSONForPreview={Niv:angular.copy(l.modal.selectedDashboard.json)}},l.setImportComponentsToDashboardJson=function(){l.modal.selectedDashboard.json.Dashboard.imports=[],l.modal.selectedDashboard.json.Dashboard.importsStat=1,angular.forEach(l.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,function(e){if(e)try{l.pushImport(e.designData.class)}catch(e){}})},l.applyGlobalvariablesToAllObjects=function(){l.modal.selectedDashboard.json.Dashboard.GlobalVariable.Variable=[],l.modal.selectedDashboard.json.Dashboard.DataProviders.queryServiceList=[],l.modal.selectedDashboard.json.Dashboard.imports=[],l.modal.selectedDashboard.json.Dashboard.importsStat=1,l.addContextGlobalVar(),l.addDashboardGlobalVar(),angular.forEach(l.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,function(e){if(e)try{var o=e.subElement,a=e.globalVariableKeyAttribute;e[o][a]=e.variable.Key,l.modal.selectedDashboard.json.Dashboard.GlobalVariable.Variable.push(e.variable),l.pushImport(e.designData.class)}catch(e){}}),angular.forEach(l.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,function(e){l.modal.selectedDashboard.json.Dashboard.GlobalVariable.Variable.push(e.variable),e.selectedServiceID&&l.modal.selectedDashboard.json.Dashboard.DataProviders.queryServiceList.push({queryServiceID:e.selectedServiceID})})},l.pushImport=function(e){-1==l.modal.selectedDashboard.json.Dashboard.imports.indexOf(e)&&(l.modal.selectedDashboard.json.Dashboard.imports.push(e),l.pushDependentImports(e))},l.pushDependentImports=function(e){if("TrellisChart"==e)for(var o=["BarChart","BubbleChart","ColumnStackChart","LineChart"],a=0;a<o.length;a++)-1==l.modal.selectedDashboard.json.Dashboard.imports.indexOf(o[a])&&l.modal.selectedDashboard.json.Dashboard.imports.push(o[a])},l.addContextGlobalVar=function(){var e=l.getNewVariableJson();e&&(e.Key="context",l.modal.selectedDashboard.json.Dashboard.GlobalVariable.Variable.push(e))},l.addDashboardGlobalVar=function(){l.modal.selectedDashboard.json.Dashboard.GlobalVariable.Variable.push(l.modal.selectedDashboard.json.Dashboard.variable)},l.updateAuthTokenInJSON=function(){var e=l.newParamJSON();e&&(e.name="token",e.value=b.AUTH_INFO.get("token"),l.modal.selectedDashboard.json.Dashboard.FlashVars.Param=[],l.modal.selectedDashboard.json.Dashboard.FlashVars.Param.push(e))},l.newParamJSON=function(){return angular.copy(l.modal.selectedDashboard.json.FlashVars_Param,"")},l.loadComps=function(){l.importCompSrc||(l.importCompSrc="./views/designArea/importcomponents.html")},angular.element(document).ready(function(){window.onbeforeunload=function(){if(IsBoolean(l.anyDashboardModified()))return"There are unsaved changes in your design."}}),l.anyDashboardModified=function(){if(l.modal&&l.modal.dashboards)for(var e=0;e<l.modal.dashboards.length;e++)if(0<l.modal.dashboards[e].json.changeStatus)return!0;return!1},l.searchClickHandle=function(){l.searchButtonToggle=!l.searchButtonToggle,1==l.searchButtonToggle&&l.populateGvarDefaultValueList()},l.populateGvarDefaultValueList=function(){try{l.defaultValueList=[],angular.forEach(l.modal.selectedDashboard.json.Dashboard[l.modal.layoutType].Object,function(e){l.defaultValueList=$.merge(l.defaultValueList,e.variable.DefaultValues.DefaultValue)})}catch(e){}},l.toggleObjOptions=function(e){e=$(e.target);l.displayFnOptions=!1,e.hasClass("bvz-display")||e.hasClass("bvz-display-placeholder")||e.hasClass("glyphicon")?l.displayObjOptions?(l.displayObjOptions=!1,l.objQuery=""):(l.displayObjOptions=!0,setTimeout(function(){$(".bvz-search").focus()})):e.hasClass("bvz-search")||(l.displayObjOptions=!1,l.objQuery="")},l.updateSelectedObjSearch=function(e,o){l.selectedObj=o},l.updateSelectedValueInSearch=function(e,o){l.selectedGlobalVariable=o},l.secureRequestErrorHandler=function(e,o){0===e.status&&(b.closeAllNotifications(),clearTimeout(l.timeout),$.unblockUI(),$("#sessionWarning").modal("show"))},l.HOTKEY_CONFIGs=[{name:"createNewDashboard",config:{combo:"alt+ctrl+n",description:"Create new dashboard",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.createNewDashboard(!0)}}},{name:"OpenDashboard",config:{combo:"ctrl+o",description:"Open dashboard from local",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.isMainMenuVisible=!0,l.HandleBrowseClick("browseBVZXDashboard"),l.isMainMenuVisible=!0}}},{name:"SaveDashboard",config:{combo:"ctrl+s",description:"Save dashboard",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.saveDashboard()}}},{name:"SaveAsDashboard",config:{combo:"ctrl+shift+s",description:"SaveAs dashboard",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.openSaveAsDialog()}}},{name:"SaveToLocalDiskDashboard",config:{combo:"alt+ctrl+s",description:"Save to local disk dashboard",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.exportCurrentDashboard()}}},{name:"ManageComponentGroup",config:{combo:"ctrl+g",description:"Manage component groups",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.modal.selectedDashboard}}},{name:"CopyComponentJson",config:{combo:"ctrl+j",description:"Copy component json",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.copyComponentJson()}}},{name:"Undo",config:{combo:"ctrl+z",description:"Undo the property change",callback:function(e){if("AbsoluteLayout"==l.modal.layoutType){if(l.isAnyModalDialogActive())return!1;e.preventDefault();var a=l.modal.currentHistoryProperties();if(0<=a.historyStackPointer&&(a.skipHistoryRegister=!0,"oldComp"!==a.historyActiveStack[a.historyStackPointer].action)){for(var o=0;o<a.compHistory.length;o++){var t=a.historyActiveStack[a.historyStackPointer].object.objectID;if(t===Object.keys(a.compHistory[o])[0]){var s,n,r=a.compHistory[o][t].length-2;void 0===a.historyActiveStack[a.historyStackPointer].executionID?angular.forEach(l.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,function(e,o){e.objectID==a.historyActiveStack[a.historyStackPointer].object.objectID&&(l.toggleRemoveComponentWindow(e.objectID),l.removeComponentbyId(e.objectID))}):"delete"===a.historyActiveStack[a.historyStackPointer].action?(n=(s=a.historyStack[a.historyStackPointer].object).designData,l.onDropComplete(n,"redo",s)):-1<r&&l.executeHistory(a.compHistory[o][t][r]),a.compHistory[o][t].pop();break}}a.historyActiveStack.pop(),a.historyStackPointer--}a.skipHistoryRegister=!1,l.modal.currentHistoryProperties(a)}}}},{name:"ReDo",config:{combo:"ctrl+y",description:"Redo the property change",callback:function(e){if("AbsoluteLayout"==l.modal.layoutType){if(l.isAnyModalDialogActive())return!1;e.preventDefault();var a=l.modal.currentHistoryProperties();if(a.historyStackPointer<a.historyStack.length-1&&(a.skipHistoryRegister=!0,a.historyStackPointer++,"oldComp"!==a.historyStack[a.historyStackPointer].action)){a.historyActiveStack.push(a.historyStack[a.historyStackPointer]);for(var o,t=0;t<a.compHistory.length;t++){var s=a.historyStack[a.historyStackPointer].object.objectID;if(s===Object.keys(a.compHistory[t])[0]){a.compHistory[t][s].push(a.historyStack[a.historyStackPointer]);break}}void 0===a.historyStack[a.historyStackPointer].executionID?(o=(e=a.historyStack[a.historyStackPointer].object).designData,l.onDropComplete(o,"redo",e)):"delete"===a.historyStack[a.historyStackPointer].action?angular.forEach(l.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.Object,function(e,o){e.objectID==a.historyActiveStack[a.historyStackPointer].object.objectID&&(l.toggleRemoveComponentWindow(e.objectID),l.removeComponentbyId(e.objectID))}):l.executeHistory(a.historyActiveStack[a.historyStackPointer])}a.skipHistoryRegister=!1,l.modal.currentHistoryProperties(a)}}}},{name:"SelectAll",config:{combo:"ctrl+a",description:"Select all components",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.selectAllComponents()}}},{name:"DeleteComponent",config:{combo:"del",description:"Delete selected component(s)",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.modal.listOfSelectedComponents&&0<l.modal.listOfSelectedComponents.length&&"AbsoluteLayout"==l.modal.layoutType&&l.doYouWantToDeleteAll()}}},{name:"MoveLeft",config:{combo:"left",description:"Move selected component left by one pixel",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.multiSelected&&l.removeMultiSelectedWrapDiv();var s="";$.each(l.modal.listOfSelectedComponents,function(e,o){var a,t;s=null==l.component?l.getComponentbyId(o):l.component,IsBoolean(s.showLocked)||0!=(t=$("#dcc_"+l.modal.listOfSelectedComponents[e]).position().left-1)&&(a=t+$("#dcc_"+l.modal.listOfSelectedComponents[e]).width(),t={attributeName:"x",propertyName:"Object",type:"Number",value:t},l.modal.selectedComponentId=o,t.value=a-$("#dcc_"+l.modal.listOfSelectedComponents[e]).width(),l.updateObjectWithPropertyValue(t),l.initPropertyPalette(l.modal.listOfSelectedComponents[e]),o=l.getComponentbyId(l.modal.selectedComponentId),l.redrawComponent(o))}),l.multiSelected&&l.multiSelectDragConfiguration()}}},{name:"MoveRight",config:{combo:"right",description:"Move selected component right by one pixel",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.multiSelected&&l.removeMultiSelectedWrapDiv();var s=l.modal.selectedDashboard.id,n="";$.each(l.modal.listOfSelectedComponents,function(e,o){var a,t;n=null==l.component?l.getComponentbyId(o):l.component,IsBoolean(n.showLocked)||(t=$("#dcc_"+l.modal.listOfSelectedComponents[e]).position().left,a=$("#"+s).width(),t+$("#dcc_"+l.modal.listOfSelectedComponents[e]).width()<a&&(a=t+$("#dcc_"+l.modal.listOfSelectedComponents[e]).width()+1,t={attributeName:"x",propertyName:"Object",type:"Number",value:t},l.modal.selectedComponentId=o,t.value=a-$("#dcc_"+l.modal.listOfSelectedComponents[e]).width(),l.updateObjectWithPropertyValue(t),l.initPropertyPalette(l.modal.listOfSelectedComponents[e]),componentJSON=l.getComponentbyId(l.modal.selectedComponentId),l.redrawComponent(componentJSON)))}),l.multiSelected&&l.multiSelectDragConfiguration()}}},{name:"MoveUp",config:{combo:"up",description:"Move selected component up by one pixel",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),l.multiSelected&&l.removeMultiSelectedWrapDiv();var t="";$.each(l.modal.listOfSelectedComponents,function(e,o){var a;t=null==l.component?l.getComponentbyId(o):l.component,IsBoolean(t.showLocked)||0!=(a="AbsoluteLayout"!==l.modal.layoutType?$("#dcc_"+l.modal.listOfSelectedComponents[e])[0].offsetTop-1:$("#dcc_"+l.modal.listOfSelectedComponents[e]).position().top-1)&&(a={attributeName:"y",propertyName:"Object",type:"Number",value:a},l.modal.selectedComponentId=o,l.updateObjectWithPropertyValue(a),l.initPropertyPalette(l.modal.listOfSelectedComponents[e]),componentJSON=l.getComponentbyId(l.modal.selectedComponentId),l.redrawComponent(componentJSON))}),l.multiSelected&&l.multiSelectDragConfiguration()}}},{name:"MoveDown",config:{combo:"down",description:"Move selected component down by one pixel",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault();var s=l.modal.selectedDashboard.id,n="";l.multiSelected&&l.removeMultiSelectedWrapDiv(),$.each(l.modal.listOfSelectedComponents,function(e,o){var a,t;n=null==l.component?l.getComponentbyId(o):l.component,IsBoolean(n.showLocked)||(t="AbsoluteLayout"!==l.modal.layoutType?$("#dcc_"+l.modal.listOfSelectedComponents[e])[0].offsetTop:$("#dcc_"+l.modal.listOfSelectedComponents[e]).position().top,a=$("#"+s).height(),t+$("#dcc_"+l.modal.listOfSelectedComponents[e]).height()<a&&(a=t+$("#dcc_"+l.modal.listOfSelectedComponents[e]).height(),t={attributeName:"y",propertyName:"Object",type:"Number",value:t},l.modal.selectedComponentId=o,t.value=a-$("#dcc_"+l.modal.listOfSelectedComponents[e]).height()+1,l.updateObjectWithPropertyValue(t),l.initPropertyPalette(l.modal.listOfSelectedComponents[e]),componentJSON=l.getComponentbyId(l.modal.selectedComponentId),l.redrawComponent(componentJSON)))}),l.multiSelected&&l.multiSelectDragConfiguration()}}},{name:"SendToBack",config:{combo:"ctrl+b",description:"Send selected component back one step",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),0==l.modal.listOfSelectedComponents.length?b.showNotification("Select a component","alert-warning",3e3):1==l.modal.listOfSelectedComponents.length?l.sendToBack():b.showNotification("Please select only one component","alert-warning",3e3)}}},{name:"SendBackward",config:{combo:"ctrl+shift+b",description:"Send selected component backward at the end",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),0==l.modal.listOfSelectedComponents.length?b.showNotification("Select a component","alert-warning",3e3):1==l.modal.listOfSelectedComponents.length?l.sendBackward():b.showNotification("Please select only one component","alert-warning",3e3)}}},{name:"BringToFront",config:{combo:"ctrl+f",description:"Bring to front",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),0==l.modal.listOfSelectedComponents.length?b.showNotification("Select a component","alert-warning",3e3):1==l.modal.listOfSelectedComponents.length?l.bringToFront():b.showNotification("Please select only one component","alert-warning",3e3)}}},{name:"BringForward",config:{combo:"ctrl+shift+f",description:"Bring selected component forward at the front",callback:function(e){if(l.isAnyModalDialogActive())return!1;e.preventDefault(),0==l.modal.listOfSelectedComponents.length?b.showNotification("Select a component","alert-warning",3e3):1==l.modal.listOfSelectedComponents.length?l.bringForward():b.showNotification("Please select only one component","alert-warning",3e3)}}}];for(var t=0;t<l.HOTKEY_CONFIGs.length;t++)e.add(l.HOTKEY_CONFIGs[t].config);l.restrictInput=function(e,o){var a=8,t=13,s=35,n=36,r=37,l=38,i=39,d=40,c=46,u=(e=e||window.event).which||e.keyCode,p=String.fromCharCode(u);if(cursorPos=e.target.selectionStart,beforeStr=e.target.value,afterStr=beforeStr.substr(0,cursorPos)+p+beforeStr.substr(cursorPos),u!=a&&u!=t&&u!=r&&u!=i&&u!=l&&u!=d&&u!=s&&u!=n&&u!=c&&null!=o)switch(o){case"positiveNumberOnly":(m=/\d/).test(p)&&"-"!=p||(b.showNotification("Only positive numbers are allowed","alert-info",3e3),e.preventDefault());break;case"fieldName":var m=/^[a-zA-Z_][a-zA-Z_0-9]*$/i;""==p||m.test(afterStr)||(b.showNotification("Space or special character not allowed","alert-info",3e3),e.preventDefault())}},l.validateInput=function(a,e){var t=(a=a||window.event).target.value,s=t;if(null!=e)switch(e){case"borderThickness":10<s&&setTimeout(function(){n("Border thickness should not be greater than 10").then(function(e){b.showNotification(e,"alert-warning",3e3);for(var o=0;o<t.length;o++)10<s&&(s=s.substring(0,s.length-1));a.target.value=s})},100);break;case"fieldName":}}}])}(),angular.module("designer").controller("DesignerPropertyController",["$scope","$rootScope","ServiceFactory",function(t,e,o){t.isBoxVisible=!1,t.rcc="",t.bizVizRightControlComponentBoxContainerWidth=270,t.bvzRCBoxWidth=t.bizVizRightControlComponentBoxContainerWidth-5,t.reloadDefault=function(e){if($(".sp-cancel").click(),t.removeMenuSelection(),""==e||null==e){try{$("input,textarea").blur()}catch(e){}$("#compBox").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#variableBox").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#DashboardPropertyPalette").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#DataSourceContainer").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#objectBrowser").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#DatasetPalette").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#FnWindow").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),t.isBoxVisible=!1}else t.isBoxVisible&&$("#"+e).hasClass("hideBox")&&($("#compBox").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#variableBox").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#DashboardPropertyPalette").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#DataSourceContainer").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#objectBrowser").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#DatasetPalette").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),$("#FnWindow").removeClass("showBox").addClass("hideBox").addClass("bvz-invisible"),t.isBoxVisible=!1);$(".dashboardContents").css({width:"100%"}),t.isSelectedDashboardResponsive()&&!$.isEmptyObject(t.modal.propertyJsonList)&&setTimeout(t.reDrawActiveDashboard,10)},e.$on("collapsePropertyWindows",t.collapsePropertyWindows),t.collapsePropertyWindows=function(e){null!=e.target.parentElement&&($("#"+e.target.id).hasClass("draggablesParentDiv")||$("#"+e.target.parentElement.id).hasClass("draggableWidgetDiv")||27==e.which)&&t.isBoxVisible&&t.reloadDefault("")},t.setMenuSelection=function(e){t.removeMenuSelection();t.modal.userPreference;var o="#C5B5FE";$(e+" div").css({opacity:"0.8","border-left":"3px solid"+o}),$(e).css({background:"#ffffff"}),$(e+" a i").css({color:o})},t.removeMenuSelection=function(){$(".mainTabIcon div").css({opacity:"1","border-left":"0px"}),$(".mainTabIcon").css({background:"#434344"}),$(".mainTabIcon div a i").css({color:"#ffffff"})},t.toggleHeader=function(){o.closeAllNotifications(),-1!=$("#toggleHeader a md-icon").attr("class").search("nt-expand-icon")?$("#toggleHeader a md-icon").removeClass("nt-expand-icon").addClass("nt-resize-small-icon"):$("#toggleHeader a md-icon").removeClass("nt-resize-small-icon").addClass("nt-expand-icon"),document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},t.toggleDataSource=function(){o.closeAllNotifications(),t.reloadDefault("DataSourceContainer"),t.isBoxVisible?(t.removeMenuSelection(),$("#DataSourceContainer").removeClass("showBox").addClass("hideBox"),$("#DataSourceContainer").addClass("bvz-invisible"),t.isBoxVisible=!1):(t.setMenuSelection("#toggleDatasource"),$("#DataSourceContainer").removeClass("bvz-invisible"),$("#DataSourceContainer").removeClass("hideBox").addClass("showBox"),t.isBoxVisible=!0)},t.toggleComponents=function(){o.closeAllNotifications(),t.reloadDefault("compBox"),t.isBoxVisible?(t.removeMenuSelection(),$("#compBox").removeClass("showBox").addClass("hideBox"),$("#compBox").addClass("bvz-invisible"),$(".dashboardContents").css({width:"100%"}),t.isBoxVisible=!1):(t.setMenuSelection("#toggleCompContainer"),$("#compBox").removeClass("bvz-invisible"),$("#compBox").removeClass("hideBox").addClass("showBox"),$(".dashboardContents").css({width:"calc( 100% - "+t.bvzRCBoxWidth+"px )"}),t.setFocusOnInput("#compBox","#compSearch"),t.isBoxVisible=!0,""==$("select#typeCombo :selected").text()&&$("select#typeCombo").val(""))},t.objectBrowserWindow=function(){o.closeAllNotifications(),t.reloadDefault("objectBrowser"),t.isBoxVisible?(t.removeMenuSelection(),$("#objectBrowser").removeClass("showBox").addClass("hideBox"),$("#objectBrowser").addClass("bvz-invisible"),$(".dashboardContents").css({width:"100%"}),t.isBoxVisible=!1):(t.setMenuSelection("#toggleObjectBrowser"),$("#objectBrowser").removeClass("bvz-invisible"),$("#objectBrowser").removeClass("hideBox").addClass("showBox"),$(".dashboardContents").css({width:"calc( 100% - "+t.bvzRCBoxWidth+"px )"}),t.isBoxVisible=!0)},t.toggleVariableWindow=function(e){o.closeAllNotifications(),void 0!==e&&(t.selectedtab="0"!==e),t.reloadDefault("variableBox"),t.isBoxVisible?(t.removeMenuSelection(),$("#variableBox").removeClass("showBox").addClass("hideBox"),$("#variableBox").addClass("bvz-invisible"),t.isBoxVisible=!1):(t.setMenuSelection("#toggleVarWin"),$("#variableBox").removeClass("bvz-invisible"),$("#variableBox").removeClass("hideBox").addClass("showBox"),t.isBoxVisible=!0,t.resetComponentAttributesList())},t.toggleDashboardPropertyPalette=function(e){o.closeAllNotifications(),t.reloadDefault("DashboardPropertyPalette"),t.removeMenuSelection(),t.rcc==e&&t.isBoxVisible||($("#DashboardPropertyPalette").removeClass("bvz-invisible"),$("#DashboardPropertyPalette").removeClass("hideBox").addClass("showBox"),$(".dashboardContents").css({width:"calc( 100% - "+t.bvzRCBoxWidth+"px )"}),t.isBoxVisible=!0)},t.toggleDatasetPalette=function(e){o.closeAllNotifications(),t.removeMenuSelection(),t.reloadDefault("DatasetPalette"),t.rcc==e&&t.isBoxVisible?($("#DatasetPalette").removeClass("showBox").addClass("hideBox"),$("#DatasetPalette").addClass("bvz-invisible"),$(".dashboardContents").css({width:"100%"}),t.isBoxVisible=!1):($("#DatasetPalette").removeClass("bvz-invisible"),$("#DatasetPalette").removeClass("hideBox").addClass("showBox"),$(".dashboardContents").css({width:"calc( 100% - "+t.bvzRCBoxWidth+"px )"}),t.isBoxVisible=!0)},t.toggleFnWindow=function(e){t.removeMenuSelection(),t.reloadDefault("FnWindow"),t.rcc==e&&t.isBoxVisible?($("#FnWindow").removeClass("showBox").addClass("hideBox"),$("#FnWindow").addClass("bvz-invisible"),t.isBoxVisible=!1):($("#FnWindow").removeClass("bvz-invisible"),$("#FnWindow").removeClass("hideBox").addClass("showBox"),t.isBoxVisible=!0),t.isBoxVisible&&t.resetFunctionWindow("",!0,"Component")},t.deleteLayoutModalPopup=function(e){"AbsoluteLayout"!=e&&""!=e&&("MobileLayout"==e?t.showModelPopup("deleteMobileViewConfirmation"):t.showModelPopup("deleteTabletViewConfirmation"))},t.deleteLayout=function(e,o){var a;o==t.modal.layoutType&&(o=t.modal.selectedDashboard.json.Dashboard[t.modal.layoutType].Object.length,a=t.modal.selectedDashboard.json.Dashboard[t.modal.layoutType].pinedObject.length,t.modal.selectedDashboard.json.Dashboard[t.modal.layoutType].pinedObject.splice(0,a),t.modal.selectedDashboard.json.Dashboard[t.modal.layoutType].Object.splice(0,o),t.switchDashboardView("Desktop"))}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("DPController",["$scope","$timeout","ServiceFactory",function(i,e,s){i.sheetsMap={},i.modal.connectorConfig.connectors=null,i.activeNodeId="",i.displayOptions=!1,i.selectedDataSource={web:"",pa:"",ds:"",datasheet:""},i.selectedQuery={web:"",pa:"",ds:"",datasheet:""},i.entitySetsJson={},i.selectedConnection="",s.getJsonFileData("./resources/data/connectors.data",function(e){if(IsBoolean(s.AUTH_INFO.get("lite"))&&e)for(var o=0;o<e.length;o++)"pa"==e[o].type&&(e[o].enabled=!1);i.modal.connectorConfig.connectors=e}),i.initDataManager=function(){i.dmUiActive={conn:{isUiActive:!1}}},i.removeHighlighterFromAllConnection=function(){i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL.map(function(e){e.isUiActive=!1})},i.onFieldSelectAll=function(){angular.forEach(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet,function(e){e.added=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedAllAvailable,i.onFieldCheckBoxClick(e)}),i.createWhereClause()},i.onConditionCheckBoxClick=function(e,o){IsBoolean(e.added)&&(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.allConditionSelected=!1),!IsBoolean(o)&&null!=o||i.createWhereClause()},i.createWhereClause=function(){var o=[],a={};angular.forEach(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet,function(e){IsBoolean(e.added)?(o.push(e.name+"="+e.condition),a[e.name]=e.condition):delete a[e.name]}),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.WhereClause.Con={},i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.WhereClause.Con.Clause=o.toString(),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.WhereClause.Con.ClauseMap=a},i.onConditionSelectAll=function(){angular.forEach(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet,function(e){e.added=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.allConditionSelected,i.onConditionCheckBoxClick(e)})},i.onFieldCheckBoxClick=function(e){e.added?(DesignerUtil.prototype.pushToArrayWithoutDuplicate(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet,"name",e),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet.length==i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet.length&&(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedAllAvailable=!0)):(DesignerUtil.prototype.deleteFromArray(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet,e),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedAllAvailable=!1,i.modal.removeFieldFromDataSet(e.name,e.dataSource))},i.changeToDefaultSelect_OnLoadScript=function(){e(function(){$(".sel_InternalFunctionScrptOnLoad").prop("selectedIndex",-1)},500)},i.handleCxtMenuOpnSelection=function(e){var o,e=e.item.label,a=i.activeNodeId,t=DesignerUtil.prototype.findInArray(i.modal.connectorConfig.connectors,"id",a);switch(e){case"Add-Connection":i.addNewConnection(t);break;case"Delete":o=DesignerUtil.prototype.findInArray(i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,"id",a),i.deleteConnection(o)}},i.onNodeSelect=function(e,o){o=o.node.id;switch(i.activeNodeId=o){case"csv_connection":case"excel_connection":case"webservice_connection":i.connectorCxtMenu={"Add-Connection":{label:"Add-Connection",action:function(e){i.handleCxtMenuOpnSelection(e)}}};break;default:i.connectorCxtMenu={Delete:{label:"Delete",action:function(e){i.handleCxtMenuOpnSelection(e)}}}}"csv_connection"!=o&&"excel_connection"!=o&&"webservice_connection"!=o&&i.setConnectionSelected(DesignerUtil.prototype.findInArray(i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,"id",o))},i.validateConnection=function(e){e&&!e.connectionName.trim()&&(s.showNotification("Connection name can not be empty","alert-warning",3e3),e.connectionName="Connection-"+e.id.split("_")[1])},i.updateConnectionTree=function(e){var o=i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL;DesignerUtil.prototype.findInArray(o,"id",e.id).text=e.connectionName,i.modal.notifyConnectionListChange()},i.setConnectionSelected=function(e){i.clearObjectSearchKey(),i.changeToDefaultSelect_OnLoadScript(),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection=e;var o=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,a=i.modal.selectedDashboard.id;null==i.sheetsMap[a+""+o]&&(i.sheets=[],i.sheets[i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.sheet]=[],i.sheetsMap[a+""+o]=i.sheets),i.$broadcast("connectionSelected",e),i.modal.updateDashboardStatus(1)},i.setSelectedConnList=function(e,o){e&&(e.stopImmediatePropagation(),e=o,i.dmUiActive.conn.isUiActive=!1,i.removeHighlighterFromAllConnection(),e.isUiActive=!0,i.dmUiActive.conn=e)},i.displayConnectorInfo=function(e){""!=i.modal.selectedDashboard?$("#connectorInfoDialog").modal("show"):s.showNotification("No dashboard present","alert-warning",3e3)},i.addNewConnection=function(e){e.state={opened:!0,disabled:!1,selected:!0},""!=i.modal.selectedDashboard?(i.selectedConnection=i.getNewDataURLObject(),i.setDefaultPropertiesToConnection(e),i.selectedConnection.typeSpecifier==e.name&&(i.selectedConnection.id,i.selectedConnection.connectionName,e.id),i.pushToDataURLArray(i.selectedConnection),i.setConnectionSelected(i.selectedConnection),i.removeHighlighterFromAllConnection(),i.selectedConnection.isUiActive=!0,i.modal.notifyConnectionListChange(),s.showNotification(i.selectedConnection.connectionName+" has been created","alert-info",3e3)):s.showNotification("No dashboard present","alert-warning",3e3)},i.setDefaultPropertiesToConnection=function(e){var o=i.modal.getUniqueConnectionID("C");i.selectedConnection.id=o,i.selectedConnection.connectionName="Connection-"+o.slice(2),i.selectedConnection.typeSpecifier=e.name,i.selectedConnection.Type=e.type,i.selectedConnection.variable=i.getNewVariableJson({}),i.selectedConnection.variable.Key=i.selectedConnection.id,i.selectedConnection.calculatedFieldList=[]},i.deleteConnection=function(e){var o=e.id,a=i.getDataURLArray(),t=a.indexOf(e);i.deleteConnectionReferences(o),i.modal.removeDataSetFromComponentObjects(o),i.modal.removeDatafromOfflineData(o),i.modal.removeDatasetExpressions(o),(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection=a).splice(t,1),i.modal.notifyConnectionListChange(),s.showNotification(e.connectionName+" has been deleted","alert-info",3e3)},i.addDataToOffLineData=function(e){var o=i.modal.selectedDashboard.json.Dashboard.OffLineData.Data;if(0<o.length){for(var a=!0,t=0;t<o.length;t++)if(o[t].id==e.id){i.modal.selectedDashboard.json.Dashboard.OffLineData.Data.splice(t,1,e),a=!1;break}a&&i.modal.selectedDashboard.json.Dashboard.OffLineData.Data.push(e)}else i.modal.selectedDashboard.json.Dashboard.OffLineData.Data.push(e)},i.getNewDataURLObject=function(){return angular.copy(i.modal.selectedDashboard.json.DataProviders_DataURL,"")},i.getDataURLFromMainJSON=function(a){return $.grep(i.getDataURLArray(),function(e,o){return e.id==a})[0]},i.getDataURLArray=function(){return null!=i.modal.selectedDashboard.json?i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL:[]},i.pushToDataURLArray=function(e){i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL.push(e)},i.deleteConnectionReferences=function(e){},i.toggleNode=function(e){},i.createNewCalculatedField=function(){i.calcFieldMode="Create";var e=i.getCalcFieldName(i.modal.selectedDashboard.json.Dashboard.DatasetExpressions.DatasetExpression,"CalcField");i.modal.calcFieldConfig={selectedDataSetExpressionName:e,selectedDataSetExpressionRename:e,selectedDataSetExpressionId:e,selectedDataSetExpressionScript:"",selectedDataSetExpressionVariables:{variable:[]},alreadyExist:!1,alreadyExistWarning:""},i.showModelPopup("calculatedFieldModel")},i.updateCalculatedFieldList=function(e){var o=i.isCalcFieldExists(i.modal.calcFieldConfig.selectedDataSetExpressionId,i.modal.calcFieldConfig.selectedDataSetExpressionName);if(IsBoolean(o[0])){i.modal.selectedDashboard.json.Dashboard.DatasetExpressions.DatasetExpression[o[1]].name=i.modal.calcFieldConfig.selectedDataSetExpressionName,i.modal.selectedDashboard.json.Dashboard.DatasetExpressions.DatasetExpression[o[1]].expressionScript.cdata=i.modal.calcFieldConfig.selectedDataSetExpressionScript,i.modal.selectedDashboard.json.Dashboard.DatasetExpressions.DatasetExpression[o[1]].variables=i.modal.calcFieldConfig.selectedDataSetExpressionVariables;for(var a=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList.indexOf(i.selectedField),t=i.modal.selectedDashboard.json.Dashboard[i.modal.layoutType].Object,s=0;s<t.length;s++){var n=t[s].subElement;if(null!=t[s][n].DataSet)for(var r=0;r<t[s][n].DataSet.Fields.length;r++)t[s][n].DataSet.Fields[r].Name==i.selectedField.name&&(t[s][n].DataSet.Fields[r].Name=e,t[s][n].DataSet.Fields[r].DisplayName=e,t[s][n].DataSet.Fields[r].expressionID=e,t[s][n].DataSet.Fields[r].fieldname=e,t[s][n].DataSet.Fields[r].displayname=e)}i.selectedField.name=e,i.selectedField.id=e,i.modal.selectedDashboard.json.Dashboard.DatasetExpressions.DatasetExpression[o[1]].name=e,i.modal.selectedDashboard.json.Dashboard.DatasetExpressions.DatasetExpression[o[1]].id=e,i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList[a].name=e,i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList[a].id=e,i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList[a].expressionScript.cdata=i.modal.calcFieldConfig.selectedDataSetExpressionScript}else{o=i.getNewDatasetExpressionObject();o.id=e,o.dataSource=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,o.name=e,o.expressionScript.cdata=i.modal.calcFieldConfig.selectedDataSetExpressionScript,o.variables=i.modal.calcFieldConfig.selectedDataSetExpressionVariables,i.modal.selectedDashboard.json.Dashboard.DatasetExpressions.DatasetExpression.push(o),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList.push(o)}},i.checkExist=function(e,o){var a=i.isCalcFieldExistDataSet(o,o);IsBoolean(a[0])||""==o?(i.modal.calcFieldConfig.alreadyExist=!0,i.modal.calcFieldConfig.alreadyExistWarning=""===o?"Name cannot be empty":"'"+o+"' already exists"):(i.modal.calcFieldConfig.alreadyExist=!1,i.modal.calcFieldConfig.alreadyExistWarning="")},i.editCalculatedField=function(e){i.calcFieldMode="Update",i.modal.calcFieldConfig=i.modal.calcFieldConfig||{},i.modal.calcFieldConfig={selectedDataSetExpressionName:i.modal.replaceCFSpecialCharWithUnderscore(e.name),selectedDataSetExpressionRename:i.modal.replaceCFSpecialCharWithUnderscore(e.name),selectedDataSetExpressionId:e.id,selectedDataSetExpressionScript:e.expressionScript.cdata,selectedDataSetExpressionVariables:e.variables,alreadyExist:!1,alreadyExistWarning:""},i.selectedField=e;for(var o=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList,a=0;a<o.length;a++)o[a].id==e.id&&(i.modal.calcFieldConfig.selectedDataSetExpressionScript=o[a].expressionScript.cdata);i.showModelPopup("calculatedFieldModel")},i.deleteCalculatedField=function(e){var o=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList.indexOf(e);i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList.splice(o,1),i.modal.removeFieldFromDataSet(e.name,e.dataSource)},i.getNewDatasetExpressionObject=function(){return angular.copy(i.modal.selectedDashboard.json.DatasetExpressions_DatasetExpression,"")},i.getCalcFieldName=function(e,o){for(var a=o+(+e.length+1),t=i.modal.checkIDUsed(e,"name",a);t;)a=o+"_"+randomChar(2),t=i.modal.checkIDUsed(e,"name",a);return a},i.isCalcFieldExistDataSet=function(e,o){for(var a=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList,t=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet,s=[],n=0;n<t.length;n++)s.push(t[n]);for(var r=0;r<a.length;r++)s.push(a[r]);for(var l=0;l<s.length;l++)if(s[l].name==o)return[!0,l];return[!1,""]},i.isCalcFieldExists=function(e,o){for(var a=i.modal.selectedDashboard.json.Dashboard.DatasetExpressions.DatasetExpression,t=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList,s=0;s<a.length;s++)for(var n=0;n<t.length;n++)if(a[s].id==e&&a[s].dataSource==t[n].dataSource)return[!0,s];return[!1,""]},i.getNewDatasetExpressionVariablesObject=function(){return angular.copy(i.modal.selectedDashboard.json.DatasetExpressions_DatasetExpression_variables_variable,"")},i.addNewCalculatedFieldVariable=function(){var e=i.getNewDatasetExpressionVariablesObject();e.name=i.getCalcFieldName(i.modal.calcFieldConfig.selectedDataSetExpressionVariables.variable,"x"),e.value="0",i.modal.calcFieldConfig.selectedDataSetExpressionVariables.variable.push(e)},i.deleteCalculatedFieldVariable=function(e){e=i.modal.calcFieldConfig.selectedDataSetExpressionVariables.variable.indexOf(e);i.modal.calcFieldConfig.selectedDataSetExpressionVariables.variable.splice(e,1)},i.deleteAllCalculatedFieldVariable=function(){i.modal.calcFieldConfig.selectedDataSetExpressionVariables.variable=[]},i.delCalculatedField=function(e,o){i.calcFieldToRemove=e,i.showModelPopup("deleteCalcFieldConfirmation")},i.handleCalcFieldDeleteAlertConfirmation=function(e,o){"DEL-CAlCFIELD"==o&&i.deleteCalculatedField(i.calcFieldToRemove)},i.onConditionTextBoxUpdate=function(e){""===e.condition&&(e.added=!1),i.createWhereClause(e),i.displayOptions=!1},i.updateSelectedValue=function(e,o,a){a.condition=o.actualTag,i.onConditionTextBoxUpdate(a)},i.getCompName=function(e){var o=e.displayTag.split(".")[0],o=(e.objectName="",e.referenceID="",i.getComponentbyReferenceId(o));return o?(e.objectName=o.objectName,e.referenceID=o.referenceID,o.objectName):""},i.toggleGlobalVarOptions=function(e,o,a){e=$(e.target);i.setSelectedItem=o.name+a,e.hasClass("bvz-display-placeholder")||e.hasClass("bvz-display")||e.hasClass("condition-gv-picker")?i.displayOptions?(i.displayOptions=!1,i.defValQuery=""):(i.displayOptions=!0,setTimeout(function(){$(".bvz-search").focus()})):e.hasClass("bvz-search")||(i.displayOptions=!1,i.defValQuery="")}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("CSVController",["$scope","$timeout","ServiceFactory",function(u,e,t){u.getFileContent=function(e){var o,a;".csv"==e.fileName.substring(e.fileName.length-4,e.fileName.length).toLowerCase()?""!=e.fileData?(a=u.convertCSVToArray(e.fileData),o=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url,o=e.fileName==o,u.updateDashboardJson(e,a,o),o?(e=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet,a=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList,u.modal.removeChangedFieldFromAvailableDataSet(e,a)):u.modal.refreshDataUrlAvailableDataSet()):t.showNotification("This CSV file does not have data","alert-warning",3e3):t.showNotification("File type is not supported","alert-danger",3e3),$("#"+u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id)[0].value=""},u.$on("connectionSelected",function(e,o){u.selectionChangeToCsv(o.typeSpecifier)}),u.onInitCsv=function(){},u.selectionChangeToCsv=function(e){"csv"==e&&pasteElementChange("txt_UserScript_csv")},u.convertCSVToArray=function(e){for(var o=new RegExp('(\\,|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\,\\r\\n]*))',"gi"),a=[[]],t=null;t=o.exec(e);){var s=t[1];s.length&&","!==s&&a.push([]),s=t[2]?t[2].replace(new RegExp('""',"g"),'"'):t[3],a[a.length-1].push(s)}return a},u.dataFields=function(e){for(var o=[],a=0;a<e.length;a++){var t=e[a];e[a]=""+t,null==e[a]||"undefined"==e[a]||""===e[a]?o.push("_blank"+(a+1)):o.push(e[a])}return o},u.getNewFieldJSON=function(){return angular.copy(u.modal.selectedDashboard.json.DataProviders_DataURL_FieldSet,"")},u.getNewOfflineDataJSON=function(){return angular.copy(u.modal.selectedDashboard.json.OffLineData_Data,"")},u.updateDashboardJson=function(e,o,a){var t=u.dataFields(o[0]),s=(o[0]=t,u.getNewOfflineDataJSON());s.id=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,s.Records.Record=o,u.addDataToOffLineData(s),u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url=e.fileName,u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.offLineDataID=u.modal.selectedDashboard.json.Dashboard.OffLineData.Data.id,u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[],a||(u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=[]),u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.dataType="Array",u.fillAvailableFieldSet(angular.copy(t)),u.fillAvailableConditionSet(angular.copy(t))},u.fillAvailableFieldSet=function(e){var o=[];"object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0});for(var a=0;a<o.length;a++){var t=u.getNewFieldJSON();t.name=o[a],t.added=!0,u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet.push(t),u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet.push(t)}},u.fillAvailableConditionSet=function(e){for(var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),o),t=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet,s=[],n=0;n<a.length;n++)for(var r=0;r<t.length;r++)if(t[r].name.toLowerCase()==a[n].toLowerCase()){s.push(t[r]);break}u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=angular.copy(s);for(var l=0;l<a.length;l++){for(var i,d=!0,c=0;c<s.length;c++)if(s[c].name.toLowerCase()==a[l].toLowerCase()){d=!1;break}d&&((i={}).name=a[l],i.added=!1,i.condition="",u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet.push(i))}},u.updateOfflineData=function(){u.modal.selectedOffLineData.Records.Record=u.modal.selectedConnection.SelectedFields.connData}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("ExcelController",["$scope","$timeout","ServiceFactory","XLSXReaderService",function(u,e,o,a){u.selectedSheetName="",u.fieldNames="";var t=document.createElement("script");t.setAttribute("src","./resources/plugins/xlsxReader/jszip.js"),document.head.appendChild(t),(t=document.createElement("script")).setAttribute("src","./resources/plugins/xlsxReader/lodash.min.js"),document.head.appendChild(t),(t=document.createElement("script")).setAttribute("src","./resources/plugins/xlsxReader/xlsx-reader.js"),document.head.appendChild(t);(t=document.createElement("script")).setAttribute("src","./resources/plugins/xlsxReader/xlsx.js"),document.head.appendChild(t);var t=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,s=u.modal.selectedDashboard.id;null==u.sheetsMap[s+""+t]&&(u.sheets=[],u.sheets[u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.sheet]=[],u.sheetsMap[s+""+t]=u.sheets),u.$on("connectionSelected",function(e,o){u.selectionChangeToExcel(o.typeSpecifier)}),u.onInitExcel=function(){},u.selectionChangeToExcel=function(e){"excel"==e&&pasteElementChange("txt_UserScript_excel")},u.HandleBrowseClick=function(e){$("#"+e).click()},u.fileChanged=function(e){u.isProcessing=!0,u.sheets=[],".xlsx"==e[0].name.substring(e[0].name.length-5,e[0].name.length).toLowerCase()?(""!=(e||"")&&0<e.length&&(e[0].size<u.modal.userPreference.defaultLimitConfigs.excelFile?(u.excelFile=e[0],u.excelFileName=e[0].name,a.readFile(u.excelFile,!0,!1).then(function(e){u.sheets=e.sheets,u.setSelectedSheet(u.sheets),u.isProcessing=!1,u.updateJSONString(u)})):o.showNotification("File size should not exceed 3MB","alert-warning",3e3)),(e=$("#"+u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id)).replaceWith(e.val("")),u.previousConnId=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,u.previousFileName=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url,u.previousSheetName=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.sheet,u.updateDashboardJsonWhenSheetNotSelected()):o.showNotification("File Type not supported","alert-warning",3e3)},u.setSelectedSheet=function(e){var o=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id;if(u.excelFileName==u.previousFileName&&u.previousConnId==o){if(null!=e[u.previousSheetName])u.selectedSheetName=u.previousSheetName;else for(var a in u.modal.refreshDataUrlAvailableDataSet(),e)if(e.hasOwnProperty(a)){u.selectedSheetName=a;break}}else for(var t in e)if(e.hasOwnProperty(t)){u.selectedSheetName=t;break}},u.updateJSONString=function(e){u.selectedSheetName=e.selectedSheetName;var e=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,o=u.modal.selectedDashboard.id;u.sheetsMap[o+""+e]=u.sheets,null!=u.selectedSheetName?(o=u.sheets[u.selectedSheetName],e=u.dataFields(o.data[0]),u.updateDashboardJson(u.excelFileName,o,u.selectedSheetName,e),o=u.isDifferentFile(),u.setQueryfieldsAndConditions(e,o),o?u.modal.refreshDataUrlAvailableDataSet():(e=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet,o=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList,u.modal.removeChangedFieldFromAvailableDataSet(e,o))):u.updateDashboardJsonWhenSheetNotSelected()},u.updateSheet=function(){u.selectedSheetName=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.sheet;var e=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,o=u.modal.selectedDashboard.id;u.excelFileName=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url,null!=u.selectedSheetName?(o=u.sheetsMap[o+""+e][u.selectedSheetName],e=u.dataFields(o.data[0]),u.updateDashboardJson(u.excelFileName,o,u.selectedSheetName,e),o=u.isDifferentSheet(),u.setQueryfieldsAndConditions(e,o),u.modal.refreshDataUrlAvailableDataSet()):u.updateDashboardJsonWhenSheetNotSelected()},u.isDifferentFile=function(){var e=!0,o=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection;return e=u.previousFileName==u.excelFileName&&u.previousConnId==o.id?!1:e},u.isDifferentSheet=function(){var e=!0,o=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection;return e=u.previousFileName==u.excelFileName&&u.previousConnId==o.id&&u.selectedSheetName==u.previousSheetName?!1:e},u.updateDashboardJsonWhenSheetNotSelected=function(){for(var e=u.modal.selectedDashboard.json.Dashboard.OffLineData.Data,o=0;o<e.length;o++)if(e[o].id==u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id){e[o].Records.Record={};break}u.isDifferentFile()&&(u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url="",u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.sheet="",u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[],u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=[],u.modal.refreshDataUrlAvailableDataSet())},u.dataFields=function(e){var o=[];if(e)for(var a=0;a<e.length;a++){var t=e[a];e[a]=""+t,null==e[a]||"undefined"==e[a]||""===e[a]?o.push("_blank"+(a+1)):o.push(e[a])}return o},u.updateDashboardJson=function(e,o,a,t){o.data[0]=t;t=o.data,o=u.getNewOfflineDataJSON();o.id=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,o.Records.Record=t,u.addDataToOffLineData(o),u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url=e,u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.sheet=a,u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.offLineDataID=u.modal.selectedDashboard.json.Dashboard.OffLineData.Data.id},u.setQueryfieldsAndConditions=function(e,o){u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[],o&&(u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=[]),u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.dataType="Array",u.fillAvailableFieldSet(angular.copy(e)),u.fillAvailableConditionSet(angular.copy(e))},u.fillAvailableFieldSet=function(e){var o=[];"object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0});for(var a=0;a<o.length;a++){var t=u.getNewFieldJSON();t.name=o[a],t.added=!0,u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet.push(t),u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet.push(t)}},u.fillAvailableConditionSet=function(e){for(var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),o),t=u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet,s=[],n=0;n<a.length;n++)for(var r=0;r<t.length;r++)if(t[r].name.toLowerCase()==a[n].toLowerCase()){s.push(t[r]);break}u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=angular.copy(s);for(var l=0;l<a.length;l++){for(var i,d=!0,c=0;c<s.length;c++)if(s[c].name.toLowerCase()==a[l].toLowerCase()){d=!1;break}d&&((i={}).name=a[l],i.added=!1,i.condition="",u.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet.push(i))}},u.updateOfflineData=function(){u.modal.selectedOffLineData.Records.Record=u.modal.selectedConnection.SelectedFields.connData},u.getNewOfflineDataJSON=function(){return angular.copy(u.modal.selectedDashboard.json.OffLineData_Data,"")},u.getNewFieldJSON=function(){return angular.copy(u.modal.selectedDashboard.json.DataProviders_DataURL_FieldSet,"")}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("WebserviceController",["$scope","$timeout","ServiceFactory",function(c,a,n){c.queriesAvailable="",c.configCAPPMConnector={enable:!1,config:{dataSourceID:"CA",dataSourceName:"CA",dataSourceType:"",date:"",hostName:""}},c.setValueArray=[],c.$on("connectionSelected",function(e,o){c.setValueArray=[],c.reloadConnectionDetail(o.typeSpecifier)}),c.onInit=function(){c.configCAPPMConnector.enable="ca"===n.AUTH_INFO.get("authType"),c.loadUserDataSourceList(!1,function(){c.reloadConnectionDetail("web")})},c.loadUserDataSourceList=function(e,s){""==c.modal.userDataSourceList.web||IsBoolean(e)?n.postRequestToServer(req_url.designer.getDatasourceList,{},n.setupFormData({hasPublishedService:!0}),function(e,o,a,t){e.dataSources.success&&void 0!==e.dataSources.dataSourcesList?((e=DesignerUtil.prototype.getArrayOfSingleLengthJson(e.dataSources.dataSourcesList)).sort(function(e,o){e=String(e.dataSourceName).toUpperCase(),o=String(o.dataSourceName).toUpperCase();return e<o?-1:o<e?1:0}),c.configCAPPMConnector.enable?c.modal.userDataSourceList.web=[c.configCAPPMConnector.config].concat(e):c.modal.userDataSourceList.web=[].concat(e)):n.showNotification("No data source found","alert-info",3e3),c.web=JSON.parse(JSON.stringify(c.selectedDataSource.web)),c.$apply(),s&&s()},function(e,o,a,t){s&&s()}):s&&s()},c.reloadConnectionDetail=function(e){"web"==e&&(c.loadSavedSourceAndService(),pasteElementChange("txt_UserScript_Web"))},c.loadSavedSourceAndService=function(){var e;c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection&&(e=DesignerUtil.prototype.findIndexInArray(c.modal.userDataSourceList.web,"dataSourceID",c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedDataSourceID),c.modal.userDataSourceList.web[e]?(c.selectedDataSource.web=c.modal.userDataSourceList.web[e],c.resetDsCombo(c.selectedDataSource.web.$$hashKey),c.listQueries(!0,function(){c.setQueryFromMap()})):(c.resetDsCombo(""),c.resetQsCombo()))},c.setQueryFromMap=function(){if(c.setValueArray=[],c.modal.selectedDashboard&&c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection&&null!==c.selectedDataSource.web)if(c.queriesAvailable=angular.copy(c.modal.dataSourceQueryMap[c.selectedDataSource.web.dataSourceID]),c.queriesAvailable){var o=DesignerUtil.prototype.findIndexInArray(c.queriesAvailable,"queryName",c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.queryName);""!=c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedServiceID&&(o=DesignerUtil.prototype.findIndexInArray(c.queriesAvailable,"serviceId",c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedServiceID));try{c.queriesAvailable[o]?$("#d-queries")&&a(function(){var e;c.selectedQuery.web=c.queriesAvailable[o],c.queriesAvailable[o]&&null!=c.queriesAvailable[o].$$hashKey&&(c.setValueArray.push(c.queriesAvailable[o]),c.selectedQuery.web=c.setValueArray[0],e=c.setValueArray[0].$$hashKey,$("#d-queries").select2("val",e))},100):$("#d-queries")&&a(function(){$("#d-queries").select2()},100)}catch(e){}}else c.resetDsCombo("");else c.resetDsCombo("")},c.listQueries=function(e,s){var o,a;c.selectedDataSource.web=null===c.selectedDataSource.web&&null!=c.web?JSON.parse(JSON.stringify(c.web)):c.selectedDataSource.web,c.selectedDataSource.web?(a={},"CA"==(o=c.selectedDataSource.web.dataSourceID||c.selectedDataSource.web)?(a={dataSourceID:0,type:"ca"},c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.serviceType="clarityWSDL"):(a={dataSourceID:o},c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.serviceType="bizviz",c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.Type="web"),"bizviz"!==o?(c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedDataSourceID=c.selectedDataSource.web.dataSourceID,c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.dataSourceName=c.selectedDataSource.web.dataSourceName,c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.dataSourceType=c.selectedDataSource.web.dataSourceType,c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.databaseName=c.selectedDataSource.web.databaseName,c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.hostName=c.selectedDataSource.web.hostName,n.postRequestToServer(req_url.designer.listQueryServices,{},n.setupFormData(a),function(e,o,a,t){e&&e.queryServices&&e.queryServices.success&&null!=e.queryServices.queryServicesList?((e=[].concat(DesignerUtil.prototype.getArrayOfSingleLengthJson(e.queryServices.queryServicesList))).sort(function(e,o){e=String(e.queryName).toUpperCase(),o=String(o.queryName).toUpperCase();return e<o?-1:o<e?1:0}),c.queriesAvailable=e,null!=c.selectedDataSource.web&&(c.modal.dataSourceQueryMap[c.selectedDataSource.web.dataSourceID]=e),s?s():c.setQueryFromMap()):(c.queriesAvailable="",c.setQueryfieldsAndConditions(!1),c.resetQsCombo()),c.$apply()},function(){c.queriesAvailable="",c.setQueryfieldsAndConditions(!1),c.resetQsCombo(),c.$apply()})):(c.queriesAvailable="",c.setQueryfieldsAndConditions(!1),c.resetQsCombo(),c.$apply())):(c.queriesAvailable="",c.resetQsCombo())},c.setQueryfieldsAndConditions=function(e){var o;c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[],"CA"==(o=null!=c.selectedDataSource.web?c.selectedDataSource.web.dataSourceID||c.selectedDataSource.web:o)&&c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.ClarityOptionalCondition&&(c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.ClarityOptionalCondition.ClaritySort.Columns=[{sortField:"",sortDirection:""}],c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.ClarityOptionalCondition.ClaritySort.sliceIndex="",c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.ClarityOptionalCondition.ClaritySort.sliceCount=""),c.selectedQuery.web&&null!=c.selectedQuery.web.queryLink?(c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url=c.selectedQuery.web.queryLink,c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.queryName=c.selectedQuery.web.queryName,c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.nividhQueryName=c.selectedQuery.web.nividhQueryName,c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedServiceID=c.selectedQuery.web.serviceId,c.getQueryFields(),c.getQueryFilters()):e&&(c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedServiceID="")},c.getQueryFields=function(){var e={queryServiceId:c.selectedQuery.web.serviceId};n.postRequestToServer(req_url.designer.getFieldValues,{},n.setupFormData(e),function(e,o,a,t){e&&e.queryServices&&e.queryServices.success&&null!=e.queryServices.fieldName&&(c.fillAvailableFields(e.queryServices.fieldName),c.updateAvailableDataSet(),c.$apply())})},c.fillAvailableFields=function(e){var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),DesignerUtil.prototype.getArrayOfSingleLengthJson(o));c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[];for(var t=0;t<a.length;t++){var s=c.getNewFieldJSON();s.name=a[t].toLowerCase(),s.added=!0,c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet.push(s),c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet.push(s)}},c.getNewFieldJSON=function(){return angular.copy(c.modal.selectedDashboard.json.DataProviders_DataURL_FieldSet,"")},c.getQueryFilters=function(){var e={id:c.selectedQuery.web.serviceId};n.postRequestToServer(req_url.designer["CA"===c.selectedDataSource.web.dataSourceID?"getClarityFilter":"getAllFilter"],{},n.setupFormData(e),function(e,o,a,t){null==e.queryServices.filter&&(e.queryServices.filter=[]),e&&e.queryServices&&e.queryServices.success&&null!=e.queryServices.filter&&(c.fillAvailableConditionSet(e.queryServices.filter),c.$apply())})},c.fillAvailableConditionSet=function(e){for(var o=DesignerUtil.prototype.getArrayOfSingleLengthJson(e),a=c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet,t=[],s=0;s<o.length;s++)for(var n=0;n<a.length;n++)if(a[n].name.toLowerCase()==o[s].toLowerCase()){t.push(a[n]);break}c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=angular.copy(t);for(var r=0;r<o.length;r++){for(var l,i=!0,d=0;d<t.length;d++)if(t[d].name.toLowerCase()==o[r].toLowerCase()){i=!1;break}i&&((l={}).name=o[r].toLowerCase(),l.displayName=IsBoolean("_"===o[r].toLowerCase()[0])?o[r].toLowerCase().slice(1,o[r].length):o[r].toLowerCase(),l.added=!1,l.condition="",l.mandatoryField=!!IsBoolean("_"===o[r].toLowerCase()[0]),c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet.push(l))}},c.onQueryChange=function(){var e=c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url;c.isExistingServiceFlag=!1,this.isExistingService(e)?(c.isExistingServiceFlag=!0,c.setQueryfieldsAndConditions(!1)):c.setQueryfieldsAndConditions(!0)},c.isExistingService=function(e){var o;return e==(o=null!=c.selectedQuery.web?c.selectedQuery.web.queryLink:o)||(o=o?""+o.split(/[/ ]+/).pop():"",(e?""+e.split(/[/ ]+/).pop():"")==o)},c.updateAvailableDataSet=function(){var e,o;IsBoolean(c.isExistingServiceFlag)&&(e=c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet,o=c.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList,c.modal.removeChangedFieldFromAvailableDataSet(e,o))},c.resetDsCombo=function(e){if($("#d-datasources"))try{a(function(){$("#d-datasources").select2("val",e)},500)}catch(e){}},c.resetQsCombo=function(o){if($("#d-queries"))if(null!=o)try{a(function(){var e=o.$$hashKey;$("#d-queries").select2("val",e)},10)}catch(e){}else try{a(function(){$("#d-queries").select2()},10)}catch(e){}}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("PAController",["$scope","$timeout","ServiceFactory",function(i,a,n){i.formData={},i.onInit=function(){i.loadUserDataSourceList()},i.$on("connectionSelected",function(e,o){i.reloadConnectionDetail(o.typeSpecifier)}),i.reloadConnectionDetail=function(e){"pa"==e&&(i.loadSavedSourceAndService(),pasteElementChange("txt_UserScript_PA"))},i.loadUserDataSourceList=function(e){var s=[],o={consumerName:"BIZVIZ_PA",serviceName:"GET_ALL_PUBLISHED_WORKFLOW",data:JSON.stringify({isPublished:1}),isSecure:!0};null!=e||""==i.modal.userDataSourceList.pa?n.postRequestToServer(req_url.designer.pluginService,{},n.setupFormData(o),function(e,o,a,t){i.modal.userDataSourceList.pa="",e&&e.success&&null!=e.predictiveModelList?(s=s.concat(DesignerUtil.prototype.getArrayOfSingleLengthJson(e.predictiveModelList))).sort(function(e,o){e=String(e.title).toUpperCase(),o=String(o.title).toUpperCase();return e<o?-1:o<e?1:0}):(i.selectedDataSource.pa="",e&&!e.predictiveModelList&&n.showNotification("No Predictive model found","alert-info",3e3)),i.modal.userDataSourceList.pa=s,i.loadSavedSourceAndService()}):a(function(){i.loadSavedSourceAndService()},1500)},i.getSparkSettings=function(){var e={id:"",type:12,status:1,spaceKey:n.AUTH_INFO.get("spacekey"),IsSparkWorkspaceLoad:!0,settings:""},e={consumerName:"BIZVIZ_PA",serviceName:"getSettingsFromPa",data:JSON.stringify(e),isSecure:!0};n.postRequestToServer(req_url.designer.pluginService,{},n.setupFormData(e),function(e){e&&!e.hasOwnProperty("status")&&null!=e.predictiveSparkServerSettings?n.showNotification("Spark server successfully connected","alert-success",3e3):e&&!e.success?n.showNotification("Predictive spark server is not configured","alert-danger",3e3):n.showNotification("No Plugin for displaying the Predictive content, Please contact the administartor","alert-danger",3e3)})},i.loadSavedSourceAndService=function(){if(i.modal.selectedDashboard.json&&i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection&&""!==i.modal.userDataSourceList.pa){var o=DesignerUtil.prototype.findIndexInArray(i.modal.userDataSourceList.pa,"modelId",i.getDatasourceIdByConnectId(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id));try{i.modal.userDataSourceList.pa[o]?(i.selectedDataSource.pa=i.modal.userDataSourceList.pa[o],$("#d-pa-datasources")&&a(function(){var e=i.modal.userDataSourceList.pa[o].$$hashKey;$("#d-pa-datasources").select2("val",e)},0)):$("#d-pa-datasources")&&a(function(){$("#d-pa-datasources").select2("val","")},0)}catch(e){}i.$apply()}},i.getDatasourceIdByConnectId=function(e){for(var o=0;o<i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL.length;o++)if(i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL[o].id==e)return i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL[o].selectedDataSourceID;return""},i.listQueries=function(e){if(!i.selectedDataSource.pa)return i.fillAvailableFields([]),!1;var o=i.selectedDataSource.pa.modelId||i.selectedDataSource.pa,a=(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.serviceType="bizvizPA",i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.Type="web",{consumerName:"BIZVIZ_PA",serviceName:"GET_METADATA_OF_PUBLISHED_WORKFLOW",data:JSON.stringify({workflowId:""+o}),isSecure:"true"});"bizviz"!=o?(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedDataSourceID=angular.copy(i.selectedDataSource.pa.modelId),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedServiceID=angular.copy(i.selectedDataSource.pa.modelId),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.dataSourceType=angular.copy("bizvizPA"),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.queryName=angular.copy(i.selectedDataSource.pa.title),n.postRequestToServer(req_url.designer.pluginService,{},n.setupFormData(a),function(e,o,a,t){try{var s,n=[],r=[],l="";i.setQueryfieldsAndConditions(!1),e&&e.success&&null!=e.preictiveModel&&null!=e.preictiveModel.predictiveJsonDefinition&&((s=JSON.parse(e.preictiveModel.predictiveJsonDefinition)).metadata.map(function(e){n.push(e.field)}),IsBoolean(s.isSpark)?s.sparkfilterComponent&&s.sparkfilterComponent[0]&&(r=s.sparkfilterComponent[0].filterArray):s.filterComponent.map(function(e){for(var o in e.filter)r.push(o)}),s.workFlowType=e.preictiveModel.workFlowType,l=s),i.fillAvailableFields(n),i.fillAvailableConditionSet(r),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.PredictiveJsonDef=l,i.updateAvailableDataSet(),i.$apply()}catch(e){}},function(){i.fillAvailableFields([]),i.fillAvailableConditionSet([]),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.PredictiveJsonDef="",i.updateAvailableDataSet(),i.$apply()})):i.setQueryfieldsAndConditions(!1)},i.fillAvailableFields=function(e){var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),DesignerUtil.prototype.getArrayOfSingleLengthJson(o));i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[];for(var t=0;t<a.length;t++){var s=i.getNewFieldJSON();s.name=a[t],s.added=!0,i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet.push(s),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet.push(s)}},i.fillAvailableConditionSet=function(e){var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),DesignerUtil.prototype.getArrayOfSingleLengthJson(o));i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=[];for(var t=0;t<a.length;t++){var s={};s.name=a[t],s.added=!1,s.condition="",i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet.push(s)}},i.updateAvailableDataSet=function(){var e=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet,o=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList;i.modal.removeChangedFieldFromAvailableDataSet(e,o)},i.setQueryfieldsAndConditions=function(e){i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url="",i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.PredictiveJsonDef="",i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[],i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=[]},i.getNewFieldJSON=function(){return angular.copy(i.modal.selectedDashboard.json.DataProviders_DataURL_FieldSet,"")}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("DataSheetController",["$scope","$timeout","ServiceFactory",function(i,a,n){i.formData={},i.onInit=function(){i.loadUserDataSourceList()},i.$on("connectionSelected",function(e,o){i.reloadConnectionDetail(o.typeSpecifier)}),i.reloadConnectionDetail=function(e){"datasheet"==e&&(i.loadSavedSourceAndService(),pasteElementChange("txt_UserScript_DataSheet"))},i.loadUserDataSourceList=function(e){var s=[],o={consumerName:"BDBDATASHEET",serviceName:"getAllDataSheet",data:JSON.stringify({type:2}),spacekey:n.AUTH_INFO.get("spacekey")};null!=e||""==i.modal.userDataSourceList.datasheet?n.postRequestToServer(req_url.designer.pluginService,{},n.setupFormData(o),function(e,o,a,t){i.modal.userDataSourceList.datasheet="",e&&e.success&&void 0!==e.bizvizMetadatas?(s=s.concat(DesignerUtil.prototype.getArrayOfSingleLengthJson(e.bizvizMetadatas))).sort(function(e,o){e=String(e.title).toUpperCase(),o=String(o.title).toUpperCase();return e<o?-1:o<e?1:0}):(i.selectedDataSource.datasheet="",e&&!e.bizvizMetadatas&&n.showNotification("No Datasheet found","alert-info",3e3)),i.modal.userDataSourceList.datasheet=s,i.loadSavedSourceAndService()}):a(function(){i.loadSavedSourceAndService()},1500)},i.loadSavedSourceAndService=function(){if(i.modal.selectedDashboard.json&&i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection&&""!==i.modal.userDataSourceList.datasheet){var e=DesignerUtil.prototype.findIndexInArray(i.modal.userDataSourceList.datasheet,"id",i.getDatasourceIdByConnectId(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id));try{i.modal.userDataSourceList.datasheet[e]?(i.selectedDataSource.datasheet=i.modal.userDataSourceList.datasheet[e],$("#d-datasheet-datasources")&&a(function(){e=i.selectedDataSource.datasheet.$$hashKey,$("#d-datasheet-datasources").select2("val",e)},10)):$("#d-datasheet-datasources")&&a(function(){$("#d-datasheet-datasources").select2("val","")},0)}catch(e){}i.$evalAsync()}},i.getDatasourceIdByConnectId=function(e){for(var o=0;o<i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL.length;o++)if(i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL[o].id==e)return i.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL[o].selectedDataSourceID;return""},i.listQueries=function(e){if(!i.selectedDataSource.datasheet)return i.fillAvailableFields([]),!1;var o=i.selectedDataSource.datasheet.id||i.selectedDataSource.datasheet,a=(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.serviceType="bizvizdatasheet",i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.Type="datasheet",{consumerName:"BDBDATASHEET",serviceName:"getAllDataSheetById",data:JSON.stringify({id:""+o}),isSecure:"true"});"bizviz"!=o?(i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedDataSourceID=angular.copy(i.selectedDataSource.datasheet.id),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedServiceID=angular.copy(i.selectedDataSource.datasheet.id),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.dataSourceType=angular.copy("bizvizdatasheet"),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.queryName=angular.copy(i.selectedDataSource.datasheet.name),n.postRequestToServer(req_url.designer.pluginService,{},n.setupFormData(a),function(e,o,a,t){try{var s,n=[],r=[],l="";i.setQueryfieldsAndConditions(!1),e&&e.success&&null!=e.bizvizMetadata&&null!=e.bizvizMetadata.metadata&&((s=JSON.parse(e.bizvizMetadata.metadata)).columns.map(function(e){"BDB_DS_ID"!==e.title&&n.push(e.title),IsBoolean(e.filter)&&r.push(e.title)}),l=s),i.fillAvailableFields(n),i.fillAvailableConditionSet(r),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.datasheetJsonDef=l,i.updateAvailableDataSet(),i.$apply()}catch(e){}},function(){i.fillAvailableFields([]),i.fillAvailableConditionSet([]),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.datasheetJsonDef="",i.updateAvailableDataSet(),i.$apply()})):i.setQueryfieldsAndConditions(!1)},i.fillAvailableFields=function(e){var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),DesignerUtil.prototype.getArrayOfSingleLengthJson(o));i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[];for(var t=0;t<a.length;t++){var s=i.getNewFieldJSON();s.name=a[t],s.added=!0,i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet.push(s),i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet.push(s)}},i.fillAvailableConditionSet=function(e){var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),DesignerUtil.prototype.getArrayOfSingleLengthJson(o));i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=[];for(var t=0;t<a.length;t++){var s={};s.name=a[t],s.added=!1,s.condition="",i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet.push(s)}},i.updateAvailableDataSet=function(){var e=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet,o=i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList;i.modal.removeChangedFieldFromAvailableDataSet(e,o)},i.setQueryfieldsAndConditions=function(e){i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url="",i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.datasheetJsonDef="",i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[],i.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=[]},i.getNewFieldJSON=function(){return angular.copy(i.modal.selectedDashboard.json.DataProviders_DataURL_FieldSet,"")}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("DSController",["$scope","$timeout","ServiceFactory",function(m,a,n){m.datastoreAvailable="",m.onInit=function(){m.loadUserDataSourceList()},m.$on("connectionSelected",function(e,o){m.reloadConnectionDetail(o.typeSpecifier)}),m.reloadConnectionDetail=function(e){"ds"==e&&(m.loadSavedSourceAndService(),pasteElementChange("txt_UserScript_DS"))},m.loadUserDataSourceList=function(e){var s=[],o={consumerName:"CUBEPROCESSSERVICE",serviceName:"getDatastoreDetails",data:JSON.stringify({id:"0",datasourcetype:"all"}),isSecure:"true"};null!=e||""==m.modal.userDataSourceList.ds?n.postRequestToServer(req_url.designer.pluginService,{},n.setupFormData(o),function(e,o,a,t){m.modal.userDataSourceList.ds="",e&&e.success&&null!=e.bizvizCubes?(s=s.concat(DesignerUtil.prototype.getArrayOfSingleLengthJson(e.bizvizCubes))).sort(function(e,o){e=String(e.title).toUpperCase(),o=String(o.title).toUpperCase();return e<o?-1:o<e?1:0}):m.selectedDataSource.ds="",m.modal.userDataSourceList.ds=s,m.loadSavedSourceAndService()}):a(function(){m.loadSavedSourceAndService()},1500)},m.getDatasourceIdByConnectId=function(e){for(var o=0;o<m.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL.length;o++)if(m.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL[o].id==e)return m.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL[o].selectedDataSourceID;return""},m.loadSavedSourceAndService=function(){if(m.modal.selectedDashboard.json&&m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection&&""!==m.modal.userDataSourceList.ds){var e=DesignerUtil.prototype.findIndexInArray(m.modal.userDataSourceList.ds,"id",m.getDatasourceIdByConnectId(m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id));try{m.modal.userDataSourceList.ds[e]?(m.selectedDataSource.ds=m.modal.userDataSourceList.ds[e],a(function(){m.modal.userDataSourceList.ds[e].$$hashKey},0),$("#d-ds-datasources")&&a(function(){val=m.modal.userDataSourceList.ds[e].$$hashKey,$("#d-ds-datasources").select2("val",val)},0)):$("#d-ds-datasources")&&a(function(){$("#d-ds-datasources").select2("val","")},0)}catch(e){}m.$evalAsync()}},m.listQueries=function(e,o){if(!m.selectedDataSource.ds)return!1;var p,a=m.selectedDataSource.ds.id||m.selectedDataSource.ds,t=(m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.serviceType="bizvizDS",m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.Type="ds",{consumerName:"CUBEPROCESSSERVICE",serviceName:"getCubeInfo",data:JSON.stringify({id:""+a}),isSecure:"true"});"bizviz"!=a?(p=a!==m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedDataSourceID,m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedDataSourceID=angular.copy(m.selectedDataSource.ds.id),m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedServiceID=angular.copy(m.selectedDataSource.ds.id),m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.dataSourceType=angular.copy("bizvizDS"),m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.queryName=angular.copy(m.selectedDataSource.ds.name),n.postRequestToServer(req_url.designer.pluginService,{},n.setupFormData(t),function(e,o,a,t){try{m.setQueryfieldsAndConditions(p);var s=[];if(e&&e.success&&null!=e.bizvizCube&&null!=e.bizvizCube.defenition){var n={},r=(n=JSON.parse(e.bizvizCube.defenition).fieldDef?JSON.parse(e.bizvizCube.defenition).fieldDef:JSON.parse(e.bizvizCube.cubeOptions).columnNmae?JSON.parse(e.bizvizCube.cubeOptions).columnNmae:JSON.parse(e.bizvizCube.cubeOptions).columnName).facts,l=n.measures,i=n.time;if(r)for(var d=0;d<r.length;d++)s.push(r[d]);if(l)for(var c=0;c<l.length;c++)s.push(l[c]);if(i)for(var u=0;u<i.length;u++)s.push(i[u])}m.fillAvailableFields(s),m.fillAvailableConditionSet(s),m.updateAvailableDataSet(),m.$apply()}catch(e){}},function(){m.fillAvailableFields([]),m.fillAvailableConditionSet([]),m.updateAvailableDataSet(),m.$apply()})):m.setQueryfieldsAndConditions(!0)},m.setQueryfieldsAndConditions=function(e){m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url="",m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[],e&&(m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=[])},m.fillAvailableFields=function(e){var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),DesignerUtil.prototype.getArrayOfSingleLengthJson(o));m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet=[],m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet=[];for(var t=0;t<a.length;t++){var s=m.getNewFieldJSON();s.name=a[t],s.added=!0,m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet.push(s),m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableFieldSet.push(s)}},m.fillAvailableConditionSet=function(e){for(var o=[],a=("object"!=typeof e?o.push(e):o=e,o.sort(function(e,o){e=String(e).toUpperCase(),o=String(o).toUpperCase();return o<e?1:e<o?-1:0}),DesignerUtil.prototype.getArrayOfSingleLengthJson(o)),t=m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet,s=[],n=0;n<a.length;n++)for(var r=0;r<t.length;r++)if(t[r].name.toLowerCase()==a[n].toLowerCase()){s.push(t[r]);break}m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet=angular.copy(s);for(var l=0;l<a.length;l++){for(var i,d=!0,c=0;c<s.length;c++)if(s[c].name.toLowerCase()==a[l].toLowerCase()){d=!1;break}d&&((i={}).name=a[l],i.added=!1,i.condition="",m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.availableConditionSet.push(i))}},m.getNewFieldJSON=function(){return angular.copy(m.modal.selectedDashboard.json.DataProviders_DataURL_FieldSet,"")},m.updateAvailableDataSet=function(){var e=m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.FieldSet,o=m.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.calculatedFieldList;m.modal.removeChangedFieldFromAvailableDataSet(e,o)}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("WSController",["$scope","$timeout","ServiceFactory",function(a,e,o){a.onInit=function(){},a.$on("connectionSelected",function(e,o){a.reloadConnectionDetail(o.typeSpecifier)}),a.reloadConnectionDetail=function(e){"ws"==e&&(a.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.serviceType="bizvizWS",a.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.Type="ws",a.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.selectedServiceID=a.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.url,pasteElementChange("txt_UserScript_WS"))}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("DdataController",["$scope","$timeout","ServiceFactory",function(r,e,t){r.leftCriteriaOperand="",r.rightCriteriaOperand="",r.connectionList=[],r.parentConnection_1={},r.parentConnection_2={},r.parentFields_1=[],r.parentFields_2=[],r.mergedFieldList=[],r.draggedConnection={},r.conditionalOperator=[],r.selectedCriteriaOperator={},r.selected,r.criteria="",r.dFieldName="",r.displayCriteriaBuilder=!0,r.displayOpenCriteriaBuilder=!0,r.displayCriteria=!0,r.derivedCondition={criteria:[r.criteria]},r.onInit=function(){r.connectionList=r.getConnectionList(),r.conditionalOperator=[{opId:"eq",displayName:"Equal",symbol:"=="},{opId:"neq",displayName:"Not Equal",symbol:"!="}],r.$on("connectionSelected",function(e,o){r.reloadConnectionDetails(o.typeSpecifier)}),r.selectedCriteriaOperator=r.conditionalOperator[0],r.setConnectionSelected(r.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection)},r.reloadConnectionDetails=function(e){e&&"derived"===e&&(r.reloadParentConnections(),r.reloadCriteria(),r.reloadDerivedFields(),r.$apply())},r.reloadParentConnections=function(){var e=r.getSelectedConnection().parentSource,o=r.getSelectedConnection().childSource;r.parentConnection_1=DesignerUtil.prototype.findInArray(r.connectionList,"id",e),r.parentConnection_2=DesignerUtil.prototype.findInArray(r.connectionList,"id",o),r.parentFields_1=r.getParentFields(e),r.parentFields_2=r.getParentFields(o)},r.reloadCriteria=function(){var e=r.getSelectedConnection().deriveConditions;r.criteria=e?r.getSelectedConnection().deriveConditions.criteria[0]:""},r.reloadDerivedFields=function(){var e=r.getSelectedConnection();r.mergedFieldList=e.availableFieldSet||[]},r.getParentFields=function(e){var o=null;return o=e?r.getConnectionByConnId(e).FieldSet:o},r.getConnectionByConnId=function(e){var o=r.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL,a=null;return a=e&&o?DesignerUtil.prototype.findInArray(o,"id",e):a},r.getSelectedConnection=function(){var e=r.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.id,o=r.getConnectionList();return DesignerUtil.prototype.findInArray(o,"id",e)},r.getConnectionList=function(){return r.modal.selectedDashboard.json.Dashboard.DataProviders.DataURL},r.onFirstConnectionChange=function(e){r.parentFields_1=r.getParentFields(e),r.removePreviousConnFieldsFromMergedFieldist(r.parentConnection_2);for(var o=0;o<r.parentFields_1.length;o++){var a=angular.copy(r.parentFields_1[o]);a.parentConnection=e,a.parentField=a.name,r.addToMeargedFieldList(a)}r.getSelectedConnection().parentSource=r.parentConnection_1.id,r.getSelectedConnection().availableFieldSet=r.mergedFieldList,r.getSelectedConnection().FieldSet=r.mergedFieldList,r.$apply()},r.onSecondConnectionChange=function(e){r.parentFields_2=r.getParentFields(e),r.removePreviousConnFieldsFromMergedFieldist(r.parentConnection_1);for(var o=0;o<r.parentFields_2.length;o++){var a=angular.copy(r.parentFields_2[o]);a.parentConnection=e,a.parentField=a.name,r.addToMeargedFieldList(a)}r.getSelectedConnection().childSource=r.parentConnection_2.id,r.getSelectedConnection().availableFieldSet=r.mergedFieldList,r.getSelectedConnection().FieldSet=r.mergedFieldList,r.$apply()},r.onFieldDragSuccess=function(e){r.draggedConnection=e},r.onLeftCriteriaOperandChange=function(e,o){r.criteria="",r.leftCriteriaOperand=r.draggedConnection.id+"."+e.name},r.onRightCriteriaOperandChange=function(){r.criteria="",r.rightCriteriaOperand=r.draggedConnection.id+"."+data.name},r.createCriteria=function(){var e,o=r.criteria;o&&""!=o&&(o+=" && "),e=r.parentConnection_1.id+"."+r.leftCriteriaOperand.name+r.selectedCriteriaOperator.symbol+r.parentConnection_2.id+"."+r.rightCriteriaOperand.name,-1<o.search(e)||(r.criteria=o+e,r.derivedCondition={criteria:[r.criteria]},r.getSelectedConnection().deriveConditions=r.derivedCondition),r.displayCriteria=!0},r.hideCriteriaBulder=function(){r.displayCriteria=!0},r.showCriteriaBuilder=function(){r.displayCriteriaBuilder&&!r.displayCriteria||(r.parentFields_1&&r.parentFields_2?0<r.parentFields_1.length&&0<r.parentFields_2.length?(r.leftCriteriaOperand=r.parentFields_1[0],r.rightCriteriaOperand=r.parentFields_2[0],r.displayCriteriaBuilder=!0,r.displayCriteria=!1):t.showNotification("Selected connection does not have fields","alert-danger",3e3):r.parentFields_1?r.parentFields_2||t.showNotification("Select a connection for Right-Table","alert-warning",3e3):t.showNotification("Select a connection for Left-Table","alert-warning",3e3))},r.showRenameFieldDialog=function(e){r.dFieldName=e.name,r.oldFieldName=e.name,r.showModelPopup("renameDerivedFields")},r.renameField=function(){var e=r.getSelectedConnection().FieldSet,o=r.dFieldName.trim();if(!/^[a-zA-Z_][a-zA-Z_0-9]*$/i.test(o))return t.showNotification('Field name must starts with "Alphabet" or "Underscore" ',"alert-warning",3e3),!1;if(o&&""!=o){for(var a=0;a<e.length;a++)e[a].name===r.oldFieldName&&(r.removeFieldsFromCompDataset(e[a]),e[a].name=r.dFieldName);r.mergedFieldList=e,r.getSelectedConnection().availableFieldSet=r.mergedFieldList,r.getSelectedConnection().FieldSet=r.mergedFieldList,r.hideModelPopup("renameDerivedFields")}else t.showNotification("Field name can not be empty","alert-warning",3e3)},r.removeFieldsFromCompDataset=function(e){for(var o=r.modal.selectedDashboard.json.Dashboard[r.modal.layoutType].Object,a=0;a<o.length;a++)for(var t,s=(t=(t=o[a])[t.subElement].DataSet)?t.Fields:[],n=0;n<s.length;n++)if(s[n].Name==e.name){s.splice(n,1);break}},r.onFieldDropSuccess=function(e,o,a){var t=angular.copy(e);t.parentConnection=r.draggedConnection.id,t.parentField=e.name,r.addToMeargedFieldList(t),r.getSelectedConnection().availableFieldSet=r.mergedFieldList,r.getSelectedConnection().FieldSet=r.mergedFieldList},r.addToMeargedFieldList=function(e){r.isMeargedFieldListContains(e)&&(e.name=e.name+"_R"),r.mergedFieldList.push(e)},r.removeFromMeargedFieldList=function(e){for(var o=-1,a=0;a<r.mergedFieldList.length;a++)if(r.mergedFieldList[a].name===e.name){o=a;break}r.mergedFieldList.splice(o,1)},r.isMeargedFieldListContains=function(e){if(e)for(var o=0;o<r.mergedFieldList.length;o++)if(r.mergedFieldList[o].name===e.name)return!0;return!1},r.removePreviousConnFieldsFromMergedFieldist=function(e){var o=[];if(e)for(var a=0;a<r.mergedFieldList.length;a++)r.mergedFieldList[a].parentConnection==e.id&&o.push(r.mergedFieldList[a]);r.mergedFieldList=o}}]),angular.module("designer").controller("FileExplorerController",["$scope","ServiceFactory",function(r,l){r.dirStrBackup={},r.newDirName="New folder",r.selectedDir={id:0,isChildPresent:!0,name:"Home",nodes:[]},r.goToCreateDirMode=function(){r.modal.newDir=!0,r.newDirName="New folder",setTimeout(function(){$(".newDirInput").focus()},10)},r.createNewDir=function(e){var o=req_url.designer.uploadDashboard,a=(new Date).toString(),t=r.newDirName.trim(),e={position:"0",type:"folder",parentid:e.id,dashboardtype:"0",id:"0",imagename:"dashboard.png",title:t,description:"Created from dashboard designer on "+a,file:""};null!=t&&""!=t?(l.showLoader(),BIZVIZ.SDK.secureRequest(o,e,function(e,o){var a;e.trees.success?(a=e.trees.tree,e=e.trees.tree.parentId.id,r.dirStrBackup[e].push({id:a.id,isChildPresent:!1,name:a.title,nodes:[],parent:e}),r.dirList=r.dirStrBackup[e],r.modal.newDir=!1,r.newDirName="New folder",r.$apply()):l.showNotification("Failed to ceate a folder","alert-danger",3e3),l.hideLoader()})):l.showNotification("Folder name can not be empty","alert-warning",3e3)},r.setSelectedDirToPublish=function(e){r.selectedFolderToPublish={id:e.id,title:e.name},r.modal.selectedDirToPublish={id:e.id,title:e.name}},r.loadPortalDirs=function(){if(r.dirList=r.publishFolder,r.dirList){for(var e=0;e<r.dirList.length;e++)r.dirList[e].parent=0;r.dirStrBackup.dirList=[angular.copy(r.selectedDir)],r.dirStrBackup[0]=angular.copy(r.dirList),r.setSelectedDirToPublish(r.selectedDir)}},r.getChildDirs=function(n){var e=req_url.designer.getListView,o={nodeid:n.id,orderType:"DateDesc"};n.nodes=[],r.dirStrBackup[n.id]?(r.dirList=r.dirStrBackup[n.id],r.selectedDir=n,r.setSelectedDirToPublish(r.selectedDir)):(l.showLoader(),BIZVIZ.SDK.secureRequest(e,o,function(e,o){for(var a,t=DesignerUtil.prototype.getArrayOfSingleLengthJson(e.trees.treesList),s=0;s<t.length;s++)null!=t[s]&&"folder"==t[s].type&&(n.isChildPresent=!0,(a={name:"",id:"",nodes:[]}).id=t[s].id,a.name=t[s].title,a.nodes=[],a.isChildPresent=!1,a.parent=n.id,n.nodes.push(a));r.dirList=n.nodes,r.selectedDir=n,r.setSelectedDirToPublish(r.selectedDir),r.dirStrBackup[n.id]=angular.copy(r.dirList),r.dirStrBackup.dirList.push(n),r.$apply(),l.hideLoader()}))},r.getDirById=function(e){return DesignerUtil.prototype.findInArray(r.dirStrBackup.dirList,"id",e)},r.getParentDir=function(e){r.modal.newDir?r.modal.newDir=!1:e&&0!=e.id&&(r.dirList=r.dirStrBackup[e.parent],r.selectedDir=r.getDirById(e.parent),r.setSelectedDirToPublish(r.selectedDir))},r.goToRootDir=function(){r.dirList=r.dirStrBackup[0],r.selectedDir=r.getDirById(0),r.setSelectedDirToPublish(r.selectedDir)},r.loadPortalDirs()}]),angular.module(designerModules.module.HelpManager).controller("HelpController",["$scope","$window","ServiceFactory","DesignerFactory","$compile","$translate","$timeout",function(t,e,s,o,a,n,r){t.modal=o,t.helpModel="./views/templates/HelpIntroduction.html",t.pageForDisplay=function(e,o){IsBoolean(IsBoolean(void 0!==o.subMenu&&0<o.subMenu.length))||IsBoolean(void 0!==o.childSubMenu&&0<o.childSubMenu.length)?0==o.isActive?o.isActive=!0:o.isActive=!1:(o=o.Url,t.helpModel=o)},s.getJsonFileData("./resources/data/HelpMenu.data",function(e){t.helpData=e,t.helpMenuList=e.helpMenus}),t.tryItHelpFeature=function(e,o){s.getJsonFileData(o,function(e){t.tryItJSON=e;e=o.split("/"),e={fileData:t.tryItJSON,fileName:e[e.length-1]};t.loadComps(),t.browseBVZXDashboard(e)})},t.downloadHelpFeature=function(e,a){s.getJsonFileData(a,function(e){t.download=e;var o,e="";e=(e=(o=a.split("/"))[o.length-1]).split(".")[0],t.exportToDefaultLocation(e,t.download)})}}]),angular.module("designer").controller("MainMenuController",["$scope","$window","ServiceFactory","DesignerFactory","$compile","$translate","$timeout","$interval","$mdMenu","$document",function(f,e,D,o,a,t,i,s,n,r){f.modal=o,f.recentlyClickedItem="",f.newDashboardName="Untitled Dashboard",f.scriptHelpUrl=dGlobals.scriptHelpUrl,f.designerHelpUrl=dGlobals.designerHelpUrl,f.searchVisible=!1,f.controlDisable=!1,f.alreadyPublished=!1,f.publishAction="PUB_OVERRIDE",f.pubInfoMsg="",f.maxTabLength=3,f.openProcessingItem="",f.updateDashAction="",f.selectedWorkspace={},f.serverAlertMsg={text:"",type:""},f.languageList=[{locale:"en-US",displayName:"English(US)"},{locale:"hi-IN",displayName:"()"}],f.brandConfig=window.app_brand_cfg,f.selectedLanguage=f.languageList[0];var l=window.sessionStorage.getItem("workspace").split("_"),d=(f.selectedWorkspaceKey=l[0],f.selectedWorkspaceName=l[1],f.currentTheme=window.sessionStorage.getItem("theme"),document.body.setAttribute("data-theme",f.currentTheme),f.toggleDarkMode=function(){this.darkMode=!this.darkMode;var e=this.darkMode?"dark":"light";document.body.setAttribute("data-theme",e),f.currentTheme=e,localStorage.setItem("theme",e)},f.isUserDropdownOpen=!1,f.isUserAlertOpen=!1,f.isUserNavigationOpen=!1,f.toggleUserDropdown=function(){f.isUserAlertOpen=!1,f.isUserNavigationOpen=!1,f.isUserDropdownOpen=!f.isUserDropdownOpen},f.toggleUserAlertNotification=function(){f.isUserDropdownOpen=!1,f.isUserNavigationOpen=!1,f.isUserAlertOpen=!f.isUserAlertOpen},f.toggleUserNavigation=function(){f.isUserDropdownOpen=!1,f.isUserAlertOpen=!1,f.isUserNavigationOpen=!f.isUserNavigationOpen},f.userNotification=function(){window.location.href="/home/#/notifications"},f.userLogout=function(){var e,a="signin";sessionStorage.getItem("bvz_authInfo")&&!0===JSON.parse(sessionStorage.getItem("bvz_authInfo")).user.lite&&(a="lite-preview"),"default"==window.headerSettings.signOuturl?(e={token:D.AUTH_INFO.get("token"),userId:D.AUTH_INFO.get("userID"),spaceKey:D.AUTH_INFO.get("spacekey")},BIZVIZ.SDK.secureRequest("/auth/logout",e,function(e,o){e.users.success;localStorage.clear(),sessionStorage.clear(),window.location.href="/home/#/"+a},function(e,o){localStorage.clear(),sessionStorage.clear(),window.location.href="/home/#/"+a})):(localStorage.clear(),sessionStorage.clear(),window.location.href="/home/#/"+a)},{998315:"administration",898305:"security",829590:"forms",798406:"pipeline",798306:"dataConnector",498314:"designer",98323:"servey",98317:"ds_lab",98407:"genai"}),c=[],u=(c.push({icon:"home",name:"Home",nameId:"Home",menuDisplayType:1,status:1}),sessionStorage.getItem("bvz_authInfo")&&JSON.parse(sessionStorage.getItem("bvz_authInfo")).permissions&&JSON.parse(sessionStorage.getItem("bvz_authInfo")).permissions.map(function(e){"Data Science Labs"==e.name&&(e.name="DS Lab"),"BDB Form"==e.name&&(e.name="Forms"),"User"==e.name&&(e.name="Security"),"Data Agent"==e.name&&(e.icon="98407"),c.push({icon:d[e.icon],name:e.name,nameId:e.nameId,menuDisplayType:e.menuDisplayType,status:e.status})}),c.push({icon:"reports",name:"Report",nameId:"Report",menuDisplayType:1,status:1}),f.headerNavMenu=c,f.dashboardResizeConfig={start:function(e,o){var a=$(this).data("uiResizable"),t=a.originalSize,a=a.sizeDiff;t.width+=a.width,t.height+=a.height},stop:function(e,o){var a=$(this).data("uiResizable").size;f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.width=a.width-a.width%f.modal.bgGridSize,f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.height=a.height-a.height%f.modal.bgGridSize,f.initPropertyPalette(f.getActiveDashboardId(),!0)}},f.dashboardSelectConfig={filter:".bizvizComponent",start:function(e,o){e.preventDefault(),$(".c-group").removeClass("selected-group"),f.deselectAllComponent(),$("#designerCxtMenuContainer .dropdown-menu").hide(),f.isBoxVisible&&f.createPropertyPalette(f.modal.selectedDashboard.id,!0),f.dragSelectList=[]},selecting:function(e,o){o=o.selecting.id.split("dcc_")[1];f.dragSelectList.push(o)},unselecting:function(e,o){o=o.unselecting.id.split("dcc_")[1],o=f.dragSelectList.indexOf(o);f.dragSelectList.splice(o,1)},stop:function(e,o){for(var a=0;a<f.dragSelectList.length;a++)f.selectComponent(f.dragSelectList[a])}},f.permissions={view:0,edit:0,execute:0},f.includeUserbtn=!1,f.deleteUser_GroupModalHeader="",f.openMenu=function(e,o){e.open(o)},f.setSnapToGridSize=function(){f.modal.bgGridSize=f.modal.userPreference.snapToGrid?Number(f.modal.userPreference.snapToGrid.size):1},f.afterMenuReady=function(){applyMainMenuColorScheme(f.portalPreference)},f.onInitMainMenu=function(){function o(e,o){e.stopPropagation();e=angular.element(document.getElementById("obc-settings")).scope();"appearance"==o?e.executeAction(e.modal.selectedComponentId,"openPropWindow"):"dataSettings"==o?e.executeAction(e.modal.selectedComponentId,"openDatasetWindow"):"fx"==o&&e.executeAction(e.modal.selectedComponentId,"openFnWindow")}f.uiActive={menu:{isUiActive:!1},workspace:{isActive:!1},dashboard:{isActive:!1},allDashboard:!1,trash:!1},i(function(){f.modal.hideBootLoader=!0,$(".bvz-loader-container").hide()}),f.initAuthInfo(BIZVIZ.SDK.getAuthInfo()),f.modal.dashVarMap={},f.modal.readySdkPropList=[],D.getJsonFileData("./resources/data/appSettings.data",function(e){for(var o in e.global)global[o]=e.global[o];f.modal.global=global,f.ver=f.modal.global.versionLabel}),designerInitLoader(),D.getJsonFileData("./resources/data/sdkConfig.data",function(e){for(var o in f.modal.sdkProperties=e,f.modal.sdkProperties)f.modal.readySdkPropList.push(o)}),D.getJsonFileData("./resources/data/containers/templateConfig.data",function(e){f.modal.responsiveTemplates=e.templates}),D.getJsonFileData("./resources/data/tourConfig.data",function(e){f.modal.tourConfig=e}),f.getWorkspaces(f.updatePublishPage),f.getSavedUserPreferences(function(e){e=DesignerUtil.prototype.ISJson(e);var o;e instanceof Object?(f.modal.userPreference=e,f.modal.userPreference.showGridLines=D.correctObjectFormat(f.modal.userPreference.showGridLines),f.modal.userPreference.snapToGrid?f.modal.userPreference.snapToGrid.size=D.correctObjectFormat(f.modal.userPreference.snapToGrid.size):f.modal.userPreference.snapToGrid={enable:!0,size:1},f.setSnapToGridSize(),f.modal.userPreference.defaultLimitConfigs?f.modal.userPreference.defaultLimitConfigs=D.correctObjectFormat(f.modal.userPreference.defaultLimitConfigs):f.modal.userPreference.defaultLimitConfigs={excelFile:"3145728",imgFile:"3145728",bvzxFile:"3145728"},f.modal.userPreference.defaultSettings.dashboardBorderThickness=D.correctObjectFormat(f.modal.userPreference.defaultSettings.dashboardBorderThickness)):D.getJsonFileData("./resources/data/UserPreference.data",function(e){f.modal.userPreference=e,f.modal.userPreference.showGridLines=D.correctObjectFormat(f.modal.userPreference.showGridLines),f.modal.userPreference.snapToGrid?f.modal.userPreference.snapToGrid.size=D.correctObjectFormat(f.modal.userPreference.snapToGrid.size):f.modal.userPreference.snapToGrid={enable:!0,size:1},f.setSnapToGridSize(),f.modal.userPreference.defaultLimitConfigs?f.modal.userPreference.defaultLimitConfigs=D.correctObjectFormat(f.modal.userPreference.defaultLimitConfigs):f.modal.userPreference.defaultLimitConfigs={excelFile:"3145728",imgFile:"3145728",bvzxFile:"3145728"},f.modal.userPreference.defaultSettings.dashboardBorderThickness=D.correctObjectFormat(f.modal.userPreference.defaultSettings.dashboardBorderThickness),f.modal.userPreference.defaultSettings.notifyOnSuccess=D.correctObjectFormat(f.modal.userPreference.defaultSettings.notifyOnSuccess),f.modal.userPreference.defaultSettings.blockNotificaton=D.correctObjectFormat(f.modal.userPreference.defaultSettings.blockNotificaton),f.modal.userPreference.defaultSettings.showShadow=D.correctObjectFormat(f.modal.userPreference.defaultSettings.showShadow),f.modal.userPreference.defaultSettings.enableMultipleDrag=D.correctObjectFormat(f.modal.userPreference.defaultSettings.enableMultipleDrag),o=JSON.stringify(f.modal.userPreference),f.updateUserPreferences(o)}),f.loadMainMenuList(),f.loadheaderNavMenu()}),$("body").on("click",".obc-settings-list li md-icon",function(e){o(e,e.target.getAttribute("name"))}),$("body").on("click",".obc-settings-list li img",function(e){o(e,e.target.name)}),$("body").on("click",".ca-settings-list img",function(e){o(e,e.target.name)}),$("body").on("click",".ca-settings-list md-icon",function(e){o(e,e.target.getAttribute("name"))}),$("body").on("click",".propertyDivIcons li img",function(e){o(e,e.target.name)}),$("body").on("click",".propertyDivIcons li md-icon",function(e){o(e,e.target.getAttribute("name"))}),$("body").on("click",function(e){$("#designerCxtMenuContainer .dropdown-menu").hide(),$(e.target).hasClass("comp-appearance-icon")||($(".comp-appearance-icon").popover("hide"),$(".bizVizControlBoxBody .popover").remove())})},f.getWorkspaces=function(n,r){var e=req_url.designer.getAllWorkspaceAndDashboard,l={wsList:[],dbList:[],wsNdb:{}};r||D.showNotification("Getting workspaces","alert-info",3e4),f.timeout=i(function(){r||D.showNotification("Server is taking more than usual time","alert-warning",3e3)},3e4),D.showLoader(),BIZVIZ.SDK.secureRequest(e,{},function(e,o){var a=e.DesignerResp.success,t=!!e.DesignerResp.dashboards?DesignerUtil.prototype.getArrayOfSingleLengthJson(e.DesignerResp.dashboards):[];if(a){f.updateTrashedItems();for(var s=t.length-1;0<=s;s--)if(t[s].isDashboard){if(t[s].isDashboard)try{t[s].isOpen=!!f.isOpenDb(t[s].dashboardId),l.dbList.push(t[s]),l.wsNdb[t[s].parentId]||(l.wsNdb[t[s].parentId]=[]),l.wsNdb[t[s].parentId].push(t[s])}catch(e){}}else try{l.wsList.push(t[s]),l.wsNdb[t[s].dashboardId]||(l.wsNdb[t[s].dashboardId]=[])}catch(e){}f.modal.wsObj=l,n&&"function"==typeof n&&n(l),i.cancel(f.timeout),0==l.wsList.length?f.modal.zeroWorkspcae=!0:f.modal.zeroWorkspcae=!1,r||D.closeAllNotifications(),r||(f.serverAlertMsg={text:"Workspaces has been loaded",type:"alert-success"})}else r||D.closeAllNotifications(),r||(f.serverAlertMsg={text:"Failed to load workspaces",type:"alert-danger"});D.hideLoader()},function(e,o){n&&"function"==typeof n&&n(l)})},f.getSavedUserPreferences=function(a){var e=req_url.designer.getUserDesignerPreferences;D.showLoader(),BIZVIZ.SDK.secureRequest(e,{},function(e,o){e&&e.DesignerResp&&e.DesignerResp.success?"function"==typeof a&&(e.DesignerResp.designerPreferences?a(e.DesignerResp.designerPreferences.preferences):a(!1)):D.showNotification("Failed to get preferences","alert-danger",3e3),D.hideLoader()},function(e,o){e&&e.DesignerResp?"function"==typeof a&&(e.DesignerResp.designerPreferences?a(e.DesignerResp.designerPreferences.preferences):a(!1)):D.showNotification("Failed to get preferences","alert-danger",3e3),D.hideLoader()})},f.updateUserPreferences=function(e,a){var o=req_url.designer.saveOrUpdateUserDesignerPreferences,t=D.AUTH_INFO.get("preferenceObject").preferenceId,e={preferences:e};t&&(e.preferenceID=t),D.showLoader(),BIZVIZ.SDK.secureRequest(o,e,function(e,o){e&&e.DesignerResp&&e.DesignerResp.success?(D.showNotification("Preferences has been saved","alert-success",3e3),"function"==typeof a&&a(e.users)):D.showNotification("Failed to save preferences","alert-danger",3e3),D.hideLoader()})},f.loadMainMenuList=function(){D.getJsonFileData("./resources/data/mainMenu.data",function(e){f.mainMenuList=e;for(var o=angular.copy(window.app_brand_cfg.enableDesignerIcons),a=0;a<f.mainMenuList.length;a++)"Help"==f.mainMenuList[a].title&&IsBoolean(!o.Help)&&(f.mainMenuList[a].enabled=!1);e=f.mainMenuList.find(function(e){return"MANAGE"===e.id});f.setMainMenuActive(e)})},f.unreadmessages=0,f.unreadnotifications=[],sessionStorage.getItem("bvz_authInfo")&&JSON.parse(sessionStorage.getItem("bvz_authInfo")).notificationCount&&(f.unreadmessages=JSON.parse(sessionStorage.getItem("bvz_authInfo")).notificationCount),sessionStorage.getItem("bvz_authInfo")&&JSON.parse(sessionStorage.getItem("bvz_authInfo")).notifications&&(f.unreadnotifications=JSON.parse(sessionStorage.getItem("bvz_authInfo")).notifications),f.NavHeaderSvgLists={home:"nt-header-home",administration:"nt-header-admin",security:"nt-header-security",forms:"nt-header-form",pipeline:"nt-header-pipeline",dataConnector:"nt-header-dataconnector",designer:"nt-header-designer",servey:"nt-header-survey",ds_lab:"nt-header-ds_lab",reports:"nt-header-reports",genai:"nt-header-genAi"},f.loadheaderNavMenu=function(){},f.navigateBy=function(e,o){var a=window.parent.appRootPath||window.appRootPath,t=f.permissionsRoute(e),s=""+window.server_url+t;a&&(s=""+(a=a.replace(/\/$/,""))+t),!e||""==e||"Designer"!==e.name&&"Form"!=e.name&&"Survey"!=e.name?parent.window.location.href=s:window.open(s,"_blank")},f.permissionsRoute=function(e){var o="/home/#/";return"Data Pipeline"==e.name?o="/datapipeline/index.html":"Home"==e.name?o="/home/#/home/document":"Admin"==e.name?o="/home/#/admin":"Security"==e.name?o="/home/#/users":"Forms"==e.name?o="/forms/index.html":"Data Center"==e.name?o="/datacenter/#/connectors":"Designer"==e.name?o="/designer/views/designer/designhome.html":"Survey"==e.name?o="/survey/views/survey/index.html#/":"DS Lab"==e.name?o="/notebook/index.html":"Report"==e.name?o="/home/#/home/action/createstory":"Data Agent"==e.name&&(o="/newGenAi/#/genai"),o},f.setWorkspaceSelected=function(e,o){e&&(e.stopImmediatePropagation(),f.modal.sWsVisible=!1,f.modal.wsSearchKey="",f.recentlyClickedItem=e.currentTarget.children[0].innerHTML.trim(),"Trash"===f.recentlyClickedItem?(f.modal.dashboardSpaceHeader="Trashed Items",f.modal.dashboardSpaceMsg="No item found !"):(f.modal.dashboardSpaceHeader="Dashboards",f.modal.dashboardSpaceMsg="No dashboard found !"),"object"==typeof(e=o)?(f.uiActive.allDashboard=!1,f.uiActive.trash=!1,f.uiActive.workspace.isActive=!1,e.isActive=!0,f.uiActive.workspace=e):"ALL_DASHBOARD"==e?(f.uiActive.workspace.isActive=!1,f.uiActive.trash=!1,f.uiActive.allDashboard=!0):"TRASH"==e&&(f.uiActive.workspace.isActive=!1,f.uiActive.allDashboard=!1,f.uiActive.trash=!0))},f.setDashboardSelected=function(e,o){e&&(e.stopImmediatePropagation(),f.modal.sWsVisible=!1,f.modal.wsSearchKey="",e=o)&&(f.uiActive.dashboard.isActive=!1,e.isActive=!0,f.uiActive.dashboard=e)},f.handleMainMenuToggle=function(e,o,a){null!=o.subMenu&&0<o.subMenu.length&&(0<(o=angular.element(e.currentTarget).find("span.nt-dropdown-icon")).length?o.removeClass("nt-dropdown-icon").addClass("nt-dropdown-icon-open"):0<(o=angular.element(e.currentTarget).find("span.nt-dropdown-icon-open")).length&&o.removeClass("nt-dropdown-icon-open").addClass("nt-dropdown-icon")),a||angular.element(document.querySelectorAll("span.nt-dropdown-icon-open")).removeClass("nt-dropdown-icon-open").addClass("nt-dropdown-icon")},f.handleMainMenuClick=function(e,o){switch(D.closeAllNotifications(),o.id){case"NEW":break;case"WORKSPACE":f.openCreateWorkspaceModal();break;case"DASHBOARD":f.createNewDashboard();break;case"RES_DASHBOARD":f.selectTemplate();break;case"MANAGE":f.modal.mainMenuSelectedWindow="workspaceManagement",f.setMainMenuActive(o);break;case"OPEN":break;case"TEMPLATES":f.modal.mainMenuSelectedWindow="templates",f.openTemplate(),f.setMainMenuActive(o);break;case"SAMPLEDB":f.modal.mainMenuSelectedWindow="sampleDashboard",f.setMainMenuActive(o);break;case"OPN_FRM_LKL_DISK":f.HandleBrowseClick("browseBVZXDashboard");break;case"PREFERENCES":f.modal.mainMenuSelectedWindow="userPreferencesDashboard",f.showUserPreference(),f.setMainMenuActive(o);break;case"SAVE_AS":f.openSaveAsDialog(e);break;case"GUIDED_TOUR":f.startTour("designerHome");break;case"HELP":f.modal.mainMenuSelectedWindow="designerHelp",f.doHelp(),f.setMainMenuActive(o);break;case"EXIT":f.exitDesigner();break;default:f.modal.mainMenuSelectedWindow="workspaceManagement",f.setMainMenuActive(o)}},f.openTemplate=function(r){f.templateMap={};var e=req_url.designer.getAllWorkspaceAndDashboard,l={templWsList:[],templDbList:[],templWsNdb:{}};r||D.showNotification("Getting Templates","alert-info",3e4),f.timeout=i(function(){r||D.showNotification("Server is taking more than usual time","alert-warning",3e3)},3e4),D.showLoader(),BIZVIZ.SDK.secureRequest(e,{type:"6"},function(e,o){var a=e.DesignerResp.success,t=!!e.DesignerResp.dashboards?DesignerUtil.prototype.getArrayOfSingleLengthJson(e.DesignerResp.dashboards):[];if(a){for(var s,n=t.length-1;0<=n;n--)if(t[n].isDashboard){if(t[n].isDashboard)try{void 0!==t[n].templateJson&&(t[n].templateJson=JSON.parse(t[n].templateJson),t[n].templateJson.dashboardTemplateJson.templId="template"+n,s=t[n].templateJson.dashboardTemplateJson.thumbNailBase64,t[n].templateJson.dashboardTemplateJson.thumbNailBase64="data:image/png;base64, "+s,t[n].templateFlag=!0),t[n].isOpen=!!f.isOpenDb(t[n].dashboardId),l.templDbList.push(t[n]),l.templWsNdb[t[n].parentId]||(l.templWsNdb[t[n].parentId]=[]),l.templWsNdb[t[n].parentId].push(t[n])}catch(e){}}else try{l.templWsList.push(t[n]),l.templWsNdb[t[n].dashboardId]||(l.templWsNdb[t[n].dashboardId]=[])}catch(e){}f.modal.templObj=l,i.cancel(f.timeout),r||D.closeAllNotifications(),r||(f.serverAlertMsg={text:"Templates has been loaded",type:"alert-success"}),f.$apply()}else r||D.closeAllNotifications(),r||(f.serverAlertMsg={text:"Failed to load Template",type:"alert-danger"});D.hideLoader()},function(e,o){})},f.backToTemplateHome=function(){f.modal.mainMenuSelectedWindow="templates"},f.listContainingTemplates=function(e){f.templateMap.templatelist=e?f.modal.templObj.templWsNdb[e]:f.modal.templObj.templDbList,f.modal.mainMenuSelectedWindow="templateList"},f.onhoverTemplates=function(e){e.templateFlag=!1},f.onleaveTemplates=function(e){e.templateFlag=!0},f.downloadTemplateData=function(e){if(e.templateJson){var e=e.templateJson.dashboardTemplateJson.excelBase64,o=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor");if(document.documentMode||/Edge/.test(navigator.userAgent)){var a=e.split(",")[0]||"",t=e.split(",")[0];t=(t=t.replace(/^[^,]+,/,"")).replace(/\s/g,"");for(var s=window.atob(t),n=[],r=0;r<s.length;r+=512){for(var l=s.slice(r,r+512),i=new Array(l.length),d=0;d<l.length;d++)i[d]=l.charCodeAt(d);var c=new Uint8Array(i);n.push(c)}var t=new Blob(n,{type:a});window.saveAs?window.saveAs(t,"TemplateData.xlsx"):window.navigator.msSaveBlob(t,"TemplateData.xlsx")}else 0<o?window.open(e):((a=document.createElement("a")).setAttribute("id","anchor"),document.body.appendChild(a),(t=document.getElementById("anchor")).href="data:application/octet-stream;base64,"+e,t.download="TemplateData.xlsx",t.click(),t.remove())}else D.showNotification("File cann't be downloaded","alert-danger",3e3)},f.openCreateWorkspaceModal=function(){f.showModelPopup("newWorkspaceModal"),f.setFocusOnInput("#newWorkspaceModal","#workspaceName")},f.createNewDashboard=function(e,o){var a;D.closeAllNotifications(),f.modal.dashboardTabs.length<f.maxTabLength?(IsBoolean(f.multiSelected)&&IsBoolean(f.modal.userPreference.defaultSettings.enableMultipleDrag)&&f.deselectAllComponent(),f.isLastScriptLoaded||D.showLoader(),a=getIdWithTimeStamp("dashboard"),f.currentTheme=window.sessionStorage.getItem("theme")||"light","dark"==f.currentTheme&&f.onCustomThemeUpdateDropdown(),f.addNewDashboardDiv(a,f.newDashboardName,f.addNewDashboardCallBack,o),f.modal.createHistoryProperties(a)):D.showNotification("Please close a dashboard","alert-danger",3e3)},f.createNewDashboardTemplate=function(e,o){var a;f.modal.dashboardTabs.length<f.maxTabLength?(IsBoolean(f.multiSelected)&&IsBoolean(f.modal.userPreference.defaultSettings.enableMultipleDrag)&&f.deselectAllComponent(),f.isLastScriptLoaded||D.showLoader(),a=getIdWithTimeStamp("dashboard"),f.addNewDashboardTemplateDiv(a,f.newDashboardName,f.addNewDashboardCallBack,o,f.templateDashboardJson),f.modal.createHistoryProperties(a)):D.showNotification("Please close a dashboard","alert-danger",3e3)},f.selectTemplate=function(){f.showModelPopup("templateSelection")},f.setMainMenuActive=function(e){f.uiActive.menu.isUiActive=!1,e.isUiActive=!0,f.uiActive.menu=e},f.HandleBrowseClick=function(e){D.getJsonFileData("./resources/bizvizchart-themes/default-theme/AllComponentsData.data",function(e){f.modal.compMetaData=e}),D.getJsonFileData("./resources/data/property/allpropertydata.data",function(e){f.modal.propertyData=e}),D.getJsonFileData("./resources/data/property/dashboard.data",function(e){f.modal.globalFontProperties=e["Global Font And Themes"][4].options}),f.loadComps(),i(function(){$("#"+e).val("").click()},0)},f.showUserPreference=function(){f.modal.userPreference.display=!0,i(function(){-1==navigator.appVersion.indexOf("Win")&&Modernizr.inputtypes.color||f.initSpectrumColorPicker("input[type='color']")},10)},f.openSaveAsDialog=function(){D.closeAllNotifications(),f.modal.saveAsDashboardName="Copy_Of_"+f.modal.selectedDashboard.name,0<f.modal.dashboardTabs.length?(f.modal.wsObjForSave.wsList&&0<f.modal.wsObjForSave.wsList.length||f.refreshWorkSpaceList(),f.showModelPopup("saveAsModalDialog"),f.setFocusOnInput("#saveAsModalDialog","#saveAsdashboardName")):D.showNotification("There is no opened dashboard to save","alert-warning",3e3)},f.doHelp=function(){""!==f.designerHelpUrl&&window.open(f.designerHelpUrl,"_blank")},f.exitDesigner=function(){f.showModelPopup("exitModalDialog")},f.updateExitDesigner=function(){if(f.hideModelPopup("exitModalDialog"),window.location.href=window.location.origin+"/home/#/",window.opener)window.close();else if(window.top===window.self)e.close();else try{top.close()}catch(e){}},f.createNewResponsiveDashboard=function(e){f.selectedTemplate=e,f.createNewDashboard(!1,!0),f.hideModelPopup("templateSelection")},f.saveUserPrefs=function(){var e=JSON.stringify(f.modal.userPreference);f.updateUserPreferences(e)},f.refreshWorkSpaceList=function(){f.getWorkspaces(function(e){0<e.wsList.length&&(null!=f.$apply(function(){})?f.$apply(function(){f.modal.wsObj=e,f.modal.wsObjForSave=angular.copy(e),f.modal.selectedWorkspaceIdForSave=f.modal.wsObjForSave.wsList[0].dashboardId}):(f.modal.wsObj=e,f.modal.wsObjForSave=angular.copy(e),f.modal.selectedWorkspaceIdForSave=f.modal.wsObjForSave.wsList[0].dashboardId))})},f.isOpenDb=function(e){for(var o=0;o<f.modal.dashboardTabs.length;o++)if(f.modal.dashboardTabs[o].json.Dashboard.backendId==e)return!0;return!1},f.createNewWorkspace=function(e){var o=f.modal.newWorkspaceName.trim();o?(f.addNewWorkspace(o,e),f.modal.newWorkspaceName="Untitled WorkSpace",f.hideModelPopup("newWorkspaceModal")):D.showNotification("Workspace name can not be empty","alert-danger",3e3)},f.addNewWorkspace=function(t,s){var e=req_url.designer.createWorkspace,o={workspaceName:t,workspaceJSON:""};D.showLoader(),BIZVIZ.SDK.secureRequest(e,o,function(e,o){var a=JSON.parse(e.DesignerResp.params).id;e.DesignerResp.success?(f.refreshList(),D.showNotification("Workspace has been created","alert-success",3e3),s&&s(t,a)):D.showNotification("Failed to create workspace","alert-danger",3e3),D.hideLoader()})},f.reSetModal=function(){f.modal.selectedDashboard&&(f.modal.selectedDashboard.name=f.modal.selectedDashboard.json.Dashboard.name)},f.syncDbNameWithTabName=function(e){var o=f.modal.dashboardTabs,a=f.modal.selectedDashboard,o=DesignerUtil.prototype.findInArray(o,"id",e);a.name?(o.name=a.name,f.modal.selectedDashboard.json.Dashboard.name=a.name):(o.name=f.newDashboardName,f.modal.selectedDashboard.json.Dashboard.name=o.name)},f.initHintVariables=function(e){f.modal.dashVarMap[e]=angular.copy(f.modal.readySdkPropList),o.refreshAllObjectList()},f.createNewDashboardInDB=function(){var e=f.modal.selectedWorkspaceIdForSave,a=f.modal.selectedDashboard.name,t=f.modal.selectedDashboard.json;f.modal.wsObj.wsList&&0==f.modal.wsObj.wsList.length?f.createNewWorkspace(function(e,o){f.modal.wsObj={wsList:[],dbList:[]},i(function(){f.modal.wsObj.wsList.push({dashboardId:o,dashboardName:e,isDashboard:!1,spaceKey:D.AUTH_INFO.get("spacekey"),status:!0,userId:D.AUTH_INFO.get("userID")}),f.selectedWorkspace=f.modal.wsObj.wsList[0],f.modal.userPreference.display=!1,f.modal.dbCreationInProgress=!0,a?o?(f.createNewDashboardInDatabase(o,a,t),f.hideModelPopup("saveDbModalDialog")):D.showNotification("Please select a workspace","alert-danger",3e3):D.showNotification("Dashboard name can not be empty","alert-danger",3e3)},1)}):a?e?(f.createNewDashboardInDatabase(e,a,t),f.hideModelPopup("saveDbModalDialog")):D.showNotification("Please select a workspace","alert-danger",3e3):D.showNotification("Dashboard name can not be empty","alert-danger",3e3)},f.saveCopyOfDashboardAsInDB=function(){if(f.modal.saveAsDashboardName.trim()){var e=f.modal.selectedWorkspaceIdForSave;if(null!=e&&""!=e){var o=f.modal.saveAsDashboardName,a=((r=angular.copy(f.modal.selectedDashboard.json)).Dashboard.name=o,r.Dashboard.id=getIdWithTimeStamp("dashboard"),f.removeDashboardPublishDetailsFromDownloadedJson(r),r.Dashboard.AbsoluteLayout.Object);r=JSON.stringify(r);for(var t=0;t<a.length;t++)var s=angular.copy(a[t].objectID),n=getIdWithTimeStamp("BVZ-"+t+"-"),s=new RegExp(s,"g"),r=r.replace(s,n);r=convertStringToJson(r),f.createNewDashboardInDatabase(e,o,r,function(e){var a=DesignerUtil.prototype.ISJson(e.params);e.success?f.refreshList(function(e){for(var o=0;o<e.dbList.length;o++)if(e.dbList[o].dashboardId==a.dashboardId){D.showNotification("Dashboard has been saved","alert-success",3e3);break}}):D.showNotification("Error","alert-danger",3e3)}),f.hideModelPopup("saveAsModalDialog")}else D.showNotification("Please select a workspace","alert-danger",3e3)}else D.showNotification("Dashboard name can not be empty","alert-danger",3e3)},f.createNewDashboardInDatabase=function(a,t,s,n,r){var e=a,o=encryptText(window.sessionStorage.getItem("bvz_spacekey")),l=encryptText(window.sessionStorage.getItem("bvz_userid")),o={authtoken:window.sessionStorage.getItem("bvz_token"),spacekey:o,docid:e,userID:l},e=req_url.designer.createDashboard,l={workspaceId:a.toString(),dashboardName:t,dashboardJSON:"{}",infoJSON:"{}"},l={dashboardParameters:JSON.stringify(l)};D.showLoader(),BIZVIZ.SDK.secureRequestDocId(e,l,o,function(e,o){e.DesignerResp.success?(e=JSON.parse(e.DesignerResp.params).dashboardId,f.saveDashboardInDB(a,e,t,s,n,void 0,r)):(D.showNotification("Failed to create dashboard","alert-danger",3e3),D.hideLoader())},function(e,o){D.hideLoader(),D.showNotification("Failed to create dashboard","alert-danger",3e3)})},f.saveDashboardInDB=function(e,o,a,t,s,n,r,l){req_url.designer.saveDashboard;var i=e+"_"+o,d=encryptText(window.sessionStorage.getItem("bvz_spacekey")),c=encryptText(window.sessionStorage.getItem("bvz_userid")),d={authtoken:window.sessionStorage.getItem("bvz_token"),spacekey:d,docid:i,userID:c};o=o.toString(),e=e.toString(),t.changeStatus=0,t.Dashboard.workspaceId=e,t.Dashboard.backendId=o,t.Dashboard.name=a;try{null==r&&null!=t.Dashboard.versionDetails?(t.Dashboard.versionDetails.lastUpdate=getTimeStamp(),r=t.Dashboard.versionDetails):null!=r&&null==t.Dashboard.versionDetails?r.lastUpdate=getTimeStamp():(g={author:"BizViz Technologies Pvt. Ltd.",edittedBy:"",lastUpdate:"",dashboardVersion:"7.6.0",publishDocId:"",publishedVersions:[],lastPublishedVersion:"",createdDesignerVersion:"",lastUpdatedDesignerVersion:"7.5.1",lastUpdatedDesignerDate:"16/09/2022"},t.Dashboard.versionDetails=g)}catch(e){}for(var u=t.Dashboard.AbsoluteLayout.Object,p=window.sessionStorage.getItem("bvz_spacekey"),m=[],b=0;b<u.length;b++){u[b].zindex=b;var h={objectId:u[b].objectID,unShowHidden:u[b].unShowHidden,spaceKey:p,status:1,dashboardId:o,data:angular.toJson(u[b])};m.push(h)}var i=angular.toJson(t),c=angular.toJson(r),g=angular.toJson(m),t=IsBoolean(l)?{workspaceId:e,dashboardId:o,dashboardName:a,infoJSON:c,dashboardComponentJSON:g}:{workspaceId:e,dashboardId:o,dashboardName:a,dashboardJSON:i,dashboardComponentJSON:g},r={dashboardParameters:t=angular.toJson(t)};D.showLoader({timeout:"180000"}),BIZVIZ.SDK.secureRequestDocId("/designer/saveDashboardWithComponents/",r,d,function(e,o){e.DesignerResp.success?(s&&("function"==typeof s?s(e.DesignerResp):f.closeDashboardTabAndDiv(f.modal.dashboardToClose.id,f.modal.dashboardToClose.index)),D.hideLoader(),D.showNotification("Dashboard has been saved","alert-success",3e3),f.refreshList(),n||f.hideMenu()):(D.hideLoader(),D.showNotification("Failed to save dashboard","alert-danger",3e3))},function(e,o){D.hideLoader(),D.showNotification("Failed to save dashboard","alert-danger",3e3)})},f.saveTemplateInDB=function(e,o,a,t,s,n,r,l){var i;req_url.designer.saveDashboard,o=o.toString(),e=e.toString(),t.changeStatus=0,t.Dashboard.workspaceId=e,t.Dashboard.backendId=o,t.Dashboard.name=a;try{null==r&&null!=t.Dashboard.versionDetails?(t.Dashboard.versionDetails.lastUpdate=getTimeStamp(),r=t.Dashboard.versionDetails):null!=r&&null==t.Dashboard.versionDetails?r.lastUpdate=getTimeStamp():(i={author:"BizViz Technologies Pvt. Ltd.",edittedBy:"",lastUpdate:"",dashboardVersion:"7.6.0",publishDocId:"",publishedVersions:[],lastPublishedVersion:"",createdDesignerVersion:"",lastUpdatedDesignerVersion:"7.5.1",lastUpdatedDesignerDate:"16/09/2022"},t.Dashboard.versionDetails=i)}catch(e){}o=angular.toJson(t),i=angular.toJson(r),t=IsBoolean(l)?{workspaceId:e,dashboardName:a,infoJSON:i}:{workspaceId:e,dashboardName:a,dashboardJSON:o};r={dashboardParameters:t=angular.toJson(t),type:"6"};D.showLoader({timeout:"180000"}),BIZVIZ.SDK.secureRequest("/designer/saveTemplate",r,function(e){e.DesignerResp.success?(s&&("function"==typeof s?s(e.DesignerResp):f.closeDashboardTabAndDiv(f.modal.dashboardToClose.id,f.modal.dashboardToClose.index)),D.hideLoader(),D.showNotification("Dashboard template has been saved","alert-success",3e3)):(D.hideLoader(),D.showNotification("Failed to save dashboard template","alert-danger",3e3))},function(e,o){D.hideLoader(),D.showNotification("Failed to save dashboard template","alert-danger",3e3)})},f.addNewDashboardCallBack=function(e,o,a,t,s){f.addInDashboardTab(e,o,a,t,s),f.setSelectedDashboard(e),i(function(){f.isSelectedDashboardResponsive()?f.handleContainersIds():f.applyUserDefaultSettings(),f.dashboardTabClick(e)},1),f.isMainMenuVisible&&(f.hideMenu(),D.hideLoader())},f.addInDashboardTab=function(e,o,a,t){e={id:e,name:o,json:a,infojson:t,responsive:f.isSelectedDashboardResponsive()};f.modal.dashboardTabs.push(e)},f.setSelectedDashboard=function(e){for(var o=0;o<f.modal.dashboards.length;o++)if(f.modal.dashboards[o].id==e){f.modal.selectedDashboard=f.modal.dashboards[o],f.modal.layoutType=f.modal.selectedDashboard.json.Dashboard.layoutType;break}},f.isSelectedDashboardResponsive=function(){return!!f.modal.selectedDashboard&&f.modal.selectedDashboard.json.Dashboard.responsive},f.applyUserDefaultSettings=function(){f.modal.userPreference&&(f.setDashboardPropertyInJson(f.modal.userPreference.defaultSettings),f.setDashboardsDefaultCSS(f.modal.userPreference.defaultSettings))},f.initResizeDashboard=function(e){},f.initDragSelection=function(e){},f.handleContainersIds=function(){for(var e=f.modal.selectedDashboard.json.Dashboard.Containers.Container,o=0;o<e.length;o++)e[o].parent&&(e[o].parent=f.modal.getSelectedDashboardId()+"-"+e[o].parent),e[o].id=f.modal.getSelectedDashboardId()+"-"+e[o].id},f.dashboardTabClick=function(e){IsBoolean(f.multiSelected)&&IsBoolean(f.modal.userPreference.defaultSettings.enableMultipleDrag)&&f.deselectAllComponent();var o=$("#dashboardTabs"),a=$(".dashboardContents").find(".tab-pane"),t=$("#tab"+e),s=$("#"+e).closest(".tab-pane");o.find("li").removeClass("active"),a.removeClass("active"),t.addClass("active"),s.addClass("active"),f.reloadDefault(""),f.modal.dashbaordLoadingInProgress||(f.setSelectedDashboard(e),f.resetFunctionWindow(void 0,!1,"Dashboard")),f.setSelectedLayout(),f.isSelectedDashboardResponsive()||f.setDashboardCSS(f.modal.userPreference),f.setPortalPreferenceTheme(),f.resetGroupManagement(),f.setSelectedConnection()},f.dashboardTabClick_old=function(e){$("#dashboardTabs").find("li").removeClass("active"),$("#dashboardTabs").find("li#tab"+e).addClass("active"),$(".tab-pane").removeClass("active"),$("#"+e).closest(".tab-pane").addClass("active"),f.reloadDefault(""),f.modal.dashbaordLoadingInProgress||(f.setSelectedDashboard(e),f.resetFunctionWindow(void 0,!1,"Dashboard")),f.isSelectedDashboardResponsive()||f.setDashboardCSS(f.modal.userPreference),f.setPortalPreferenceTheme(),f.resetGroupManagement(),f.setSelectedConnection()},f.setDashboardCSS=function(e){if(null!=e){var o=e.showGridLines,e=e.defaultSettings.showDashboardBorder,a=f.modal.selectedDashboard.json.Dashboard[f.modal.layoutType],t=f.modal.selectedDashboard.json.Dashboard.backendId,t=((""==t&&null==t?!1:!0)?(c=e?2*a.borderThickness:0,$("#mainDesignerViewDiv #"+f.modal.selectedDashboard.id).css({height:+a.height+c,width:+a.width+c,border:e?a.borderThickness+"px solid "+a.borderColor:""})):(c=null==a.showBorder||1==IsBoolean(a.showBorder)?2*a.borderThickness:0,$("#mainDesignerViewDiv #"+f.modal.selectedDashboard.id).css({height:+a.height+c,width:+a.width+c,border:null==a.showBorder||1==IsBoolean(a.showBorder)?a.borderThickness+"px solid "+a.borderColor:""})),f.modal.selectedDashboard.json.Dashboard[f.modal.layoutType].gradientRotation||"0"),s=["rgba(255,255,255,1)","rgba(255,255,255,1)"],e=f.modal.selectedDashboard.json.Dashboard[f.modal.layoutType].gradients||"#FFFFFF",n=f.modal.selectedDashboard.json.Dashboard[f.modal.layoutType].bgAlpha||"1";if(""!=e){var r=e.split(",");if(1==r.length)s[0]=hex2rgb(convertColorToHex(r[0]),n),s[1]=hex2rgb(convertColorToHex(r[0]),n);else for(var l=0;l<r.length;l++)s[l]=hex2rgb(convertColorToHex(r[l]),n)}for(var i="",d=0;d<s.length;d++)i+=s[d]+(d<s.length-1?" ,":"");var c=o?"url(./resources/images/svg/bgGrid.png), ":"";$("#mainDesignerViewDiv #"+f.modal.selectedDashboard.id).css({background:c+"linear-gradient("+t+"deg,"+i+")"}),$("#mainDesignerViewDiv #"+f.modal.selectedDashboard.id).css({background:c+"-webkit-linear-gradient("+t+"deg, "+i+")"}),$("#mainDesignerViewDiv #"+f.modal.selectedDashboard.id).css({background:c+"-o-linear-gradient("+t+"deg, "+i+")"}),$("#mainDesignerViewDiv #"+f.modal.selectedDashboard.id).css({background:c+"-moz-linear-gradient("+t+"deg, "+i+")"})}},f.setPortalPreferenceTheme=function(){f.portalPreference&&(applyDashboardMenuColorScheme(f.portalPreference),applyFloatingWindowColorScheme(f.portalPreference),applyDashboardColorScheme(f.portalPreference))},f.showHideGridLines=function(e){var o="",a="",t="",s="";if(f.modal.selectedDashboard&&(o=f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.gradientRotation,a=["rgba(255,255,255,1)","rgba(255,255,255,1)"],t=f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.gradients,s=f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.bgAlpha),""!=t){var n=t.split(",");if(1==n.length)a[0]=hex2rgb(convertColorToHex(n[0]),s),a[1]=hex2rgb(convertColorToHex(n[0]),s);else for(var r=0;r<n.length;r++)a[r]=hex2rgb(convertColorToHex(n[r]),s)}t=e?"url(./resources/images/bgGrid.png), ":"";$(".draggablesParentDiv").css({background:t+"linear-gradient("+o+"deg, "+a[0]+", "+a[1]+")"}),$(".draggablesParentDiv").css({background:t+"-webkit-linear-gradient("+o+"deg, "+a[0]+", "+a[1]+")"}),$(".draggablesParentDiv").css({background:t+"-o-linear-gradient("+o+"deg, "+a[0]+", "+a[1]+")"}),$(".draggablesParentDiv").css({background:t+"-moz-linear-gradient("+o+"deg, "+a[0]+", "+a[1]+")"})},f.setDashboardsDefaultCSS=function(e){var o=e.showDashboardBorder?2*e.dashboardBorderThickness:0;$("#mainDesignerViewDiv #"+f.modal.selectedDashboard.id).css({height:+e.dashboardHeight+o,width:+e.dashboardWidth+o,border:e.showDashboardBorder?e.dashboardBorderThickness+"px solid "+e.dashboardBorderColor:"none","background-color":e.dashboardBackgroundColor})},f.setDashboardPropertyInJson=function(e){e.fixedDashboardDimensions?(f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.width=e.dashboardWidth,f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.height=e.dashboardHeight):(f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.width=$(".rw-container").get(0).clientWidth-10,f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.height=$(".rw-container").get(0).clientHeight-10),f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.borderColor=e.dashboardBorderColor,f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.borderThickness=e.dashboardBorderThickness,f.modal.selectedDashboard.json.Dashboard.AbsoluteLayout.gradients=e.dashboardBackgroundColor},f.setSelectedConnection=function(){var e;try{(e=f.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection)&&(f.setConnectionSelected(f.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection),i(function(){angular.element("#UI_"+e.id).trigger("click")},1))}catch(e){}},f.closeModelDashboardResponse=function(e){var o=""==f.modal.dashboardToClose.json.Dashboard.workspaceId?f.selectedWorkspace.dashboardId:f.modal.dashboardToClose.json.Dashboard.workspaceId,a=f.modal.dashboardToClose.json.Dashboard.backendId,t=f.modal.dashboardToClose.name,s=f.modal.dashboardToClose.json,n=f.modal.dashboardToClose.infojson;if((0<t.length||"close"==e)&&(null!=o||"close"==e)){switch(e){case!1:f.createNewDashboardInDatabase(o,t,s,"CreateSaveAndClose");break;case!0:f.saveDashboardInDB(o,a,t,s,"SaveAndClose",void 0,n);break;default:f.closeDashboardTabAndDiv(f.modal.dashboardToClose.id,f.modal.dashboardToClose.index)}f.saveDashboardBeforeClose=!1,f.hideModelPopup("closeAndSaveDbModalDialog"),f.reloadDefault("")}},f.getIndexOfWsFromWsListByWsId=function(e){for(var o=f.modal.wsObj.wsList,a=-1,t=0;t<o.length;t++)if(e==o[t].dashboardId){a=t;break}return a},f.triggerCloaseDashboardFromManagePage=function(e){var o;try{for(var a=f.modal.dashboardTabs,t=0;t<a.length;t++)if(e==a[t].json.Dashboard.backendId)return o=a[t].id,f.closeDashboard(o,t),!0;return!1}catch(e){return!1}},f.closeDashboard=function(e,o){D.closeAllNotifications();var a=f.modal.dashboardTabs[o].json.changeStatus;null!=a&&0<a?(f.saveDashboardBeforeClose=!1,f.modal.dashboardToClose={id:e,name:f.modal.dashboardTabs[o].name,json:f.modal.dashboardTabs[o].json,infojson:f.modal.dashboardTabs[o].infojson,dashboardExistInDatabase:""!=f.modal.dashboardTabs[o].json.Dashboard.backendId,index:o},(a=f.modal.dashboardTabs[o].json.Dashboard.workspaceId)&&(f.selectedWorkspace=f.modal.wsObj.wsList[f.getIndexOfWsFromWsListByWsId(a)]||{}),f.showModelPopup("closeAndSaveDbModalDialog"),$("#closeAndSaveDbModalDialog").css("zIndex","9999999999"),f.setFocusOnInput("#closeAndSaveDbModalDialog","#saveAsdashboardName")):f.closeDashboardTabAndDiv(e,o)},f.closeDashboardTabAndDiv=function(e,o){var a=f.getDashboardByTimeStampId(e),a=DesignerUtil.prototype.findInArray(f.modal.wsObj.dbList,"dashboardId",a.backendId);$("#dashboardTabs").find("li #tab_"+e).remove(),f.removeFromDashboardTab(o),f.removeFromDashboard(e),$("#"+e).remove(),null!=a&&(a.isOpen=!1),f.modal.componentListInObjectBrowser=[],f.modal.listOfSelectedComponents=[],f.modal.dashVarMap[e]=[],f.modal.historyProperties[e]=[],f.modal.selectedVariableDefaultValue=[],f.modal.calcFieldConfig={},f.modal.selectedDashboard.id==e?0<f.modal.dashboards.length?(a=o==f.modal.dashboardTabs.length?o-1:o,f.modal.layoutType=f.modal.dashboardTabs[a].json.Dashboard.layoutType,f.dashboardTabClick(f.modal.dashboardTabs[a].id)):(f.modal.layoutType="",f.modal.selectedDashboard=""):(f.modal.layoutType=f.modal.selectedDashboard.json.Dashboard.layoutType,f.dashboardTabClick(f.modal.selectedDashboard.id)),f.reloadDefault("")},f.removeFromDashboardTab=function(e){f.modal.dashboardTabs.splice(e,1)},f.removeFromDashboard=function(e){for(var o=0;o<f.modal.dashboards.length;o++)if(f.modal.dashboards[o].id==e){f.modal.dashboards.splice(o,1);break}return{}},f.onPreferenceChange=function(){f.showHideGridLines(f.modal.userPreference.showGridLines),f.applySelectedLanguage()},f.onSnapToGridPreferenceChange=function(){f.setSnapToGridSize()},f.applySelectedLanguage=function(){var e=f.selectedLanguage.locale;t.use(e)},f.toggleSearchWs=function(e){D.closeAllNotifications(),e.stopPropagation(),f.modal.sWsVisible?(f.modal.sWsVisible=!1,f.modal.wsSearchKey=""):(f.modal.sWsVisible=!0,i(function(){$("input[ name='worspace_search' ]").focus()},10))},f.saveDashboard=function(){D.closeAllNotifications(),""!=f.modal.selectedDashboard?f.controlDisable||(f.saveDashboardPrompt(f.modal.selectedDashboard.json),f.controlDisable=!0,i(function(){f.controlDisable=!1},3e3)):D.showNotification("Invalid dashboard configuration","alert-success",3e3)},f.saveDashboardTemplate=function(a){f.saveDashboardTemplateFlg=!1,f.saveDashboardTemplateName="";var e=req_url.designer.openDashboard,o={dashboardId:a.dashboardId.toString()},o={dashboardParameters:JSON.stringify(o)};D.showLoader(),BIZVIZ.SDK.secureRequest(e,o,function(e,o){e&&e.DesignerResp&&e.DesignerResp.success&&e.DesignerResp.params?(e=JSON.parse(e.DesignerResp.params),f.saveDashboardTemplateFlg=!0,f.saveDashboardTemplateName=a.dashboardName,f.saveDashboardPrompt(e.dashboardJson)):D.showNotification("Invalid dashboard configuration","alert-danger",3e3),D.hideLoader()})},f.saveDashboardPrompt=function(e){var o=e.Dashboard,a=o.backendId,t=o.workspaceId,o=o.name;""!=a?1==f.saveDashboardTemplateFlg?f.saveTemplateInDB(t,a,f.saveDashboardTemplateName,e,void 0,void 0,void 0):f.saveDashboardInDB(t,a,o,e,void 0,void 0,void 0):(null!=f.modal.wsObj.wsList&&0<f.modal.wsObj.wsList.length?(f.modal.wsObjForSave=angular.copy(f.modal.wsObj),f.modal.selectedWorkspaceIdForSave=f.modal.wsObjForSave.wsList[0].dashboardId,i(function(){f.modal.userPreference.display=!1,f.modal.dbCreationInProgress=!0},1)):D.showNotification("Workspace not found","alert-info",3e3),f.showModelPopup("saveDbModalDialog"),f.setFocusOnInput("#saveDbModalDialog","#dashboardName"))},f.exportDashboard=function(r){if(!r)return!1;var e=req_url.designer.openDashboard,o={dashboardId:r.dashboardId.toString()},o={dashboardParameters:JSON.stringify(o)};D.showLoader(),BIZVIZ.SDK.secureRequest(e,o,function(e,o){if(e&&e.DesignerResp&&e.DesignerResp.success&&e.DesignerResp.params){var e=JSON.parse(e.DesignerResp.params),a=(e.dashboardJson.Dashboard.id=getIdWithTimeStamp("dashboard"),f.removeDashboardPublishDetailsFromDownloadedJson(e.dashboardJson),(_activeDashboardJson=e.dashboardJson).Dashboard.AbsoluteLayout.Object);_activeDashboardJson=JSON.stringify(_activeDashboardJson);for(var t=0;t<a.length;t++){var s=angular.copy(a[t].objectID),n=getIdWithTimeStamp("BVZ-"+t+"-"),s=new RegExp(s,"g");_activeDashboardJson=_activeDashboardJson.replace(s,n)}e.dashboardJson=JSON.parse(_activeDashboardJson),f.exportToDefaultLocation(r.dashboardName,e)}else D.showNotification("Invalid dashboard configuration","alert-danger",3e3);D.hideLoader()})},f.exportCurrentDashboard=function(){D.closeAllNotifications();var e=f.modal.selectedDashboard;if(""!=e){(n=angular.copy(e.json)).Dashboard.id=getIdWithTimeStamp("dashboard"),f.removeDashboardPublishDetailsFromDownloadedJson(n);var o=n.Dashboard.AbsoluteLayout.Object;n=JSON.stringify(n);for(var a=0;a<o.length;a++)var t=angular.copy(o[a].objectID),s=getIdWithTimeStamp("BVZ-"+a+"-"),t=new RegExp(t,"g"),n=n.replace(t,s);n=JSON.parse(n),f.exportToDefaultLocation(e.name,{dashboardJson:n})}else D.showNotification("No active dashboard","alert-danger",3e3)},f.exportToDefaultLocation=function(e,o){var a,t=document.createElement("a"),t=(t.setAttribute("id","anchor"),document.body.appendChild(t),document.createElement("iframe"));document.body.appendChild(t),t.setAttribute("id","exportIframe"),t.style.display="none",t.style.visibility="hidden",(isIE=!!document.documentMode)?(a=angular.toJson(o),t=new Blob([a]),window.navigator.msSaveBlob(t,e+".bvzx")):(isSafari=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"))?(t="data:application/...,"+encodeURIComponent(angular.toJson(o)),location.replace(t)):(t=$("#anchor"),a=angular.toJson(o),o=new Blob([a],{type:"text/plain"}),a=URL.createObjectURL(o),$(t).attr({download:e+".bvzx",href:a}),$(t)[0].click()),$("#exportIframe").remove()},f.reloadWorkSpaces=function(){f.getWorkspaces(f.updatePublishPage)},f.updatePublishPage=function(e){null!=D.AUTH_INFO.get("rootFolders")?(i(function(){f.selectedFolderToPublish=D.AUTH_INFO.get("rootFolders")[0]},1),f.loadFolderStructure()):D.showNotification("Failed to get Root-Folder","alert-danger",3e3)},f.loadFolderStructure=function(){f.publishFolder=[];for(var e,o=D.AUTH_INFO.get("rootFolders"),a=0;a<o.length;a++)"share_with_me"!==o[a].type&&((e={name:"",id:"",nodes:[]}).id=o[a].id,e.name=o[a].title,e.nodes=[],e.isChildPresent=!1,f.publishFolder.push(e))},f.openPublishDialog_OLD=function(e){f.publishDashboardName=e.dashboardName,f.publishDashboardDescription="Published from dashboard designer",f.dashboardToPublish=e,f.getDashboardJsonFromServer(e.dashboardId,function(e){e.DesignerResp.success&&(f.drParams=e.DesignerResp.params,(e=convertStringToJson(e.DesignerResp.params).dashboardJson).Dashboard)?(f.pubDocId=e.Dashboard.versionDetails.publishDocId,f.checkForAlreadyPublished(f.pubDocId,f.showPublishDialog)):D.showNotification("Invalid dashboard configuration","alert-danger",3e3)},function(){D.showNotification("Failed to get dashboard file for publishing","alert-danger",3e3)})},f.gitExport=function(e,o,a){e.stopPropagation(),f.modal.gitexportconfig={commitMessage:"",dashboardId:o.dashboardId},f.isInUse(o.dashboardId)?D.showNotification("Workspace is in use","alert-danger",3e3):(f.updateDashAction=a,f.isTrashAction=!1,f.updateModalPopup(e,o,a),f.showModelPopup("gitExportModalDialog"),f.setFocusOnInput("#gitExportModalDialog","#dashboardName"))},f.vcsPush=function(e,o,a){e.stopPropagation(),f.modal.vcsexportconfig={commitMessage:"",pushItem:"vcs",pushType:[{label:"Dashboard Versioning",value:"vcs"},{label:"Git Export",value:"gitmigration"}],dashboardId:String(o.dashboardId)},f.isInUse(o.dashboardId)?D.showNotification("Workspace is in use","alert-danger",3e3):(f.updateDashAction=a,f.isTrashAction=!1,f.updateModalPopup(e,o,a),f.showModelPopup("vcsExportModalDialog"),f.setFocusOnInput("#vcsExportModalDialog","#dashboardName"))},f.openVcsImportDialog=function(e,o){e.stopPropagation(),f.modal.pullDashboard={pushVersion:""},f.modal.importVcsDbConfig={name:f.modal.replaceSpecialCharWithUnderscore(o.dashboardName),description:"Pull from VCS",dashboardInfo:o,dashboardId:String(o.dashboardId),publishedVersions:[]},f.getDashboardVersionList()},f.getDashboardVersionList=function(){var e=window.sessionStorage.getItem("bvz_spacekey"),o=(window.sessionStorage.getItem("bvz_token"),f.modal.importVcsDbConfig.dashboardId),o=(window.sessionStorage.getItem("bvz_userid"),{data:{dashId:o,name:f.modal.importVcsDbConfig.name,module:"Dashboard"},spacekey:e,consumerName:"BVZGIT",serviceName:"fetchComponentVersions",isSecure:!0});requestSuccessFn=function(e,o){if(e.success){for(var a=0;a<e.data.length;a++)f.modal.importVcsDbConfig.publishedVersions.push(e.data[a]);D.showNotification("Version list successfully loaded","alert-success",3e3),D.hideLoader(),f.showModelPopup("vcsImportModalDialog")}else D.showNotification(e.errorMessage,"alert-danger",3e3)},requestFailedFn=function(e,o){D.showNotification("Error in fetching version list","alert-danger",3e3),f.showModelPopup("vcsImportModalDialog"),D.hideLoader()},D.showLoader(),BIZVIZ.SDK.secureRequest("/bizviz/pluginService",o,requestSuccessFn,requestFailedFn)},f.updateVcsImport=function(){var e,o;""==f.modal.pullDashboard.pushVersion?D.showNotification("Please select version","alert-danger",3e3):(e=window.sessionStorage.getItem("bvz_spacekey"),window.sessionStorage.getItem("bvz_token"),o=f.modal.importVcsDbConfig.dashboardId,window.sessionStorage.getItem("bvz_userid"),o={dashId:o,name:f.modal.importVcsDbConfig.name,module:"Dashboard",commitId:String(f.modal.pullDashboard.pushVersion)},requestSuccessFn=function(e){e.success?D.showNotification("Dashboard Imported successfully !","alert-success",3e3):D.showNotification(e.errorMessage,"alert-danger",3e3)},requestFailedFn=function(e,o){D.showNotification("Dashboard Not Imported !","alert-danger",3e3)},BIZVIZ.SDK.secureRequest("/bizviz/pluginService",{data:o,spacekey:e,consumerName:"BVZGIT",serviceName:"pullDashboard",isSecure:!0},requestSuccessFn,requestFailedFn))},f.openShareWokspaceDialog=function(e,o){e.stopPropagation(),f.modal.shareWorkspaceDbConfig={name:f.modal.replaceSpecialCharWithUnderscore(o.dashboardName),description:"Share from dashboard designer",dashboardInfo:o,dashboardJson:"",pubDocId:0,publishedVersions:[],sharedTo:{selectedUsers:[],selectedGroups:[],excludedUsers:[]},publishTo:{users:[],userGroupsList:[],excludeUsers:[]},publishNew:{users:[],userGroupsList:[],excludeUsers:[]},selectedTab:0,alreadyPublished:!1,publishAction:"PUB_NEW",selectedFolderName:"",publishTime:"",currentUser:{address:"",fullName:D.AUTH_INFO.get("user").fullName,id:D.AUTH_INFO.get("user").id,lastLoginDate:D.AUTH_INFO.get("user").lastLoginDate,spaceKey:D.AUTH_INFO.get("user").spaceKey,state:"",status:D.AUTH_INFO.get("user").status,thirdPartyUser:"",uniqueId:D.AUTH_INFO.get("user").uniqueId||D.AUTH_INFO.get("user").emailID,userName:D.AUTH_INFO.get("user").userName,userType:D.AUTH_INFO.get("user").userType,published:!1},legacyPubVersion:""},f.getShareWorkspacePrviledgeUserAndGroupList(),f.getShareWorkspaceUserAndGroupList(function(){f.showModelPopup("shareWorkspaceModalDialog"),f.setFocusOnInput("#shareWorkspaceModalDialog","#publishUserSearchW"),f.onShareWorkspaceActionChange()},function(){D.showNotification("Failed to get list of users","alert-danger",3e3)})},f.getShareWorkspacePrviledgeUserAndGroupList=function(){f.modal.shareWorkspaceDbConfig.sharedTo.selectedUsersAccessPrivileges||(f.modal.shareWorkspaceDbConfig.sharedTo.selectedUsersAccessPrivileges=[]),f.modal.shareWorkspaceDbConfig.sharedTo.selectedGroupAccessPrivileges||(f.modal.shareWorkspaceDbConfig.sharedTo.selectedGroupAccessPrivileges=[]),f.modal.shareWorkspaceDbConfig.sharedTo.excludedGroupUsers||(f.modal.shareWorkspaceDbConfig.sharedTo.excludedGroupUsers=[]),f.modal.shareWorkspaceDbConfig.sharedTo.excludedGroupUsers||(f.modal.shareWorkspaceDbConfig.sharedTo.excludedGroupUsers=[]);var e={workSpaceId:f.modal.shareWorkspaceDbConfig.dashboardInfo.dashboardId};D.showLoader(),BIZVIZ.SDK.secureRequest("/designer/getDashborardWorkSpacePriviligeDetails",e,function(e,o){if(e.userprivilegeResp.selectedUsers&&0<e.userprivilegeResp.selectedUsers.length)for(var a=0;a<e.userprivilegeResp.selectedUsers.length;a++)f.modal.shareWorkspaceDbConfig.sharedTo.selectedUsers.push(parseInt(e.userprivilegeResp.selectedUsers[a])),f.modal.shareWorkspaceDbConfig.sharedTo.selectedUsersAccessPrivileges.push(e.userprivilegeResp.selectedUsersAccessPrivileges[a]);if(e.userprivilegeResp.selectedGroups&&0<e.userprivilegeResp.selectedGroups.length)for(a=0;a<e.userprivilegeResp.selectedGroups.length;a++)f.modal.shareWorkspaceDbConfig.sharedTo.selectedGroups.push(parseInt(e.userprivilegeResp.selectedGroups[a])),f.modal.shareWorkspaceDbConfig.sharedTo.selectedGroupAccessPrivileges.push(e.userprivilegeResp.selectedGroupAccessPrivileges[a]);if(e.userprivilegeResp.excludedUsers&&0<e.userprivilegeResp.excludedUsers.length)for(a=0;a<e.userprivilegeResp.excludedUsers.length;a++)f.modal.shareWorkspaceDbConfig.sharedTo.excludedUsers.push(parseInt(e.userprivilegeResp.excludedUsers[a]));if(0<e.userprivilegeResp.excludedGroupUsers.length)for(a=0;a<e.userprivilegeResp.excludedGroupUsers.length;a++)f.modal.shareWorkspaceDbConfig.sharedTo.excludedGroupUsers.push(e.userprivilegeResp.excludedGroupUsers[a]);D.hideLoader()},function(e,o){D.showNotification("Failed to get shared list of users","alert-danger",3e3),D.hideLoader()})},f.getWorkspaceExcludeUsersFromGroupList=function(){document.getElementById("excludeUser_searchW").value="";var o=[],e=(angular.forEach(f.modal.shareWorkspaceDbConfig.publishNew.userGroupsList,function(e){e.published&&o.push(Number(e.id))}),req_url.designer.getusersfromgroups),a={groupIds:o};D.showLoader(),BIZVIZ.SDK.secureRequest(e,a,function(e,o){if(D.hideLoader(),e.userGroups.assignedUsers){for(var a=0,t=0;t<e.userGroups.assignedUsers.length;t++){var s=DesignerUtil.prototype.findInArray(f.modal.shareWorkspaceDbConfig.publishNew.excludeUsers,"id",e.userGroups.assignedUsers[t].id),s=(s&&IsBoolean(s.published)?e.userGroups.assignedUsers[t].published=!0:e.userGroups.assignedUsers[t].published=!1,DesignerUtil.prototype.findInArray(f.modal.shareWorkspaceDbConfig.publishTo.excludeUsers,"id",e.userGroups.assignedUsers[t].id));s&&IsBoolean(s.published)?(e.userGroups.assignedUsers[t].published=!0,a++):e.userGroups.assignedUsers[t].published=!1}f.modal.shareWorkspaceDbConfig.publishNew.excludeUsers=[],f.modal.shareWorkspaceDbConfig.publishTo.excludeUsers=[];for(t=0;t<e.userGroups.assignedUsers.length;t++)(-1==f.modal.shareWorkspaceDbConfig.sharedTo.excludedUsers.indexOf(e.userGroups.assignedUsers[t].id)?f.modal.shareWorkspaceDbConfig.publishNew:f.modal.shareWorkspaceDbConfig.publishTo).excludeUsers.push(e.userGroups.assignedUsers[t]);f.$apply()}b=a})},f.getShareWorkspaceUserAndGroupList=function(s,a){D.showLoader(),BIZVIZ.SDK.secureRequest("/designer/loadDashboardWorkspacePrivilege",{id:11},function(e,o){if(e.userGroups.users)for(var a=0;a<e.userGroups.users.length;a++)(-1==f.modal.shareWorkspaceDbConfig.sharedTo.selectedUsers.indexOf(e.userGroups.users[a].id)?f.modal.shareWorkspaceDbConfig.publishNew:(f.modal.shareWorkspaceDbConfig.publishNew.users.push(e.userGroups.users[a]),f.modal.shareWorkspaceDbConfig.publishTo)).users.push(e.userGroups.users[a]);if(e.userGroups.userGroupsList)for(var t=0;t<e.userGroups.userGroupsList.length;t++)(-1==f.modal.shareWorkspaceDbConfig.sharedTo.selectedGroups.indexOf(e.userGroups.userGroupsList[t].id)?f.modal.shareWorkspaceDbConfig.publishNew:(f.modal.shareWorkspaceDbConfig.publishNew.userGroupsList.push(e.userGroups.userGroupsList[t]),f.modal.shareWorkspaceDbConfig.publishTo)).userGroupsList.push(e.userGroups.userGroupsList[t]);f.modal.shareWorkspaceDbConfig.publishNew.excludeUsers=[],f.modal.shareWorkspaceDbConfig.publishTo.excludedGroupUsers=[],0<f.modal.shareWorkspaceDbConfig.sharedTo.excludedGroupUsers.length&&angular.forEach(f.modal.shareWorkspaceDbConfig.sharedTo.excludedGroupUsers,function(e){var r=JSON.parse(e);angular.forEach(f.modal.shareWorkspaceDbConfig.publishNew.users,function(o){for(var a=Object.values(r),t=0;t<a.length;t++)for(var s,n=0;n<a[t].length;n++)a[t][n]==o.id&&(s=Object.keys(r),angular.forEach(f.modal.shareWorkspaceDbConfig.publishTo.userGroupsList,function(e){s==e.id&&(e=e.name,e={userid:a[t][n],userName:o.userName,groupName:e,groupId:s[0]},f.modal.shareWorkspaceDbConfig.publishTo.excludedGroupUsers.push(e))}))})}),s&&s(e),D.hideLoader()},function(e,o){e.DesignerResp.success&&a&&a(e),D.hideLoader()})},0),p=0,u=(f.onShareWorkspaceActionChange=function(){var e=0,o=0,a=0;0<f.modal.shareWorkspaceDbConfig.publishTo.users.length&&(e=f.modal.shareWorkspaceDbConfig.publishTo.users.length),u=e,0<f.modal.shareWorkspaceDbConfig.publishTo.userGroupsList.length&&(o=f.modal.shareWorkspaceDbConfig.publishTo.userGroupsList.length),p=o,0<f.modal.shareWorkspaceDbConfig.publishTo.excludeUsers.length&&(a=f.modal.shareWorkspaceDbConfig.publishTo.excludeUsers.length),$("md-tab-item")[0].childNodes[0].data="Users",$("md-tab-item")[1].childNodes[0].data="User Groups",$("md-tab-item")[2].childNodes[0].data="Exclude Users"},f.openShareDialog=function(e){f.modal.shareDbConfig={name:f.modal.replaceSpecialCharWithUnderscore(e.dashboardName),description:"Share from dashboard designer",dashboardInfo:e,dashboardJson:"",pubDocId:0,publishedVersions:[],sharedTo:{selectedUsers:[],selectedGroups:[],excludedUsers:[]},publishTo:{users:[],userGroupsList:[],excludeUsers:[]},publishNew:{users:[],userGroupsList:[],excludeUsers:[]},selectedTab:0,alreadyPublished:!1,publishAction:"PUB_NEW",publishTime:"",currentUser:{address:"",fullName:D.AUTH_INFO.get("user").fullName,id:D.AUTH_INFO.get("user").id,lastLoginDate:D.AUTH_INFO.get("user").lastLoginDate,spaceKey:D.AUTH_INFO.get("user").spaceKey,state:"",status:D.AUTH_INFO.get("user").status,thirdPartyUser:"",uniqueId:D.AUTH_INFO.get("user").uniqueId||D.AUTH_INFO.get("user").emailID,userName:D.AUTH_INFO.get("user").userName,userType:D.AUTH_INFO.get("user").userType,published:!1},legacyPubVersion:""},f.getShareDashboardPrviledgeUserAndGroupList(),f.getShareDashboardUserAndGroupList(function(){f.showModelPopup("shareModalDialog"),f.setFocusOnInput("#shareModalDialog","#publishUserSearchD"),f.onShareActionChange()},function(){D.showNotification("Failed to get list of users","alert-danger",3e3)})},f.getShareDashboardPrviledgeUserAndGroupList=function(){f.modal.shareDbConfig.sharedTo.selectedUsersAccessPrivileges||(f.modal.shareDbConfig.sharedTo.selectedUsersAccessPrivileges=[]),f.modal.shareDbConfig.sharedTo.selectedGroupAccessPrivileges||(f.modal.shareDbConfig.sharedTo.selectedGroupAccessPrivileges=[]),f.modal.shareDbConfig.sharedTo.excludedGroupUsers||(f.modal.shareDbConfig.sharedTo.excludedGroupUsers=[]),f.modal.shareDbConfig.sharedTo.excludedGroupUsers||(f.modal.shareDbConfig.sharedTo.excludedGroupUsers=[]);var e={workSpaceId:f.modal.shareDbConfig.dashboardInfo.dashboardId};D.showLoader(),BIZVIZ.SDK.secureRequest("/designer/getDashborardPriviligeDetails",e,function(e,o){if(e.userprivilegeResp.selectedUsers&&0<e.userprivilegeResp.selectedUsers.length)for(var a=0;a<e.userprivilegeResp.selectedUsers.length;a++)f.modal.shareDbConfig.sharedTo.selectedUsers.push(parseInt(e.userprivilegeResp.selectedUsers[a])),f.modal.shareDbConfig.sharedTo.selectedUsersAccessPrivileges.push(e.userprivilegeResp.selectedUsersAccessPrivileges[a]);if(e.userprivilegeResp.selectedGroups&&0<e.userprivilegeResp.selectedGroups.length)for(a=0;a<e.userprivilegeResp.selectedGroups.length;a++)f.modal.shareDbConfig.sharedTo.selectedGroups.push(parseInt(e.userprivilegeResp.selectedGroups[a])),f.modal.shareDbConfig.sharedTo.selectedGroupAccessPrivileges.push(e.userprivilegeResp.selectedGroupAccessPrivileges[a]);if(e.userprivilegeResp.excludedUsers&&0<e.userprivilegeResp.excludedUsers.length)for(a=0;a<e.userprivilegeResp.excludedUsers.length;a++)f.modal.shareDbConfig.sharedTo.excludedUsers.push(parseInt(e.userprivilegeResp.excludedUsers[a]));if(0<e.userprivilegeResp.excludedGroupUsers.length)for(a=0;a<e.userprivilegeResp.excludedGroupUsers.length;a++)f.modal.shareDbConfig.sharedTo.excludedGroupUsers.push(e.userprivilegeResp.excludedGroupUsers[a]);D.hideLoader()},function(e,o){D.showNotification("Failed to get shared list of users","alert-danger",3e3),D.hideLoader()})},f.getShareDashboardUserAndGroupList=function(s,a){D.showLoader(),BIZVIZ.SDK.secureRequest("/designer/loadDashboardPrivilege",{id:12},function(e,o){if(e.userGroups.users)for(var a=0;a<e.userGroups.users.length;a++)(-1==f.modal.shareDbConfig.sharedTo.selectedUsers.indexOf(e.userGroups.users[a].id)?f.modal.shareDbConfig.publishNew:(f.modal.shareDbConfig.publishNew.users.push(e.userGroups.users[a]),f.modal.shareDbConfig.publishTo)).users.push(e.userGroups.users[a]);if(e.userGroups.userGroupsList)for(var t=0;t<e.userGroups.userGroupsList.length;t++)(-1==f.modal.shareDbConfig.sharedTo.selectedGroups.indexOf(e.userGroups.userGroupsList[t].id)?f.modal.shareDbConfig.publishNew:(f.modal.shareDbConfig.publishNew.userGroupsList.push(e.userGroups.userGroupsList[t]),f.modal.shareDbConfig.publishTo)).userGroupsList.push(e.userGroups.userGroupsList[t]);f.modal.shareDbConfig.publishNew.excludeUsers=[],f.modal.shareDbConfig.publishTo.excludedGroupUsers=[],0<f.modal.shareDbConfig.sharedTo.excludedGroupUsers.length&&angular.forEach(f.modal.shareDbConfig.sharedTo.excludedGroupUsers,function(e){var r=JSON.parse(e);angular.forEach(f.modal.shareDbConfig.publishNew.users,function(o){for(var a=Object.values(r),t=0;t<a.length;t++)for(var s,n=0;n<a[t].length;n++)a[t][n]==o.id&&(s=Object.keys(r),angular.forEach(f.modal.shareDbConfig.publishTo.userGroupsList,function(e){s==e.id&&(e=e.name,e={userid:a[t][n],userName:o.userName,groupName:e,groupId:s[0]},f.modal.shareDbConfig.publishTo.excludedGroupUsers.push(e))}))})}),s&&s(e),D.hideLoader()},function(e,o){e.DesignerResp.success&&a&&a(e),D.hideLoader()})},0),p=0;function m(e){try{$("#"+e+" option").prop("selected",!1)}catch(e){}}f.onShareActionChange=function(){var e=0,o=0,a=0;0<f.modal.shareDbConfig.publishTo.users.length&&(e=f.modal.shareDbConfig.publishTo.users.length),u=e,0<f.modal.shareDbConfig.publishTo.userGroupsList.length&&(o=f.modal.shareDbConfig.publishTo.userGroupsList.length),p=o,0<f.modal.shareDbConfig.publishTo.excludeUsers.length&&(a=f.modal.shareDbConfig.publishTo.excludeUsers.length),$("md-tab-item")[0].childNodes[0].data="Users",$("md-tab-item")[1].childNodes[0].data="User Groups",$("md-tab-item")[2].childNodes[0].data="Exclude Users"},f.getDashboardExcludeUsersFromGroupList=function(){document.getElementById("excludeUser_searchD").value="";var o=[],e=(new Array,angular.forEach(f.modal.shareDbConfig.publishNew.userGroupsList,function(e){e.published&&o.push(Number(e.id))}),req_url.designer.getusersfromgroups),a={groupIds:o};D.showLoader(),BIZVIZ.SDK.secureRequest(e,a,function(e,o){if(D.hideLoader(),e.userGroups.assignedUsers){for(var a=0,t=0;t<e.userGroups.assignedUsers.length;t++){var s=DesignerUtil.prototype.findInArray(f.modal.shareDbConfig.publishNew.excludeUsers,"id",e.userGroups.assignedUsers[t].id),s=(s&&IsBoolean(s.published)?e.userGroups.assignedUsers[t].published=!0:e.userGroups.assignedUsers[t].published=!1,DesignerUtil.prototype.findInArray(f.modal.shareDbConfig.publishTo.excludeUsers,"id",e.userGroups.assignedUsers[t].id));s&&IsBoolean(s.published)?(e.userGroups.assignedUsers[t].published=!0,a++):e.userGroups.assignedUsers[t].published=!1}f.modal.shareDbConfig.publishNew.excludeUsers=[],f.modal.shareDbConfig.publishTo.excludeUsers=[];for(t=0;t<e.userGroups.assignedUsers.length;t++)(-1==f.modal.shareDbConfig.sharedTo.excludedUsers.indexOf(e.userGroups.assignedUsers[t].id)?f.modal.shareDbConfig.publishNew:f.modal.shareDbConfig.publishTo).excludeUsers.push(e.userGroups.assignedUsers[t]);f.$apply()}b=a})},f.shareDashboardToUserGroups=function(){var e=window.sessionStorage.getItem("bvz_spacekey"),o=(window.sessionStorage.getItem("bvz_token"),f.modal.shareDbConfig.dashboardInfo.dashboardId),a=f.modal.shareDbConfig.dashboardInfo.parentId,t=(window.sessionStorage.getItem("bvz_userid"),new Array,this.shareDashboardToUser()),s=(new Array,this.shareDashboardToGroup()),n=(new Array,this.shareDashboardExcludedUsers()),r=!1,l=!1,i=!1,d=!1;1!=f.permissions.view&&1!=f.permissions.edit&&1!=f.permissions.execute||(d=!0),angular.forEach(f.modal.shareDbConfig.publishNew.users,function(e){e.published&&(r=!0)}),angular.forEach(f.modal.shareDbConfig.publishNew.userGroupsList,function(e){e.published&&(l=!0)}),i=!("Revoke"!==f.deleteUser_GroupModalHeader&&IsBoolean(!f.includeUserbtn)&&(IsBoolean(d)?!IsBoolean(r)&&!IsBoolean(l)&&(D.showNotification("Please select atleast 1 user or group","alert-danger",3e3),1):(D.showNotification("Please select atleast 1 permission","alert-danger",3e3),1))),IsBoolean(i)&&(d={pluginId:o,selectedUsers:angular.toJson(t),selectedGroups:angular.toJson(s),excludedUsers:angular.toJson(n),type:12,spacekey:e,parentId:a},requestSuccessFn=function(e){e?(f.hideModelPopup("shareModalDialog"),"Revoke"==f.deleteUser_GroupModalHeader?(D.showNotification("privilege revoked successfully","alert-success",3e3),f.deleteUser_GroupModalHeader=""):(IsBoolean(f.includeUserbtn)&&(f.includeUserbtn=!1),D.showNotification("Dashboard shared successfully","alert-success",3e3))):D.showNotification("Dashboard not shared successfully","alert-danger",3e3),D.hideLoader()},requestFailedFn=function(e,o){D.showNotification("Unsuccessfull share","alert-danger",3e3),D.hideLoader()},D.showLoader(),BIZVIZ.SDK.secureRequest("/designer/shareDashboard/",d,requestSuccessFn,requestFailedFn)),f.permissions={view:0,edit:0,execute:0}},f.shareWorkspaceDashboardToUserGroups=function(){var e=window.sessionStorage.getItem("bvz_spacekey"),o=(window.sessionStorage.getItem("bvz_token"),f.modal.shareWorkspaceDbConfig.dashboardInfo.dashboardId),a=(window.sessionStorage.getItem("bvz_userid"),new Array,this.shareWorkspaceToUser()),t=(new Array,this.shareWorkspaceToGroup()),s=(new Array,this.shareWorkspaceExcludedUsers()),n=!1,r=!1,l=!1,i=!1;1!=f.permissions.view&&1!=f.permissions.edit&&1!=f.permissions.execute||(i=!0),angular.forEach(f.modal.shareWorkspaceDbConfig.publishNew.users,function(e){e.published&&(n=!0)}),angular.forEach(f.modal.shareWorkspaceDbConfig.publishNew.userGroupsList,function(e){e.published&&(r=!0)}),"Revoke"!==f.deleteUser_GroupModalHeader&&IsBoolean(!f.includeUserbtn)?l=IsBoolean(i)?!(!IsBoolean(n)&&!IsBoolean(r)&&(D.showNotification("Please select atleast 1 user or group","alert-danger",3e3),1)):(D.showNotification("Please select atleast 1 permission","alert-danger",3e3),!1):f.includeUserbtn=!(l=!0),IsBoolean(l)&&(i={pluginId:o,selectedUsers:angular.toJson(a),selectedGroups:angular.toJson(t),excludedUsers:angular.toJson(s),type:11,spacekey:e},requestSuccessFn=function(e){e?(f.hideModelPopup("shareWorkspaceModalDialog"),"Revoke"==f.deleteUser_GroupModalHeader?(D.showNotification("privilege revoked successfully","alert-success",3e3),f.deleteUser_GroupModalHeader=""):D.showNotification("Workspace shared successfully","alert-success",3e3)):D.showNotification("Workspace not shared successfully","alert-danger",3e3),D.hideLoader()},requestFailedFn=function(e,o){D.showNotification("Unsuccessfull share","alert-danger",3e3),D.hideLoader()},D.showLoader(),BIZVIZ.SDK.secureRequest("/designer/shareDashboardWorkSpace/",i,requestSuccessFn,requestFailedFn)),f.permissions={view:0,edit:0,execute:0}},f.moveItem=function(e,o){$("#"+e+"option:selected").each(function(){$("#"+o).append("<option value='"+$(this).val()+"'>"+$(this).text()+"</option>"),$(this).remove()}),angular.element(document.querySelector("#"+o)).append(angular.element(document.querySelector("#"+e)).find("option:selected")),angular.element(document.querySelector("#"+e)).find("option:selected").remove(),m(o)},f.moveAllItems=function(e,o){var e=document.getElementById(e),a=document.getElementById(o);a.innerHTML=a.innerHTML+e.innerHTML,e.innerHTML="",m(o)},f.filterFunction=function(e,o){for(var a=document.getElementById(e).value.toUpperCase(),t=document.getElementById(o).getElementsByTagName("option"),s=0;s<t.length;s++)-1<(txtValue=t[s].textContent||t[s].innerText).toUpperCase().indexOf(a)?t[s].style.display="":t[s].style.display="none"},f.UserfilterFunction=function(e,o){for(var a=document.getElementById(e).value.toUpperCase(),t=document.getElementById(o).getElementsByTagName("md-list-item"),s=0;s<t.length;s++){var n=t[s].getElementsByTagName("h5")[0];n&&(-1<(n.textContent||n.innerText).toUpperCase().indexOf(a)?t[s].style.display="":t[s].style.display="none")}},f.onPermissionChange=function(e){f.permissions=e,f.permissions={view:f.permissions.view?1:0,edit:f.permissions.edit?1:0,execute:f.permissions.execute?1:0}},f.deleteWorkspaceList=function(o){angular.forEach(f.modal.shareWorkspaceDbConfig.publishTo.users,function(e){e.id==o.id&&(f.modal.shareWorkspaceDbConfig.selectedTab=0,-1!==(e=f.modal.shareWorkspaceDbConfig.publishTo.users.findIndex(function(e){return e.id===o.id})))&&f.modal.shareWorkspaceDbConfig.publishTo.users.splice(e,1)}),angular.forEach(f.modal.shareWorkspaceDbConfig.publishTo.userGroupsList,function(e){e.id==o.id&&-(f.modal.shareWorkspaceDbConfig.selectedTab=1)!==(e=f.modal.shareWorkspaceDbConfig.publishTo.userGroupsList.findIndex(function(e){return e.id===o.id}))&&f.modal.shareWorkspaceDbConfig.publishTo.userGroupsList.splice(e,1)}),angular.forEach(f.modal.shareWorkspaceDbConfig.publishTo.excludedGroupUsers,function(e){e.groupId==o.id&&-1!==(e=f.modal.shareWorkspaceDbConfig.publishTo.excludedGroupUsers.findIndex(function(e){return+e.groupId===o.id}))&&f.modal.shareWorkspaceDbConfig.publishTo.excludedGroupUsers.splice(e,1)})},f.includeUser=function(o){f.includeUserbtn=!0,angular.forEach(f.modal.shareWorkspaceDbConfig?.sharedTo.excludedUsers,function(e){o.userid==e&&(-1!==(e=f.modal.shareWorkspaceDbConfig.sharedTo.excludedUsers.findIndex(function(e){return e===o.userid}))&&f.modal.shareWorkspaceDbConfig.sharedTo.excludedUsers.splice(e,1),-1!==(e=f.modal.shareWorkspaceDbConfig.publishTo.excludedGroupUsers.findIndex(function(e){return e.userid===o.userid})))&&f.modal.shareWorkspaceDbConfig.publishTo.excludedGroupUsers.splice(e,1)}),angular.forEach(f.modal.shareDbConfig?.sharedTo.excludedUsers,function(e){o.userid==e&&(-1!==(e=f.modal.shareDbConfig.sharedTo.excludedUsers.findIndex(function(e){return e===o.userid}))&&f.modal.shareDbConfig.sharedTo.excludedUsers.splice(e,1),-1!==(e=f.modal.shareDbConfig.publishTo.excludedGroupUsers.findIndex(function(e){return e.userid===o.userid})))&&f.modal.shareDbConfig.publishTo.excludedGroupUsers.splice(e,1)})},f.getPrivileges=function(s){var n="N/A";return angular.forEach(f.modal.shareDbConfig?.sharedTo.selectedUsersAccessPrivileges,function(e){e=JSON.parse(e);if(e[s]){var o,a=e[s],t=[];for(o in a)1===a[o]&&t.push(o.charAt(0).toUpperCase()+o.slice(1));0<t.length&&(n=t.join(", "))}}),angular.forEach(f.modal.shareDbConfig?.sharedTo.selectedGroupAccessPrivileges,function(e){e=JSON.parse(e);if(e[s]){var o,a=e[s],t=[];for(o in a)1===a[o]&&t.push(o.charAt(0).toUpperCase()+o.slice(1));0<t.length&&(n=t.join(", "))}}),angular.forEach(f.modal.shareWorkspaceDbConfig?.sharedTo.selectedUsersAccessPrivileges,function(e){e=JSON.parse(e);if(e[s]){var o,a=e[s],t=[];for(o in a)1===a[o]&&t.push(o.charAt(0).toUpperCase()+o.slice(1));0<t.length&&(n=t.join(", "))}}),angular.forEach(f.modal.shareWorkspaceDbConfig?.sharedTo.selectedGroupAccessPrivileges,function(e){e=JSON.parse(e);if(e[s]){var o,a=e[s],t=[];for(o in a)1===a[o]&&t.push(o.charAt(0).toUpperCase()+o.slice(1));0<t.length&&(n=t.join(", "))}}),n},f.confirmDeleteUserGroup=function(e,o,a,t){e.stopPropagation(),f.user_groupName=a,f.type=t,f.user_GroupToDelete=o,f.deleteUser_GroupModalHeader="Revoke",f.showModelPopup("confirmDeleteUserGroupModal")},f.deleteUser_Group=function(e,o){"workspace"==o?(f.deleteWorkspaceList(e),f.shareWorkspaceDashboardToUserGroups()):"dashboard"==o&&(f.deleteUsersForDashboard(e),f.shareDashboardToUserGroups()),f.closeDeleteUserGroupModal()},f.closeDeleteUserGroupModal=function(){f.setModelWatcherStatus("confirmDeleteUserGroupModal",!1)},f.deleteUsersForDashboard=function(o){angular.forEach(f.modal.shareDbConfig.publishTo.users,function(e){e.id==o.id&&(f.modal.shareDbConfig.selectedTab=0,-1!==(e=f.modal.shareDbConfig.publishTo.users.findIndex(function(e){return e.id===o.id})))&&f.modal.shareDbConfig.publishTo.users.splice(e,1)}),angular.forEach(f.modal.shareDbConfig.publishTo.userGroupsList,function(e){e.id==o.id&&-(f.modal.shareDbConfig.selectedTab=1)!==(e=f.modal.shareDbConfig.publishTo.userGroupsList.findIndex(function(e){return e.id===o.id}))&&f.modal.shareDbConfig.publishTo.userGroupsList.splice(e,1)}),angular.forEach(f.modal.shareDbConfig.publishTo.excludedGroupUsers,function(e){e.groupId==o.id&&-1!==(e=f.modal.shareDbConfig.publishTo.excludedGroupUsers.findIndex(function(e){return+e.groupId===o.id}))&&f.modal.shareDbConfig.publishTo.excludedGroupUsers.splice(e,1)})},f.shareWorkspaceToUser=function(){var a=[];return"Revoke"!==f.deleteUser_GroupModalHeader&&IsBoolean(!f.includeUserbtn)&&angular.forEach(f.modal.shareWorkspaceDbConfig.publishNew.users,function(e){var o={};e.published&&(o[String(e.id)]=f.permissions,a.push(o))}),angular.forEach(f.modal.shareWorkspaceDbConfig.publishTo.users,function(o){!1!==o.published&&angular.forEach(f.modal.shareWorkspaceDbConfig.sharedTo.selectedUsersAccessPrivileges,function(e){e=JSON.parse(e);!a.some(function(e){return Object.keys(e)[0]===String(o.id)})&&e[o.id]&&a.push(e)})}),a},f.shareWorkspaceToGroup=function(){var a=[];return"Revoke"!==f.deleteUser_GroupModalHeader&&angular.forEach(f.modal.shareWorkspaceDbConfig.publishNew.userGroupsList,function(e){var o={};e.published&&(o[String(e.id)]=f.permissions,a.push(o))}),angular.forEach(f.modal.shareWorkspaceDbConfig.publishTo.userGroupsList,function(o){!1!==o.published&&angular.forEach(f.modal.shareWorkspaceDbConfig.sharedTo.selectedGroupAccessPrivileges,function(e){e=JSON.parse(e);!a.some(function(e){return Object.keys(e)[0]===String(o.id)})&&e[o.id]&&a.push(e)})}),a},f.shareWorkspaceExcludedUsers=function(){var o=[];return"Revoke"!==f.deleteUser_GroupModalHeader&&IsBoolean(!f.includeUserbtn)&&angular.forEach(f.modal.shareWorkspaceDbConfig.publishNew.excludeUsers,function(e){e.published&&o.push(Number(e.id))}),angular.forEach(f.modal.shareWorkspaceDbConfig.sharedTo.excludedUsers,function(e){0!=e.published&&o.push(Number(e))}),o},f.shareDashboardToUser=function(){var a=[];return"Revoke"!==f.deleteUser_GroupModalHeader&&IsBoolean(!f.includeUserbtn)&&angular.forEach(f.modal.shareDbConfig.publishNew.users,function(e){var o={};e.published&&(o[String(e.id)]=f.permissions,a.push(o))}),angular.forEach(f.modal.shareDbConfig.publishTo.users,function(o){!1!==o.published&&angular.forEach(f.modal.shareDbConfig.sharedTo.selectedUsersAccessPrivileges,function(e){e=JSON.parse(e);!a.some(function(e){return Object.keys(e)[0]===String(o.id)})&&e[o.id]&&a.push(e)})}),a},f.shareDashboardToGroup=function(){var a=[];return"Revoke"!==f.deleteUser_GroupModalHeader&&IsBoolean(!f.includeUserbtn)&&angular.forEach(f.modal.shareDbConfig.publishNew.userGroupsList,function(e){var o={};e.published&&(o[String(e.id)]=f.permissions,a.push(o))}),angular.forEach(f.modal.shareDbConfig.publishTo.userGroupsList,function(o){!1!==o.published&&angular.forEach(f.modal.shareDbConfig.sharedTo.selectedGroupAccessPrivileges,function(e){e=JSON.parse(e);!a.some(function(e){return Object.keys(e)[0]===String(o.id)})&&e[o.id]&&a.push(e)})}),a},f.shareDashboardExcludedUsers=function(){var o=[];return"Revoke"!==f.deleteUser_GroupModalHeader&&IsBoolean(!f.includeUserbtn)&&angular.forEach(f.modal.shareDbConfig.publishNew.excludeUsers,function(e){e.published&&o.push(Number(e.id))}),angular.forEach(f.modal.shareDbConfig.sharedTo.excludedUsers,function(e){e&&o.push(Number(e))}),o},f.clearfilterFunction=function(e,o){var a,t;for(document.getElementById(e).value="",a=document.getElementById(o).getElementsByTagName("md-list-item"),t=0;t<a.length;t++)a[t].style.display=""},f.openPublishDialog=function(e){f.modal.publishDbConfig={name:f.modal.replaceSpecialCharWithUnderscore(e.dashboardName),description:"Published from dashboard designer",dashboardInfo:e,dashboardJson:"",pubDocId:0,publishedVersions:[],publishToFolder:"",publishToFolderId:"",publishTo:{users:[],userGroupsList:[],excludeUsers:[]},publishNew:{users:[],userGroupsList:[],excludeUsers:[]},selectedTab:0,alreadyPublished:!1,publishAction:"PUB_NEW",publishTime:"",currentUser:{address:"",fullName:D.AUTH_INFO.get("user").fullName,id:D.AUTH_INFO.get("user").id,lastLoginDate:D.AUTH_INFO.get("user").lastLoginDate,spaceKey:D.AUTH_INFO.get("user").spaceKey,rootFolders:D.AUTH_INFO.get("rootFolders"),state:"",status:D.AUTH_INFO.get("user").status,thirdPartyUser:"",uniqueId:D.AUTH_INFO.get("user").uniqueId||D.AUTH_INFO.get("user").emailID,userName:D.AUTH_INFO.get("user").userName,userType:D.AUTH_INFO.get("user").userType,published:!1},legacyPubVersion:""},f.getDashboardJsonFromServer(f.modal.publishDbConfig.dashboardInfo.dashboardId,function(e){var o,a;e.DesignerResp.success?(f.modal.publishDbConfig.dashboardJson=e.DesignerResp.params,o=(e=convertStringToJson(e.DesignerResp.params)).dashboardJson,e=e.infoJson,o&&o.Dashboard&&null==e?(f.modal.publishDbConfig.publishToFolderId="",f.getSelectedFolderValue(f.modal.publishDbConfig.publishToFolderId),f.modal.publishDbConfig.pubDocId=o.Dashboard.versionDetails.publishDocId||0,""!==o.Dashboard.versionDetails.publishDocId&&0!==o.Dashboard.versionDetails.publishDocId&&(f.modal.publishDbConfig.alreadyPublished=!0,f.modal.publishDbConfig.publishAction="PUB_OVERRIDE",null==o.Dashboard.versionDetails.publishedVersions)&&(o.Dashboard.versionDetails.publishedVersions=[],f.modal.publishDbConfig.legacyPubVersion={id:f.modal.publishDbConfig.pubDocId,name:f.modal.publishDbConfig.name,description:f.modal.publishDbConfig.description,publishTime:o.Dashboard.versionDetails.publishedOn,publishFolder:f.modal.publishDbConfig.publishToFolderId,legacyPubVersion:!0},o.Dashboard.versionDetails.publishedVersions.push(f.modal.publishDbConfig.legacyPubVersion)),f.modal.publishDbConfig.publishedVersions=o.Dashboard.versionDetails.publishedVersions||[],(a=DesignerUtil.prototype.findInArray(f.modal.publishDbConfig.publishedVersions,"id",f.modal.publishDbConfig.pubDocId))&&(f.modal.publishDbConfig.name=f.modal.replaceSpecialCharWithUnderscore(a.name||f.modal.publishDbConfig.name),f.modal.publishDbConfig.description=a.description||f.modal.publishDbConfig.description),f.getUserAndGroupList(function(){f.showModelPopup("publishModalDialog"),f.setFocusOnInput("#publishModalDialog","#publishUserSearch"),f.onActionChange()},function(){D.showNotification("Failed to get list of users","alert-danger",3e3)})):o&&o.Dashboard&&null!=e?(f.modal.publishDbConfig.publishToFolderId=e.publishFolderId||"",f.getSelectedFolderValue(f.modal.publishDbConfig.publishToFolderId,e),f.modal.publishDbConfig.pubDocId=e.publishDocId||0,""!==e.publishDocId&&0!==e.publishDocId&&(f.modal.publishDbConfig.alreadyPublished=!0,f.modal.publishDbConfig.publishAction="PUB_OVERRIDE",null==e.publishedVersions)&&(e.publishedVersions=[],f.modal.publishDbConfig.legacyPubVersion={id:f.modal.publishDbConfig.pubDocId,name:f.modal.publishDbConfig.name,description:f.modal.publishDbConfig.description,publishTime:e.publishedOn,publishFolder:f.modal.publishDbConfig.publishToFolderId,legacyPubVersion:!0},e.publishedVersions.push(f.modal.publishDbConfig.legacyPubVersion)),f.modal.publishDbConfig.publishedVersions=e.publishedVersions||[],(a=DesignerUtil.prototype.findInArray(f.modal.publishDbConfig.publishedVersions,"id",f.modal.publishDbConfig.pubDocId))&&(f.modal.publishDbConfig.name=f.modal.replaceSpecialCharWithUnderscore(a.name||f.modal.publishDbConfig.name),f.modal.publishDbConfig.description=a.description||f.modal.publishDbConfig.description),f.getUserAndGroupList(function(){f.showModelPopup("publishModalDialog"),f.setFocusOnInput("#publishModalDialog","#publishUserSearch"),f.onActionChange()},function(){D.showNotification("Failed to get list of users","alert-danger",3e3)})):D.showNotification("Invalid dashboard configuration","alert-danger",3e3)):D.showNotification("Invalid dashboard configuration","alert-danger",3e3)},function(){D.showNotification("Failed to get dashboard file for publishing","alert-danger",3e3)})},f.getUserAndGroupList=function(i,a){var e=req_url.designer.loadPrivilege,o={treeID:f.modal.publishDbConfig.pubDocId};D.showLoader(),BIZVIZ.SDK.secureRequest(e,o,function(e,o){if(""!==f.modal.publishDbConfig.pubDocId&&0!==f.modal.publishDbConfig.pubDocId){if(e.userGroups.assignedUsers&&0<e.userGroups.assignedUsers.length){for(var a=!1,t=0;t<e.userGroups.assignedUsers.length;t++)f.modal.publishDbConfig.currentUser.id!==e.userGroups.assignedUsers[t].id?(e.userGroups.assignedUsers[t].published=!0,f.modal.publishDbConfig.publishTo.users.push(e.userGroups.assignedUsers[t])):e.userGroups.assignedUsers[t].published=a=!0,f.modal.publishDbConfig.publishNew.users.push(e.userGroups.assignedUsers[t]);IsBoolean(a)&&(f.modal.publishDbConfig.currentUser.published=!0,f.modal.publishDbConfig.publishTo.users.push(f.modal.publishDbConfig.currentUser))}else e.userGroups.assignedUserGroups&&0==e.userGroups.assignedUserGroups.length&&(f.modal.publishDbConfig.disablepublish=!0);if(e.userGroups.assignedUserGroups)for(var s=0;s<e.userGroups.assignedUserGroups.length;s++)e.userGroups.assignedUserGroups[s].published=!0,f.modal.publishDbConfig.publishTo.userGroupsList.push(e.userGroups.assignedUserGroups[s]),f.modal.publishDbConfig.publishNew.userGroupsList.push(e.userGroups.assignedUserGroups[s]);if(e.userGroups.excludeUsers)for(var n=0;n<e.userGroups.excludeUsers.length;n++)e.userGroups.excludeUsers[n].published=!0,f.modal.publishDbConfig.publishTo.excludeUsers.push(e.userGroups.excludeUsers[n])}if(IsBoolean(f.modal.publishDbConfig.currentUser.published)||f.modal.publishDbConfig.publishNew.users.push(f.modal.publishDbConfig.currentUser),e.userGroups.users)for(var r=0;r<e.userGroups.users.length;r++)e.userGroups.users[r].published=!1,f.modal.publishDbConfig.publishNew.users.push(e.userGroups.users[r]);if(e.userGroups.userGroupsList)for(var l=0;l<e.userGroups.userGroupsList.length;l++)e.userGroups.userGroupsList[l].published=!1,f.modal.publishDbConfig.publishNew.userGroupsList.push(e.userGroups.userGroupsList[l]);f.modal.publishDbConfig.publishNew.excludeUsers=[],i&&i(e),D.hideLoader()},function(e,o){e.DesignerResp.success&&a&&a(e),D.hideLoader()})},f.getExcludeUsersFromGroupList=function(){var o=[],e=(f.modal.publishDbConfig.publishNew.userGroupsList.map(function(e){IsBoolean(e.published)&&o.push(e.id)}),req_url.designer.getusersfromgroups),a={groupIds:o};D.showLoader(),BIZVIZ.SDK.secureRequest(e,a,function(e,o){if(D.hideLoader(),e.userGroups.assignedUsers){for(var a=0,t=0;t<e.userGroups.assignedUsers.length;t++){var s=DesignerUtil.prototype.findInArray(f.modal.publishDbConfig.publishNew.excludeUsers,"id",e.userGroups.assignedUsers[t].id);s&&IsBoolean(s.published)?(e.userGroups.assignedUsers[t].published=!0,a++):e.userGroups.assignedUsers[t].published=!1}f.modal.publishDbConfig.publishNew.excludeUsers=e.userGroups.assignedUsers,f.$apply()}b=a,"PUB_NEW"==f.modal.publishDbConfig.publishAction&&($("md-tab-item")[2].childNodes[0].data="Exclude Users ("+b+")")})},f.getAllExcludeUsersFromGroupList=function(){var o=[],e=(f.modal.publishDbConfig.publishNew.userGroupsList.map(function(e){IsBoolean(e.published)&&o.push(e.id)}),{groupIds:o});D.showLoader(),BIZVIZ.SDK.secureRequest("/document/getAllUsersFromGroups",e,function(e,o){if(D.hideLoader(),e.userGroups.assignedUsers){for(var a=0,t=0;t<e.userGroups.assignedUsers.length;t++){var s=DesignerUtil.prototype.findInArray(f.modal.publishDbConfig.publishNew.excludeUsers,"id",e.userGroups.assignedUsers[t].id);s&&IsBoolean(s.published)?(e.userGroups.assignedUsers[t].published=!0,a++):e.userGroups.assignedUsers[t].published=!1}f.modal.publishDbConfig.publishNew.excludeUsers=e.userGroups.assignedUsers,f.$apply()}b=a,"PUB_NEW"==f.modal.publishDbConfig.publishAction&&($("md-tab-item")[2].childNodes[0].data="Exclude Users ("+b+")")})},f.getSelectedFolderValue=function(o,a){""==o?f.modal.publishDbConfig.selectedFolderName="My Documents":(a&&angular.forEach(a.publishedVersions,function(e){e.id===a.publishDocId&&(o=e.publishFolder)}),angular.forEach(f.modal.publishDbConfig.currentUser.rootFolders,function(e){e.id===o&&(f.modal.publishDbConfig.selectedFolderName=e.title)}))},f.getPublishedFolderName=function(o){var a="My Documents";return null!=o&&angular.forEach(f.modal.publishDbConfig.currentUser.rootFolders,function(e){e.id===o&&(a=e.title)}),a},f.getUserGroupsForVersion=function(){f.modal.publishDbConfig.publishTo.users=[],f.modal.publishDbConfig.publishTo.userGroupsList=[],f.modal.publishDbConfig.publishTo.excludeUsers=[],f.modal.publishDbConfig.publishNew.users=[],f.modal.publishDbConfig.publishNew.userGroupsList=[];var e=req_url.designer.loadPrivilege,o={treeID:f.modal.publishDbConfig.pubDocId};D.showLoader(),BIZVIZ.SDK.secureRequest(e,o,function(e,o){var a=";";if("PUB_NEW"!==f.modal.publishDbConfig.publishAction&&(i=f.modal.publishDbConfig.publishedVersions.findIndex(function(e){return e.id===f.modal.publishDbConfig.pubDocId}),a=f.modal.publishDbConfig.publishedVersions[i].publishFolder||""),f.getSelectedFolderValue(a),""!==f.modal.publishDbConfig.pubDocId&&0!==f.modal.publishDbConfig.pubDocId){if(e.userGroups.assignedUsers)for(var t=0;t<e.userGroups.assignedUsers.length;t++)e.userGroups.assignedUsers[t].published=!0,f.modal.publishDbConfig.publishTo.users.push(e.userGroups.assignedUsers[t]),f.modal.publishDbConfig.publishNew.users.push(e.userGroups.assignedUsers[t]),f.modal.publishDbConfig.currentUser.id==e.userGroups.assignedUsers[t].id&&(f.modal.publishDbConfig.currentUser.published=!0);if(IsBoolean(f.modal.publishDbConfig.currentUser.published)||f.modal.publishDbConfig.publishNew.users.push(f.modal.publishDbConfig.currentUser),e.userGroups.assignedUsers&&0==e.userGroups.assignedUsers.length&&DesignerUtil.prototype.findInArray(f.modal.publishDbConfig.publishedVersions,"legacyPubVersion",!0)&&f.modal.publishDbConfig.publishTo.users.push(f.modal.publishDbConfig.currentUser),e.userGroups.assignedUserGroups)for(var s=0;s<e.userGroups.assignedUserGroups.length;s++)e.userGroups.assignedUserGroups[s].published=!0,f.modal.publishDbConfig.publishTo.userGroupsList.push(e.userGroups.assignedUserGroups[s]),f.modal.publishDbConfig.publishNew.userGroupsList.push(e.userGroups.assignedUserGroups[s]);if(e.userGroups.excludeUsers)for(var n=0;n<e.userGroups.excludeUsers.length;n++)e.userGroups.excludeUsers[n].published=!0,f.modal.publishDbConfig.publishTo.excludeUsers.push(e.userGroups.excludeUsers[n]),f.modal.publishDbConfig.publishNew.excludeUsers.push(e.userGroups.excludeUsers[n]);if(e.userGroups.users)for(var r=0;r<e.userGroups.users.length;r++)f.modal.publishDbConfig.publishNew.users.push(e.userGroups.users[r]);if(e.userGroups.userGroupsList)for(var l=0;l<e.userGroups.userGroupsList.length;l++)f.modal.publishDbConfig.publishNew.userGroupsList.push(e.userGroups.userGroupsList[l]);f.getExcludeUsersFromGroupList(),f.onActionChange()}"PUB_NEW"!==f.modal.publishDbConfig.publishAction&&0==e.userGroups.assignedUsers.length&&0==e.userGroups.assignedUserGroups.length?f.modal.publishDbConfig.disablepublish=!0:f.modal.publishDbConfig.disablepublish=!1;var i=DesignerUtil.prototype.findInArray(f.modal.publishDbConfig.publishedVersions,"id",f.modal.publishDbConfig.pubDocId);i&&(f.modal.publishDbConfig.name=f.modal.replaceSpecialCharWithUnderscore(i.name||f.modal.publishDbConfig.name),f.modal.publishDbConfig.description=i.description||f.modal.publishDbConfig.description),f.$apply(),D.hideLoader()},function(e,o){f.$apply(),D.hideLoader()})};var u=0,p=0,b=0;f.onActionChange=function(){var e=0,o=0,a=0;0<f.modal.publishDbConfig.publishTo.users.length&&(e=f.modal.publishDbConfig.publishTo.users.length),u=e,0<f.modal.publishDbConfig.publishTo.userGroupsList.length&&(o=f.modal.publishDbConfig.publishTo.userGroupsList.length),p=o,0<f.modal.publishDbConfig.publishTo.excludeUsers.length&&(a=f.modal.publishDbConfig.publishTo.excludeUsers.length),b=a,$("md-tab-item")[0].childNodes[0].data="Users ("+e+")",$("md-tab-item")[1].childNodes[0].data="User Groups ("+o+")",$("md-tab-item")[2].childNodes[0].data="Exclude Users ("+a+")",$("md-tab-item")[2].childNodes[0].data="Exclude Users ("+a+")"},f.onSelectDeselectUser=function(e,o){if("PUB_NEW"!==f.modal.publishDbConfig.publishAction||f.modal.publishDbConfig.alreadyPublished){if($(".md-active")[0].childNodes[0].data.includes("Users")&&!$(".md-active")[0].childNodes[0].data.includes("Exclude Users"))if(o){for(var a=0;a<f.modal.publishDbConfig.publishNew.users.length;a++)f.modal.publishDbConfig.publishNew.users[a].id===e&&u++;$("md-tab-item")[0].childNodes[0].data="Users ("+u+")"}else if(!o){for(var t=0;t<f.modal.publishDbConfig.publishNew.users.length;t++)f.modal.publishDbConfig.publishNew.users[t].id===e&&u--;$("md-tab-item")[0].childNodes[0].data="Users ("+u+")"}if($(".md-active")[0].childNodes[0].data.includes("User Groups"))if(f.getExcludeUsersFromGroupList(),o){for(a=0;a<f.modal.publishDbConfig.publishNew.userGroupsList.length;a++)f.modal.publishDbConfig.publishNew.userGroupsList[a].id===e&&p++;$("md-tab-item")[1].childNodes[0].data="User Groups ("+p+")"}else if(!o){for(a=0;a<f.modal.publishDbConfig.publishNew.userGroupsList.length;a++)f.modal.publishDbConfig.publishNew.userGroupsList[a].id===e&&p--;$("md-tab-item")[1].childNodes[0].data="User Groups ("+p+")"}if($(".md-active")[0].childNodes[0].data.includes("Exclude Users"))if(o){for(a=0;a<f.modal.publishDbConfig.publishNew.excludeUsers.length;a++)f.modal.publishDbConfig.publishNew.excludeUsers[a].id===e&&b++;$("md-tab-item")[2].childNodes[0].data="Exclude Users ("+b+")"}else if(!o){for(a=0;a<f.modal.publishDbConfig.publishNew.excludeUsers.length;a++)f.modal.publishDbConfig.publishNew.excludeUsers[a].id===e&&b--;$("md-tab-item")[2].childNodes[0].data="Exclude Users ("+b+")"}}else f.onSelectDeselectUserPublishNew(e,o)},f.onSelectDeselectUserPublishNew=function(e,o){if($(".md-active")[0].childNodes[0].data.includes("Users")&&!$(".md-active")[0].childNodes[0].data.includes("Exclude Users"))if(o){for(var a=0;a<f.modal.publishDbConfig.publishNew.users.length;a++)f.modal.publishDbConfig.publishNew.users[a].id===e&&u++;$("md-tab-item")[0].childNodes[0].data="Users ("+u+")"}else if(!o){for(var t=0;t<f.modal.publishDbConfig.publishNew.users.length;t++)f.modal.publishDbConfig.publishNew.users[t].id===e&&u--;$("md-tab-item")[0].childNodes[0].data="Users ("+u+")"}if($(".md-active")[0].childNodes[0].data.includes("User Groups"))if(f.getExcludeUsersFromGroupList(),o){for(a=0;a<f.modal.publishDbConfig.publishNew.userGroupsList.length;a++)f.modal.publishDbConfig.publishNew.userGroupsList[a].id===e&&p++;$("md-tab-item")[1].childNodes[0].data="User Groups ("+p+")"}else if(!o){for(a=0;a<f.modal.publishDbConfig.publishNew.userGroupsList.length;a++)f.modal.publishDbConfig.publishNew.userGroupsList[a].id===e&&p--;$("md-tab-item")[1].childNodes[0].data="User Groups ("+p+")"}if($(".md-active")[0].childNodes[0].data.includes("Exclude Users"))if(o){for(a=0;a<f.modal.publishDbConfig.publishNew.excludeUsers.length;a++)f.modal.publishDbConfig.publishNew.excludeUsers[a].id===e&&b++;$("md-tab-item")[2].childNodes[0].data="Exclude Users ("+b+")"}else if(!o){for(a=0;a<f.modal.publishDbConfig.publishNew.excludeUsers.length;a++)f.modal.publishDbConfig.publishNew.excludeUsers[a].id===e&&b--;$("md-tab-item")[2].childNodes[0].data="Exclude Users ("+b+")"}},f.updateVcsExport=function(){var e=f.modal.vcsexportconfig.commitMessage,o=f.modal.vcsexportconfig.pushItem;""!=e.trim()?(D.showLoader(),"gitmigration"==o?f.updateVcsGitExport():f.updateVcsPushExport()):D.showNotification("Commit Message cannot be empty","alert-danger",3e3)},f.updateVcsPushExport=function(){var e=f.modal.vcsexportconfig.commitMessage,o=window.sessionStorage.getItem("bvz_spacekey"),a=(window.sessionStorage.getItem("bvz_token"),f.modal.vcsexportconfig.dashboardId);window.sessionStorage.getItem("bvz_userid");requestSuccessFn=function(e){e.success?D.showNotification("Dashboard has been pushed successfully","alert-success",3e3):D.showNotification(e.errorMessage,"alert-danger",3e3),D.hideLoader()},requestFailedFn=function(e,o){D.showNotification("Unsuccessfull export","alert-danger",3e3),D.hideLoader()},BIZVIZ.SDK.secureRequest("/bizviz/pluginService",{data:{dashId:a,commitMsg:e,module:"Dashboard"},spacekey:o,consumerName:"BVZGIT",serviceName:"exportDashboardForVersion",isSecure:!0},requestSuccessFn,requestFailedFn)},f.updateVcsGitExport=function(){var e=f.modal.vcsexportconfig.commitMessage,o=window.sessionStorage.getItem("bvz_spacekey"),a=(window.sessionStorage.getItem("bvz_token"),f.modal.vcsexportconfig.dashboardId);window.sessionStorage.getItem("bvz_userid");requestSuccessFn=function(e){e.success?D.showNotification("Dashboard has been exported successfully","alert-success",3e3):D.showNotification(e.errorMessage,"alert-danger",3e3),D.hideLoader()},requestFailedFn=function(e,o){D.showNotification("Unsuccessfull export","alert-danger",3e3),D.hideLoader()},BIZVIZ.SDK.secureRequest("/workspace/exportDashboardGitMigration",{spacekey:o,dashID:a,commitMessage:e,module:"Dashboard"},requestSuccessFn,requestFailedFn)},f.updateGitExport=function(){var e=f.modal.gitexportconfig.commitMessage,o=window.sessionStorage.getItem("bvz_spacekey"),a=(window.sessionStorage.getItem("bvz_token"),f.modal.gitexportconfig.dashboardId),a=(window.sessionStorage.getItem("bvz_userid"),{dashID:a,commitMessage:e,module:"Dashboard",spacekey:o});requestSuccessFn=function(e){e?D.showNotification("File has been exported successfully","alert-success",3e3):D.showNotification("Unsuccessfull export","alert-danger",3e3),D.hideLoader()},requestFailedFn=function(e,o){D.showNotification("Unsuccessfull export","alert-danger",3e3),D.hideLoader()},""!=e.trim()?(D.showLoader(),BIZVIZ.SDK.secureRequest("/workspace/exportDashboard/",a,requestSuccessFn,requestFailedFn)):D.showNotification("Commit Message cannot be empty","alert-danger",3e3),f.hideModelPopup("gitExportModalDialog")},f.publishDashboardToUserGroups=function(){if(!f.modal.publishDbConfig.dashboardInfo)return!1;for(var e,o=[],a=[],t=[],s=("PUB_OVERRIDE"==f.modal.publishDbConfig.publishAction?(f.modal.publishDbConfig.publishTo.userGroupsList.map(function(e){IsBoolean(e.published)&&o.push(e.id)}),f.modal.publishDbConfig.publishTo.users.map(function(e){IsBoolean(e.published)&&a.push(e.id)}),f.modal.publishDbConfig.publishTo.excludeUsers.map(function(e){IsBoolean(e.published)&&t.push(e.id)})):(f.modal.publishDbConfig.publishNew.userGroupsList.map(function(e){IsBoolean(e.published)&&o.push(e.id)}),f.modal.publishDbConfig.publishNew.users.map(function(e){IsBoolean(e.published)&&a.push(e.id)}),f.modal.publishDbConfig.publishNew.excludeUsers.map(function(e){IsBoolean(e.published)&&t.push(e.id)})),convertStringToJson(f.modal.publishDbConfig.dashboardJson)),n=s.dashboardJson.Dashboard,r=(hasMobileView=n.MobileLayout&&0<n.MobileLayout.Object.length?1:0,n.layoutType="AbsoluteLayout",void 0===n.enableReportBurst||IsBoolean(!n.enableReportBurst)?"0":"1"),l="PUB_OVERRIDE"==f.modal.publishDbConfig.publishAction&&f.modal.publishDbConfig.pubDocId||0,i=f.modal.publishDbConfig.pubDocId,d=("PUB_OVERRIDE"==f.modal.publishDbConfig.publishAction?angular.forEach(f.modal.publishDbConfig.publishedVersions,function(e){e.id===i&&e.publishFolder}):e=f.modal.publishDbConfig.publishToFolder,""),c=0;c<f.modal.publishDbConfig.currentUser.rootFolders.length;c++)e==f.modal.publishDbConfig.currentUser.rootFolders[c].id&&(d=f.modal.publishDbConfig.currentUser.rootFolders[c].title);"Public Documents"==d&&(o=[],t=[],-1===(a=[]).indexOf(f.modal.publishDbConfig.currentUser.id))&&a.push(f.modal.publishDbConfig.currentUser.id);var u=req_url.designer.saveDocuments,l={assignedUserGroupRecords:o,assignedUsers:a,excludeUserRecords:t,contentId:l,isReportBurst:r,globalFilter:[],dashboardtype:"2",imagename:"dashboard.png",position:"0",type:"file",originalfilename:f.modal.publishDbConfig.name+".bvzx",title:f.modal.publishDbConfig.name,description:f.modal.publishDbConfig.description,dependencyDetails:JSON.stringify(f.findUsedQueryServiceIDs(n)),mobileViewVal:hasMobileView,file:JSON.stringify({Niv:{Dashboard:n}}),width:n.AbsoluteLayout.width,height:n.AbsoluteLayout.height};0<a.length||0<o.length?"PUB_OVERRIDE"!=f.modal.publishDbConfig.publishAction&&0==a.length&&0<o.length&&0==f.modal.publishDbConfig.publishNew.excludeUsers.length?D.showNotification("Please select a group having user","alert-warning",3e3):(D.showLoader(),""!=f.modal.publishDbConfig.publishToFolder&&(l.parentid=f.modal.publishDbConfig.publishToFolder),BIZVIZ.SDK.secureRequest(u,l,function(e,o){e&&e.trees&&e.trees.success?(D.showNotification("Dashboard has been published","alert-success",3e3),f.modal.publishDbConfig.publishTime=getNumericTimeStamp(),f.updatePublishedDetailsAndSaveDashboard(s,e)):D.showNotification("Failed to publish dashboard","alert-danger",3e3),D.hideLoader()},function(e,o){D.showNotification("Failed to publish dashboard","alert-danger",3e3),D.hideLoader()})):D.showNotification("Please select atleast one user or group","alert-warning",3e3),f.hideModelPopup("publishModalDialog")},f.updatePublishedDetailsAndSaveDashboard=function(e,o){var a;null==e.infoJson&&null!=e.dashboardJson.Dashboard.versionDetails?(e.dashboardJson.Dashboard.versionDetails.publishDocId=o.trees.tree.id,e.dashboardJson.Dashboard.versionDetails.publishedBy=D.AUTH_INFO.get("userID"),e.dashboardJson.Dashboard.versionDetails.publishedOn=f.modal.publishDbConfig.publishTime,e.dashboardJson.Dashboard.versionDetails.publishedAt=D.AUTH_INFO.get("spacekey"),null==e.dashboardJson.Dashboard.versionDetails.publishedVersions&&(e.dashboardJson.Dashboard.versionDetails.publishedVersions=[]),""===f.modal.publishDbConfig.legacyPubVersion||DesignerUtil.prototype.findInArray(e.dashboardJson.Dashboard.versionDetails.publishedVersions,"id",f.modal.publishDbConfig.legacyPubVersion.id)||e.dashboardJson.Dashboard.versionDetails.publishedVersions.push(f.modal.publishDbConfig.legacyPubVersion),(a=DesignerUtil.prototype.findInArray(e.dashboardJson.Dashboard.versionDetails.publishedVersions,"id",o.trees.tree.id))?(a.description=f.modal.publishDbConfig.description,a.publishTime=f.modal.publishDbConfig.publishTime):null==e.infoJson?(e.infoJson={},e.infoJson=JSON.parse(JSON.stringify(e.dashboardJson.Dashboard.versionDetails)),""!=f.modal.publishDbConfig.publishToFolder&&(e.infoJson.publishFolderId=f.modal.publishDbConfig.publishToFolder),e.infoJson.publishedVersions.push({id:o.trees.tree.id,name:f.modal.publishDbConfig.name,description:f.modal.publishDbConfig.description,publishTime:f.modal.publishDbConfig.publishTime,publishFolder:f.modal.publishDbConfig.publishToFolder,legacyPubVersion:!1}),e.dashboardJson.Dashboard.versionDetails.publishedVersions=[]):e.infoJson.publishedVersions.push({id:o.trees.tree.id,name:f.modal.publishDbConfig.name,description:f.modal.publishDbConfig.description,publishTime:f.modal.publishDbConfig.publishTime,publishFolder:f.modal.publishDbConfig.publishToFolder,legacyPubVersion:!1})):(""!=f.modal.publishDbConfig.publishToFolder&&(e.infoJson.publishFolderId=f.modal.publishDbConfig.publishToFolder),e.infoJson.publishDocId=o.trees.tree.id,e.infoJson.publishedBy=D.AUTH_INFO.get("userID"),e.infoJson.publishedOn=f.modal.publishDbConfig.publishTime,e.infoJson.publishedAt=D.AUTH_INFO.get("spacekey"),e.infoJson.publishFolder=f.modal.publishDbConfig.publishToFolder,null==e.infoJson.publishedVersions&&(e.infoJson.publishedVersions=[]),""===f.modal.publishDbConfig.legacyPubVersion||DesignerUtil.prototype.findInArray(e.infoJson.publishedVersions,"id",f.modal.publishDbConfig.legacyPubVersion.id)||e.infoJson.publishedVersions.push(f.modal.publishDbConfig.legacyPubVersion),(a=DesignerUtil.prototype.findInArray(e.infoJson.publishedVersions,"id",o.trees.tree.id))?(a.description=f.modal.publishDbConfig.description,a.publishTime=f.modal.publishDbConfig.publishTime):e.infoJson.publishedVersions.push({id:o.trees.tree.id,name:f.modal.publishDbConfig.name,description:f.modal.publishDbConfig.description,publishTime:f.modal.publishDbConfig.publishTime,publishFolder:f.modal.publishDbConfig.publishToFolder,legacyPubVersion:!1})),f.saveDashboardInDB(e.dashboardJson.Dashboard.workspaceId,e.dashboardJson.Dashboard.backendId,e.dashboardJson.Dashboard.name,e.dashboardJson,void 0,!0,e.infoJson,!0)},f.getDashboardJsonFromServer=function(e,a,t){var o=req_url.designer.openDashboard,e={dashboardId:e.toString()},e={dashboardParameters:JSON.stringify(e)};D.showLoader(),BIZVIZ.SDK.secureRequest(o,e,function(e,o){e.DesignerResp.success&&a&&a(e),D.hideLoader()},function(e,o){e.DesignerResp.success&&t&&t(e),D.hideLoader()})},f.checkForAlreadyPublished=function(e,a){var o=req_url.designer.getDocumentInfoById,e={docId:e||"0"};D.showLoader(),BIZVIZ.SDK.secureRequest(o,e,function(e,o){a&&a(e),D.hideLoader()})},f.showPublishDialog=function(e){e.trees.tree&&e.trees.tree.parentId?(f.alreadyPublished=!0,f.publishAction="PUB_OVERRIDE",f.pubInfoMsg='This dashboard is already published to "'+e.trees.fileOrFolderPath+'"',f.modal.selectedDirToPublish.id=e.trees.tree.parentId.id):(f.pubDocId="0",f.alreadyPublished=!1),f.$apply(),f.showModelPopup("publishModalDialog"),f.setFocusOnInput("#publishModalDialog","#dashboardName")},f.publishToPortal=function(e){""!=f.modal.publishDbConfig.name?f.publishDashboard(e,f.drParams):D.showNotification("Dashboard name can not be empty","alert-danger",3e3)},f.publishDashboard=function(e,o){if(!e)return!1;var e=req_url.designer.uploadDashboard,a="PUB_OVERRIDE"===f.publishAction?f.pubDocId:"0",t=convertStringToJson(o),o=t.dashboardJson.Dashboard,s=o.MobileLayout&&0<o.MobileLayout.Object.length?1:0,n=(o.layoutType="AbsoluteLayout",JSON.stringify(f.findUsedQueryServiceIDs(o))),a={parentid:f.modal.selectedDirToPublish.id,position:"0",type:"file",dashboardtype:"2",imagename:"dashboard.png",id:a,mobileViewVal:s,title:f.modal.publishDbConfig.name,description:f.modal.publishDbConfig.description,width:o.AbsoluteLayout.width,height:o.AbsoluteLayout.height,file:JSON.stringify({Niv:{Dashboard:o}}),dependencyDetails:n,originalfilename:f.modal.publishDbConfig.name+".bvzx"};o?(D.showLoader(),BIZVIZ.SDK.secureRequest(e,a,function(e,o){e&&e.trees&&e.trees.success?(D.showNotification('Dashboard has been published to "'+f.modal.selectedDirToPublish.title+'"',"alert-success",3e3),f.updatePublishedDetails(t,e)):D.showNotification("Failed to publish dashboard","alert-danger",3e3),D.hideLoader()})):D.showNotification("Invalid dashboard configuration","alert-danger",3e3),f.hideModelPopup("publishModalDialog")},f.updatePublishedDetails=function(e,o){e.dashboardJson.Dashboard.versionDetails.publishDocId=o.trees.tree.id,e.dashboardJson.Dashboard.versionDetails.publishedBy=o.trees.tree.userId,e.dashboardJson.Dashboard.versionDetails.publishedOn=o.trees.tree.lastUpdatedDate,e.dashboardJson.Dashboard.versionDetails.publishedAt=o.trees.tree.spaceKey,null==e.dashboardJson.Dashboard.versionDetails.publishedVersions&&(e.dashboardJson.Dashboard.versionDetails.publishedVersions=[]);var a=DesignerUtil.prototype.findInArray(e.dashboardJson.Dashboard.versionDetails.publishedVersions,"id",o.trees.tree.id);a?(a.description=f.modal.publishDbConfig.description,a.publishTime=f.modal.publishDbConfig.publishTime):e.dashboardJson.Dashboard.versionDetails.publishedVersions.push({id:o.trees.tree.id,name:f.modal.publishDbConfig.name,description:f.modal.publishDbConfig.description,publishTime:f.modal.publishDbConfig.publishTime,legacyPubVersion:!1}),f.saveDashboardInDB(e.dashboardJson.Dashboard.workspaceId,e.dashboardJson.Dashboard.backendId,e.dashboardJson.Dashboard.name,e.dashboardJson,void 0,!0)},f.findUsedQueryServiceIDs=function(e){var o=[],a={bizviz:"dataService",web:"dataService",bizvizDS:"dataStore",ds:"dataStore",bizvizPA:"paService",bizvizWS:"webSocket",ws:"webSocket"};return angular.forEach(e.DataProviders.DataURL,function(e){"offline"!==e.Type&&e.selectedServiceID&&o.push({queryServiceID:""+e.selectedServiceID,type:a[e.serviceType||e.Type]})}),o},f.isExpanded=function(e){return!!e.hasClass("glyphicon-folder-open")},f.handleCollapseExpand=function(e){var o=$(e.target);$(e.target.parentNode.parentNode.parentNode.childNodes[3]).slideToggle(),f.isExpanded(o)?o.removeClass("glyphicon-folder-open").addClass("glyphicon-folder-close"):o.removeClass("glyphicon-folder-close").addClass("glyphicon-folder-open")},f.setSelectedStyles=function(e,o){o=f.checkInAlreadyOpenedList(o.dashboardId);setSelectedStylesInTree(e.currentTarget,o)},f.checkInAlreadyOpenedList=function(o){var a=!1;return angular.forEach(f.modal.dashboardTabs,function(e){e.json.Dashboard.backendId.toString()!=o.toString()&&e.json.Dashboard.workspaceId.toString()!=o.toString()||(a=!0)}),a},f.updateDashboard=function(e,o,a){e.stopPropagation(),f.isInUse(o.dashboardId)?D.showNotification("Workspace is in use","alert-danger",3e3):(f.updateDashAction=a,f.isTrashAction=!1,f.updateModalPopup(e,o,a),f.showModelPopup("updateModalDialog"),f.setFocusOnInput("#updateModalDialog","#dashboardName"))},f.openInfoDialog=function(a){var e={workspaceId:a.dashboardId,spacekey:a.spaceKey};D.showLoader(),BIZVIZ.SDK.secureRequest("/designer/getWorkspaceDashboardInfoDetails/",e,function(e,o){e.wokspaceResp.success?(e=e.wokspaceResp.bizvizWorkspace,f.date=0==e.lastUpdatedDate?"NA":e.lastUpdatedDate,f.name=""==e.updatedBy?"NA":e.updatedBy):(f.date=0==a.lastUpdatedDate?"NA":a.lastUpdatedDate,f.name=""==a.updatedBy?"NA":a.updatedBy),f.showModelPopup("infoDialog"),D.hideLoader()})},f.filterSameWS=function(e){if(!e.isActive)return e},f.isInUse=function(e){var o=f.modal.dashboardTabs,a=f.modal.wsObj.wsNdb[e];if(a)for(var t=0;t<o.length;t++)for(var s=o[t].json.Dashboard.backendId,n=0;n<a.length;n++)if(s==a[n].dashboardId)return!0;return!1},f.updateModalPopup=function(e,o,a){f.updateModalHeader=e.currentTarget.attributes.headername.value;e=o.dashboardId;switch(f.itemToUpdate=e,f.dashboardToUpdate=e,f.modal.dashActionConfig.nameOfWorkspaceToUpdate="",f.modal.dashActionConfig.nameOfDashboardToUpdate=o.dashboardName,f.updateDashAction){case"renameDashboard":f.updateBtnLabel="Rename",f.dashboardNameLabel="Dashboard",f.modal.dashActionConfig.nameOfDashboardToUpdate=f.modal.replaceSpecialCharWithUnderscore(o.dashboardName);break;case"renameWorkspace":f.updateBtnLabel="Rename",f.dashboardNameLabel="Workspace",f.modal.dashActionConfig.nameOfDashboardToUpdate=f.modal.replaceSpecialCharWithUnderscore(o.dashboardName);break;case"deleteWorkspace":return f.updateBtnLabel="Remove",void(f.deleteWarning='If you are removing the workspace "'+f.modal.dashActionConfig.nameOfDashboardToUpdate+'", dashboards under the workspace will be moved to Trash. Are you sure to move it to trash?');case"saveDashboardAsTemplate":f.updateBtnLabel="Save",f.dashboardNameLabel="Save Dashboard as Template",f.modal.dashActionConfig.nameOfDashboardToUpdate=f.modal.replaceSpecialCharWithUnderscore(o.dashboardName);break;case"deleteDashboard":return f.updateBtnLabel="Remove",void(f.deleteWarning='Are you sure to remove the dashboard "'+f.modal.dashActionConfig.nameOfDashboardToUpdate+'"?');case"moveDashboard":f.updateBtnLabel="Move";break;case"trash_RemoveDashboard":f.updateBtnLabel="Remove From Trash",f.deleteWarning='Are you sure to remove the dashboard "'+f.modal.dashActionConfig.nameOfDashboardToUpdate+'"?';break;case"trash_RestoreDashboard":f.updateBtnLabel="Restore";break;case"trash_RemoveWorkspace":f.updateBtnLabel="Remove From Trash",f.deleteWarning='Are you sure to remove the workspace "'+f.modal.dashActionConfig.nameOfDashboardToUpdate+'"?';break;case"trash_RestoreWorkspace":f.updateBtnLabel="Restore",f.deleteWarning='Do you want to restore workspace "'+f.modal.dashActionConfig.nameOfDashboardToUpdate+'" and its contents?';break;case"gitExport":f.updateBtnLabel="Push"}},f.updateDashboardOrWorkspace=function(){var e={dashboardId:f.itemToUpdate.toString()},o=!1;switch(f.updateDashAction){case"renameDashboard":""!=f.modal.dashActionConfig.nameOfDashboardToUpdate?(e.dashboardName=f.modal.dashActionConfig.nameOfDashboardToUpdate,o=!0,f.hideUpdateModalDialog()):D.showNotification("Dashboard name can not be empty","alert-danger",3e3);break;case"renameWorkspace":""!=f.modal.dashActionConfig.nameOfDashboardToUpdate?(e.dashboardName=f.modal.dashActionConfig.nameOfDashboardToUpdate,o=!0,f.hideUpdateModalDialog()):D.showNotification("Workspace name can not be empty","alert-danger",3e3);break;case"saveDashboardAsTemplate":""!=f.modal.dashActionConfig.nameOfDashboardToUpdate?(e.dashboardName=f.modal.dashActionConfig.nameOfDashboardToUpdate,o=!1,f.hideUpdateModalDialog(),f.saveDashboardTemplate(e)):D.showNotification("Dashboard template name can not be empty","alert-danger",3e3);break;case"deleteWorkspace":return e.workspaceId=f.itemToUpdate.toString(),f.deleteDashboardOrWSFromDB(e,!0),void f.hideUpdateModalDialog();case"deleteDashboard":f.deleteDashboardOrWSFromDB(e,!1),f.hideUpdateModalDialog();break;case"moveDashboard":f.modal.dashActionConfig.nameOfWorkspaceToUpdate.dashboardId?(e.workspaceId=f.modal.dashActionConfig.nameOfWorkspaceToUpdate.dashboardId.toString(),o=!0,f.hideUpdateModalDialog()):D.showNotification("Workspace name can not be empty","alert-danger",3e3)}o&&f.updateDashboardOrWorkspaceInDB(e)},f.hideUpdateModalDialog=function(){angular.element("#updateModalDialog").modal("hide"),f.hideModelPopup("updateModalDialog")},f.showModalPopupRemoveAllTrashItems=function(e,o,a){f.updateModalHeader=e.currentTarget.attributes.headername.value,f.updateBtnLabel="Remove All",f.deleteWarning="Are you sure you want to permanently remove all the items?",f.showModelPopup("cleanTrashModalDialog")},f.removeAllTrashItems=function(){for(var e={},o=[],a=[],t=0;t<f.trashItems.length;t++)(f.trashItems[t].isDashboard?o:a).push(f.trashItems[t].dashboardId);e.dashboardId=JSON.stringify(o),e.workspaceId=JSON.stringify(a);var s=req_url.designer.deleteDashboardPermanently,e={spacekey:$.jStorage.get("spacekey"),token:$.jStorage.get("token"),dashboardParameters:JSON.stringify(e)};BIZVIZ.SDK.secureRequest(s,e,function(e){e.DesignerResp.success?(f.refreshList(),f.serverAlertMsg={text:"Trash has been cleaned",type:"alert-success"}):f.serverAlertMsg={text:"Failed to clean the trash",type:"alert-success"}},f.secureRequestErrorHandler)},f.trashActions=function(e,o,a){var t=o.parentId;a+=o.isDashboard?"Dashboard":"Workspace",f.isTrashAction=!0,e.stopPropagation(),f.updateDashAction=a,f.updateModalPopup(e,o,a),f.modal.dashActionConfig.nameOfWorkspaceToUpdate=t?f.modal.wsObj.wsList[f.getIndexOfWsFromWsListByWsId(t)]:{},f.showModelPopup("updateModalDialog")},f.updateFromTrash=function(){var e={dashboardId:f.itemToUpdate.toString()};switch(f.updateDashAction){case"trash_RemoveDashboard":e.dashboardId=JSON.stringify([f.itemToUpdate]),f.deleteFromTrash(e);break;case"trash_RestoreDashboard":f.modal.dashActionConfig.nameOfWorkspaceToUpdate.dashboardId&&(e.restoreTo=f.modal.dashActionConfig.nameOfWorkspaceToUpdate.dashboardId.toString(),f.restoreFromTrash(e));break;case"trash_RemoveWorkspace":e.dashboardId=JSON.stringify([f.itemToUpdate]),e.workspaceId=JSON.stringify([f.itemToUpdate]),f.deleteFromTrash(e);break;case"trash_RestoreWorkspace":e.workspaceId=f.itemToUpdate.toString(),f.restoreFromTrash(e)}},f.deleteDashboardOrWSFromDB=function(t,s){var e=req_url.designer.trashDashboard,o={dashboardParameters:JSON.stringify(t)};D.showLoader(),BIZVIZ.SDK.secureRequest(e,o,function(e,o){if(e.DesignerResp.success){if(s)f.serverAlertMsg={text:"Workspace has been deleted",type:"alert-success"};else{f.serverAlertMsg={text:"Dashboard has been deleted",type:"alert-success"};for(var a=0;a<f.modal.dbInsideWs.length;a++)if(f.modal.dbInsideWs[a].dashboardId==t.dashboardId){f.modal.dbInsideWs.splice(a,1);break}}f.refreshList()}else f.serverAlertMsg={text:"Failed to delete",type:"alert-danger"};D.hideLoader()})},f.restoreFromTrash=function(e){var o=req_url.designer.restoreDashboardFromTrash,e={dashboardParameters:JSON.stringify(e)};D.showLoader(),BIZVIZ.SDK.secureRequest(o,e,function(e,o){e.DesignerResp.success?(f.refreshList(),f.serverAlertMsg={text:"Successfully restored",type:"alert-success"}):f.serverAlertMsg={text:"Failed to restore",type:"alert-danger"},D.hideLoader()})},f.updateTrashedItems=function(){f.getTrashItems(function(e){f.uiActive.trash&&(f.modal.dbInsideWs=e)})},f.deleteFromTrash=function(e){var o=req_url.designer.deleteDashboardPermanently,e={dashboardParameters:JSON.stringify(e)};D.showLoader(),BIZVIZ.SDK.secureRequest(o,e,function(e,o){e.DesignerResp.success?(f.refreshList(),f.updateTrashedItems(),f.serverAlertMsg={text:"Removed from trash",type:"alert-success"}):f.serverAlertMsg={text:"Failed to remove",type:"alert-success"},D.hideLoader()})},f.getTrashItems=function(a){var e=req_url.designer.getTrashItems;D.showLoader(),BIZVIZ.SDK.secureRequest(e,{},function(e,o){e=e.DesignerResp.success&&e.DesignerResp.dashboards||[];f.trashItems=[],D.isArray(e)?f.trashItems=e:f.trashItems[0]=e,a&&"function"==typeof a&&a(e),"Trash"===f.recentlyClickedItem&&(0===f.trashItems.lenth?(f.modal.dashboardSpaceMsg="No item found !",f.zeroDashboard=!0):f.zeroDashboard=!1,f.modal.dbInsideWs=f.trashItems),D.showNotification(f.serverAlertMsg.text,f.serverAlertMsg.type,3e3),f.serverAlertMsg={text:"",type:""},f.$apply(),D.hideLoader()})},f.updateDashboardOrWorkspaceInDB=function(s){var e=req_url.designer.updateDashboardOrWorkspace,o={dashboardParameters:JSON.stringify(s)};D.showLoader(),BIZVIZ.SDK.secureRequest(e,o,function(e,o){if(e.DesignerResp.success){if(f.serverAlertMsg={text:"Workspace has been renamed",type:"alert-success"},s.workspaceId){for(var a=0;a<f.modal.dbInsideWs.length;a++)if(f.modal.dbInsideWs[a].dashboardId==s.dashboardId){f.modal.dbInsideWs.splice(a,1);break}f.serverAlertMsg={text:"Dashboard has been moved",type:"alert-success"}}else if(s.dashboardName)for(var t=0;t<f.modal.dbInsideWs.length;t++){if(f.modal.dbInsideWs[t].dashboardId==s.dashboardId){f.modal.dbInsideWs[t].dashboardName=s.dashboardName,f.serverAlertMsg={text:"Dashboard has been renamed",type:"alert-success"};break}f.serverAlertMsg={text:"Workspace has been renamed",type:"alert-success"}}else f.serverAlertMsg={text:"Dashboard has been updated",type:"alert-success"};f.refreshList()}else f.serverAlertMsg={text:"Failed to update",type:"alert-danger"};D.hideLoader()})},f.refreshList=function(o){f.getWorkspaces(function(e){0<e.wsList.length?(f.modal.zeroWorkspcae=!1,f.modal.wsObj=e,f.$apply()):f.modal.zeroWorkspcae=!0,o&&"function"==typeof o&&o(e)},!0)},f.onrefreshComplete=function(){D.showNotification("Workspace has been refreshed","alert-info",3e3)},f.browseBVZXDashboard=function(e){if(3==f.modal.dashboardTabs.length)return D.showNotification("Please close a dashboard","alert-success",3e3),!1;var o;null!=e&&-1!=e.fileName.indexOf(".bvzx")?(e=e.fileData,null!=(e=convertStringToJson(e))&&""!=e&&null!=e.dashboardJson?(f.modal.dashboardVisibleComponents=[],f.modal.dashboardHiddenComponents=[],f.removeDashboardPublishDetailsFromDownloadedJson(e.dashboardJson),f.openProcessingItem={dashboardId:e.dashboardJson.Dashboard.id,dashboardName:e.dashboardJson.Dashboard.name,isDashboard:"true",parentId:"00000000",spaceKey:D.AUTH_INFO.get("spacekey"),status:D.AUTH_INFO.get("token"),userId:D.AUTH_INFO.get("userID")},(o=f.isDashboardAlredyOpened(e.dashboardJson.Dashboard.backendId,e.dashboardJson.Dashboard.id)).exist?(D.showNotification("Dashboard with same id is already opened","alert-info",3e3),f.toggleMenu(),f.dashboardTabClick(o.dashboardId)):f.loadDashboardInDesigner(e)):D.showNotification("Invalid dashboard configuration","alert-danger",3e3)):D.showNotification("File type is not supported","alert-danger",3e3)},f.isDashboardAlredyOpened=function(e,o){for(var a=0;a<f.modal.dashboardTabs.length;a++){if(f.modal.dashboardTabs[a].json.Dashboard.backendId==e&&""!=e)return{exist:!0,dashboardId:f.modal.dashboardTabs[a].json.Dashboard.id};if(f.modal.dashboardTabs[a].json.Dashboard.id==o)return{exist:!0,dashboardId:f.modal.dashboardTabs[a].json.Dashboard.id}}return{exist:!1,dashboardId:""}},f.removeDashboardPublishDetailsFromDownloadedJson=function(e){e&&e.Dashboard&&(e.Dashboard.backendId="",e.Dashboard.workspaceId="",e.Dashboard.versionDetails)&&(e.Dashboard.versionDetails.publishDocId=0,e.Dashboard.versionDetails.publishedVersions=[])},f.loadDashboardInDesigner=function(e){if(D.getJsonFileData("./resources/bizvizchart-themes/default-theme/AllComponentsData.data",function(e){f.modal.compMetaData=e}),D.getJsonFileData("./resources/data/property/allpropertydata.data",function(e){f.modal.propertyData=e}),f.modal.dashboardTabs.length<f.maxTabLength){var o=convertStringToJson(e).dashboardJson,a=convertStringToJson(e).infoJson;if(delete f.datasetcolor,null!=o&&null!=o.Dashboard){o.Dashboard.AbsoluteLayout.designerTheme||(o.Dashboard.AbsoluteLayout.designerTheme="default-theme"),o.Dashboard.layoutType="AbsoluteLayout",f.modal.layoutType=o.Dashboard.layoutType,o.Dashboard.workspaceId=f.openProcessingItem.parentId,o.Dashboard.name=f.openProcessingItem.dashboardName;var t=o.Dashboard.id,s=o.Dashboard.name;if(!f.isDashboardAlredyOpened(o.Dashboard.backendId,o.Dashboard.id).exist){if(""!=t&&null!=t)return f.toggleMenu(),o.Dashboard.AbsoluteLayout.Object=DesignerUtil.prototype.removeNullFromObjectsArray(o.Dashboard.AbsoluteLayout.Object),f.modal.selectedDashboard={id:t,name:s,json:o,infojson:a},f.appendDesignDataForDashboard(),f.modal.selectedDashboard.componentObjectList={},f.modal.dashboards.push(f.modal.selectedDashboard),f.selectedTheme[f.getActiveDashboardId()]=o.Dashboard.AbsoluteLayout.designerTheme,f.selectedGlobalProperty[f.getActiveDashboardId()]={},f.selectedGlobalProperty[f.getActiveDashboardId()][f.modal.layoutType]=o.Dashboard[f.modal.layoutType].globalProperties,f.loadDesignerThemeInfo(f.selectedTheme[f.getActiveDashboardId()],function(){i(function(){f.applySettingsToOpenedDashboard(t,s,o,a),f.selectedTheme[f.getActiveDashboardId()]=o.Dashboard.AbsoluteLayout.designerTheme},0),i(function(){f.modal.prepForBroadcast()},1)}),!0;D.showNotification("Invalid dashboard configuration","alert-warning",3e3)}}else D.showNotification("Invalid dashboard configuration","alert-danger",3e3)}},f.loadTemplateInDesigner=function(e){if(D.getJsonFileData("./resources/bizvizchart-themes/default-theme/AllComponentsData.data",function(e){f.modal.compMetaData=e}),D.getJsonFileData("./resources/data/property/allpropertydata.data",function(e){f.modal.propertyData=e}),D.showNotification("Please verify scripts in dashboard and its components","alert-warning",6e3),f.modal.dashboardTabs.length<f.maxTabLength){var o=convertStringToJson(e).dashboardJson,a=convertStringToJson(e).infoJson;if(delete f.datasetcolor,null!=o&&null!=o.Dashboard){o.Dashboard.AbsoluteLayout.designerTheme||(o.Dashboard.AbsoluteLayout.designerTheme="default-theme"),o.Dashboard.layoutType="AbsoluteLayout",f.modal.layoutType=o.Dashboard.layoutType,o.Dashboard.workspaceId=f.openProcessingItem.parentId,o.Dashboard.name=f.openProcessingItem.dashboardName,o.Dashboard.id=getIdWithTimeStamp("dashboard"),o.Dashboard.workspaceId="",o.Dashboard.backendId="",o.Dashboard.DataProviders.DataURL=[],o.Dashboard.DataProviders.queryServiceList=[],o.Dashboard.DataProviders.selectedConnection=[];for(var t=0;t<o.Dashboard.AbsoluteLayout.Object.length;t++){var s=o.Dashboard.AbsoluteLayout.Object[t].subElement,n=o.Dashboard.AbsoluteLayout.Object[t][s].DataSet;s&&n&&(o.Dashboard.AbsoluteLayout.Object[t][s].DataSet.dataSource="",o.Dashboard.AbsoluteLayout.Object[t][s].DataSet.Fields=[])}var r=(f.templateDashboardJson=o).Dashboard.id,l=o.Dashboard.name;if(!f.isDashboardAlredyOpened(o.Dashboard.backendId,o.Dashboard.id).exist){if(""!=r&&null!=r)return f.toggleMenu(),o.Dashboard.AbsoluteLayout.Object=DesignerUtil.prototype.removeNullFromObjectsArray(o.Dashboard.AbsoluteLayout.Object),f.modal.selectedDashboard={id:r,name:l,json:o,infojson:a},f.appendDesignDataForDashboard(),f.modal.selectedDashboard.componentObjectList={},f.modal.dashboards.push(f.modal.selectedDashboard),f.selectedTheme[f.getActiveDashboardId()]=o.Dashboard.AbsoluteLayout.designerTheme,f.selectedGlobalProperty[f.getActiveDashboardId()]={},f.selectedGlobalProperty[f.getActiveDashboardId()][f.modal.layoutType]=o.Dashboard[f.modal.layoutType].globalProperties,f.loadDesignerThemeInfo(f.selectedTheme[f.getActiveDashboardId()],function(){i(function(){f.applySettingsToOpenedDashboard(r,l,o,a),f.selectedTheme[f.getActiveDashboardId()]=o.Dashboard.AbsoluteLayout.designerTheme},0),i(function(){f.modal.prepForBroadcast()},1)}),!0;D.showNotification("Invalid dashboard configuration","alert-warning",3e3)}}else D.showNotification("Invalid dashboard configuration","alert-danger",3e3)}},f.applySettingsToOpenedDashboard=function(e,o,a,t){f.addInDashboardTab(e,o,a,t),f.setDashboardsDefaultCSS(f.modal.userPreference.defaultSettings),f.showHideGridLines(f.modal.userPreference.showGridLines),f.modal.createHistoryProperties(e),i(function(){f.isSelectedDashboardResponsive()||f.setDashboardCSS(f.modal.userPreference),f.dashboardTabClick(e),f.modal.updateDashboardStatus(0)},10)},f.OpenDasboard=function(l,e){if(e&&e.stopPropagation(),!l)return!1;f.openProcessingItem=l;D.getJsonFileData("./resources/bizvizchart-themes/default-theme/AllComponentsData.data",function(e){f.modal.compMetaData=e}),D.getJsonFileData("./resources/data/property/allpropertydata.data",function(e){f.modal.propertyData=e}),D.getJsonFileData("./resources/data/property/dashboard.data",function(e){f.modal.globalFontProperties=e["Global Font And Themes"][4].options}),D.getJsonFileData("./resources/bizvizchart-themes/default-theme/chart/CopyComponent.data",function(e){f.modal.copyJson=e.Properties.Object}),f.loadComps();var e=req_url.designer.openDashboard,o=f.isDashboardAlredyOpened(l.dashboardId,""),a={dashboardId:l.dashboardId.toString()},a={dashboardParameters:JSON.stringify(a)};o.exist?(D.showNotification("Dashboard with same id is already opened","alert-info",3e3),f.toggleMenu(),f.dashboardTabClick(o.dashboardId)):f.modal.dashboardTabs.length<f.maxTabLength?(D.showNotification("Getting dashboard","alert-info",3e4),f.modal.dashbaordLoadingInProgress=!0,D.showLoader(),BIZVIZ.SDK.secureRequest(e,a,function(e,o){if(e&&e.DesignerResp.success){f.openDashboardSaveAlertUser(l);var a=convertStringToJson(e.DesignerResp.params).dashboardJson;if(a.Dashboard){for(var t=a.Dashboard[a.Dashboard.layoutType].designerTheme,s=("default-theme"!==t&&D.getJsonFileData("./resources/bizvizchart-themes/"+t+"/themeConfig.data",function(e){f.modal.themeData=e}),a.Dashboard.AbsoluteLayout.Object),n=[],r=0;r<s.length;r++)n.push(s[r].objectID);f.getDashboardComponents(l,e.DesignerResp.params,n)}else D.showNotification("Invalid dashboard configuration","alert-danger",3e3)}else D.showNotification("Invalid dashboard configuration","alert-danger",3e3)},function(e){D.showNotification("Invalid dashboard configuration","alert-danger",3e3)})):(D.showNotification("Please close a dashboard","alert-warning",3e3),f.toggleMenu())},f.getDashboardComponents=function(t,s,e){var o=window.sessionStorage.getItem("bvz_spacekey"),a=window.sessionStorage.getItem("bvz_token"),e=(window.sessionStorage.getItem("bvz_userid"),f.modal.dashboardVisibleComponents=[],f.modal.getDashboardComponents=!1,f.modal.dashboardHiddenComponents=[],f.modal.dashboardComponents=[],{dashboardComponents:angular.toJson(e),token:a,dashboardId:t.dashboardId,spacekey:o});BIZVIZ.SDK.secureRequest("/workspace/getDashboardComponents",e,function(e){if(e&&e.wokspaceResp.success){var o=e.wokspaceResp.components;f.modal.getDashboardComponents=!0;for(var a=0;a<o.length;a++)f.modal.dashboardComponents.push(convertStringToJson(o[a].data)),(0==IsBoolean(o[a].unShowHidden)?f.modal.dashboardVisibleComponents:f.modal.dashboardHiddenComponents).push(convertStringToJson(o[a].data));f.loadDashboardInDesignerFromDb(s)?(t.isOpen=!0,D.closeAllNotifications(),D.showNotification("Dashboard has been loaded","alert-success",3e3),f.enableSaveDashboardInInterval(),f.modal.dashboardHiddenComponents.length):D.closeAllNotifications()}e&&!e.wokspaceResp.success&&(f.loadDashboardInDesigner(s)?(t.isOpen=!0,D.closeAllNotifications(),D.showNotification("Dashboard has been loaded","alert-success",3e3),f.enableSaveDashboardInInterval()):D.closeAllNotifications()),D.hideLoader()},function(e){D.showNotification("Invalid dashboard configuration","alert-danger",3e3)})},f.loadDashboardInDesignerFromDb=function(e){if(D.getJsonFileData("./resources/bizvizchart-themes/default-theme/AllComponentsData.data",function(e){f.modal.compMetaData=e}),D.getJsonFileData("./resources/data/property/allpropertydata.data",function(e){f.modal.propertyData=e}),D.getJsonFileData("./resources/data/property/dashboard.data",function(e){f.modal.globalFontProperties=e["Global Font And Themes"][4].options}),f.modal.dashboardTabs.length<f.maxTabLength){var o=convertStringToJson(e).dashboardJson,a=convertStringToJson(e).infoJson;if(delete f.datasetcolor,null!=o&&null!=o.Dashboard){o.Dashboard.AbsoluteLayout.designerTheme||(o.Dashboard.AbsoluteLayout.designerTheme="default-theme"),o.Dashboard.layoutType="AbsoluteLayout",f.modal.layoutType=o.Dashboard.layoutType,o.Dashboard.workspaceId=f.openProcessingItem.parentId,o.Dashboard.name=f.openProcessingItem.dashboardName;var t=o.Dashboard.id,s=o.Dashboard.name;if(!f.isDashboardAlredyOpened(o.Dashboard.backendId,o.Dashboard.id).exist){if(""!=t&&null!=t)return f.toggleMenu(),f.modal.dashboardVisibleComponents.concat(f.modal.dashboardHiddenComponents),o.Dashboard.AbsoluteLayout.Object=DesignerUtil.prototype.removeNullFromObjectsArray(o.Dashboard.AbsoluteLayout.Object),f.modal.selectedDashboard={id:t,name:s,json:o,infojson:a},f.appendDesignDataForDashboard(),f.modal.selectedDashboard.componentObjectList={},f.modal.dashboards.push(f.modal.selectedDashboard),f.selectedTheme[f.getActiveDashboardId()]=o.Dashboard.AbsoluteLayout.designerTheme,f.selectedGlobalProperty[f.getActiveDashboardId()]={},f.selectedGlobalProperty[f.getActiveDashboardId()][f.modal.layoutType]=o.Dashboard[f.modal.layoutType].globalProperties,f.selectedGlobalProperty[f.getActiveDashboardId()].MobileLayout=o.Dashboard.MobileLayout.globalProperties,f.selectedGlobalProperty[f.getActiveDashboardId()].TabletLayout=o.Dashboard.TabletLayout.globalProperties,f.loadDesignerThemeInfo(f.selectedTheme[f.getActiveDashboardId()],function(){i(function(){f.applySettingsToOpenedDashboard(t,s,o,a),f.selectedTheme[f.getActiveDashboardId()]=o.Dashboard.AbsoluteLayout.designerTheme},0),i(function(){f.modal.prepForBroadcast()},1)}),!0;D.showNotification("Invalid dashboard configuration","alert-warning",3e3)}}else D.showNotification("Invalid dashboard configuration","alert-danger",3e3)}},f.rednerHiddenDashboarComponents=function(e){e=convertStringToJson(e).dashboardJson;e.Dashboard.AbsoluteLayout.Object=f.dashboardHiddenComponents,e.Dashboard.AbsoluteLayout.Object=DesignerUtil.prototype.removeNullFromObjectsArray(e.Dashboard.AbsoluteLayout.Object),f.modal.selectedDashboard.json=e,f.appendDesignDataForDashboard(),f.modal.dashboards=[],f.modal.selectedDashboard.componentObjectList={},f.modal.dashboards.push(f.modal.selectedDashboard),i(function(){f.modal.prepForBroadcast()},1)},f.OpenTemplateDasboard=function(a,e){if(e&&e.stopPropagation(),!a)return!1;f.openProcessingItem=a;D.getJsonFileData("./resources/bizvizchart-themes/default-theme/AllComponentsData.data",function(e){f.modal.compMetaData=e}),D.getJsonFileData("./resources/data/property/allpropertydata.data",function(e){f.modal.propertyData=e}),f.loadComps();var e=req_url.designer.openDashboard,o=f.isDashboardAlredyOpened(a.dashboardId,""),t={dashboardId:a.dashboardId.toString()},t={dashboardParameters:JSON.stringify(t)};o.exist?(D.showNotification("Dashboard template with same id is already opened","alert-info",3e3),f.toggleMenu(),f.dashboardTabClick(o.dashboardId)):f.modal.dashboardTabs.length<f.maxTabLength?(D.showNotification("Getting dashboard","alert-info",3e4),f.modal.dashbaordLoadingInProgress=!0,D.showLoader(),BIZVIZ.SDK.secureRequest(e,t,function(e,o){e&&e.DesignerResp.success?(e=f.loadTemplateInDesigner(e.DesignerResp.params),f.removeDashboardPublishDetailsFromDownloadedJson(f.modal.selectedDashboard.json),e?(a.isOpen=!0,D.closeAllNotifications(),D.showNotification("Template has been loaded","alert-success",3e3),f.enableSaveDashboardInInterval()):D.closeAllNotifications()):D.showNotification("Invalid dashboard template configuration","alert-danger",3e3),D.hideLoader()})):(D.showNotification("Please close a dashboard","alert-warning",3e3),f.toggleMenu())},f.openDashboardSaveAlertUser=function(o){var a=new WebSocket(window.bizviz_camelwebsocket||parent.window.bizviz_camelwebsocket),e=window.sessionStorage.getItem("bvz_token"),t=window.sessionStorage.getItem("bvz_userid"),s=(o.parentId.toString(),o.dashboardId.toString()),n={type:"add",data:{},key:s,token:e,userinfo:t};a.onopen=function(e){a.readyState===WebSocket.OPEN&&a.send(JSON.stringify(n))},a.addEventListener("message",function(e){e.data&&(e=JSON.parse(e.data),1==o.isOpen)&&e.key===s&&e.userId!==t&&f.showModelPopup("websoketAlertModalDialog")}),a.onclose=function(e){1==o.isOpen&&f.openDashboardSaveAlertUser(o)},a.onerror=function(e){}},f.closeOpenSameDashboard=function(){f.hideModelPopup("websoketAlertModalDialog");for(var e=0,o="",a=f.openProcessingItem.dashboardId.toString(),t=0;t<f.modal.dashboardTabs.length;t++)a===f.modal.dashboardTabs[t].json.Dashboard.backendId&&(e=t,o=f.modal.dashboardTabs[t].id);""!=o?(f.openProcessingItem.dashboardId,f.closeDashboardTabAndDiv(o,e),f.toggleMenu(),f.OpenDasboard(f.openProcessingItem,"")):D.showNotification(" Changes not applied. Try after some times","alert-info",3e3)},f.enableSaveDashboardInInterval=function(){},f.copyComponentJson=function(){""!=f.modal.selectedComponentId?(f.selectedComponentJSON=JSON.stringify(f.getComponentbyId(f.modal.selectedComponentId),null,4),f.showModelPopup("copyComponentJsonModalDialog"),f.setFocusOnInput("#copyComponentJsonModalDialog",".custom-text-area-jsonData")):D.showNotification("Please select a component","alert-info",3e3)},f.goToScriptHelp=function(e){window.open(f.scriptHelpUrl+(e?"#"+e:""),"_blank")},f.openConnectorInfo=function(){f.showModelPopup("connectorInfoBox")},f.checkLast=function(e){e&&f.listContainingDashboards()},f.listContainingDashboards=function(e){f.workSpaceAndDashboardSearch="",f.modal.dbInsideWs=e?"trash"==e?f.trashItems:f.modal.wsObj.wsNdb[e]:f.modal.wsObj.dbList,0==f.modal.dbInsideWs.length?f.zeroDashboard=!0:f.zeroDashboard=!1},f.toggleSearchBox=function(){D.closeAllNotifications(),f.searchVisible?(f.workSpaceAndDashboardSearch="",f.searchVisible=!1):(f.searchVisible=!0,i(function(){$("#search-db").focus()},10))},f.resetDashboardSearch=function(){f.workSpaceAndDashboardSearch=""},f.startTour=function(e){D.closeAllNotifications();var o=angular.copy(f.modal.tourConfig[e].steps),e=("designerHome"===e&&o.unshift({orphan:!0,title:"Welcome, "+f.modal.AUTH_INFO.user.userName,placement:"bottom",content:"This tour of Dashboard designer will guide you through the action items on this home page"}),new Tour({name:f.modal.tourConfig[e].name,steps:o,smartPlacement:!0,storage:!1,backdrop:!0,animation:!1,template:'<div class="popover tour"><div class="arrow">&nbsp;</div><h3 class="popover-title">&nbsp;</h3><div class="popover-content">&nbsp;</div><div class="popover-navigation"><button class="btn btn-default" data-role="prev">&laquo; Prev</button> <button class="btn btn-default" data-role="next">Next &raquo;</button> <button class="btn btn-default" data-role="end">End tour</button></div></div>'}));e.ended()?e.restart():(e.init(),e.start())}}]),angular.module(designerModules.module.DesignerManager).controller("ObjectBrowserController",["$scope","ServiceFactory","$timeout",function(u,p,t){u.componentsList=[],u.hideAll=!1,u.lockAll=!1,u.hide_showAllBtnIcon="./resources/images/svg/hideAll.svg",u.hideShowGlyph="nt-eye-close-icon",u.groupCompHideShowGlyph="visibility_off",u.lockMoveGlyph="lock",u.hide_showAllToolTip="Hide All",u.hide_showAllgCompToolTip="Hide All Components",u.lock_unlockAllBtnIcon="./resources/images/svg/lockAll.svg",u.lock_unlockAllToolTip="Lock All",u.deleteAllBtnIcon="./resources/images/svg/delete.svg",u.oldIndex=-1,u.isSortingActive=!1,u.disableObjectList=!1,u.objectSortCfg={axis:"y",tolerance:"pointer",containment:"parent",cursor:"move",revert:!0,placeholder:"s-o-p-h",scroll:!0,handle:".compReorderDragDiv",start:function(e,o){u.isSortingActive=!0,u.oldIndex=o.item.index()},stop:function(e,o){var a=o.item.index();t(function(){u.updateZindex(u.oldIndex,a),u.isSortingActive=!1},0)}},u.updateZindex=function(e,o){var a=u.componentsList,t=u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object;if(t&&0<t.length){Array.prototype.move=function(e,o){var a=!1;if(o>=this.length)for(var t=o-this.length,a=!0;1+t--;)this.push(void 0);if(this.splice(o,0,this.splice(e,1)[0]),a){var s=JSON.parse(JSON.stringify(this));this.splice(0,this.length);for(var n=0;n<s.length;n++)void 0!==s[n]&&null!==s[n]&&this.push(s[n])}},a.move(e,o),t.move(e,o);for(var s=0;s<a.length;s++)try{$("#dcc_"+a[s].objectID).css("zIndex",s)}catch(e){}}},u.prepareComponentSelectionFromObjExp=function(e,o,a,t){u.isSortingActive||($(".c-group").removeClass("selected-group"),u.handleComponentSelection(e,o,a,t))},u.$watch("modal.selectedDashboard",function(){u.updateComponentList()}),u.$watch("modal.objectListChange",function(){u.updateComponentList()}),u.$watch("modal.layoutType",function(){u.updateComponentList()}),u.clearObjectSearch=function(){u.objecBrowserSearchkey=""},u.updateComponentList=function(){u.componentsList=[],null!=u.modal.selectedDashboard&&null!=u.modal.selectedDashboard.json&&$.each(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,function(e,o){o&&"object"==typeof o&&(o={objectName:u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[e].objectName,objectID:u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[e].objectID,hideComponent:u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[e].unShowHidden,lockComponent:u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[e].showLocked,pinedComponent:u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[e].isPined||!1,referenceID:u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[e].referenceID},u.componentsList.push(o),u.modal.componentListInObjectBrowser=u.componentsList,$("#dcc_"+o.objectID).css("zIndex",e))}),u.hideAll=!1,u.isAllHidden&&(u.hideAll=!0),u.lockAll=!1},u.initObjectBrowser=function(){u.modal.isActiveBox=!0},u.showAddToGroup=function(){u.modal.isActiveBox?(u.modal.isActiveBox=!1,u.showGrpBtns=!0):(u.modal.isActiveBox=!0,u.showGrpBtns=!1)},u.showGroupPanel=function(){u.reloadDefault("objectBrowser"),u.isBoxVisible||(u.setMenuSelection("#toggleObjectBrowser"),$("#objectBrowser").removeClass("bvz-invisible"),$("#objectBrowser").removeClass("hideBox").addClass("showBox"),$(".dashboardContents").css({width:"calc( 100% - "+u.bvzRCBoxWidth+"px )"}),u.isBoxVisible=!0,u.modal.isActiveBox=!1,u.showGrpBtns=!0)},u.onChangeComponentName=function(e,o){DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",o.objectID).objectName=o.objectName,u.disableObjectList=!1,u.modal.refreshAllObjectList()},u.renameComp=function(){u.disableObjectList=!0},u.selectGroupComponent=function(e){for(var o=u.getDashboardGroups(),a=0;a<o.length;a++)if(o[a].gName===e){for(var t=u.modal.selectedDashboard.json.Dashboard.componentGroups[a].aCompIds,s=0;s<t.length;s++)u.selectComponent(t[s]);break}},u.deSelectGroupComponent=function(e){for(var o=u.getDashboardGroups(),a=0;a<o.length;a++)if(o[a].gName===e){for(var t=u.modal.selectedDashboard.json.Dashboard.componentGroups[a].aCompIds,s=0;s<t.length;s++)u.deselectComponent(t[s]);break}},u.renameGroup=function(e){e.stopPropagation(),u.showGrpBtns=!1,u.tempGrp=u.selectedGroup,u.selectedGroup=this.g.gName,u.groupNameUpadte=u.selectedGroup,u.modal.selectedGroup=u.getSelectedGroup(),$("#groupListContainer #"+u.selectedGroup).find(".w-list-option").hide(),$("#groupListContainer #"+u.selectedGroup).parent().siblings().addClass("disableListEvent")},u.updateGroupName=function(e,o){e.stopPropagation();e=o.replace(/\s/g,"");if(u.modal.selectedGroup=this.g.gName||u.selectedGroup,$("#groupListContainer #"+u.selectedGroup).find(".w-list-option").show(),$("#groupListContainer #"+u.selectedGroup).parent().siblings().removeClass("disableListEvent"),u.showGrpBtns=!0,""==e)return p.showNotification("Group name cann't be empty","alert-danger",3e3),!1;if(!/^[a-zA-Z0-9_-]+$/i.test(e))return p.showNotification("Group name should not contain any special character","alert-danger",3e3),!1;for(var a=e.split(","),t=!0,s=u.getDashboardGroups(),n=0;n<s.length;n++)if(s[n].gName===a[0]){t=!1;break}if(t){for(n=0;n<s.length;n++)if(s[n].gName===u.modal.selectedGroup){for(var r=u.modal.selectedDashboard.json.Dashboard.componentGroups[n].aCompIds,l=0;l<r.length;l++){var i=u.getComponentbyId(r[l]),d=i.groupings.split(","),c=(d=d.map(function(e){return e.replace(/\s/g,"")})).indexOf(s[n].gName);-1!==c&&(d[c]=a[0]),i.groupings=d.join()}u.modal.selectedDashboard.json.Dashboard.componentGroups[n].gName=a[0],u.groupNameUpadte=a[0],u.selectedGroup=a[0],p.showNotification("Group name updated","alert-info",3e3);break}}else p.showNotification("Group name already exists","alert-info",3e3);u.selectedGroup=u.tempGrp,u.tempGrp=null},u.createDashboardGroup=function(){u.fromExistingGroup=!1;for(var e,o=0;o<50;o++)if(e={gName:"grp"+o,aCompIds:[],gCompHidden:!1,iClass:u.groupCompHideShowGlyph,tooltip:u.hide_showAllgCompToolTip},u.isNewDashboardGroup(e.gName)){u.getDashboardGroups().push(e),u.newGroup="",t(function(){u.$apply()},10);break}},u.addSelectedComponentToSelectedGroup=function(e){for(var o,a=u.selectedGroup,t=(u.selectedGroup=this.g.gName,u.getSelectedComponents()),s=u.getGroupByGroupName(u.selectedGroup).aCompIds,n=0;n<t.length;n++)p.isArrayContains(s,t[n])||((o=u.getComponentbyId(t[n])).groupings=u.manageGroupingInComponent(o,u.selectedGroup,"ADD"),s.push(t[n]));u.selectedGroup=a},u.selectGroup=function(e,o){var a=e.x||e.clientX,t=e.y||e.clientY;a&&t&&(t=a=null,t=e?$(e.currentTarget):$("#"+o),e.ctrlKey?(a=t.hasClass("selected-group"))?(t.removeClass("selected-group"),u.deSelectGroupComponent(o)):(t.addClass("selected-group"),u.selectGroupComponent(o)):(a=t.hasClass("c-active-group"),$(".c-group").hasClass("selected-group")&&($(".c-group").parent().find(".selected-group").each(function(e,o){u.deSelectGroupComponent(o.id)}),$(".c-group").removeClass("selected-group")),$(".c-group").removeClass("c-active-group"),$(".a-comps").css({visibility:"hidden"}),a?(t.removeClass("c-active-group"),t.parent().find(".a-comps").css({visibility:"hidden"}),u.selectedGroup="",u.fromExistingGroup=!1):(t.addClass("c-active-group"),t.parent().find(".a-comps").css({visibility:"visible"}),u.selectedGroup=o,u.fromExistingGroup=!0)))},u.getSelectedGroup=function(){return u.selectedGroup},u.duplicateGroup=function(e,o){e&&e.stopPropagation();e=u.getGroupByGroupName(o),o=angular.copy(e);try{u.getDashboardGroups(),o.aCompIds.length&&u.duplicateComponents(o.aCompIds)}catch(e){}},u.deleteGroup=function(e,o){e.stopPropagation(),u.tempGrp=u.selectedGroup,u.selectedGroup=o,u.deleteWarning='Are you sure to remove the group"'+o+'"?',$("#deleteGroupModalDialog").modal("show")},u.removeGroup=function(e,o){e&&e.stopPropagation();var a,t=angular.copy(o);try{if(a=u.getDashboardGroups(),t.aCompIds.length)for(var s=0;s<t.aCompIds.length;s++)u.removeComponentFromDashboardGroup(t.aCompIds[s],t.gName);a.splice(a.indexOf(o),1),0==a.length&&(u.fromExistingGroup=!1)}catch(e){}u.selectedGroup=u.tempGrp,u.tempGrp=null,$("#deleteGroupModalDialog").modal("hide")},u.deleteAllDbGroupsDialog=function(e){e.stopPropagation(),u.getDashboardGroups().length?(u.deleteAllWarning="Are you sure to remove all the groups ?",$("#deleteAllGroupModalDialog").modal("show")):p.showNotification("No group available","alert-info",3e3)},u.deleteAllDbGroups=function(e){e.stopPropagation();for(var o=u.getDashboardGroups(),a=angular.copy(o),t=0;t<a.length;t++){if(a[t].aCompIds.length)for(var s=0;s<a[t].aCompIds.length;s++)u.removeComponentFromDashboardGroup(a[t].aCompIds[s],a[t].gName);for(var n=0;n<o.length;n++)if(o[n].gName==a[t].gName){o.splice(n,1);break}0==o.length&&(u.fromExistingGroup=!1)}u.selectedGroup="",$("#deleteAllGroupModalDialog").modal("hide")},u.deleteComponent=function(e,o){e.stopPropagation(),u.deselectAllComponent(),u.selectComponent(o.objectID),u.executeAction(o.objectID,"removeComponent")},u.shiftComponentUp=function(e,o,a){e.stopPropagation();e=u.getComponentbyId(u.componentsList[a].objectID);u.redrawComponent(e,$("#dcc_"+u.componentsList[a].objectID).zIndex()+1),e=u.getComponentbyId(u.componentsList[a+1].objectID),u.redrawComponent(e,$("#dcc_"+u.componentsList[a+1].objectID).zIndex()-1),u.swapPositions(a,a+1)},u.shiftComponentDown=function(e,o,a){e.stopPropagation();e=u.getComponentbyId(u.componentsList[a].objectID);u.redrawComponent(e,$("#dcc_"+u.componentsList[a].objectID).zIndex()-1),e=u.getComponentbyId(u.componentsList[a-1].objectID),u.redrawComponent(e,$("#dcc_"+u.componentsList[a-1].objectID).zIndex()+1),u.swapPositions(a,a-1)},u.swapPositions=function(e,o){var a=u.componentsList[e],t=u.componentsList[o],s=u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[e],n=u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[o];u.componentsList[e]=t,u.componentsList[o]=a,u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[e]=n,u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object[o]=s},u.createDuplicate=function(e,o){e&&e.stopPropagation(),u.selectComponent(o.objectID),u.executeAction(o.objectID,"duplicateComponent")},u.handlePopover=function(e){e.stopPropagation();e={placement:"top",container:"#objectBrowser .bizVizControlBoxBody",html:!0,selector:".comp-appearance-icon",content:function(){return $("#obc-settings").html()}};$(".comp-appearance-icon").popover(e),$(".comp-appearance-icon").popover("toggle")},u.pinUnpinComp=function(e,o){var a=u.getComponentbyId(o.objectID);if(o.pinedComponent){a.isPined=!1,o.pinedComponent=!1,$("#dcc_"+o.objectID).hide();for(var t=u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].pinedObject,s=0;s<t.length;s++)t[s].objectID==o.objectID&&u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].pinedObject.splice(s,1)}else{a.isPined=!0,o.pinedComponent=!0,$("#dcc_"+o.objectID).show();a={objectID:o.objectID};u.isSelectedComponent(o.objectID)&&u.deselectComponent(o.objectID),u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].pinedObject.push(a)}},u.hideComponent=function(e,o,a){o.hideComponent=0==e?o.hideComponent:!o.hideComponent,e&&e.stopPropagation(),$(".comp-appearance-icon").popover("hide"),$(".bizVizControlBoxBody .popover").remove();e=DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",o.objectID);e.unShowHidden=o.hideComponent,IsBoolean(o.hideComponent)&&!a?p.showNotification(e.objectName+" is now Hidden","alert-info",3e3):a||p.showNotification(e.objectName+" is now Visible","alert-info",3e3),IsBoolean(o.hideComponent)?(u.isSelectedComponent(o.objectID)&&u.deselectComponent(o.objectID),$("#dcc_"+o.objectID).css({visibility:"hidden",display:"none"}),$("#dcc_"+o.objectID).css({visibility:"hidden"})):($("#dcc_"+o.objectID).css({visibility:"visible",display:"block"}),$("#dcc_"+o.objectID).css({visibility:"visible"}),u.hideAll=!1,u.hide_showAllBtnIcon="./resources/images/svg/hideAll.svg",u.hideShowGlyph="nt-eye-close-icon",u.hide_showAllToolTip="Hide All","benchmark_analysis_chart"!=e.componentType&&"datagrid"!==e.objectType&&"decomposition_chart"!==e.componentType&&"knowledge_graph_chart"!==e.componentType||u.redrawComponent(e)),u.isAllHidden()&&(u.hideShowGlyph="nt-eye-open-icon",u.hide_showAllToolTip="Show All",u.hideAll=!0)},u.hideAllComponent=function(e){if(u.hideAll=!u.hideAll,""!=u.modal.selectedDashboard)if(0!=e.length){for(var o=0;o<e.length;o++){var a=DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",e[o].objectID);"benchmark_analysis_chart"!=a.componentType&&"tree_grid"!==a.componentType&&"datagrid"!==a.objectType&&"decomposition_chart"!==a.componentType&&"knowledge_graph_chart"!==a.componentType||u.redrawComponent(a),IsBoolean(u.hideAll)?(a.unShowHidden=!0,e[o].hideComponent=!0,$("#dcc_"+e[o].objectID).css({visibility:"hidden",display:"none"})):(a.unShowHidden=!1,e[o].hideComponent=!1,$("#dcc_"+e[o].objectID).css({visibility:"visible",display:"block"}))}IsBoolean(u.hideAll)?(u.hide_showAllBtnIcon="./resources/images/svg/showAll.svg",u.hideShowGlyph="nt-eye-open-icon",u.hide_showAllToolTip="Show All",p.showNotification("All components are visible","alert-info",3e3)):(u.hide_showAllBtnIcon="./resources/images/svg/hideAll.svg",u.hideShowGlyph="nt-eye-close-icon",u.hide_showAllToolTip="Hide All",p.showNotification("All components are hidden","alert-info",3e3))}else p.showNotification("No component available","alert-warning",3e3);else p.showNotification("No dashboard found","alert-danger",3e3)},u.hideAllGroupComponent=function(e,o){e.stopPropagation();for(var a=o.aCompIds,t=[],s=!0,n=0;n<a.length;n++)if(t.push(u.getComponentbyId(a[n])),"AbsoluteLayout"!==u.modal.layoutType&&!t[n].isPined){s=!1;break}if(s)if(""!=u.modal.selectedDashboard)if(0!=t.length){for(var r,l=0;l<t.length;l++)null!=t[l]&&("benchmark_analysis_chart"!=(r=DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",t[l].objectID)).componentType&&"tree_grid"!==r.componentType&&"datagrid"!==r.objectType&&"decomposition_chart"!==r.componentType&&"knowledge_graph_chart"!==r.componentType||u.redrawComponent(r),IsBoolean(o.gCompHidden)?(r.unShowHidden=!1,t[l].hideComponent=!1,$("#dcc_"+t[l].objectID).css({visibility:"visible",display:"block"}),$("#ob-hideComp-checkbox"+t[l].objectID).prop("checked",!1)):(r.unShowHidden=!0,t[l].hideComponent=!0,$("#dcc_"+t[l].objectID).css({visibility:"hidden",display:"none"}),$("#ob-hideComp-checkbox"+t[l].objectID).prop("checked",!0)));IsBoolean(o.gCompHidden)?(o.iClass="visibility_off",o.tooltip="Hide All Components",o.gCompHidden=!1,p.showNotification("All components are visible","alert-info",3e3)):(o.iClass="visibility",o.tooltip="Show All Components",o.gCompHidden=!0,p.showNotification("All components are hidden","alert-info",3e3))}else p.showNotification("No component available","alert-warning",3e3);else p.showNotification("No dashboard found","alert-danger",3e3);else p.showNotification("Group components are unpinned","alert-danger",3e3);u.isAllHidden()&&(u.hideShowGlyph="nt-eye-open-icon",u.hide_showAllToolTip="Show All",u.hideAll=!0)},u.isAllHidden=function(){return $("input[name='HIDE_BTN']:checked").length===u.modal.selectedDashboard.json?.Dashboard[u.modal.layoutType].Object.length},u.isAllLock=function(){return $("input[name='LOCK_BTN']:checked").length===u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object.length},u.lockSelectedComponent=function(){for(var e=0;e<u.modal.listOfSelectedComponents.length;e++){var o=u.getManageComponentObj(u.modal.listOfSelectedComponents[e]);o&&(DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",o.objectID).showLocked=!0,o.lockComponent=!0,$("#dcc_"+o.objectID).resizable("option","disabled",!0),$("#dcc_"+o.objectID).draggable("option","disabled",!0),$("#dcc_"+o.objectID).css({"background-image":"none",opacity:"0.9"}),u.hideResizableHandles(o.objectID),u.hideSettingsBtn(o.objectID))}u.isAllLock()&&(u.lockMoveGlyph="lock_open",u.lockAll=!0,u.lock_unlockAllToolTip="Unlock All")},u.unLockSelectedComponent=function(){for(var e=0;e<u.modal.listOfSelectedComponents.length;e++){var o=u.getManageComponentObj(u.modal.listOfSelectedComponents[e]);o&&(DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",o.objectID).showLocked=!1,o.lockComponent=!1,$("#dcc_"+o.objectID).resizable("option","disabled",!1),$("#dcc_"+o.objectID).draggable("option","disabled",!1),$("#dcc_"+o.objectID).css({"background-image":"none",opacity:"1.0"}),u.lockAll=!1,u.lock_unlockAllBtnIcon="./resources/images/svg/lockAll.svg",u.lockMoveGlyph="lock",u.lock_unlockAllToolTip="Lock All")}},u.getManageComponentObj=function(e){for(var o=0;o<u.modal.componentListInObjectBrowser.length;o++)if(e==u.modal.componentListInObjectBrowser[o].objectID)return u.modal.componentListInObjectBrowser[o]},u.lockComponent=function(e,o,a){o.lockComponent=0==e?o.lockComponent:!o.lockComponent,e&&e.stopPropagation(),$(".comp-appearance-icon").popover("hide"),$(".bizVizControlBoxBody .popover").remove(),u.multiSelected&&u.removeMultiSelectedWrapDiv();e=DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",o.objectID);e.showLocked=o.lockComponent,IsBoolean(o.lockComponent)&&!a?p.showNotification(e.objectName+" is now Locked","alert-info",3e3):a||p.showNotification(e.objectName+" is now Unlocked","alert-info",3e3),IsBoolean(o.lockComponent)?($("#dcc_"+o.objectID).resizable("option","disabled",!0),$("#dcc_"+o.objectID).draggable("option","disabled",!0),$("#dcc_"+o.objectID).css({"background-image":"none",opacity:"0.9"}),u.hideResizableHandles(o.objectID),u.hideSettingsBtn(o.objectID)):($("#dcc_"+o.objectID).resizable("option","disabled",!1),$("#dcc_"+o.objectID).draggable("option","disabled",!1),$("#dcc_"+o.objectID).css({"background-image":"none",opacity:"1.0"}),u.lockAll=!1,u.lock_unlockAllBtnIcon="./resources/images/svg/lockAll.svg",u.lockMoveGlyph="lock",u.lock_unlockAllToolTip="Lock All"),u.isAllLock()&&(u.lockMoveGlyph="lock_open",u.lockAll=!0,u.lock_unlockAllToolTip="Unlock All"),u.multiSelected&&u.multiSelectDragConfiguration()},u.lockAllComponent=function(e){if(u.lockAll=!u.lockAll,""!=u.modal.selectedDashboard)if(0!=e.length){u.multiSelected&&u.removeMultiSelectedWrapDiv();for(var o=0;o<e.length;o++){var a=DesignerUtil.prototype.findInArray(u.modal.selectedDashboard.json.Dashboard[u.modal.layoutType].Object,"objectID",e[o].objectID);IsBoolean(u.lockAll)?(a.showLocked=!0,e[o].lockComponent=!0,$("#dcc_"+e[o].objectID).resizable("option","disabled",!0),$("#dcc_"+e[o].objectID).draggable("option","disabled",!0),$("#dcc_"+e[o].objectID).css({"background-image":"none",opacity:"0.9"}),u.hideResizableHandles(e[o].objectID),u.hideSettingsBtn(e[o].objectID)):(a.showLocked=!1,e[o].lockComponent=!1,$("#dcc_"+e[o].objectID).resizable("option","disabled",!1),$("#dcc_"+e[o].objectID).draggable("option","disabled",!1),$("#dcc_"+e[o].objectID).css({"background-image":"none",opacity:"1.0"}))}IsBoolean(u.lockAll)?(u.lock_unlockAllBtnIcon="./resources/images/svg/unlockAll.svg",u.lockMoveGlyph="lock_open",u.lock_unlockAllToolTip="Unlock All",p.showNotification("All components are locked","alert-info",3e3)):(u.lock_unlockAllBtnIcon="./resources/images/svg/lockAll.svg",u.lockMoveGlyph="lock",u.lock_unlockAllToolTip="Lock All",p.showNotification("All components are unlocked","alert-info",3e3)),u.multiSelected&&u.multiSelectDragConfiguration()}else p.showNotification("No component available","alert-warning",3e3);else p.showNotification("No dashboard found","alert-warning",3e3)},u.deleteAllComponent=function(e){if(""!=u.modal.selectedDashboard)if(0!=e.length){for(var o=0;o<e.length;o++)-1==u.modal.listOfSelectedComponents.indexOf(e[o].objectID)&&u.modal.listOfSelectedComponents.push(e[o].objectID);u.showModelPopup("deleteAllCompConfirmationFromManageDashPallete")}else p.showNotification("No component available","alert-warning",3e3);else p.showNotification("No dashboard found","alert-warning",3e3)}}]),!function(){var propCtrlFn=function($scope,ServiceFactory){$scope.oneAtATime=!0,$scope.status={isFirstOpen:!0,isFirstDisabled:!1},$scope.$on("cachePropertyInfo",function(e,o){$scope.dataFilePath=o.dataFilePath,$scope._currentComponentId=o.id,$scope._objectType=o.objectType,$scope.componentName=o.propFileName,$scope.cachePropertyPalette()}),$scope.cachePropertyPalette=function(){$scope.propertyJson={},$scope.modal.propertyJsonList.hasOwnProperty($scope.componentName)?$scope.propertyJson=$scope.modal.propertyJsonList[$scope.componentName]:ServiceFactory.getJsonFileData($scope.dataFilePath,function(e){$scope.propertyJson=e,$scope.modal.propertyJsonList.hasOwnProperty($scope.componentName)||($scope.modal.propertyJsonList[$scope.componentName]=$scope.propertyJson)})},$scope.initPropertyPalette=function(t,e){if(t){$scope.component=$scope.getComponentbyId(t);var s=e?"dashboard":$scope.component.componentType,n=$scope.component?AttributeMigration[$scope.component.objectType][0]:"Dashboard",e="./resources/data/property/"+s+".data";if($scope.component&&($scope.modal.selectedComponentId=t),$scope.propertyJson={},$scope.modal.propertyJsonList.hasOwnProperty(s)){if($scope.propertyJson=$scope.modal.propertyJsonList[s],void 0!==$scope.modal.globalFontProperties)for(var o in $scope.propertyJson)for(var a=0;a<$scope.propertyJson[o].length;a++)void 0!==$scope.propertyJson[o][a].attributeName&&("FontFamily"==$scope.propertyJson[o][a].attributeName||-1<$scope.propertyJson[o][a].attributeName.indexOf("FontFamily")||-1<$scope.propertyJson[o][a].attributeName.indexOf("fontFamily"))&&($scope.propertyJson[o][a].options=$scope.modal.globalFontProperties);$scope.modal.propertyJson=$scope.synchronizeProperty($scope.propertyJson,n,t),$scope.$$phase||$scope.$apply(function(){$scope.modal.currentSelectedPellet=$scope.modal.propertyJson})}else ServiceFactory.getJsonFileData(e,function(e){if($scope.propertyJson=e,void 0!==$scope.modal.globalFontProperties)for(var o in $scope.propertyJson)for(var a=0;a<$scope.propertyJson[o].length;a++)void 0!==$scope.propertyJson[o][a].attributeName&&("FontFamily"==$scope.propertyJson[o][a].attributeName||-1<$scope.propertyJson[o][a].attributeName.indexOf("FontFamily")||-1<$scope.propertyJson[o][a].attributeName.indexOf("fontFamily"))&&($scope.propertyJson[o][a].options=$scope.modal.globalFontProperties);$scope.modal.propertyJson=$scope.synchronizeProperty($scope.propertyJson,n,t),$scope.modal.propertyJsonList.hasOwnProperty(s)||($scope.modal.propertyJsonList[s]=$scope.propertyJson,$scope.$$phase)||$scope.$apply(function(){$scope.modal.currentSelectedPellet=$scope.modal.propertyJson})})}},$scope.synchronizeProperty=function(e,s,o){var a;$scope._currentComponentJSON=null;try{"Dashboard"==s?$scope._currentComponentJSON=$scope.modal.selectedDashboard.json.Dashboard:(a=$scope.modal.selectedDashboard.json.Dashboard[$scope.modal.layoutType].Object,$scope._currentComponentJSON=DesignerUtil.prototype.findInArray(a,"objectID",o)),$.each(e,function(e,o){"Info"!=e&&$.each(o,function(e,o){var a=ServiceFactory.correctObjectFormat($scope.getCurrentPropertyValue(o.attributeName,o.propertyName,s));switch(o.type){case"select":o.value=DesignerUtil.prototype.findInArray(o.options,"key",a);break;case"CascadedParentSelect":o.value=DesignerUtil.prototype.findInArray(o.options,"key",a),$scope.cascadedParentsChild[o.cascadedChild]=[],null!=o.value&&($scope.cascadedParentsChild[o.cascadedChild]=o.value.child);break;case"CascadedChildSelect":o.value=DesignerUtil.prototype.findInArray($scope.cascadedParentsChild[o.attributeName],"key",a);break;case"gradient":var t=a.split(",");o.value={gColor_1:t[0],gColor_2:t[1]};break;case"color":isNaN(a)?ServiceFactory.isValidHexColorString(a)?o.value=a:o.value="#0DAEA7":o.value=convertColorToHex(a);break;case"checkbox":o.value=IsBoolean(a);break;case"number":o.value=parseFloat(a);break;default:o.value=a}})})}catch(e){}return e},$scope.getCurrentPropertyValue=function(attributeName,propertyName,widgetType){try{var returnValue="",obj;if("Dashboard"==widgetType){var obj=$scope._currentComponentJSON,layoutType=$scope.modal.layoutType||"AbsoluteLayout",attr;switch(propertyName){case"absoluteLayout":var oldTheme=["brown-theme","black-theme","bstorycard-theme","orange-theme"],returnValue=obj[layoutType][attributeName];-1<oldTheme.indexOf(returnValue)&&"designerTheme"===attributeName&&(returnValue="default-theme");break;case"Dashboard":returnValue=-1<attributeName.indexOf("LanguageMapping.")?(attr=attributeName.split(".")[1],obj.LanguageMapping[attr]):obj[attributeName];break;default:returnValue=obj[attributeName]}}else obj=$scope._currentComponentJSON,null!=propertyName&&""!=propertyName&&(returnValue=("Object"==propertyName?obj:eval("obj."+propertyName))[attributeName]);return null==returnValue&&(returnValue=""),returnValue}catch(error){}},$scope.isValidObject=function(e){return angular.isObject(e)}};angular.module(designerModules.module.DesignerManager).controller("PropertyController",["$scope","ServiceFactory",propCtrlFn])}(),angular.module(designerModules.module.DesignerPropertyManager).controller("UserScriptController",["$scope","ServiceFactory","DesignerFactory",function(p,e,m){p.defaultValues=[],p.fnVisible=!1,p.scriptOf="",CodeMirror.hint.designerScriptHint=function(e,o){var t={from:e.getCursor(),to:e.getCursor(),list:[]},s=[],a=e.getCursor(),n=function(e,o){var a=o.toUpperCase(),e=e.toUpperCase();0==a.lastIndexOf(e,0)&&t.list.push(o)},r=function(e,o){return e.getTokenAt(o)},l=function(e){function a(e){$.each(e,function(e,o){if("string"==typeof o||"number"==typeof o||"boolean"==typeof o)return t.push(o),o;a(o)})}var t=[];return a(e),t},e=function(e){var o=e.getCursor(),a=r(e,o);for(a.state=CodeMirror.innerMode(e.getMode(),a.state).state,_tempProp=null,/^[\w$_]*$/.test(a.string)?a.end>o.ch&&(a.end=o.ch,a.string=a.string.slice(0,o.ch-a.start)):a={start:o.ch,end:o.ch,string:"",state:a.state,type:"."==a.string?"property":null},_tempProp=a;"property"==_tempProp.type;){var t=CodeMirror.Pos(o.line,_tempProp.start);if("."!=(_tempProp=r(e,t)).string)return!1;t=CodeMirror.Pos(o.line,_tempProp.start),_tempProp=r(e,t),s.push(_tempProp)}return{tokenHint:a,propOf:s}}(e),i=e.tokenHint,e=e.propOf[0];if(e)for(var d=(e=p.modal.sdkProperties[e.string])?l(e):[],c=0;c<d.length;c++)n(i.string,d[c]);else{var u=p.modal.dashVarMap[m.getSelectedDashboardId()];if(u)for(c=0;c<u.length;c++)n(i.string,u[c])}return t.from=CodeMirror.Pos(a.line,i.start),t.to=CodeMirror.Pos(a.line,i.end),t},p.onLoadScriptEditor=function(o){o.setSize("auto","100%"),window.cm=p.modal.cm=o,$(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(e){o.refresh(),o.focus()})},p.scriptEditorOptions={lineNumbers:!0,mode:{name:"javascript",helperType:"designerScriptHint"},autofocus:!0,tabSize:4,indentUnit:4,indentWithTabs:!0,undoDepth:500,extraKeys:{"Ctrl-Space":"autocomplete"},styleActiveLine:!0,matchBrackets:!0,lint:!0,gutters:["CodeMirror-lint-markers"]},p.resetFunctionWindow=function(e,o,a){p.displayFnOptions=!1,p.displayObjOptions=!1,p.clearObjectSearchKey(),o?""!=p.modal.selectedComponentId&&(o=DesignerUtil.prototype.findInArray(p.modal.selectedDashboard.json.Dashboard[p.modal.layoutType].Object,"objectID",p.modal.selectedComponentId),p.userScript=o.variable.userScript,p.scriptOf=o.objectName,p.userScript.id=p.modal.selectedComponentId):"Dashboard"==a?(p.userScript=p.modal.selectedDashboard.json.Dashboard.variable.userScript,p.scriptOf="Dashboard",p.userScript.id=p.modal.selectedDashboard.json.Dashboard.id):p.userScript=p.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.variable.userScript,p.modal.updateDashboardStatus(1),e?pasteElementChange(e):pasteElementChange("txt_UserScript_comp"),setTimeout(p.$apply.bind(p))},p.insertTextFromConnection=function(e,o,a){p.modal.selectedDashboard.json.Dashboard.DataProviders.selectedConnection.variable.userScript.value=null==a?insertTextAtCursorPos(e,"'"+o+"'"):insertTextAtCursorPos(e,o)},p.insertText=function(e,o,a){p.userScript.value=null==a?insertTextAtCursorPos(e,"'"+o+"'"):insertTextAtCursorPos(e,o)},p.changeToDefaultSelect=function(e){setTimeout(function(){$(".sel_InternalFunction").prop("selectedIndex",-1)},500)},p.pasteTextFromSearchObjects=function(e,o,a){e=$(e.currentTarget).attr("paste-to");null!=e&&(p.userScript.value=null==a?insertTextAtCursorPos(e,o):insertTextAtCursorPos(e,"'"+o+"'"))},p.loadInbuiltFunctions=function(){e.getJsonFileData("./resources/data/InbuiltFunctions.data",function(e){p.inbuiltFunctions=e})},p.clearObjectSearchKey=function(){$(".searchKeyText").val(""),$(".searchResult").addClass("ng-hide"),$(".srchAvailConditionTag").val(""),p.actualTag=""},p.updateSelectedInternalFunction=function(e,o){switch(p.selectedInternalFunction=o,$(e.target).closest(".tab-pane").attr("id")){case"csvLoadScriptDivision":case"excelLoadScriptDivision":case"webserviceLoadScriptDivision":p.insertTextFromConnection("txt_UserScript_csv",o.internalFunction,!1);break;default:p.insertText("txt_UserScript_comp",o.internalFunction,!1)}p.changeToDefaultSelect()},p.toggleFnOptions=function(e){e=$(e.target);p.displayObjOptions=!1,e.hasClass("bvz-display")||e.hasClass("bvz-display-placeholder")||e.hasClass("glyphicon")?p.displayFnOptions?(p.displayFnOptions=!1,p.fnQuery=""):(p.displayFnOptions=!0,setTimeout(function(){$(".bvz-search").focus()})):e.hasClass("bvz-search")||(p.displayFnOptions=!1,p.fnQuery="")}}]),angular.module(designerModules.module.DesignerPropertyManager).controller("WidgetController",["$scope","ServiceFactory",function(n,e){n.wGroups=[],n.widgets=[],n.allWidgets=[],n.charts=[],n.advCharts=[],n.grids=[],n.filters=[],n.others=[],n.active=!1,n.activeGroupId="",n.draggedItem={},n.search="",n.searchFound=!0,n.searchActive=!1,n.view={},n.WILD_CARD={ALL_COMPONENTS:"*",ALL_CHARTS:"*chart"},n.initWidgets=function(){n.view={viewIcon:"nt-apps-icon",isListView:!1},e.getJsonFileData("./resources/data/widgets.data",function(e){n.wGroups=e.wGroups,n.prepareAllWidgets(),n.showCharts()})},n.showCharts=function(){var o=setInterval(function(){var e=angular.element($("#CHARTS")[0]);e.length&&(e.trigger("click"),$(".group-widget-separator").find(".pointer").css("left",20),clearInterval(o))},100)},n.switchView=function(){n.view.isListView?(n.view.isListView=!1,n.view.viewIcon="nt-apps-icon"):(n.view.isListView=!0,n.view.viewIcon="nt-chart-list-icon")},n.prepareAllWidgets=function(){for(var e=0;e<n.wGroups.length;e++)switch(n.wGroups[e].gId){case"CHARTS":n.charts=n.wGroups[e].gItems,n.allWidgets=$.merge(n.allWidgets,n.charts);break;case"GRIDS":n.grids=n.wGroups[e].gItems,n.allWidgets=$.merge(n.allWidgets,n.grids);break;case"FILTERS":n.filters=n.wGroups[e].gItems,n.allWidgets=$.merge(n.allWidgets,n.filters);break;case"ADV_CHARTS":n.advCharts=n.wGroups[e].gItems,n.allWidgets=$.merge(n.allWidgets,n.advCharts);break;case"OTHER":n.others=n.wGroups[e].gItems,n.allWidgets=$.merge(n.allWidgets,n.others)}},n.displayWidgets=function(e,o){e&&(e.stopPropagation(),n.displayAsCurrent(e),n.movePointer(e)),n.activeGroupId=o.gId,n.widgets=o.gItems,o.disabled=!1,n.searchFound=!0,n.search="",n.searchActive=!1,n.disableOtherGroups(o)},n.displayAsCurrent=function(e){n.removeSelection(),$(e.currentTarget).find(".highlighter").addClass("current")},n.removeSelection=function(){$(".highlighter").removeClass("current")},n.disableOtherGroups=function(e){for(var o=0;o<n.wGroups.length;o++)e.gId!=n.wGroups[o].gId&&(n.wGroups[o].disabled=!0);n.active=!0},n.enableAllGroups=function(){for(var e=0;e<n.wGroups.length;e++)n.wGroups[e].disabled=!1;n.active=!1},n.setDraggedItem=function(e,o){e=(e=e||window.event).buttons;return e!=1&&e!=3&&e!=2&&(n.draggedItem=o,!0)},n.isWildCardToken=function(e){for(var o=n.WILD_CARD,a=Object.keys(o),t=0;t<a.length;t++)if(e==o[a[t]])return!0;return!1},n.prepareWidgetList=function(e){var o=null,a=null,t=e.trim().toLowerCase();if(n.widgets=[],n.searchActive=0<n.search.length,!t)return n.enableAllGroups(),n.active=!1,n.clearSearch(),!1;if(n.isWildCardToken(t))switch(t){case n.WILD_CARD.ALL_COMPONENTS:n.widgets=n.allWidgets;break;case n.WILD_CARD.ALL_CHARTS:n.widgets=$.merge($.merge([],n.charts),n.advCharts)}else for(var s=0;s<n.allWidgets.length;s++)(a=(o=n.allWidgets[s].name)?o.trim().toLowerCase():"")&&-1!=a.indexOf(t)&&n.widgets.push(n.allWidgets[s]);n.widgets.length?n.searchFound=!0:n.searchFound=!1},n.clearSearch=function(){var e=$("#"+n.activeGroupId);n.search="",e.length&&setTimeout(function(){angular.element(e[0]).trigger("click")},1)},n.searchWidget=function(){n.removeSelection(),n.disableOtherGroups({id:"BIZVIZ"}),n.prepareWidgetList(n.search),$(".group-widget-separator").find(".pointer").css("left",156)},n.movePointer=function(e){var o=e.currentTarget.clientWidth/2,e=e.currentTarget.offsetLeft+o-5;$(".group-widget-separator").find(".pointer").css("left",e)}}]);
//# sourceMappingURL=designer.ctrl.min.js.map